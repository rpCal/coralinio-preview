(this.webpackJsonpcoralinio=this.webpackJsonpcoralinio||[]).push([[0],{61:function(t,e,a){},63:function(t,e,a){},83:function(t,e){t.exports=function(t){var e=function(e,a,i,n,s){t.BufferGeometry.call(this),this.type="RoundedBoxGeometry",s=isNaN(s)?1:Math.max(1,Math.floor(s)),e=isNaN(e)?1:e,a=isNaN(a)?1:a,i=isNaN(i)?1:i,n=isNaN(n)?.15:n;var o=e/2-(n=Math.min(n,Math.min(e,Math.min(a,Math.min(i)))/2)),d=a/2-n,r=i/2-n;this.parameters={width:e,height:a,depth:i,radius:n,radiusSegments:s};var c=s+1,l=c*s+1<<3,u=new t.BufferAttribute(new Float32Array(3*l),3),h=new t.BufferAttribute(new Float32Array(3*l),3),p=[],f=[],b=(new t.Vector3,new t.Vector3),g=[],x=[],j=[],v=c*s,y=c*s+1;!function(){for(var e=[new t.Vector3(1,1,1),new t.Vector3(1,1,-1),new t.Vector3(-1,1,-1),new t.Vector3(-1,1,1),new t.Vector3(1,-1,1),new t.Vector3(1,-1,-1),new t.Vector3(-1,-1,-1),new t.Vector3(-1,-1,1)],a=0;a<8;a++)p.push([]),f.push([]);for(var i=Math.PI/2,c=new t.Vector3(o,d,r),l=0;l<=s;l++){var u=l/s*i,h=Math.cos(u),j=Math.sin(u);if(l!=s)for(var v=0;v<=s;v++){var y=v/s*i;b.x=h*Math.cos(y),b.y=j,b.z=h*Math.sin(y);S=b.clone().multiplyScalar(n).add(c);p[0].push(S),g.push(S);m=b.clone().normalize();f[0].push(m),x.push(m)}else{b.set(0,1,0);var S=b.clone().multiplyScalar(n).add(c);p[0].push(S),g.push(S);var m=b.clone();f[0].push(m),x.push(m)}}for(var O=1;O<8;O++)for(a=0;a<p[0].length;a++){S=p[0][a].clone().multiply(e[O]);p[O].push(S),g.push(S);m=f[0][a].clone().multiply(e[O]);f[O].push(m),x.push(m)}}(),function(){var t=v,e=v+y,a=v+2*y,i=v+3*y;j.push(t),j.push(e),j.push(a),j.push(t),j.push(a),j.push(i),t=v+4*y,e=v+5*y,a=v+6*y,i=v+7*y,j.push(t),j.push(a),j.push(e),j.push(t),j.push(i),j.push(a),t=0,e=y,a=4*y,i=5*y,j.push(t),j.push(a),j.push(e),j.push(e),j.push(a),j.push(i),t=2*y,e=3*y,a=6*y,i=7*y,j.push(t),j.push(a),j.push(e),j.push(e),j.push(a),j.push(i),t=s,e=s+3*y,a=s+4*y,i=s+7*y,j.push(t),j.push(e),j.push(a),j.push(e),j.push(i),j.push(a),t=s+y,e=s+2*y,a=s+5*y,i=s+6*y,j.push(t),j.push(a),j.push(e),j.push(e),j.push(a),j.push(i)}(),function(){for(var t=[!0,!1,!0,!1,!1,!0,!1,!0],e=c*(s-1),a=0;a<8;a++){for(var i=y*a,n=0;n<s-1;n++)for(var o=n*c,d=(n+1)*c,r=0;r<s;r++){var l=r+1,u=i+o+r,h=i+o+l,p=i+d+r,f=i+d+l;t[a]?(j.push(u),j.push(p),j.push(h),j.push(h),j.push(p),j.push(f)):(j.push(u),j.push(h),j.push(p),j.push(h),j.push(f),j.push(p))}for(r=0;r<s;r++){u=i+e+r,h=i+e+r+1,p=i+v;t[a]?(j.push(u),j.push(p),j.push(h)):(j.push(u),j.push(h),j.push(p))}}}(),function(){for(var t=0;t<4;t++)for(var e=t*y,a=4*y+e,i=!0&t,n=0;n<s;n++){var o=n+1,d=e+n,r=e+o,c=a+n,l=a+o;i?(j.push(d),j.push(c),j.push(r),j.push(r),j.push(c),j.push(l)):(j.push(d),j.push(r),j.push(c),j.push(r),j.push(l),j.push(c))}}(),function(){for(var t=s-1,e=[0,1,4,5],a=[3,2,7,6],i=[0,1,1,0],n=0;n<4;n++)for(var o=e[n]*y,d=a[n]*y,r=0;r<=t;r++){var l=o+s+r*c,u=o+(r!=t?s+(r+1)*c:y-1),h=d+s+r*c,p=d+(r!=t?s+(r+1)*c:y-1);i[n]?(j.push(l),j.push(h),j.push(u),j.push(u),j.push(h),j.push(p)):(j.push(l),j.push(u),j.push(h),j.push(u),j.push(p),j.push(h))}}(),function(){for(var t=[0,2,4,6],e=[1,3,5,7],a=0;a<4;a++)for(var i=y*t[a],n=y*e[a],o=1>=a,d=0;d<s;d++){var r=d*c,l=(d+1)*c,u=i+r,h=i+l,p=n+r,f=n+l;o?(j.push(u),j.push(p),j.push(h),j.push(h),j.push(p),j.push(f)):(j.push(u),j.push(h),j.push(p),j.push(h),j.push(f),j.push(p))}}();for(var S=0,m=0;m<g.length;m++)u.setXYZ(S,g[m].x,g[m].y,g[m].z),h.setXYZ(S,x[m].x,x[m].y,x[m].z),S++;this.setIndex(new t.BufferAttribute(new Uint16Array(j),1)),this.addAttribute("position",u),this.addAttribute("normal",h)};return e.prototype=Object.create(t.BufferGeometry.prototype),e.constructor=e,e}},84:function(t,e,a){"use strict";a.r(e);var i,n,s,o,d,r=a(0),c=a.n(r),l=a(17),u=a.n(l),h=(a(61),a(62),a(63),a(37)),p=a(14);!function(t){t.BasicRectangle="BasicRectangle",t.BasicEllipse="BasicEllipse"}(i||(i={})),function(t){t.Idle="Idle",t.EditLines="EditLines",t.AddLine="AddLine",t.EditBeads="EditBeads",t.AddBeads="AddBeads",t.DeleteBeads="DeleteBeads",t.PaintBeads="ColorPaint"}(n||(n={})),function(t){t.None="None",t.File="File",t.Grid="Grid",t.Background="Background"}(s||(s={})),function(t){t.Hex="Hex",t.Box="Box"}(o||(o={})),function(t){t.Color="Color"}(d||(d={}));var f,b,g,x,j,v=a(12),y=a(10),S="#aeaeae",m="#4fc3f7",O=a(7),k=a(8),B=a(20),C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(k.a)({x:t,y:e},B.a,!0)},D=function(t){var e=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)}(t),a=0===e,i=a?0:t.x/e,n=a?0:t.y/e;return C(i,n)},w=function(t,e){return C(t.x*e,t.y*e)},_=function(t,e,a){return C(t.x+e,t.y+a)},I=function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))},M=function(t,e,a){return a.x>t.x&&a.x<e.x&&a.y>t.y&&a.y<e.y},E=a(11),L=a(2),A=a(4),R=a(5),N=a(6),T=a(30),F=a(22),z=a.n(F),H=function(t){var e=Object(k.a)({id:Object(T.generate)(),position:C(0,0),type:i.BasicEllipse,rotate:0,lineRotate:0,color:m,height:10,width:10,keepAspectRatio:!1},B.a,!0);return Object(F.merge)(e,t)},P=function(t){var e=Object(k.a)({id:Object(T.generate)(),start:C(10,10),end:C(100,100),beadIds:[],settings:{beadsCount:0,beadsAutoCount:!0,beadsSpacing:0,beadsAutoSpacing:!1,defaultBead:H({})}},B.a,!0);return Object(F.merge)(e,t)},V=function(t,e,a,i,n){var s=C(a-t,i-e);return s=D(s),s=w(s,n),s=_(s,t,e)},W=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"updateBeadsPositions",value:function(t){var e=this.draftState.appData.lines[t],a=this.getLineBeadsCount(t),i=e.beadIds.length;if(a>i){var n=a-i;this.addRemainingBeads(t,n)}else if(a<i){var s=i-a;this.removeOverflowBeads(t,s)}this.draftState.appData.lines[t].settings.beadsCount=a,this.modifyBeadsPosition(t),this.modifyBeadsRotate(t)}},{key:"getLineBeadsCount",value:function(t){var e=this,a=this.draftState.appData.lines[t],i=a.settings,n=i.beadsAutoCount,s=i.beadsAutoSpacing,o=i.beadsCount,d=i.beadsSpacing,r=i.defaultBead,c=a.start,l=a.end,u=a.beadIds,h=I(c,l);if(!0===n&&!0===s){var p=[],f=0;if(u.forEach((function(t){var a=e.draftState.appData.beads[t].width;f+=a,p.push(a)})),h>=f){var b=r.width?r.width:10,g=h-f;return Math.floor(g/b)+p.length}for(var x=p.length-1;x>=0;x--){if(h>(f-=p[x]))return x}return 0}if(!1===n&&!1===s)return o;if(!0===n&&!1===s){var j=[],v=0;if(u.forEach((function(t){var a=e.draftState.appData.beads[t].width+d;v+=a,j.push(a)})),h>=v-d){var y=r.width?r.width:10,S=h-(v-d);return Math.floor(S/(y+d))+j.length}for(var m=j.length-1;m>=0;m--){if(h>(v-=j[m])-d)return m}return 0}return!1===n&&!0===s?o:0}},{key:"addRemainingBeads",value:function(t,e){for(var a=this.draftState.appData.lines[t],i=0;i<e;i++){var n={};a.settings.defaultBead?n=Object(p.a)({},a.settings.defaultBead):this.draftState.ui.lineSettings.settings&&this.draftState.ui.lineSettings.settings.defaultBead&&(n=Object(p.a)({},this.draftState.ui.lineSettings.settings.defaultBead)),n.id=void 0,n.position=void 0;var s=H(n);this.draftState.appData.beads[s.id]=s,this.draftState.appData.lines[t].beadIds.push(s.id)}}},{key:"removeOverflowBeads",value:function(t,e){for(var a=0;a<e;a++){var i=this.draftState.appData.lines[t].beadIds.length,n=this.draftState.appData.lines[t].beadIds.splice(i-1,1);delete this.draftState.appData.beads[n[0]]}}},{key:"modifyBeadsPosition",value:function(t){var e=this,a=this.draftState.appData.lines[t],i=a.start,n=a.end,s=a.beadIds,o=a.settings,d=o.beadsAutoCount,r=o.beadsAutoSpacing,c=o.beadsSpacing;if(!0===d&&!0===r){var l=0;this.draftState.appData.lines[t].beadIds.forEach((function(t){var a=e.draftState.appData.beads[t],s=a.width,o=a.height;l+=s/2;var d=V(i.x,i.y,n.x,n.y,l),r=d.x-s/2,c=d.y-o/2+5;e.draftState.appData.beads[t].position.x=r,e.draftState.appData.beads[t].position.y=c,l+=s/2}))}else if(!1===d&&!1===r){var u=0;this.draftState.appData.lines[t].beadIds.forEach((function(t){var a=e.draftState.appData.beads[t],s=a.width,o=a.height;u+=s/2;var d=V(i.x,i.y,n.x,n.y,u),r=d.x-s/2,l=d.y-o/2+5;e.draftState.appData.beads[t].position.x=r,e.draftState.appData.beads[t].position.y=l,u=u+s/2+c}))}else if(!0===d&&!1===r){var h=0;this.draftState.appData.lines[t].beadIds.forEach((function(t){var a=e.draftState.appData.beads[t],s=a.width,o=a.height;h+=s/2;var d=V(i.x,i.y,n.x,n.y,h),r=d.x-s/2,l=d.y-o/2+5;e.draftState.appData.beads[t].position.x=r,e.draftState.appData.beads[t].position.y=l,h=h+s/2+c}))}else if(!1===d&&!0===r){var p=0;s.forEach((function(t){var a=e.draftState.appData.beads[t].width;p+=a}));var f=I(i,n)-p,b=0;s.length>1&&(b=f/(s.length-1));var g=0;this.draftState.appData.lines[t].beadIds.forEach((function(t){var a=e.draftState.appData.beads[t],s=a.width,o=a.height;g+=s/2;var d=V(i.x,i.y,n.x,n.y,g),r=d.x-s/2,c=d.y-o/2+5;e.draftState.appData.beads[t].position.x=r,e.draftState.appData.beads[t].position.y=c,g=g+s/2+b}))}}},{key:"modifyBeadsRotate",value:function(t){var e,a,i=this,n=this.draftState.appData.lines[t],s=n.start,o=n.end,d=n.beadIds,r=(e=s.x-o.x,a=s.y-o.y,Math.atan2(e,a));d.forEach((function(t){i.draftState.appData.beads[t].lineRotate=-1*(180*r/Math.PI)}))}}]),a}(E.ImmerReducer),G=function(){function t(){Object(L.a)(this,t),this._events=void 0,this._events={}}return Object(A.a)(t,[{key:"on",value:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)}},{key:"removeListener",value:function(t,e){if(!this._events[t])throw new Error("Can't remove a listener. Event \"".concat(t,"\" doesn't exits."));this._events[t]=this._events[t].filter((function(t){return t!==e}))}},{key:"emit",value:function(t,e,a){if(console.log("EventEmitter:emit:",t,e),this._events[t]){this._events[t].forEach((function(t){t(e,a)}))}else console.warn("Can't emit an event. Event \"".concat(t,"\" doesn't exits."))}}]),t}(),Y=function(){return void 0===f&&(f=new G),f},X=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"action_updateSceneZoom",value:function(t){this.draftState.ui.sceneWrapperPosition=t}},{key:"action_updateSceneWrapperSize",value:function(t){var e=t.width,a=t.height;this.draftState.ui.sceneWrapperWidth=e,this.draftState.ui.sceneWrapperHeight=a}},{key:"editorAppDataHasChanged",value:function(){this.draftState.ui.saveInfo.saved=!1,this.draftState.ui.saveInfo.haveUnsavedChanges=!0}},{key:"action_onAddLine",value:function(t,e){var a=P(Object(p.a)(Object(p.a)({},this.draftState.ui.lineSettings),{},{start:t,end:e}));this.draftState.appData.lines[a.id]=a,this.draftState.mode=n.EditLines,this.updateBeadsPositions(a.id),this.editorAppDataHasChanged()}},{key:"action_onStartPointDrag",value:function(t,e){if(this.draftState.appData.lines[t]){var a=this.draftState.appData.lines[t],i=this.draftState.ui.grid,n=i.width,s=i.height,d=i.snapEnabled,r=i.type,c=i.hexSize;if(!0===d){if(r===o.Box)a.start.x=Math.round(e.x/n)*n-5,a.start.y=Math.round(e.y/s)*s-5;else if(r===o.Hex){var l=Math.sqrt(3)*c,u=2*c,h=u*(3/4),p=Math.round(e.x/l)*l-5,f=Math.round(e.y/h),b=f*h-5-u/4;a.start.y=b,a.start.x=f%2===0?l/2+p:p}}else a.start.x=e.x-5,a.start.y=e.y-5;this.updateBeadsPositions(a.id),this.editorAppDataHasChanged()}}},{key:"action_onEndPointDrag",value:function(t,e){if(this.draftState.appData.lines[t]){var a=this.draftState.appData.lines[t],i=this.draftState.ui.grid,n=i.width,s=i.height,d=i.snapEnabled,r=i.hexSize,c=i.type;if(!0===d){if(c===o.Box)a.end.x=Math.round(e.x/n)*n-5,a.end.y=Math.round(e.y/s)*s-5;else if(c===o.Hex){var l=Math.sqrt(3)*r,u=2*r,h=u*(3/4),p=Math.round(e.x/l)*l-5,f=Math.round(e.y/h),b=f*h-5-u/4;a.end.y=b,a.end.x=f%2===0?l/2+p:p}}else a.end.x=e.x-5,a.end.y=e.y-5;this.updateBeadsPositions(a.id),this.editorAppDataHasChanged()}}},{key:"action_onLineDrag",value:function(t,e){var a=e.startX,i=e.startY,n=e.lineStart,s=e.lineEnd,d=e.x,r=e.y;if(this.draftState.appData.lines[t]){var c=this.draftState.appData.lines[t],l=this.draftState.ui.grid,u=l.width,h=l.height,p=l.snapEnabled,f=l.type,b=l.hexSize;if(!0===p){if(f===o.Box)c.start.x=Math.round((c.start.x+e.deltaX)/u)*u-5,c.start.y=Math.round((c.start.y+e.deltaY)/h)*h-5,c.end.x=Math.round((c.end.x+e.deltaX)/u)*u-5,c.end.y=Math.round((c.end.y+e.deltaY)/h)*h-5;else if(f===o.Hex){var g=Math.sqrt(3)*b,x=2*b,j=x*(3/4);if(null!==n){var v=n.x+(d-a),y=n.y+(r-i),S=Math.round(v/g)*g-5,m=Math.round(y/j),O=m*j-5-x/4;c.start.y=O,c.start.x=m%2===0?g/2+S:S}if(null!==s){var k=s.x+(d-a),B=s.y+(r-i),C=Math.round(k/g)*g-5,D=Math.round(B/j),w=D*j-5-x/4;c.end.y=w,c.end.x=D%2===0?g/2+C:C}}}else c.start.x=c.start.x+e.deltaX,c.start.y=c.start.y+e.deltaY,c.end.x=c.end.x+e.deltaX,c.end.y=c.end.y+e.deltaY;this.updateBeadsPositions(c.id),this.editorAppDataHasChanged()}}},{key:"action_onGroupLineDrag",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){if(e.draftState.appData.lines[a]){var i=e.draftState.appData.lines[a],n=e.draftState.ui.grid,s=n.width,o=n.height;!0===n.snapEnabled?(i.start.x=Math.round((i.start.x+t.deltaX)/s)*s-5,i.start.y=Math.round((i.start.y+t.deltaY)/o)*o-5,i.end.x=Math.round((i.end.x+t.deltaX)/s)*s-5,i.end.y=Math.round((i.end.y+t.deltaY)/o)*o-5):(i.start.x=i.start.x+t.deltaX,i.start.y=i.start.y+t.deltaY,i.end.x=i.end.x+t.deltaX,i.end.y=i.end.y+t.deltaY),e.updateBeadsPositions(i.id)}})),this.editorAppDataHasChanged()}},{key:"action_onGroupBeadsDrag",value:function(t){}},{key:"action_onClickLine",value:function(t){this.draftState.ui.selectedLinesIds={},this.draftState.ui.selectedLinesIds[t]=!0,this.draftState.ui.selectedLinesIdsCount=1}},{key:"action_onClickLastestLine",value:function(){var t=Object.keys(this.draftState.appData.lines);if(t.length>0){var e=t[t.length-1];this.action_onClickLine(e)}}},{key:"action_onClickBead",value:function(t){this.draftState.ui.selectedBeadsIds={},this.draftState.ui.selectedBeadsIds[t]=!0,this.draftState.ui.selectedBeadsIdsCount=1}},{key:"action_addBeads_onMouseDown",value:function(t){var e=t.x,a=t.y;this.draftState.ui.currentBeadChain.isDragEnabled=!0;var i=Object(p.a)({},this.draftState.ui.beadsTemplate);i.id=void 0,i.position=C(e,a);var n=H(i);n.position.x=n.position.x-n.width/2,n.position.y=n.position.y-n.height/2,this.draftState.appData.beads[n.id]=n,this.draftState.ui.currentBeadChain.beadIds.push(n.id)}},{key:"action_addBeads_onMouseMove",value:function(t){var e=t.x,a=t.y;if(this.draftState.ui.currentBeadChain.isDragEnabled){var i=this.draftState.ui.currentBeadChain.beadIds.length,n=this.draftState.ui.currentBeadChain.beadIds[i-1],s=this.draftState.appData.beads[n],o=C(e,a),d=C(s.position.x+s.width/2,s.position.y+s.height/2);if(I(d,o)>s.width){var r=function(t,e,a){return C(t.x-e,t.y-a)}(o,d.x,d.y),c=D(r),l=w(c,s.width),u=Object(p.a)({},this.draftState.ui.beadsTemplate);u.id=void 0;var h=d.x+l.x,f=d.y+l.y;u.position=C(h,f);var b=H(u);b.position.x=b.position.x-b.width/2,b.position.y=b.position.y-b.height/2,this.draftState.appData.beads[b.id]=b,this.draftState.ui.currentBeadChain.beadIds.push(b.id)}}}},{key:"action_addBeadOnClick",value:function(t){var e=t.x,a=t.y,i=Object(p.a)({},this.draftState.ui.beadsTemplate);i.id=void 0,i.position=C(e,a);var n=H(i);n.position.x=n.position.x-n.width/2,n.position.y=n.position.y-n.height/2,this.draftState.appData.beads[n.id]=n,Y().emit("action_addBeadOnClick",{bead:n},this.state)}},{key:"action_addBeads_onMouseUp",value:function(t){t.x,t.y;this.draftState.ui.currentBeadChain.isDragEnabled=!1,this.draftState.ui.currentBeadChain.beadIds=[]}}]),a}(W),U=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"action_onClearCanvas",value:function(){this.draftState.appData.beads={},this.draftState.appData.lines={},this.draftState.ui.selectedBeadsIds={},this.draftState.ui.selectedBeadsIdsCount=0,this.draftState.ui.selectedLinesIds={},this.draftState.ui.selectedLinesIdsCount=0,this.draftState.ui.saveInfo.saved=!1,this.draftState.ui.saveInfo.haveUnsavedChanges=!1}},{key:"action_readSavedCanvas",value:function(){console.log("action_readSavedCanvas");for(var t=0;t<100;t+=10)for(var e=0;e<500;e+=10){var a=H({width:8,height:8,position:{x:t,y:e}});this.draftState.appData.beads[a.id]=a}Y().emit("action_readSavedCanvas",this.draftState.appData,this.state)}},{key:"action_onSaveCanvas",value:function(){"localStorage"in window?(localStorage.setItem("appData",JSON.stringify(this.draftState.appData)),this.draftState.ui.saveInfo.saved=!0,this.draftState.ui.saveInfo.haveUnsavedChanges=!1,console.log("action_onSaveCanvas saved")):(this.draftState.ui.saveInfo.saved=!1,console.info("No localstorage available"))}}]),a}(W),q=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){var t;Object(L.a)(this,a);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(t=e.call.apply(e,[this].concat(n))).clearSelectedBeads=function(){t.draftState.ui.selectedBeadsIdsCount>0&&(t.draftState.ui.selectedBeadsIds={},t.draftState.ui.selectedBeadsIdsCount=0)},t.clearSelectedLines=function(){t.draftState.ui.selectedLinesIdsCount&&(t.draftState.ui.selectedLinesIds={},t.draftState.ui.selectedLinesIdsCount=0)},t}return Object(A.a)(a,[{key:"action_onChangeEditorMode",value:function(t){this.draftState.mode=t,this.clearSelectedBeads(),this.clearSelectedLines()}},{key:"action_setSaveInfo",value:function(t){this.draftState.ui.saveInfo.saved=t}}]),a}(E.ImmerReducer),Z=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"action_test",value:function(){}},{key:"action_restoreState",value:function(){}}]),a}(E.ImmerReducer),J=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"action_onEditBeadsMouseDown",value:function(t,e){console.log("action_onEditBeadsMouseDown??"),this.draftState.ui.mouseSelection.isDragStarted=!0,this.draftState.ui.mouseSelection.start.x=t,this.draftState.ui.mouseSelection.start.y=e,this.draftState.ui.mouseSelection.end.x=t,this.draftState.ui.mouseSelection.end.y=e}},{key:"action_onEditBeadsMouseMove",value:function(t,e){var a=this;if(console.log("action_onEditBeadsMouseMove??"),this.draftState.ui.mouseSelection.end.x=t,this.draftState.ui.mouseSelection.end.y=e,!1===this.draftState.ui.mouseSelection.isDragged){var i=this.draftState.ui.mouseSelection,n=i.start,s=i.end,o=s.x-n.x,d=s.y-n.y;(Math.abs(o)>5||Math.abs(d)>5)&&(this.draftState.ui.mouseSelection.isDragged=!0)}if(!0===this.draftState.ui.mouseSelection.isDragged){var r=this.draftState.ui.mouseSelection,c=r.start,l=r.end,u=C(Math.min(c.x,l.x),Math.min(c.y,l.y)),h=C(Math.max(c.x,l.x),Math.max(c.y,l.y));this.draftState.ui.selectedBeadsIds={},this.draftState.ui.selectedBeadsIdsCount=0,Object.keys(this.draftState.appData.beads).forEach((function(t){var e=a.draftState.appData.beads[t],i=C(e.position.x+10,e.position.y+10);M(u,h,i)&&(a.draftState.ui.selectedBeadsIds[t]=!0,a.draftState.ui.selectedBeadsIdsCount=a.draftState.ui.selectedBeadsIdsCount+1)}))}}},{key:"action_selectBeads",value:function(t){var e=this,a=Object.keys(this.draftState.ui.selectedBeadsIds),i=z.a.xor(a,t).map((function(t){return a.includes(t)?Object(k.a)({},t,!1):Object(k.a)({},t,!0)}));this.draftState.ui.selectedBeadsIds={},this.draftState.ui.selectedBeadsIdsCount=0,t.length>0&&Object.keys(this.draftState.appData.beads).forEach((function(a){t.includes(a)&&(e.draftState.ui.selectedBeadsIds[a]=!0,e.draftState.ui.selectedBeadsIdsCount=e.draftState.ui.selectedBeadsIdsCount+1)})),Y().emit("action_selectBeads",{diffStates:i},this.state)}},{key:"action_onEditBeadsMouseUp",value:function(){!1===this.draftState.ui.mouseSelection.isDragged&&this.draftState.ui.selectedBeadsIdsCount>0&&(this.draftState.ui.selectedBeadsIds={},this.draftState.ui.selectedBeadsIdsCount=0),this.draftState.ui.mouseSelection.isDragStarted=!1,this.draftState.ui.mouseSelection.isDragged=!1,this.draftState.ui.mouseSelection.start.x=0,this.draftState.ui.mouseSelection.start.y=0,this.draftState.ui.mouseSelection.end.x=0,this.draftState.ui.mouseSelection.end.y=0}},{key:"action_onEditLinesMouseDown",value:function(t,e){this.draftState.ui.mouseSelection.isDragStarted=!0,this.draftState.ui.mouseSelection.start.x=t,this.draftState.ui.mouseSelection.start.y=e,this.draftState.ui.mouseSelection.end.x=t,this.draftState.ui.mouseSelection.end.y=e}},{key:"action_onEditLinesMouseMove",value:function(t,e){var a=this;if(this.draftState.ui.mouseSelection.end.x=t,this.draftState.ui.mouseSelection.end.y=e,!1===this.draftState.ui.mouseSelection.isDragged){var i=this.draftState.ui.mouseSelection,n=i.start,s=i.end,o=s.x-n.x,d=s.y-n.y;(Math.abs(o)>5||Math.abs(d)>5)&&(this.draftState.ui.mouseSelection.isDragged=!0)}if(!0===this.draftState.ui.mouseSelection.isDragged){var r=this.draftState.ui.mouseSelection,c=r.start,l=r.end,u=C(Math.min(c.x,l.x),Math.min(c.y,l.y)),h=C(Math.max(c.x,l.x),Math.max(c.y,l.y));this.draftState.ui.selectedLinesIds={},this.draftState.ui.selectedLinesIdsCount=0,Object.keys(this.draftState.appData.lines).forEach((function(t){var e=a.draftState.appData.lines[t];(M(u,h,e.start)||M(u,h,e.end))&&(a.draftState.ui.selectedLinesIds[t]=!0,a.draftState.ui.selectedLinesIdsCount=a.draftState.ui.selectedLinesIdsCount+1)}))}}},{key:"action_onEditLinesMouseUp",value:function(){!1===this.draftState.ui.mouseSelection.isDragged&&this.draftState.ui.selectedLinesIdsCount>0&&(this.draftState.ui.selectedLinesIds={},this.draftState.ui.selectedLinesIdsCount=0),this.draftState.ui.mouseSelection.isDragStarted=!1,this.draftState.ui.mouseSelection.isDragged=!1,this.draftState.ui.mouseSelection.start.x=0,this.draftState.ui.mouseSelection.start.y=0,this.draftState.ui.mouseSelection.end.x=0,this.draftState.ui.mouseSelection.end.y=0}}]),a}(E.ImmerReducer),K=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"editorAppDataHasChanged",value:function(){this.draftState.ui.saveInfo.saved=!1,this.draftState.ui.saveInfo.haveUnsavedChanges=!0}},{key:"action_changeBeadFill",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){e.draftState.appData.beads[a].color=t})),this.editorAppDataHasChanged()}},{key:"action_updateLight",value:function(t,e,a){if(this.draftState.ui.lights[t][e]){var i=this.draftState.ui.lights[t];i[e]=a;var n=i.name;this.editorAppDataHasChanged(),Y().emit("action_updateLight",{name:n,field:e,value:a},this.state)}}},{key:"action_changeBeadType",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){e.draftState.appData.beads[a].type=t})),this.editorAppDataHasChanged()}},{key:"action_onBeadRotate",value:function(t,e){e.deg}},{key:"action_onBeadsRotate",value:function(t){t.deg}},{key:"action_changeSelectedLinesBeadsSpacing",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsSpacing=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLinesBeadsAutoSpacing",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsAutoSpacing=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLinesBeadsCount",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsCount=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLinesBeadsAutoCount",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsAutoCount=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_resetSelectedLines",value:function(){var t=this,e=Object.keys(this.draftState.ui.selectedLinesIds)[0],a=this.draftState.appData.lines[e],i=Object(p.a)({},a.settings.defaultBead);i.id=void 0,i.position=void 0,Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(e){t.draftState.appData.lines[e].beadIds.forEach((function(e){i&&(t.draftState.appData.beads[e]=Object(F.merge)(t.draftState.appData.beads[e],i))})),t.draftState.appData.lines[e].settings.defaultBead=Object(F.merge)(t.draftState.appData.lines[e].settings.defaultBead,i),t.updateBeadsPositions(e)})),this.editorAppDataHasChanged()}},{key:"action_deleteSelectedLines",value:function(){var t=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(e){t.draftState.appData.lines[e].beadIds.forEach((function(e){delete t.draftState.appData.beads[e]})),delete t.draftState.appData.lines[e]})),this.draftState.ui.selectedLinesIds={},this.draftState.ui.selectedLinesIdsCount=0,this.editorAppDataHasChanged()}},{key:"action_cloneSelectedLines",value:function(){var t=this,e=[];Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){var i=P(Object(p.a)(Object(p.a)({},t.draftState.appData.lines[a]),{},{id:void 0,beadIds:[]}));i.start.x=i.start.x+20,i.start.y=i.start.y+20,i.end.x=i.end.x+20,i.end.y=i.end.y+20,t.draftState.appData.lines[a].beadIds.forEach((function(e){var a=H(Object(p.a)(Object(p.a)({},t.draftState.appData.beads[e]),{},{id:void 0}));a.position.x=a.position.x+20,a.position.y=a.position.y+20,t.draftState.appData.beads[a.id]=a,i.beadIds.push(a.id)})),e.push(i.id),t.draftState.appData.lines[i.id]=i})),e.forEach((function(e){t.updateBeadsPositions(e)})),this.draftState.ui.selectedLinesIds={},this.draftState.ui.selectedLinesIdsCount=0,e.forEach((function(e){t.draftState.ui.selectedLinesIds[e]=!0,t.draftState.ui.selectedLinesIdsCount=t.draftState.ui.selectedLinesIdsCount+1})),this.editorAppDataHasChanged()}},{key:"action_changeDefaultLineBeadsCount",value:function(t){this.draftState.ui.lineSettings.settings&&(this.draftState.ui.lineSettings.settings.beadsCount=t)}},{key:"action_changeDefaultLineBeadsAutoCount",value:function(t){this.draftState.ui.lineSettings.settings&&(this.draftState.ui.lineSettings.settings.beadsAutoCount=t)}},{key:"action_changeDefaultLineBeadsSpacing",value:function(t){this.draftState.ui.lineSettings.settings&&(this.draftState.ui.lineSettings.settings.beadsSpacing=t)}},{key:"action_changeDefaultLineBeadsAutoSpacing",value:function(t){this.draftState.ui.lineSettings.settings&&(this.draftState.ui.lineSettings.settings.beadsAutoSpacing=t)}},{key:"action_changeDefaultLineBeadType",value:function(t){this.draftState.ui.lineSettings.settings&&this.draftState.ui.lineSettings.settings.defaultBead&&(this.draftState.ui.lineSettings.settings.defaultBead.type=t)}},{key:"action_changeDefaultLineColor",value:function(t){this.draftState.ui.lineSettings.settings&&this.draftState.ui.lineSettings.settings.defaultBead&&(this.draftState.ui.lineSettings.settings.defaultBead.color=t)}},{key:"action_changeDefaultLineBeadHeight",value:function(t){var e=this.draftState.ui.lineSettings;if(e.settings&&e.settings.defaultBead){var a=e.settings.defaultBead,i=a.width,n=a.height;if(a.keepAspectRatio&&i&&n)if(n>=1){var s=i/n;e.settings.defaultBead.width=t*s,e.settings.defaultBead.height=t}else e.settings.defaultBead.height=1;else e.settings.defaultBead.height=t}}},{key:"action_changeDefaultLineBeadWidth",value:function(t){var e=this.draftState.ui.lineSettings;if(e.settings&&e.settings.defaultBead){var a=e.settings.defaultBead,i=a.width,n=a.height;if(a.keepAspectRatio&&i&&n)if(i>=1){var s=n/i;e.settings.defaultBead.width=t,e.settings.defaultBead.height=t*s}else e.settings.defaultBead.width=1;else e.settings.defaultBead.width=t}}},{key:"action_changeDefaultLineBeadKeepAspectRatio",value:function(t){var e=this.draftState.ui.lineSettings;e.settings&&e.settings.defaultBead&&(e.settings.defaultBead.keepAspectRatio=t)}},{key:"action_changeDefaultLineBeadRotate",value:function(t){var e=this.draftState.ui.lineSettings;e.settings&&e.settings.defaultBead&&(e.settings.defaultBead.rotate=t)}},{key:"action_changeSelectedLines_settings_beadsCount",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsCount=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_settings_beadsAutoCount",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsAutoCount=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_settings_beadsSpacing",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsSpacing=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_settings_beadsAutoSpacing",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.beadsAutoSpacing=t,e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_defaultBead_type",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.defaultBead.type=t,e.draftState.appData.lines[a].beadIds.forEach((function(a){e.draftState.appData.beads[a].type=t})),e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_defaultBead_color",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.defaultBead.color=t,e.draftState.appData.lines[a].beadIds.forEach((function(a){e.draftState.appData.beads[a].color=t})),e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_defaultBead_height",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){var i=e.draftState.appData.lines[a],n=i.settings.defaultBead,s=n.width,o=n.height;if(!1===n.keepAspectRatio)i.settings.defaultBead.height=t,e.draftState.appData.lines[a].beadIds.forEach((function(a){e.draftState.appData.beads[a].height=t})),e.updateBeadsPositions(a);else{if(s&&o){if(t>=1)s=t*(s/o),o=t;i.settings.defaultBead.width=s,i.settings.defaultBead.height=o}e.draftState.appData.lines[a].beadIds.forEach((function(t){s&&o&&(e.draftState.appData.beads[t].width=s,e.draftState.appData.beads[t].height=o)})),e.updateBeadsPositions(a)}})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_defaultBead_width",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){var i=e.draftState.appData.lines[a],n=i.settings.defaultBead,s=n.width,o=n.height;if(!1===n.keepAspectRatio)i.settings.defaultBead.width=t,e.draftState.appData.lines[a].beadIds.forEach((function(a){e.draftState.appData.beads[a].width=t})),e.updateBeadsPositions(a);else{if(s&&o){if(t>=1){var d=o/s;s=t,o=t*d}i.settings.defaultBead.width=s,i.settings.defaultBead.height=o}e.draftState.appData.lines[a].beadIds.forEach((function(t){s&&o&&(e.draftState.appData.beads[t].width=s,e.draftState.appData.beads[t].height=o)})),e.updateBeadsPositions(a)}})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_defaultBead_keepAspectRatio",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.defaultBead.keepAspectRatio=t,e.draftState.appData.lines[a].beadIds.forEach((function(a){e.draftState.appData.beads[a].keepAspectRatio=t})),e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedLines_defaultBead_rotate",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedLinesIds).forEach((function(a){e.draftState.appData.lines[a].settings.defaultBead.rotate=t,e.draftState.appData.lines[a].beadIds.forEach((function(a){e.draftState.appData.beads[a].rotate=t})),e.updateBeadsPositions(a)})),this.editorAppDataHasChanged()}},{key:"action_changeSelectedBeads_type",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){e.draftState.appData.beads[a].type=t})),this.updateLineFromSelectedBeads()}},{key:"action_changeSelectedBeads_color",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){e.draftState.appData.beads[a].color=t})),Y().emit("action_changeSelectedBeads_color",{beadIds:Object.keys(this.draftState.ui.selectedBeadsIds),color:t},this.state),this.updateLineFromSelectedBeads()}},{key:"action_changeSelectedBeads_height",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){var i=e.draftState.appData.beads[a],n=i.width,s=i.height;if(!1===i.keepAspectRatio)e.draftState.appData.beads[a].height=t;else{if(n&&s)if(t>=1)n=t*(n/s),s=t;e.draftState.appData.beads[a].width=n,e.draftState.appData.beads[a].height=s}})),this.updateLineFromSelectedBeads()}},{key:"action_changeSelectedBeads_width",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){var i=e.draftState.appData.beads[a],n=i.width,s=i.height;if(!1===i.keepAspectRatio)e.draftState.appData.beads[a].width=t;else{if(n&&s&&t>=1){var o=s/n;n=t,s=t*o}e.draftState.appData.beads[a].width=n,e.draftState.appData.beads[a].height=s}})),this.updateLineFromSelectedBeads()}},{key:"action_changeSelectedBeads_keepAspectRatio",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){e.draftState.appData.beads[a].keepAspectRatio=t})),this.updateLineFromSelectedBeads()}},{key:"action_changeSelectedBeads_rotate",value:function(t){var e=this;Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){e.draftState.appData.beads[a].rotate=t})),this.updateLineFromSelectedBeads()}},{key:"updateLineFromSelectedBeads",value:function(){var t=this,e=[];Object.keys(this.draftState.ui.selectedBeadsIds).forEach((function(a){for(var i=0,n=Object.keys(t.draftState.appData.lines);i<n.length;i++){var s=n[i];if(-1!==t.draftState.appData.lines[s].beadIds.indexOf(a)&&-1===e.indexOf(s)){e.push(s);break}}}));for(var a=0,i=e;a<i.length;a++){var n=i[a];this.updateBeadsPositions(n)}}},{key:"action_updateBrushSize",value:function(t){this.draftState.ui.brush.size=t}},{key:"action_updateBrushColor",value:function(t){this.draftState.ui.brush.color=t}},{key:"action_updateBeadsTemplate",value:function(t,e){if(void 0!==this.draftState.ui.beadsTemplate[t]){var a=this.draftState.ui.beadsTemplate,i=a.keepAspectRatio,n=a.width,s=a.height;if(!0===i){if("width"===t){if(e>=1)s=e*(s/n);this.draftState.ui.beadsTemplate.height=s}if("height"===t){if(e>=1)n=e*(n/s);this.draftState.ui.beadsTemplate.width=n}}this.draftState.ui.beadsTemplate[t]=e}else console.warn("action_updateBeadsTemplate: key dont exists ".concat(t))}}]),a}(W),Q=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"action_toggleMenuFile",value:function(){this.draftState.ui.currentMenuMainOpen===s.File?this.draftState.ui.currentMenuMainOpen=s.None:this.draftState.ui.currentMenuMainOpen=s.File}},{key:"action_toggleMenuSettings",value:function(){this.draftState.ui.currentMenuMainOpen===s.Grid?this.draftState.ui.currentMenuMainOpen=s.None:this.draftState.ui.currentMenuMainOpen=s.Grid}},{key:"action_toggleMenuBackground",value:function(){this.draftState.ui.currentMenuMainOpen===s.Background?this.draftState.ui.currentMenuMainOpen=s.None:this.draftState.ui.currentMenuMainOpen=s.Background}},{key:"action_toggleGridSnapEnabled",value:function(){this.draftState.ui.grid.snapEnabled=!this.draftState.ui.grid.snapEnabled}},{key:"action_toggleGridIsVisible",value:function(){this.draftState.ui.grid.isVisible=!this.draftState.ui.grid.isVisible}},{key:"action_setGridWidth",value:function(t){this.draftState.ui.grid.width=t}},{key:"action_setGridHeight",value:function(t){this.draftState.ui.grid.height=t}},{key:"action_setGridType",value:function(t){this.draftState.ui.grid.type=t}},{key:"action_setGridHexSize",value:function(t){this.draftState.ui.grid.hexSize=t}},{key:"action_background_image_clear",value:function(){this.draftState.ui.background.image.position=C(0,0),this.draftState.ui.background.image.scale=1,this.draftState.ui.background.image.url=""}},{key:"action_background_image_upload",value:function(t){this.draftState.ui.background.image.url=t}},{key:"action_background_image_pointX",value:function(t){this.draftState.ui.background.image.position.x=t}},{key:"action_background_image_pointY",value:function(t){this.draftState.ui.background.image.position.y=t}},{key:"action_background_image_scale",value:function(t){this.draftState.ui.background.image.scale=t}},{key:"action_background_image_opacity",value:function(t){this.draftState.ui.background.image.opacity=t}}]),a}(E.ImmerReducer),$=function(t){Object(R.a)(a,t);var e=Object(N.a)(a);function a(){return Object(L.a)(this,a),e.apply(this,arguments)}return Object(A.a)(a,[{key:"action_applyColorBrush",value:function(t,e){var a=this,i=this.draftState.ui.brush,n=i.color,s=i.type,o=i.size;if(s===d.Color){var r=C(t+o/2,e+o/2);Object.keys(this.draftState.appData.beads).forEach((function(t){var e=a.draftState.appData.beads[t];if(e.color!==n){var i=C(e.position.x+e.width/2,e.position.y+e.height/2);I(i,r)<o/2+Math.min(e.width,e.height)/2&&(a.draftState.appData.beads[t].color=n)}}))}}}]),a}(E.ImmerReducer),tt=H({}),et={appData:{beads:{},lines:{}},ui:{lights:[{type:"THREE.DirectionalLight",name:"main_light_1",color:"#FFF",intensity:.8,position:{x:0,y:0,z:10}},{type:"THREE.DirectionalLight",name:"main_light_2",color:"#FFF",intensity:.4,position:{x:0,y:0,z:10}}],lineSettings:{settings:{beadsAutoCount:!0,beadsAutoSpacing:!0,beadsCount:0,beadsSpacing:0,defaultBead:{type:i.BasicEllipse,rotate:0,color:m,height:52,width:52,keepAspectRatio:!1}}},saveInfo:{saved:!1,haveUnsavedChanges:!1},selectedLinesIds:{},selectedLinesIdsCount:0,selectedBeadsIds:{},selectedBeadsIdsCount:0,mouseSelection:{start:C(0,0),end:C(0,0),isDragStarted:!1,isDragged:!1},currentMenuMainOpen:s.None,grid:{type:o.Hex,hexSize:30,snapEnabled:!0,isVisible:!0,width:30,height:30},brush:{type:d.Color,size:50,color:m},background:{image:{url:"",scale:1,position:C(0,0),opacity:.5}},beadsTemplate:{color:tt.color,width:tt.width,height:tt.height,keepAspectRatio:tt.keepAspectRatio,rotate:tt.rotate,type:tt.type},currentBeadChain:{isDragEnabled:!1,beadIds:[]},sceneWrapperWidth:0,sceneWrapperHeight:0,sceneWrapperPosition:{x:0,y:0,angle:0,scale:0,top:0,left:0}},mode:n.Idle},at={Main:Object(E.createActionCreators)(Z),Draggable:Object(E.createActionCreators)(X),Persist:Object(E.createActionCreators)(U),ChangeEditorMode:Object(E.createActionCreators)(q),MouseSelection:Object(E.createActionCreators)(J),Toolbar:Object(E.createActionCreators)(K),Topbar:Object(E.createActionCreators)(Q),Paint:Object(E.createActionCreators)($)},it=Y(),nt=Object(B.b)((function(t,e){it.emit(e.type,e.payload,t)}),{}),st=Object(E.composeReducers)(Object(E.createReducerFunction)(Z,et),Object(E.createReducerFunction)(X,et),Object(E.createReducerFunction)(U,et),Object(E.createReducerFunction)(K,et),Object(E.createReducerFunction)(Q,et),Object(E.createReducerFunction)(q,et),Object(E.createReducerFunction)(J,et),Object(E.createReducerFunction)($,et),nt),ot=a(1),dt=function(t){var e=t.editorMode,a=Object(O.b)(),i=function(t){a(at.ChangeEditorMode.action_onChangeEditorMode(t))};return Object(ot.jsxs)("div",{className:"",children:[Object(ot.jsx)(rt,{label:"Idle",icon:Object(ot.jsx)(v.a,{icon:y.a,color:S}),onClick:function(){return i(n.Idle)},isSelected:e===n.Idle}),Object(ot.jsx)(rt,{label:"Edit",icon:Object(ot.jsx)(v.a,{icon:y.g,color:S}),onClick:function(){return i(n.EditBeads)},isSelected:e===n.EditBeads}),Object(ot.jsx)(rt,{label:"Add",icon:Object(ot.jsx)(v.a,{icon:y.m,color:S}),onClick:function(){return i(n.AddBeads)},isSelected:e===n.AddBeads}),Object(ot.jsx)(rt,{label:"Paint",icon:Object(ot.jsx)(v.a,{icon:y.m,color:S}),onClick:function(){return i(n.PaintBeads)},isSelected:e===n.PaintBeads}),Object(ot.jsx)(rt,{label:"Delete",icon:Object(ot.jsx)(v.a,{icon:y.m,color:S}),onClick:function(){return i(n.DeleteBeads)},isSelected:e===n.DeleteBeads})]})},rt=function(t){var e=t.label,a=t.isSelected,i=t.onClick,n=t.icon;return Object(ot.jsxs)("div",{className:"\n              button \n              ".concat(a?"is-active":"","\n            "),onClick:i,children:[Object(ot.jsx)("span",{className:"icon is-small",children:n}),Object(ot.jsx)("span",{children:e})]})},ct=function(t){var e=t.bead,a=t.opacity,n=t.zIndex,s=t.isSelected,o=t.isSelectable,d=void 0!==a&&a>=0&&a<=1,r=void 0!==n&&n>=0&&n<=9999,c=Object(O.b)(),l=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return"translate3d(".concat(t,"px, ").concat(e,"px, ").concat(a,"px)")}(e.position.x,e.position.y),u=e.rotate+e.lineRotate,h=u?"rotateZ(".concat(u,"deg)"):"rotateZ(0deg)",p={transform:"".concat(l," ").concat(h),opacity:d?a:1,zIndex:r?n:void 0,border:s?"1px solid #000":"",width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),background:e.color};return e.type===i.BasicEllipse&&(p.borderRadius="100%"),Object(ot.jsx)("div",{className:"bead-item",onClick:function(){o&&c(at.Draggable.action_onClickBead(e.id))},style:p,children:"\xa0"})},lt=function(t){var e=t.bead,a=H(Object(p.a)(Object(p.a)({},e),{},{position:C(0,0)}));return Object(ot.jsx)("div",{style:{marginTop:"20px",marginBottom:"20px",display:"flex",justifyContent:"center",alignItems:"center",height:"100px",boxSizing:"border-box"},children:Object(ot.jsx)("div",{style:{position:"relative",top:"".concat(-1*e.height/2,"px"),left:"".concat(-1*e.width/2,"px")},children:Object(ot.jsx)(ct,{bead:a,isSelected:!1,isSelectable:!1})})})},ut=a(56),ht=function(t){var e=t.label,a=t.icon,i=t.value,n=t.onToggle;return Object(ot.jsxs)("div",{className:"fieldset",onClick:n,style:{cursor:"pointer"},children:[Object(ot.jsxs)("div",{className:"label",children:[a?Object(ot.jsx)("div",{style:{width:"30px",display:"flex",justifyContent:"center",alignItems:"center",height:"30px",marginRight:"10px"},children:a}):null,e?Object(ot.jsx)("div",{children:e}):null]}),Object(ot.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",boxSizing:"border-box",paddingLeft:"10px",paddingRight:"20px",width:"100%"},children:Object(ot.jsx)("div",{children:void 0!==i?i:"-"})})]})},pt=function(t){var e=t.selected,a=t.label,i=t.icon,n=t.children,s=Object(r.useState)(!1),o=Object(ut.a)(s,2),d=o[0],l=o[1];return Object(ot.jsxs)("div",{style:{borderTop:"1px solid #dfdfdf"},children:[Object(ot.jsx)(ht,{label:a,onToggle:function(){l(!d)},icon:i,value:e}),!0===d?Object(ot.jsx)("div",{style:{background:"#fff"},children:c.a.cloneElement(n)}):null]})},ft=a(33),bt=a(3),gt=function(t){t.value;var e=t.onChange,a=(Object(ft.a)(t,["value","onChange"]),[[bt.p[900],bt.p[700],bt.p[500],bt.p[300],bt.p[100]],[bt.n[900],bt.n[700],bt.n[500],bt.n[300],bt.n[100]],[bt.o[900],bt.o[700],bt.o[500],bt.o[300],bt.o[100]],[bt.g[900],bt.g[700],bt.g[500],bt.g[300],bt.g[100]],[bt.i[900],bt.i[700],bt.i[500],bt.i[300],bt.i[100]],[bt.b[900],bt.b[700],bt.b[500],bt.b[300],bt.b[100]],[bt.j[900],bt.j[700],bt.j[500],bt.j[300],bt.j[100]],[bt.e[900],bt.e[700],bt.e[500],bt.e[300],bt.e[100]],[bt.q[900],bt.q[700],bt.q[500],bt.q[300],bt.q[100]],["#194D33",bt.h[700],bt.h[500],bt.h[300],bt.h[100]],[bt.k[900],bt.k[700],bt.k[500],bt.k[300],bt.k[100]],[bt.l[900],bt.l[700],bt.l[500],bt.l[300],bt.l[100]],[bt.r[900],bt.r[700],bt.r[500],bt.r[300],bt.r[100]],[bt.a[900],bt.a[700],bt.a[500],bt.a[300],bt.a[100]],[bt.m[900],bt.m[700],bt.m[500],bt.m[300],bt.m[100]],[bt.f[900],bt.f[700],bt.f[500],bt.f[300],bt.f[100]],[bt.d[900],bt.d[700],bt.d[500],bt.d[300],bt.d[100]],[bt.c[900],bt.c[700],bt.c[500],bt.c[300],bt.c[100]],["#000000","#525252","#969696","#D9D9D9","#FFFFFF"]]);return Object(ot.jsx)("div",{style:{width:"100%",paddingTop:"20px",paddingBottom:"30px",paddingLeft:"20px",paddingRight:"20px"},children:Object(ot.jsx)(xt,{colors:a,onClick:e})})},xt=function(t){var e=t.colors,a=t.onClick;return Object(ot.jsx)("div",{children:Object(ot.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",alignItems:"center",flexWrap:"wrap"},children:e.map((function(t){return Object(ot.jsx)("div",{style:{marginBottom:"10px"},children:t.map((function(t){return Object(ot.jsx)("div",{style:{cursor:"pointer",border:"3px solid transparent",boxSizing:"border-box"},children:Object(ot.jsx)("div",{onClick:function(){return a(t)},style:{boxSizing:"border-box",background:t,width:"28px",height:"28px",borderRadius:"100%",border:"none"}})},t)}))},t.toString())}))})})},jt=function(t){var e=t.value,a=t.isSelected,i=t.onClick;return Object(ot.jsx)("div",{style:{border:"5px solid transparent"},children:Object(ot.jsx)("div",{onClick:i?function(){return i(e)}:void 0,style:{width:25,height:25,background:e,marginBottom:0,marginRight:0,border:"2px solid #000",boxShadow:a?"2px 2px 2px rgba(0,0,0,1)":"2px 2px 2px rgba(0,0,0,0.1)"}})})},vt=function(t){var e=t.value,a=t.onChange;return Object(ot.jsx)(pt,{selected:Object(ot.jsx)(jt,{value:e,isSelected:!1,onClick:void 0}),label:"Color",icon:Object(ot.jsx)(v.a,{icon:y.n,color:S,size:"lg"}),children:Object(ot.jsx)(gt,{value:e,onChange:a})})},yt=(b={},Object(k.a)(b,i.BasicEllipse,"circle"),Object(k.a)(b,i.BasicRectangle,"rectangle-wide"),b),St=function(t){var e=t.value,a=t.onChange;return Object(ot.jsx)(mt,{types:yt,selectedType:e,onClick:a})},mt=function(t){var e=t.types,a=t.selectedType,i=t.onClick;return Object(ot.jsxs)("div",{className:"fieldset",style:{},children:[Object(ot.jsx)("div",{className:"label"}),Object(ot.jsx)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",boxSizing:"border-box",paddingLeft:"10px",paddingRight:"20px",width:"100%"},children:Object.keys(e).map((function(t,n){return Object(ot.jsx)(Ot,{icon:e[t],type:t,isSelected:a===t,onClick:i},n)}))})]})},Ot=function(t){var e=t.icon,a=t.type,i=t.isSelected,n=t.onClick;return Object(ot.jsx)("div",{style:{border:"5px solid transparent"},children:Object(ot.jsxs)("div",{onClick:n?function(){return n(a)}:void 0,style:{width:25,height:25,background:"#eee",marginBottom:0,marginRight:0,border:"2px solid #000",boxShadow:i?"2px 2px 2px rgba(0,0,0,1)":"2px 2px 2px rgba(0,0,0,0.1)",display:"flex",justifyContent:"center",alignItems:"center"},children:["circle"===e?Object(ot.jsx)(v.a,{icon:y.d}):null,"rectangle-wide"===e?Object(ot.jsx)(v.a,{icon:y.h}):null]})})},kt=function(t){var e=t.value,a=t.onChange;return Object(ot.jsx)(pt,{selected:Object(ot.jsx)(Ot,{icon:e?yt[e]:void 0,type:e,isSelected:!1,onClick:void 0}),label:"Type",icon:Object(ot.jsx)(v.a,{icon:y.p,color:S,size:"lg"}),children:Object(ot.jsx)(St,{value:e,onChange:a})})},Bt=(a(45),a(25)),Ct=Object(Bt.a)(Bt.b),Dt=function(t){var e=t.value,a=t.onChange,i=t.label,n=t.icon;return Object(ot.jsxs)("div",{className:"fieldset",style:{paddingTop:"10px",paddingBottom:"10px",paddingLeft:"10px",paddingRight:"10px",display:"flex",flexDirection:"row",justifyContent:"space-between",background:"#fff",borderBottom:0},children:[Object(ot.jsxs)("div",{className:"label",style:{padding:0,width:"105px"},children:[n?Object(ot.jsx)("div",{style:{width:"30px",display:"flex",justifyContent:"center",alignItems:"center",height:"30px",marginRight:"10px"},children:n}):null,i?Object(ot.jsx)("div",{children:i}):null]}),Object(ot.jsx)("div",{style:{boxSizing:"border-box",flexGrow:1,paddingRight:"10px",paddingBottom:"10px"},children:Object(ot.jsx)(Ct,{max:100,min:1,step:1,value:e,onChange:function(t){return a(t)},defaultValue:10,marks:{0:"0",50:"50",100:"100"}})})]})},wt=function(t){var e=t.label,a=t.value,i=t.onChange,n=t.isDisabled;return Object(ot.jsxs)("div",{className:"fieldset",children:[Object(ot.jsx)("div",{className:"label",children:e}),Object(ot.jsx)("input",{type:"checkbox",disabled:n,value:!0===a?1:0,checked:!0===a,onChange:function(t){return i("0"===t.target.value)}})]})},_t=function(t){var e=t.height,a=t.width,i=t.keepAspectRatio,n=t.onChange_beadHeight,s=t.onChange_beadWidth,o=t.onChange_keepAspectRatio,d=function(t){return t.toLocaleString(void 0,{maximumFractionDigits:2,style:"decimal"})},r="".concat(d(a)," x ").concat(d(e));return Object(ot.jsx)("div",{children:Object(ot.jsx)(pt,{selected:r,label:"Size",icon:Object(ot.jsx)(v.a,{icon:y.i,color:S,size:"lg"}),children:Object(ot.jsxs)("div",{children:[Object(ot.jsx)("div",{style:{width:"100%",background:"#fff"},children:Object(ot.jsx)(wt,{label:Object(ot.jsxs)("div",{style:{display:"flex",flexWrap:"nowrap",justifyContent:"space"},children:[Object(ot.jsx)("div",{style:{width:"30px",display:"flex",justifyContent:"center",alignItems:"center",height:"30px",marginRight:"10px",background:"#fff"},children:Object(ot.jsx)(v.a,{icon:!0===i?y.l:y.s,color:S,size:"lg"})}),Object(ot.jsx)("div",{children:"Keep aspect ratio"})]}),value:i,onChange:o,isDisabled:!1})}),Object(ot.jsx)(Dt,{label:"Width",icon:Object(ot.jsx)(v.a,{icon:y.b,color:S,size:"lg"}),value:a,onChange:s}),Object(ot.jsx)(Dt,{label:"Height",icon:Object(ot.jsx)(v.a,{icon:y.c,color:S,size:"lg"}),value:e,onChange:n})]})})})},It=Object(Bt.a)(Bt.b),Mt=function(t){var e=t.value,a=t.onChange,i=Object(ft.a)(t,["value","onChange"]);return Object(ot.jsx)("div",{style:{background:"#fff",width:"100%",paddingTop:"20px",paddingBottom:"30px",paddingLeft:"20px",paddingRight:"20px"},children:Object(ot.jsx)(It,Object(p.a)({max:100,min:1,step:1,value:e,onChange:function(t){return a(t)},defaultValue:10,marks:{0:"0",50:"50",100:"100"}},i))})},Et=a(24),Lt=function(t){var e=t.value,a=t.onChange;return Object(ot.jsx)(pt,{selected:"".concat(e,"deg"),label:"Rotate",icon:Object(ot.jsx)(v.a,{icon:y.q,color:S,size:"lg"}),children:Object(ot.jsxs)(c.a.Fragment,{children:[Object(ot.jsx)(Mt,{value:e,onChange:function(t){a(t)},max:180,min:-180,defaultValue:0,marks:{"-180":"-180",0:"0",180:"180"}}),Object(ot.jsx)(Et.a,{suffix:"deg",allowNegative:!0,allowEmptyFormatting:!0,value:e,onValueChange:function(t){a(t.floatValue)},placeholder:" deg",style:{color:"#4a4a4a",textAlign:"center",border:"1px solid #aeaeae",fontFamily:"Open Sans, sans-serif",fontSize:"1em",fontWeight:400,lineHeight:"1.5",padding:"3px 10px",marginBottom:"15px",marginTop:"5px"}})]})})},At=function(t){return!0===t.isVisible?Object(ot.jsx)(Rt,{}):Object(ot.jsx)(c.a.Fragment,{})},Rt=function(){return Object(O.c)((function(t){return t.ui.selectedBeadsIdsCount>=1}))?Object(ot.jsx)(Nt,{}):Object(ot.jsx)(c.a.Fragment,{})},Nt=function(){return Object(ot.jsxs)(c.a.Fragment,{children:[Object(ot.jsx)(Pt,{}),Object(ot.jsx)(Ft,{}),Object(ot.jsx)(Ht,{}),Object(ot.jsx)(zt,{}),Object(ot.jsx)(Tt,{})]})},Tt=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){var e=Object.keys(t.ui.selectedBeadsIds)[0];return t.appData.beads[e]}));if(!e)return Object(ot.jsx)(c.a.Fragment,{});return Object(ot.jsx)(Lt,{value:e.rotate,onChange:function(e){var a=e;void 0!==e&&null!==e&&!0!==isNaN(e)||(a=0),t(at.Toolbar.action_changeSelectedBeads_rotate(a))}})},Ft=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){var e=Object.keys(t.ui.selectedBeadsIds)[0];return t.appData.beads[e]}));if(!e)return Object(ot.jsx)(c.a.Fragment,{});var a=e.width?e.width:10,i=e.height?e.height:10,n=!!e.keepAspectRatio&&e.keepAspectRatio;return Object(ot.jsx)("div",{children:Object(ot.jsx)(_t,{height:i,width:a,keepAspectRatio:n,onChange_beadHeight:function(e){t(at.Toolbar.action_changeSelectedBeads_height(e))},onChange_beadWidth:function(e){t(at.Toolbar.action_changeSelectedBeads_width(e))},onChange_keepAspectRatio:function(e){t(at.Toolbar.action_changeSelectedBeads_keepAspectRatio(e))}})})},zt=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){var e=Object.keys(t.ui.selectedBeadsIds)[0];return t.appData.beads[e]}));if(!e)return Object(ot.jsx)(c.a.Fragment,{});if(!e.type)return Object(ot.jsx)(c.a.Fragment,{});return Object(ot.jsx)(kt,{onChange:function(e){t(at.Toolbar.action_changeSelectedBeads_type(e))},value:e.type})},Ht=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){var e=Object.keys(t.ui.selectedBeadsIds)[0];return t.appData.beads[e]}));if(!e)return Object(ot.jsx)(c.a.Fragment,{});if(!e.color)return Object(ot.jsx)(c.a.Fragment,{});return Object(ot.jsx)(vt,{onChange:function(e){t(at.Toolbar.action_changeSelectedBeads_color(e))},value:e.color})},Pt=function(){var t=Object(O.c)((function(t){var e=Object.keys(t.ui.selectedBeadsIds)[0];return t.appData.beads[e]}));return t?Object(ot.jsx)(lt,{bead:t}):Object(ot.jsx)(c.a.Fragment,{})},Vt=function(t){return!0===t.isVisible?Object(ot.jsx)(Wt,{}):Object(ot.jsx)(c.a.Fragment,{})},Wt=function(){var t=Object(O.c)((function(t){return Object.keys(t.appData.lines).length})),e=Object(O.c)((function(t){return Object.keys(t.appData.beads).length}));return Object(ot.jsxs)("div",{children:[Object(ot.jsx)(ht,{label:"Beads",onToggle:void 0,value:e,icon:void 0}),Object(ot.jsx)(ht,{label:"Lines",onToggle:void 0,value:t,icon:void 0})]})},Gt=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.currentMenuMainOpen}));return Object(ot.jsxs)("div",{className:"field has-addons",style:{margin:0,border:"1px solid #e0e0e0",paddingBottom:"0px"},children:[Object(ot.jsx)("div",{className:"control",children:Object(ot.jsxs)("div",{className:"button is-light ".concat(e===s.File?"is-dark":""),onClick:function(){t(at.Topbar.action_toggleMenuFile())},style:{height:"25px",padding:"3px 10px"},children:[Object(ot.jsx)("span",{className:"icon is-small",children:Object(ot.jsx)(v.a,{icon:y.j,color:S})}),Object(ot.jsx)("span",{children:"File"})]})}),Object(ot.jsx)("div",{className:"control",children:Object(ot.jsxs)("div",{className:"button is-light ".concat(e===s.Grid?"is-dark":""),onClick:function(){t(at.Topbar.action_toggleMenuSettings())},style:{height:"25px",padding:"3px 10px"},children:[Object(ot.jsx)("span",{className:"icon is-small",children:Object(ot.jsx)(v.a,{icon:y.e,color:S})}),Object(ot.jsx)("span",{children:"Grid"})]})}),Object(ot.jsx)("div",{className:"control",children:Object(ot.jsxs)("div",{className:"button is-light ".concat(e===s.Background?"is-dark":""),onClick:function(){t(at.Topbar.action_toggleMenuBackground())},style:{height:"25px",padding:"3px 10px"},children:[Object(ot.jsx)("span",{className:"icon is-small",children:Object(ot.jsx)(v.a,{icon:y.k,color:S})}),Object(ot.jsx)("span",{children:"Background"})]})})]})},Yt=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.saveInfo.saved})),a=Object(O.c)((function(t){return t.ui.saveInfo.haveUnsavedChanges}));return Object(ot.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[Object(ot.jsxs)("div",{className:"field has-addons",style:{width:"auto",flexWrap:"nowrap",marginBottom:"0"},children:[Object(ot.jsx)("div",{className:"control",children:Object(ot.jsxs)("div",{className:" button is-light ",onClick:function(){t(at.Persist.action_onClearCanvas())},children:[Object(ot.jsx)("span",{className:"icon is-small",children:Object(ot.jsx)(v.a,{icon:y.r,color:S})}),Object(ot.jsx)("span",{children:"New project"})]})}),Object(ot.jsx)("div",{className:"control",children:Object(ot.jsxs)("div",{className:" button is-light ".concat(!0===e?"is-success":""),onClick:function(){t(at.Persist.action_onSaveCanvas())},children:[Object(ot.jsx)("span",{className:"icon is-small",children:Object(ot.jsx)(v.a,{icon:y.o,color:S})}),Object(ot.jsx)("span",{children:"Save"})]})}),Object(ot.jsx)("div",{className:"control",children:Object(ot.jsxs)("div",{className:"button is-light ",onClick:function(){t(at.Persist.action_readSavedCanvas())},children:[Object(ot.jsx)("span",{className:"icon is-small",children:Object(ot.jsx)(v.a,{icon:y.f,color:S})}),Object(ot.jsx)("span",{children:"Load local"})]})})]}),Object(ot.jsx)("div",{style:{fontFamily:"Open Sans, sans-serif",fontSize:"13px",alignSelf:"center"},children:!0===a?Object(ot.jsx)("div",{children:"You have unsaved changes"}):Object(ot.jsx)("div",{children:"No changes to save"})})]})},Xt=function(){var t=Object(O.c)((function(t){return t.ui.currentMenuMainOpen}));return t===s.File?Object(ot.jsx)(Ut,{}):t===s.Grid?Object(ot.jsx)(Jt,{}):t===s.Background?Object(ot.jsx)(qt,{}):Object(ot.jsx)(c.a.Fragment,{})},Ut=function(){return Object(ot.jsx)("div",{children:Object(ot.jsx)(Yt,{})})},qt=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.background.image})),a=e.position,i=e.scale,n=e.opacity;return Object(ot.jsxs)("div",{style:{flexWrap:"nowrap",display:"flex",alignItems:"flex-start"},children:[Object(ot.jsxs)("div",{style:{flexWrap:"nowrap",display:"flex",marginTop:"4px"},children:[Object(ot.jsx)("div",{className:"control",children:Object(ot.jsx)("div",{className:" button is-light ",onClick:function(){t(at.Topbar.action_background_image_clear())},children:Object(ot.jsx)("span",{children:"Clear"})})}),Object(ot.jsx)("div",{className:"control",children:Object(ot.jsxs)("div",{className:" button is-light ",style:{position:"relative"},children:[Object(ot.jsx)("input",{type:"file",onChange:function(e){var a=e.target.files,i=Array.from(a);if(0!==i.length){var n=i[0];if(["image/png","image/jpeg","image/gif"].every((function(t){return n.type!==t})))console.error("'".concat(n.type,"' is not a supported format"));else if(n.size>1048576)console.error("'".concat(n.name,"' is too large, please pick a smaller file"));else{var s=new FileReader;s.onloadend=function(){t(at.Topbar.action_background_image_upload(s.result))},s.readAsDataURL(n),e.preventDefault()}}else console.error("no files selected")},style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,zIndex:2}}),Object(ot.jsx)("span",{children:"Upload"})]})})]}),Object(ot.jsxs)("div",{style:{display:"flex",marginLeft:"10px",marginRight:"10px",flexWrap:"nowrap",alignItems:"flex-start"},children:[Object(ot.jsx)("div",{className:"fieldset",style:{width:"100px",whiteSpace:"nowrap",flexWrap:"nowrap",display:"flex",alignItems:"flex-start"},children:Object(ot.jsx)("div",{className:"label",style:{whiteSpace:"nowrap"},children:"Scale: ".concat(i)})}),Object(ot.jsx)("div",{style:{width:"100px",marginLeft:"20px",marginTop:"13px"},children:Object(ot.jsx)(It,{max:16,min:.2,step:.1,value:i,onChange:function(e){return function(e){t(at.Topbar.action_background_image_scale(e))}(e)},defaultValue:1})})]}),Object(ot.jsx)(Zt,{pointX:a.x,onChange_pointX:function(e){t(at.Topbar.action_background_image_pointX(e))},pointY:a.y,onChange_pointY:function(e){t(at.Topbar.action_background_image_pointY(e))}}),Object(ot.jsxs)("div",{style:{display:"flex",marginLeft:"10px",marginRight:"10px",flexWrap:"nowrap",alignItems:"flex-start"},children:[Object(ot.jsx)("div",{className:"fieldset",style:{width:"85px"},children:Object(ot.jsxs)("div",{className:"label",style:{flexWrap:"nowrap",whiteSpace:"nowrap"},children:["Opacity: ",n]})}),Object(ot.jsx)("div",{style:{width:"80px",marginLeft:"10px",marginTop:"13px"},children:Object(ot.jsx)(It,{max:1,min:0,step:.1,value:n,onChange:function(e){return function(e){t(at.Topbar.action_background_image_opacity(e))}(e)},defaultValue:1})})]})]})},Zt=function(t){var e=t.pointX,a=t.onChange_pointX,i=t.pointY,n=t.onChange_pointY;return Object(ot.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center",marginRight:"15px"},children:Object(ot.jsxs)("div",{className:"fieldset",children:[Object(ot.jsx)("div",{className:"label",children:"Image position: "}),Object(ot.jsx)(Et.a,{allowNegative:!1,allowEmptyFormatting:!0,max:999,min:-999,maxLength:3,value:e,onValueChange:function(t){a(t.floatValue)},placeholder:"x",style:{color:"#4a4a4a",textAlign:"center",border:"1px solid #aeaeae",fontFamily:"Open Sans, sans-serif",fontSize:"13px",fontWeight:400,lineHeight:"1.5",padding:"0px 10px",marginBottom:"0px",marginTop:"0px",maxWidth:"70px",marginRight:"5px"}}),Object(ot.jsx)(Et.a,{allowNegative:!1,allowEmptyFormatting:!0,max:999,min:-999,maxLength:3,value:i,onValueChange:function(t){n(t.floatValue)},placeholder:"y",style:{color:"#4a4a4a",textAlign:"center",border:"1px solid #aeaeae",fontFamily:"Open Sans, sans-serif",fontSize:"13px",fontWeight:400,lineHeight:"1.5",padding:"0px 10px",marginBottom:"0px",marginTop:"0px",maxWidth:"70px"}})]})})},Jt=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.grid})),a=e.height,i=e.width,n=e.hexSize,s=e.type,d=e.snapEnabled,r=e.isVisible;return Object(ot.jsxs)("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center"},children:[Object(ot.jsx)(Kt,{isVisible:r,onChange_isVisible:function(){t(at.Topbar.action_toggleGridIsVisible())},snapEnabled:d,onChange_snapEnabled:function(){t(at.Topbar.action_toggleGridSnapEnabled())},type:s,onClick_selectTypeHex:function(){t(at.Topbar.action_setGridType(o.Hex))},onClick_selectTypeBox:function(){t(at.Topbar.action_setGridType(o.Box))}}),s===o.Box?Object(ot.jsx)(Qt,{gridItemW:i,onChange_gridItemW:function(e){var a=e;void 0!==e&&null!==e&&!0!==isNaN(e)?(a<1&&(a=1),a>100&&(a=100),t(at.Topbar.action_setGridWidth(a))):a=1},gridItemH:a,onChange_gridItemH:function(e){var a=e;void 0!==e&&null!==e&&!0!==isNaN(e)?(a<1&&(a=1),a>100&&(a=100),t(at.Topbar.action_setGridHeight(a))):a=1}}):null,s===o.Hex?Object(ot.jsx)($t,{hexSize:n,onChange_hexSize:function(e){var a=e;void 0!==e&&null!==e&&!0!==isNaN(e)?(a<1&&(a=1),a>100&&(a=100),t(at.Topbar.action_setGridHexSize(a))):a=1}}):null]})},Kt=function(t){var e=t.isVisible,a=t.onChange_isVisible,i=t.snapEnabled,n=t.onChange_snapEnabled,s=t.type,d=t.onClick_selectTypeHex,r=t.onClick_selectTypeBox;return Object(ot.jsxs)(c.a.Fragment,{children:[Object(ot.jsx)("div",{style:{marginRight:"15px"},children:Object(ot.jsx)(wt,{label:"Show grid",value:e,onChange:a,isDisabled:!1})}),Object(ot.jsx)("div",{style:{marginRight:"15px"},children:Object(ot.jsx)(wt,{label:"Snap to grid",value:i,onChange:n,isDisabled:!1})}),Object(ot.jsx)("div",{style:{marginRight:"15px"},children:Object(ot.jsxs)("div",{className:"fieldset",children:[Object(ot.jsx)("div",{className:"label",children:"Grid type: "}),Object(ot.jsx)("div",{className:"control",children:Object(ot.jsx)("div",{className:" button is-light ".concat(s===o.Hex?"is-dark":""," "),onClick:d,children:Object(ot.jsx)("span",{children:"Hexagon"})})}),Object(ot.jsx)("div",{className:"control",children:Object(ot.jsx)("div",{className:" button is-light ".concat(s===o.Box?"is-dark":""),onClick:r,children:Object(ot.jsx)("span",{children:"Rectangle"})})})]})})]})},Qt=function(t){var e=t.gridItemW,a=t.onChange_gridItemW,i=t.gridItemH,n=t.onChange_gridItemH;return Object(ot.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center",marginRight:"15px"},children:Object(ot.jsxs)("div",{className:"fieldset",children:[Object(ot.jsx)("div",{className:"label",children:"Grid size: "}),Object(ot.jsx)(Et.a,{allowNegative:!1,allowEmptyFormatting:!0,max:99,min:1,maxLength:2,value:e,onValueChange:function(t){a(t.floatValue)},placeholder:"width",style:{color:"#4a4a4a",textAlign:"center",border:"1px solid #aeaeae",fontFamily:"Open Sans, sans-serif",fontSize:"13px",fontWeight:400,lineHeight:"1.5",padding:"0px 10px",marginBottom:"0px",marginTop:"0px",maxWidth:"70px",marginRight:"5px"}}),Object(ot.jsx)(Et.a,{allowNegative:!1,allowEmptyFormatting:!0,max:99,min:1,maxLength:2,value:i,onValueChange:function(t){n(t.floatValue)},placeholder:"height",style:{color:"#4a4a4a",textAlign:"center",border:"1px solid #aeaeae",fontFamily:"Open Sans, sans-serif",fontSize:"13px",fontWeight:400,lineHeight:"1.5",padding:"0px 10px",marginBottom:"0px",marginTop:"0px",maxWidth:"70px"}})]})})},$t=function(t){var e=t.hexSize,a=t.onChange_hexSize;return Object(ot.jsx)("div",{style:{display:"flex",flexWrap:"nowrap",alignItems:"center",marginRight:"15px"},children:Object(ot.jsxs)("div",{className:"fieldset",children:[Object(ot.jsx)("div",{className:"label",children:"Hex size: "}),Object(ot.jsx)(Et.a,{allowNegative:!1,allowEmptyFormatting:!0,max:99,min:5,maxLength:2,value:e,onValueChange:function(t){a(t.floatValue)},placeholder:"width",style:{color:"#4a4a4a",textAlign:"center",border:"1px solid #aeaeae",fontFamily:"Open Sans, sans-serif",fontSize:"13px",fontWeight:400,lineHeight:"1.5",padding:"0px 10px",marginBottom:"0px",marginTop:"0px",maxWidth:"70px",marginRight:"5px"}})]})})},te=function(t){var e=t.value,a=t.onChange;return Object(ot.jsx)(pt,{selected:e,label:"Size",icon:Object(ot.jsx)(v.a,{icon:y.a,color:S,size:"lg"}),children:Object(ot.jsx)(Mt,{value:e,onChange:a})})},ee=function(t){return!0===t.isVisible?Object(ot.jsx)(ae,{}):Object(ot.jsx)(c.a.Fragment,{})},ae=function(){return Object(ot.jsxs)(c.a.Fragment,{children:[Object(ot.jsx)(ie,{}),Object(ot.jsx)(ne,{})]})},ie=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.brush.size}));if(!e)return Object(ot.jsx)(c.a.Fragment,{});return Object(ot.jsx)(te,{value:e,onChange:function(e){var a=e;void 0!==e&&null!==e&&!0!==isNaN(e)||(a=0),t(at.Toolbar.action_updateBrushSize(a))}})},ne=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.brush.color}));if(!e)return Object(ot.jsx)(c.a.Fragment,{});return Object(ot.jsx)(vt,{onChange:function(e){t(at.Toolbar.action_updateBrushColor(e))},value:e})},se=function(t){return!0===t.isVisible?Object(ot.jsx)(oe,{}):Object(ot.jsx)(c.a.Fragment,{})},oe=function(){return Object(ot.jsxs)(c.a.Fragment,{children:[Object(ot.jsx)(ue,{}),Object(ot.jsx)(re,{}),Object(ot.jsx)(le,{}),Object(ot.jsx)(ce,{}),Object(ot.jsx)(de,{})]})},de=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.beadsTemplate}));return Object(ot.jsx)(Lt,{value:e.rotate,onChange:function(e){var a=e;void 0!==e&&null!==e&&!0!==isNaN(e)||(a=0),t(at.Toolbar.action_updateBeadsTemplate("rotate",a))}})},re=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.beadsTemplate})),a=e.width?e.width:10,i=e.height?e.height:10,n=!!e.keepAspectRatio&&e.keepAspectRatio;return Object(ot.jsx)("div",{children:Object(ot.jsx)(_t,{height:i,width:a,keepAspectRatio:n,onChange_beadHeight:function(e){t(at.Toolbar.action_updateBeadsTemplate("height",e))},onChange_beadWidth:function(e){t(at.Toolbar.action_updateBeadsTemplate("width",e))},onChange_keepAspectRatio:function(e){t(at.Toolbar.action_updateBeadsTemplate("keepAspectRatio",e))}})})},ce=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.beadsTemplate}));return Object(ot.jsx)(kt,{onChange:function(e){t(at.Toolbar.action_updateBeadsTemplate("type",e))},value:e.type})},le=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.ui.beadsTemplate}));return Object(ot.jsx)(vt,{onChange:function(e){t(at.Toolbar.action_updateBeadsTemplate("color",e))},value:e.color})},ue=function(){var t=Object(O.c)((function(t){return t.ui.beadsTemplate})),e=H(t);return Object(ot.jsx)(lt,{bead:e})},he=a(50),pe=a(41),fe=function(){var t=Object(O.b)(),e=Object(O.c)((function(t){return t.mode})),a=Object(O.d)().getState();console.log("EditorRerender: ",a);Object(r.useRef)(null);if(!a)return Object(ot.jsx)("div",{children:"Error in app"});return Object(ot.jsxs)("div",{className:"scene",children:[Object(ot.jsxs)("div",{className:"topbar-wrapper",children:[Object(ot.jsx)(Gt,{}),Object(ot.jsx)(Xt,{})]}),Object(ot.jsx)("div",{className:"actions-wrapper",children:Object(ot.jsx)(dt,{editorMode:e})}),Object(ot.jsx)("div",{className:"scene-wrapper",children:Object(ot.jsx)(he.a,{handleWidth:!0,handleHeight:!0,skipOnMount:!1,onResize:function(e,a){t(at.Draggable.action_updateSceneWrapperSize({width:e,height:a}))}})}),Object(ot.jsx)("div",{className:"toolbar-wrapper",children:Object(ot.jsxs)(be,{children:[Object(ot.jsx)(At,{isVisible:e===n.EditBeads}),Object(ot.jsx)(Vt,{isVisible:e===n.Idle}),Object(ot.jsx)(ee,{isVisible:e===n.PaintBeads}),Object(ot.jsx)(se,{isVisible:e===n.AddBeads}),Object(ot.jsx)(ge,{})]})})]})},be=pe.a.div(g||(g=Object(h.a)(['\n  .fieldset {\n    /* border-top: 1px solid #dfdfdf;\n  border-bottom: 1px solid #dfdfdf; */\n    padding-bottom: 5px;\n    padding-top: 5px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n  }\n\n  .fieldset .label {\n    font-family: "Open Sans", sans-serif;\n    font-size: 16px;\n    line-height: 30px;\n    font-weight: 300;\n    padding: 0;\n    margin: 0;\n    padding-left: 10px;\n    padding-right: 10px;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    align-items: center;\n  }\n\n  .fieldset .input {\n    border: none;\n    background: none;\n    border-bottom: 1px solid #dfdfdf;\n    color: #6e6e6e;\n    font-size: 14px;\n    line-height: 30px;\n    font-family: "Open Sans", sans-serif;\n    box-shadow: none;\n    max-width: 200px;\n    padding: 0;\n    margin: 0;\n  }\n\n  .fieldset .input[type="number"] {\n    max-width: 50px;\n  }\n']))),ge=function(t){var e=Object(O.b)(),a=Object(O.c)((function(t){return t.ui.lights}));return Object(ot.jsx)(xe,{children:Object(ot.jsx)("div",{className:"toolbar-lights",children:a.map((function(t,a){var i;return Object(ot.jsxs)("div",{className:"light",children:[Object(ot.jsx)("div",{className:"info",children:JSON.stringify(t)}),Object(ot.jsx)("div",{className:"fields",children:Object(ot.jsxs)("fieldset",{children:[Object(ot.jsx)("label",{children:"intensity: "}),Object(ot.jsx)("input",{type:"range",name:"".concat(t.name,"_").concat(t.intensity),value:100*(null!==(i=t.intensity)&&void 0!==i?i:0),onChange:function(t){var i=Number(t.target.value)/100;console.log("co mam?",i),e(at.Toolbar.action_updateLight(a,"intensity",i))},min:"1",max:"99",step:"1"})]})})]},t.name)}))})})},xe=pe.a.div(x||(x=Object(h.a)(["\n  .toolbar-lights {\n    background: #ddd;\n    width: 100%;\n    border: none;\n    box-sizing: border-box;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n  }\n  .light {\n    border: 1px solid #000;\n    border-radius: 3px;\n    margin-bottom: 10px;\n    padding: 10px;\n  }\n  .light .info {\n    font-size: 11px;\n    line-height: 13px;\n    display: block;\n    margin-bottom: 5px;\n    width: 100%;\n    overflow: hidden;\n    word-break: break-all;\n    white-space: pre-line;\n  }\n  .light .fields {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  .light .fields fieldset {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    column-gap: 10px;\n  }\n"]))),je=a(29),ve=Object(je.b)(st),ye=function(){return console.log("render App.tsx"),c.a.useEffect((function(){ve.dispatch({type:"startAppEvent",payload:{state:ve.getState()}}),ve.dispatch(at.Persist.action_readSavedCanvas())}),[]),Object(ot.jsx)("div",{className:"App",children:Object(ot.jsx)(O.a,{store:ve,children:Object(ot.jsx)(fe,{})})})},Se=a(9),me=(a(83)(Se),function(t){var e,a,i,s=new Se.Vector2(1,1),o=((new Se.Matrix4).multiplyMatrices((new Se.Matrix4).makeRotationY(.05),(new Se.Matrix4).makeRotationZ(.03)),Y()),d=new Oe,r=new ke;!function(){if(null!==t){var n=t.getBoundingClientRect(),s=n.width,o=n.height;e=new Se.OrthographicCamera(s/-2,s/2,o/2,o/-2,-1e3,1e3)}e.position.set(0,0,500),e.lookAt(0,0,0),(a=new Se.Scene).background=new Se.Color("#F1F3F3");var d=new Se.PlaneGeometry(1e3,1e3,1),c=new Se.MeshBasicMaterial({color:"#ccc",side:Se.DoubleSide}),l=new Se.Mesh(d,c);a.add(l);d=new Se.PlaneGeometry(1e3,1e3,1),c=new Se.MeshBasicMaterial({color:"#ccc",side:Se.DoubleSide}),l=new Se.Mesh(d,c);if(a.add(l),(i=new Se.WebGLRenderer({antialias:!0})).setPixelRatio(window.devicePixelRatio),null!==t){var h=t.getBoundingClientRect(),p=h.width,f=h.height;i.setSize(p,f),t.appendChild(i.domElement)}window.addEventListener("resize",v,!1),null!==t&&(t.addEventListener("mousedown",x,!1),t.addEventListener("mousemove",y,!1),t.addEventListener("mouseup",j,!1),t.addEventListener("wheel",u,!1));r.setRenderer(i)}(),function t(){requestAnimationFrame(t),i.render(a,e)}(),o.on("action_changeSelectedBeads_color",(function(t){t.beadIds.forEach((function(e){var i=a.getObjectByName(e);void 0!==i&&i.material.color.set(t.color)}))})),o.on("action_selectBeads",(function(t){t.diffStates.forEach((function(t){var e=Object.keys(t)[0],i=Object.values(t)[0],n=a.getObjectByName(e);void 0!==n&&(!0===i?n.material.emissive.set(1513239):n.material.emissive.set(0))}))})),o.on("action_addBeadOnClick",(function(t){var e=t.bead,i=new Se.SphereGeometry(Math.max(e.width,e.height),10,10);i.computeVertexNormals();var n=new Se.MeshPhysicalMaterial({flatShading:!0,reflectivity:1,color:e.color}),s=new Se.Mesh(i,n);s.applyMatrix4((new Se.Matrix4).makeRotationX(90*Se.MathUtils.DEG2RAD)),s.applyMatrix4((new Se.Matrix4).makeRotationZ(Se.MathUtils.DEG2RAD*e.rotate)),s.applyMatrix4((new Se.Matrix4).makeTranslation(e.position.x,e.position.y,0)),c.push(s),s.name=e.id,a.add(s)})),o.on("action_updateLight",(function(t){console.log("co jest?",t);var e=a.getObjectByName(t.name);void 0!==e&&("color"===t.field&&(e.color=t.value),"intensity"===t.field&&(e.intensity=t.value))})),o.on("action_readSavedCanvas",(function(t){})),o.on("action_readSavedCanvas",(function(t){Object.keys(t.beads).forEach((function(e){var i=t.beads[e],n=new Se.SphereGeometry(Math.max(i.width,i.height),10,10);n.computeVertexNormals();var s=new Se.MeshPhysicalMaterial({flatShading:!0,reflectivity:1,color:i.color}),o=new Se.Mesh(n,s);o.applyMatrix4((new Se.Matrix4).makeRotationX(90*Se.MathUtils.DEG2RAD)),o.applyMatrix4((new Se.Matrix4).makeRotationZ(Se.MathUtils.DEG2RAD*i.rotate)),o.applyMatrix4((new Se.Matrix4).makeTranslation(i.position.x,i.position.y,0)),c.push(o),o.name=i.id,a.add(o)}))})),o.on("startAppEvent",(function(t){console.log("startAppEvent: ...",t.state.ui.lights),t.state.ui.lights&&t.state.ui.lights.length>0&&t.state.ui.lights.forEach((function(t){if("THREE.DirectionalLight"===t.type){var e,i,n,s,o,d,r=new Se.DirectionalLight(t.color,t.intensity);r.position.set(null!==(e=null===(i=t.position)||void 0===i?void 0:i.x)&&void 0!==e?e:0,null!==(n=null===(s=t.position)||void 0===s?void 0:s.y)&&void 0!==n?n:0,null!==(o=null===(d=t.position)||void 0===d?void 0:d.z)&&void 0!==o?o:10),r.name=t.name,a.add(r)}}))}));var c=[],l=1;function u(a){if(a.preventDefault(),null!==t){var i=t.getBoundingClientRect(),n=i.width,s=i.height,o=i.top,d=i.left,r=a.clientX-d,c=a.clientY-o,u=e.position.x,h=e.position.y,p=(r-n/2)*l,f=-1*(c-s/2)*l;l+=.1*Math.sign(a.deltaY);var b=(r-n/2)*(l=Math.min(Math.max(.125,l),4)),g=-1*(c-s/2)*l;e.left=n*l/-2,e.right=n*l/2,e.top=s*l/2,e.bottom=s*l/-2,e.updateProjectionMatrix();var x=p-b,j=f-g;e.position.x=u+x,e.position.y=h+j,e.lookAt(e.position.x,e.position.y,0)}}var h,p=function(a,i){if(null===t)throw new Error("no el in dom");var n=t.getBoundingClientRect(),s=n.width,o=n.height,d=i-n.top,r=(a-n.left-s/2)*l+e.position.x,c=(o/2-d)*l+e.position.y;return new Se.Vector2(r,c)},f=!1,b=new Se.Vector2,g=new Se.Vector2;function x(a){var i=(0,ve.getState)();if(i.mode===n.Idle){if(f=!0,null!==t){var s=t.getBoundingClientRect(),o=(s.width,s.height,s.top),c=s.left;h=t.getBoundingClientRect();var l=a.clientX-c,u=a.clientY-o;b.x=l,b.y=u,g.x=e.position.x,g.y=e.position.y}}else if(i.mode===n.EditBeads){null!==t&&(h=t.getBoundingClientRect());var x=p(a.clientX,a.clientY),j=x.x,v=x.y;if(d.onDown(j,v),null===t)throw new Error("no el in dom");var y=t.getBoundingClientRect(),S=(y.width,y.height,y.top),m=y.left,O=a.clientX-m,k=a.clientY-S;r.onDown(O,k)}}function j(t){var e=ve.dispatch,a=(0,ve.getState)();if(a.mode===n.AddBeads){var i=p(t.clientX,t.clientY),s=i.x,o=i.y;e(at.Draggable.action_addBeadOnClick({x:s,y:o}))}else if(a.mode===n.Idle)!0===f&&(f=!1);else if(a.mode===n.EditBeads){if(!0===d.isDragged);else if(!1===d.isDragged&&!0===d.isDragStarted){var c=p(t.clientX,t.clientY),l=c.x,u=c.y,h=[];Object.keys(a.appData.beads).forEach((function(t){var e=a.appData.beads[t],i=C(e.position.x-e.width/2,e.position.y-e.height/2),n=C(e.position.x+e.width/2,e.position.y+e.height/2);M(i,n,C(l,u))&&h.push(t)})),e(at.MouseSelection.action_selectBeads(h))}else e(at.MouseSelection.action_selectBeads([]));d.onUp(),r.onUp()}}function v(){if(null!==t){var a=t.getBoundingClientRect(),n=a.width,s=a.height;e.left=n/-2,e.right=n/2,e.top=s/2,e.bottom=s/-2,e.updateProjectionMatrix(),i.setSize(n,s)}}function y(a){if(h){var i=h,o=i.width,c=i.height,u=i.top,x=i.left;s.x=(a.clientX-x)/o*2-1,s.y=-(a.clientY-u)/c*2+1;var j=a.clientX-x,v=a.clientY-u;if(!0===f){var y=b.x-j,S=b.y-v,m=y*l,O=S*l,k=g.x+m,B=g.y-O;e.position.x=k,e.position.y=B,e.lookAt(k,B,0)}var C=ve.dispatch,D=(0,ve.getState)();if(D.mode===n.EditBeads){if(!0===d.isDragStarted){var w=p(a.clientX,a.clientY),_=w.x,I=w.y;if(d.onMove(_,I),!0===d.isDragged){var M=[];Object.keys(D.appData.beads).forEach((function(t){var e=D.appData.beads[t];d.contain(e.position)&&M.push(t)})),C(at.MouseSelection.action_selectBeads(M))}}if(null===t)throw new Error("no el in dom");var E=t.getBoundingClientRect(),L=(E.width,E.height,E.top),A=E.left,R=a.clientX-A,N=a.clientY-L;r.onMove(R,N)}}}}),Oe=function(){function t(){Object(L.a)(this,t),this.isDragged=!1,this.isDragStarted=!1,this.end={x:0,y:0},this.start={x:0,y:0}}return Object(A.a)(t,[{key:"onUp",value:function(){this.isDragStarted=!1,this.isDragged=!1,this.start.x=0,this.start.y=0,this.end.x=0,this.end.y=0}},{key:"onDown",value:function(t,e){this.isDragStarted=!0,this.start.x=t,this.start.y=e,this.end.x=t,this.end.y=e}},{key:"onMove",value:function(t,e){if(1==this.isDragStarted&&(this.end.x=t,this.end.y=e,!1===this.isDragged)){var a=this.start,i=this.end,n=i.x-a.x,s=i.y-a.y;(Math.abs(n)>5||Math.abs(s)>5)&&(this.isDragged=!0)}}},{key:"contain",value:function(t){var e=this.start,a=this.end,i=Math.min(e.x,a.x),n=Math.min(e.y,a.y),s=Math.max(e.x,a.x),o=Math.max(e.y,a.y);return t.x>i&&t.x<s&&t.y>n&&t.y<o}}]),t}(),ke=function(){function t(){Object(L.a)(this,t),this.element=void 0,this.renderer=void 0,this.startPoint=void 0,this.pointTopLeft=void 0,this.pointBottomRight=void 0,this.isDown=void 0,this.element=document.createElement("div"),this.element.style.pointerEvents="none",this.element.style.background="rgba(75, 160, 255, 0.3)",this.element.style.border="1px solid #55aaff",this.element.style.position="absolute",this.element.style.zIndex="2",this.startPoint=new Se.Vector2,this.pointTopLeft=new Se.Vector2,this.pointBottomRight=new Se.Vector2,this.isDown=!1}return Object(A.a)(t,[{key:"setRenderer",value:function(t){this.renderer=t}},{key:"onDown",value:function(t,e){this.isDown=!0,this.renderer.domElement.parentElement.appendChild(this.element),this.element.style.left=t+"px",this.element.style.top=e+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=t,this.startPoint.y=e}},{key:"onMove",value:function(t,e){this.isDown&&(this.pointBottomRight.x=Math.max(this.startPoint.x,t),this.pointBottomRight.y=Math.max(this.startPoint.y,e),this.pointTopLeft.x=Math.min(this.startPoint.x,t),this.pointTopLeft.y=Math.min(this.startPoint.y,e),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px")}},{key:"onUp",value:function(){null!==this.element.parentElement&&this.element.parentElement.removeChild(this.element)}}]),t}();u.a.render(Object(ot.jsx)(ye,{}),document.getElementById("root")),j=document.getElementById("threejs"),me(j)}},[[84,1,2]]]);
//# sourceMappingURL=main.e976f5fb.chunk.js.map