{"version":3,"sources":["threejs/RoundedBoxGeometry.js","editorObjects/Editor.tsx","EventEmitter.tsx","threejs/renderThreejs.ts","components/colors.ts","editorObjects/Point.ts","editorObjects/Bead.ts","editorObjects/Line.ts","immerReducers/BeadSnapperImmerReducer.tsx","immerReducers/DraggableOperationsImmerReducer.tsx","immerReducers/PersistImmerReducer.tsx","immerReducers/ChangeEditorModeImmerReducer.tsx","immerReducers/MainImmerReducer.tsx","immerReducers/MouseSelectionImmerReducer.tsx","immerReducers/ToolbarImmerReducer.tsx","immerReducers/TopbarImmerReducer.tsx","immerReducers/PaintImmerReducer.tsx","immerReducers/store.tsx","components/Toolbar/EditorModes.tsx","components/Bead/DisplayBead.tsx","components/operations/MapValuesToCss.tsx","components/Toolbar/ui/FieldBeadPreview.tsx","components/Toolbar/ui/ToolbarField.tsx","components/Toolbar/ui/ToolbarFieldSet.tsx","components/Toolbar/ui/FieldColorPicker.tsx","components/Toolbar/ui/FieldColor.tsx","components/Toolbar/ui/FieldsetColor.tsx","components/Toolbar/ui/FieldBeadTypePicker.tsx","components/Toolbar/ui/FieldsetBeadType.tsx","components/Toolbar/ui/FieldSliderWithLabel.tsx","components/Toolbar/ui/FieldCheckbox.tsx","components/Toolbar/ui/FieldsetWidthAndHeight.tsx","components/Toolbar/ui/FieldSlider.tsx","components/Toolbar/ui/FieldsetBeadRotate.tsx","components/Toolbar/Modes/ToolbarEditBeads.tsx","components/Toolbar/Modes/ToolbarIdle.tsx","components/Topbar/TopbarMain.tsx","components/Toolbar/EditorChangeState.tsx","components/Topbar/TopbarSecoundary.tsx","components/Toolbar/ui/FieldsetSize.tsx","components/Toolbar/Modes/ToolbarPaint.tsx","components/Toolbar/Modes/ToolbarAddBeads.tsx","components/Editor.tsx","immerReducers/appStore.tsx","App.tsx","index.tsx"],"names":["module","exports","THREE","RoundedBoxGeometry","width","height","depth","radius","radiusSegments","BufferGeometry","call","this","type","isNaN","Math","max","floor","edgeHalfWidth","min","edgeHalfHeight","edgeHalfDepth","parameters","rs1","totalVertexCount","positions","BufferAttribute","Float32Array","normals","cornerVerts","cornerNormals","vertex","Vector3","vertexPool","normalPool","indices","lastVertex","cornerVertNumber","cornerLayout","j","push","PIhalf","PI","cornerOffset","y","va","cosVa","cos","sinVa","sin","x","ha","z","vert","clone","multiplyScalar","add","norm","normalize","set","i","length","multiply","doVertices","a","b","c","d","doFaces","flips","lastRowOffset","v","r1","r2","u","u1","doCorners","cOffset","cRowOffset","needsFlip","doHeightEdges","end","cStarts","cEnds","cStart","cEnd","doWidthEdges","urs1","u1rs1","doDepthEdges","index","setXYZ","setIndex","Uint16Array","addAttribute","prototype","Object","create","constructor","BeadTypes","EditorMode","EditorMenuMain","EditorGridType","BrushType","internalEventEmiter","el","uiButton","defaulBeadColor","buildPoint","immerable","point","sqrt","getLength","useLen","scale","scalar","getDistanceBetweenPoints","start","contain","p1","p2","p","buildBead","props","defaults","id","generate","position","BasicEllipse","rotate","lineRotate","color","keepAspectRatio","merge","buildLine","__defaults","beadIds","settings","beadsCount","beadsAutoCount","beadsSpacing","beadsAutoSpacing","defaultBead","getPointFromStartLine","startX","startY","endX","endY","distance","BeadSnapperImmerReducer","lineId","currentLine","draftState","appData","lines","count","getLineBeadsCount","currentCount","remaining","addRemainingBeads","overflow","removeOverflowBeads","modifyBeadsPosition","modifyBeadsRotate","lineLen","beadsWidths","beadsWidth","forEach","beadId","beads","defaultBeadWidth","remainingSpace","remainingCount","ui","lineSettings","undefined","bead","overflowCount","arrLen","lastItemBeadId","splice","currentDistance","newPosition","standardLineHeight","avaiableSpace","dynamicBeadsSpacing","lineRotateRadian","atan2","ImmerReducer","EventEmitter","_events","name","listener","listenerToRemove","Error","filter","data","state","console","log","callback","warn","getEventEmitter","DraggableOperationsImmerReducer","event","sceneWrapperPosition","sceneWrapperWidth","sceneWrapperHeight","saveInfo","saved","haveUnsavedChanges","line","mode","EditLines","updateBeadsPositions","editorAppDataHasChanged","key","grid","snapEnabled","hexSize","Box","round","Hex","hSpace","hexHeight","vSpace","changeX","vLine","changeY","lineStart","lineEnd","deltaX","deltaY","newX","newY","keys","selectedLinesIds","selectedLinesIdsCount","action_onClickLine","selectedBeadsIds","selectedBeadsIdsCount","currentBeadChain","isDragEnabled","beadsTemplate","len","lastBeadId","lastBead","lastPosition","vec","sub","scaled","_x","_y","emit","PersistImmerReducer","b1","window","localStorage","setItem","JSON","stringify","info","ChangeEditorModeImmerReducer","clearSelectedBeads","clearSelectedLines","newEditorMode","newValue","MainImmerReducer","MouseSelectionImmerReducer","mouseSelection","isDragStarted","isDragged","abs","p3","beadsIds","prevSelectedIds","diffStates","_","xor","map","includes","ToolbarImmerReducer","field","value","lights","light","deg","firstLineId","firstLine","newLinesIds","newLine","newBead","ratio","currLine","updateLineFromSelectedBeads","currBead","results","indexOf","brush","size","TopbarImmerReducer","currentMenuMainOpen","File","None","Grid","Background","isVisible","background","image","url","opacity","PaintImmerReducer","Color","mousePoint","centerPoint","defaultAppData","intensity","angle","top","left","Idle","Actions","Main","createActionCreators","Draggable","Persist","ChangeEditorMode","MouseSelection","Toolbar","Topbar","Paint","eventEmitter","reducerForEventEmitter","produce","action","payload","store","composeReducers","createReducerFunction","EditorModes","editorMode","dispatch","useDispatch","onChangeEditorMode","action_onChangeEditorMode","className","label","icon","faArrowsAlt","onClick","isSelected","faEdit","EditBeads","faPaintBrush","AddBeads","PaintBeads","DeleteBeads","StateButton","DisplayBead","zIndex","isSelectable","isOpacity","isZindex","translate3d","getTranslate3dCss","rotateCss","styles","transform","border","borderRadius","action_onClickBead","style","FieldBeadPreview","displayBead","marginTop","marginBottom","display","justifyContent","alignItems","boxSizing","ToolbarField","onToggle","cursor","marginRight","flexDirection","paddingLeft","paddingRight","ToolbarFieldSet","selected","children","useState","isPickerOpen","setIsPickerOpen","borderTop","React","cloneElement","FieldColorPicker","onChange","colors","material","paddingTop","paddingBottom","DisplayColorsGroup","flexWrap","group","toString","FieldColor","boxShadow","FieldsetColor","faPalette","BeadTypesIcons","BasicRectangle","FieldBeadTypePicker","types","selectedType","DisplayAvailableBeadTypes","DisplayBeadType","faCircle","faExpand","FieldsetBeadType","faShapes","SliderWithTooltip","createSliderWithTooltip","Slider","FieldSliderWithLabel","borderBottom","padding","flexGrow","step","defaultValue","marks","0","50","100","FieldCheckbox","isDisabled","disabled","checked","target","FieldsetWidthAndHeight","onChange_beadHeight","onChange_beadWidth","onChange_keepAspectRatio","format","toLocaleString","maximumFractionDigits","faExpandArrowsAlt","faLink","faUnlink","faArrowsAltH","faArrowsAltV","FieldSlider","FieldsetBeadRotate","faSyncAlt","Fragment","suffix","allowNegative","allowEmptyFormatting","onValueChange","floatValue","placeholder","textAlign","fontFamily","fontSize","fontWeight","lineHeight","ToolbarEditBeads","ContentWrapper","useSelector","Content","BeadsRotate","action_changeSelectedBeads_rotate","BeadSize","action_changeSelectedBeads_height","action_changeSelectedBeads_width","action_changeSelectedBeads_keepAspectRatio","BeadType","action_changeSelectedBeads_type","BeadColor","action_changeSelectedBeads_color","BeadPreview","ToolbarIdle","linesLen","beadsLen","TopbarMain","margin","action_toggleMenuFile","faFileAlt","action_toggleMenuSettings","faCog","action_toggleMenuBackground","faImage","EditorChangeState","isSaved","action_onClearCanvas","faTimes","action_onSaveCanvas","faSave","action_readSavedCanvas","faDownload","alignSelf","TopbarSecoundary","SubMenuFile","SubMenuBackground","action_background_image_clear","selectedFiles","files","Array","from","file","every","error","reader","FileReader","onloadend","action_background_image_upload","result","readAsDataURL","preventDefault","marginLeft","whiteSpace","action_background_image_scale","onChange_scale","pointX","onChange_pointX","action_background_image_pointX","pointY","onChange_pointY","action_background_image_pointY","action_background_image_opacity","onChange_opacity","BackgroundPosition","maxLength","maxWidth","SubMenuGrid","onChange_isVisible","action_toggleGridIsVisible","onChange_snapEnabled","action_toggleGridSnapEnabled","onClick_selectTypeHex","action_setGridType","onClick_selectTypeBox","gridItemW","onChange_gridItemW","action_setGridWidth","gridItemH","onChange_gridItemH","action_setGridHeight","onChange_hexSize","action_setGridHexSize","GridOptions","GridBoxSettings","GridHexSettings","FieldsetSize","ToolbarPaint","BrushSize","action_updateBrushSize","BrushColor","action_updateBrushColor","ToolbarAddBeads","action_updateBeadsTemplate","EditorScene","useStore","getState","useRef","handleWidth","handleHeight","skipOnMount","onResize","action_updateSceneWrapperSize","ToolBarStyles","styled","div","Lights","LightsStyles","l","Number","action_updateLight","appStore","createStore","App","useEffect","initCanvasApp","require","camera","scene","renderer","mouse_intercestion","multiplyMatrices","makeRotationY","makeRotationZ","mouseSelectionBeads","mouseSelectionHelper","MouseSelectionHelper","getBoundingClientRect","lookAt","bg_geometry","bg_material","side","bg_plane","antialias","setPixelRatio","devicePixelRatio","setSize","appendChild","domElement","addEventListener","onWindowResize","onMouseDown","onMouseMove","onMouseUp","onWheel","setRenderer","init","animate","requestAnimationFrame","render","on","child","getObjectByName","values","emissive","geometry","SphereGeometry","computeVertexNormals","flatShading","reflectivity","beadMesh","applyMatrix4","makeRotationX","DEG2RAD","makeTranslation","basicMesh","sceneScale","screenX","clientX","screenY","clientY","cameraX","cameraY","mouseXInWorldBefore","mouseYInWorldBefore","sign","mouseXInWorldAfter","mouseYInWorldAfter","right","bottom","updateProjectionMatrix","diffX","diffY","boundingClientRect","screenToWorld","isCameraGrabed","startDragMousePosition","startDragCamera","onDown","action_addBeadOnClick","leftTop","rightBottom","action_selectBeads","onUp","screenMouseDiffX","screenMouseDiffY","mouseDiffXInWorldSpace","mouseDiffYInWorldSpace","onMove","p1_x","p1_y","p2_x","p2_y","element","startPoint","pointTopLeft","pointBottomRight","isDown","document","createElement","pointerEvents","Vector2","parentElement","removeChild","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.e976f5fb.chunk.js","sourcesContent":["/**\n * @author pailhead / http://dusanbosnjak.com\n */\nmodule.exports = function(THREE) {\n  var RoundedBoxGeometry = function(width, height, depth, radius, radiusSegments) {\n    THREE.BufferGeometry.call(this);\n\n    this.type = \"RoundedBoxGeometry\";\n\n    //validate params ===================================\n\n    radiusSegments = !isNaN(radiusSegments)\n      ? Math.max(1, Math.floor(radiusSegments))\n      : 1;\n\n    width = !isNaN(width) ? width : 1;\n    height = !isNaN(height) ? height : 1;\n    depth = !isNaN(depth) ? depth : 1;\n\n    radius = !isNaN(radius) ? radius : 0.15;\n\n    radius = Math.min(\n      radius,\n      Math.min(width, Math.min(height, Math.min(depth))) / 2\n    );\n\n    var edgeHalfWidth = width / 2 - radius;\n    var edgeHalfHeight = height / 2 - radius;\n    var edgeHalfDepth = depth / 2 - radius;\n\n    //not sure why this is needed, for querying? ========\n\n    this.parameters = {\n      width: width,\n      height: height,\n      depth: depth,\n      radius: radius,\n      radiusSegments: radiusSegments\n    };\n\n    //calculate vertices count ==========================\n\n    var rs1 = radiusSegments + 1; //radius segments + 1\n\n    var totalVertexCount = (rs1 * radiusSegments + 1) << 3;\n\n    //make buffers ======================================\n\n    var positions = new THREE.BufferAttribute(\n      new Float32Array(totalVertexCount * 3),\n      3\n    );\n\n    var normals = new THREE.BufferAttribute(\n      new Float32Array(totalVertexCount * 3),\n      3\n    );\n\n    //some vars =========================================\n\n    var cornerVerts = [],\n      cornerNormals = [],\n      normal = new THREE.Vector3(),\n      vertex = new THREE.Vector3(),\n      vertexPool = [],\n      normalPool = [],\n      indices = [];\n    var lastVertex = rs1 * radiusSegments,\n      cornerVertNumber = rs1 * radiusSegments + 1;\n    doVertices();\n    doFaces();\n    doCorners();\n    doHeightEdges();\n    doWidthEdges();\n    doDepthEdges();\n\n    // calculate vert positions =========================\n\n    function doVertices() {\n      //corner offsets\n      var cornerLayout = [\n        new THREE.Vector3(1, 1, 1),\n        new THREE.Vector3(1, 1, -1),\n        new THREE.Vector3(-1, 1, -1),\n        new THREE.Vector3(-1, 1, 1),\n        new THREE.Vector3(1, -1, 1),\n        new THREE.Vector3(1, -1, -1),\n        new THREE.Vector3(-1, -1, -1),\n        new THREE.Vector3(-1, -1, 1)\n      ];\n\n      //corner holder\n      for (var j = 0; j < 8; j++) {\n        cornerVerts.push([]);\n        cornerNormals.push([]);\n      }\n\n      //construct 1/8 sphere ==============================\n\n      var PIhalf = Math.PI / 2;\n\n      var cornerOffset = new THREE.Vector3(\n        edgeHalfWidth,\n        edgeHalfHeight,\n        edgeHalfDepth\n      );\n\n      for (var y = 0; y <= radiusSegments; y++) {\n        var v = y / radiusSegments;\n\n        var va = v * PIhalf; //arrange in 90 deg\n\n        var cosVa = Math.cos(va); //scale of vertical angle\n\n        var sinVa = Math.sin(va);\n\n        if (y == radiusSegments) {\n          vertex.set(0, 1, 0);\n\n          var vert = vertex\n            .clone()\n            .multiplyScalar(radius)\n            .add(cornerOffset);\n\n          cornerVerts[0].push(vert);\n\n          vertexPool.push(vert);\n\n          var norm = vertex.clone();\n\n          cornerNormals[0].push(norm);\n\n          normalPool.push(norm);\n\n          continue; //skip row loop\n        }\n\n        for (var x = 0; x <= radiusSegments; x++) {\n          var u = x / radiusSegments;\n\n          var ha = u * PIhalf;\n\n          //make 1/8 sphere points\n          vertex.x = cosVa * Math.cos(ha);\n          vertex.y = sinVa;\n          vertex.z = cosVa * Math.sin(ha);\n\n          //copy sphere point, scale by radius, offset by half whd\n          var vert = vertex\n            .clone()\n            .multiplyScalar(radius)\n            .add(cornerOffset);\n\n          cornerVerts[0].push(vert);\n\n          vertexPool.push(vert);\n\n          //sphere already normalized, just clone\n\n          var norm = vertex.clone().normalize();\n          cornerNormals[0].push(norm);\n          normalPool.push(norm);\n        }\n      }\n\n      //distribute corner verts ===========================\n\n      for (var i = 1; i < 8; i++) {\n        for (var j = 0; j < cornerVerts[0].length; j++) {\n          var vert = cornerVerts[0][j].clone().multiply(cornerLayout[i]);\n\n          cornerVerts[i].push(vert);\n\n          vertexPool.push(vert);\n\n          var norm = cornerNormals[0][j].clone().multiply(cornerLayout[i]);\n\n          cornerNormals[i].push(norm);\n\n          normalPool.push(norm);\n        }\n      }\n    }\n\n    // weave corners ====================================\n\n    function doCorners() {\n      var indexInd = 0;\n\n      var flips = [true, false, true, false, false, true, false, true];\n\n      var lastRowOffset = rs1 * (radiusSegments - 1);\n\n      for (var i = 0; i < 8; i++) {\n        var cornerOffset = cornerVertNumber * i;\n\n        for (var v = 0; v < radiusSegments - 1; v++) {\n          var r1 = v * rs1; //row offset\n          var r2 = (v + 1) * rs1; //next row\n\n          for (var u = 0; u < radiusSegments; u++) {\n            var u1 = u + 1;\n            var a = cornerOffset + r1 + u;\n            var b = cornerOffset + r1 + u1;\n            var c = cornerOffset + r2 + u;\n            var d = cornerOffset + r2 + u1;\n\n            if (!flips[i]) {\n              indices.push(a);\n              indices.push(b);\n              indices.push(c);\n\n              indices.push(b);\n              indices.push(d);\n              indices.push(c);\n            } else {\n              indices.push(a);\n              indices.push(c);\n              indices.push(b);\n\n              indices.push(b);\n              indices.push(c);\n              indices.push(d);\n            }\n          }\n        }\n\n        for (var u = 0; u < radiusSegments; u++) {\n          var a = cornerOffset + lastRowOffset + u;\n          var b = cornerOffset + lastRowOffset + u + 1;\n          var c = cornerOffset + lastVertex;\n\n          if (!flips[i]) {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n          } else {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n          }\n        }\n      }\n    }\n\n    //plates ============================================\n    //fix this loop matrices find pattern something\n\n    function doFaces() {\n      //top\n      var a = lastVertex; // + cornerVertNumber * 0;\n      var b = lastVertex + cornerVertNumber; // * 1;\n      var c = lastVertex + cornerVertNumber * 2;\n      var d = lastVertex + cornerVertNumber * 3;\n\n      indices.push(a);\n      indices.push(b);\n      indices.push(c);\n      indices.push(a);\n      indices.push(c);\n      indices.push(d);\n\n      //bottom\n      a = lastVertex + cornerVertNumber * 4; // + cornerVertNumber * 0;\n      b = lastVertex + cornerVertNumber * 5; // * 1;\n      c = lastVertex + cornerVertNumber * 6;\n      d = lastVertex + cornerVertNumber * 7;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(a);\n      indices.push(d);\n      indices.push(c);\n\n      //left\n      a = 0;\n      b = cornerVertNumber;\n      c = cornerVertNumber * 4;\n      d = cornerVertNumber * 5;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(b);\n      indices.push(c);\n      indices.push(d);\n\n      //right\n      a = cornerVertNumber * 2;\n      b = cornerVertNumber * 3;\n      c = cornerVertNumber * 6;\n      d = cornerVertNumber * 7;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(b);\n      indices.push(c);\n      indices.push(d);\n\n      //front\n      a = radiusSegments;\n      b = radiusSegments + cornerVertNumber * 3;\n      c = radiusSegments + cornerVertNumber * 4;\n      d = radiusSegments + cornerVertNumber * 7;\n\n      indices.push(a);\n      indices.push(b);\n      indices.push(c);\n      indices.push(b);\n      indices.push(d);\n      indices.push(c);\n\n      //back\n      a = radiusSegments + cornerVertNumber;\n      b = radiusSegments + cornerVertNumber * 2;\n      c = radiusSegments + cornerVertNumber * 5;\n      d = radiusSegments + cornerVertNumber * 6;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(b);\n      indices.push(c);\n      indices.push(d);\n    }\n\n    // weave edges ======================================\n\n    function doHeightEdges() {\n      for (var i = 0; i < 4; i++) {\n        var cOffset = i * cornerVertNumber;\n        var cRowOffset = 4 * cornerVertNumber + cOffset;\n        var needsFlip = i & (1 === 1);\n        for (var u = 0; u < radiusSegments; u++) {\n          var u1 = u + 1;\n          var a = cOffset + u;\n          var b = cOffset + u1;\n          var c = cRowOffset + u;\n          var d = cRowOffset + u1;\n\n          if (!needsFlip) {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n            indices.push(b);\n            indices.push(d);\n            indices.push(c);\n          } else {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n            indices.push(b);\n            indices.push(c);\n            indices.push(d);\n          }\n        }\n      }\n    }\n\n    function doDepthEdges() {\n      var cStarts = [0, 2, 4, 6];\n      var cEnds = [1, 3, 5, 7];\n\n      for (var i = 0; i < 4; i++) {\n        var cStart = cornerVertNumber * cStarts[i];\n        var cEnd = cornerVertNumber * cEnds[i];\n\n        var needsFlip = 1 >= i;\n\n        for (var u = 0; u < radiusSegments; u++) {\n          var urs1 = u * rs1;\n          var u1rs1 = (u + 1) * rs1;\n\n          var a = cStart + urs1;\n          var b = cStart + u1rs1;\n          var c = cEnd + urs1;\n          var d = cEnd + u1rs1;\n\n          if (needsFlip) {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n            indices.push(b);\n            indices.push(c);\n            indices.push(d);\n          } else {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n            indices.push(b);\n            indices.push(d);\n            indices.push(c);\n          }\n        }\n      }\n    }\n\n    function doWidthEdges() {\n      var end = radiusSegments - 1;\n\n      var cStarts = [0, 1, 4, 5];\n      var cEnds = [3, 2, 7, 6];\n      var needsFlip = [0, 1, 1, 0];\n\n      for (var i = 0; i < 4; i++) {\n        var cStart = cStarts[i] * cornerVertNumber;\n        var cEnd = cEnds[i] * cornerVertNumber;\n\n        for (var u = 0; u <= end; u++) {\n          // var dInd = u != end ? radiusSegments + u * rs1 : cornerVertNumber - 1;\n\n          var a = cStart + radiusSegments + u * rs1;\n          var b =\n            cStart +\n            (u != end ? radiusSegments + (u + 1) * rs1 : cornerVertNumber - 1);\n\n          var c = cEnd + radiusSegments + u * rs1;\n          var d =\n            cEnd +\n            (u != end ? radiusSegments + (u + 1) * rs1 : cornerVertNumber - 1);\n\n          if (!needsFlip[i]) {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n            indices.push(b);\n            indices.push(d);\n            indices.push(c);\n          } else {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n            indices.push(b);\n            indices.push(c);\n            indices.push(d);\n          }\n        }\n      }\n    }\n\n    //fill buffers ======================================\n\n    var index = 0;\n\n    for (var i = 0; i < vertexPool.length; i++) {\n      positions.setXYZ(\n        index,\n        vertexPool[i].x,\n        vertexPool[i].y,\n        vertexPool[i].z\n      );\n\n      normals.setXYZ(index, normalPool[i].x, normalPool[i].y, normalPool[i].z);\n\n      index++;\n    }\n\n    this.setIndex(new THREE.BufferAttribute(new Uint16Array(indices), 1));\n\n    this.addAttribute(\"position\", positions);\n\n    this.addAttribute(\"normal\", normals);\n  };\n\n  RoundedBoxGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\n  RoundedBoxGeometry.constructor = RoundedBoxGeometry;\n\n  return RoundedBoxGeometry;\n};\n","import { immerable } from \"immer\";\nimport { DeepPartial } from \"ts-essentials\";\n\nexport interface Point {\n  x: number;\n  y: number;\n  [immerable]: boolean;\n}\n\nexport enum BeadTypes {\n  BasicRectangle = \"BasicRectangle\",\n  BasicEllipse = \"BasicEllipse\"\n}\n\nexport interface Bead {\n  id: string;\n  position: Point;\n  [immerable]: boolean;\n  width: number;\n  height: number;\n  type: BeadTypes;\n  color: string;\n  rotate: number;\n  lineRotate: number;\n  keepAspectRatio: boolean;\n}\n\nexport interface Line {\n  id: string;\n  start: Point;\n  end: Point;\n  beadIds: string[];\n  [immerable]: boolean;\n  settings: {\n    beadsCount: number;\n    beadsAutoCount: boolean;\n    beadsSpacing: number;\n    beadsAutoSpacing: boolean;\n    defaultBead: Partial<Bead>;\n  };\n}\n\nexport interface AppData {\n  beads: { [s: string]: Bead };\n  lines: { [s: string]: Line };\n}\n\nexport enum EditorMode {\n  Idle = \"Idle\",\n  EditLines = \"EditLines\",\n  AddLine = \"AddLine\",\n  EditBeads = \"EditBeads\",\n  AddBeads = \"AddBeads\",\n  DeleteBeads = \"DeleteBeads\",\n  PaintBeads = \"ColorPaint\"\n}\nexport enum EditorMenuMain {\n  None = \"None\",\n  File = \"File\",\n  Grid = \"Grid\",\n  Background = \"Background\"\n}\nexport enum EditorGridType {\n  Hex = \"Hex\",\n  Box = \"Box\"\n}\nexport enum BrushType {\n  Color = \"Color\"\n}\nexport interface ThreeLightConfig {\n  type: \"THREE.DirectionalLight\" | \"THREE.AmbientLight\";\n  name: string;\n  color?: string | number | THREE.Color | undefined, \n  intensity?: number | undefined\n  position?: {\n    x: number;\n    y: number;\n    z: number;\n  }\n}\n\nexport interface EditorUi {\n  lights: ThreeLightConfig[];\n  lineSettings: DeepPartial<Line>;\n  saveInfo: {\n    saved: boolean;\n    haveUnsavedChanges: boolean;\n  };\n  selectedLinesIds: { [s: string]: boolean };\n  selectedLinesIdsCount: number;\n  selectedBeadsIds: { [s: string]: boolean };\n  selectedBeadsIdsCount: number;\n  mouseSelection: {\n    start: Point;\n    end: Point;\n    isDragStarted: boolean;\n    isDragged: boolean;\n  };\n  currentMenuMainOpen: EditorMenuMain;\n  grid: {\n    type: EditorGridType;\n    hexSize: number;\n    snapEnabled: boolean;\n    isVisible: boolean;\n    width: number;\n    height: number;\n  };\n  currentBeadChain: {\n    isDragEnabled: boolean;\n    beadIds: string[];\n  };\n  beadsTemplate: {\n    width: number;\n    height: number;\n    type: BeadTypes;\n    color: string;\n    rotate: number;\n    keepAspectRatio: boolean;\n  };\n  brush: {\n    type: BrushType;\n    size: number;\n    color: string;\n  };\n  background: {\n    image: {\n      url: string;\n      scale: number;\n      position: Point;\n      opacity: number;\n    };\n  };\n  sceneWrapperWidth: number;\n  sceneWrapperHeight: number;\n  sceneWrapperPosition: {\n    x: number;\n    y: number;\n    angle: number;\n    scale: number;\n    top: number;\n    left: number;\n  };\n}\n\nexport interface Editor {\n  appData: AppData;\n  ui: EditorUi;\n  mode: EditorMode;\n}\n","export type EventCallback = (data: any, state: any) => void;\nexport interface Events {\n  [key: string]: EventCallback[];\n}\nexport class EventEmitter {\n  _events: Events;\n  constructor() {\n    this._events = {};\n  }\n\n  on(name: string, listener: EventCallback) {\n    if (!this._events[name]) {\n      this._events[name] = [];\n    }\n\n    this._events[name].push(listener);\n  }\n\n  removeListener(name: string, listenerToRemove: EventCallback) {\n    if (!this._events[name]) {\n      throw new Error(\n        `Can't remove a listener. Event \"${name}\" doesn't exits.`\n      );\n    }\n\n    const filterListeners = (listener) => listener !== listenerToRemove;\n\n    this._events[name] = this._events[name].filter(filterListeners);\n  }\n\n  emit(name: string, data: any, state: any) {\n    console.log(\"EventEmitter:emit:\", name, data);\n\n    if (!this._events[name]) {\n      console.warn(`Can't emit an event. Event \"${name}\" doesn't exits.`);\n      return;\n    }\n\n    const fireCallbacks = (callback: EventCallback) => {\n      callback(data, state);\n    };\n\n    this._events[name].forEach(fireCallbacks);\n  }\n}\n\nlet internalEventEmiter: EventEmitter | undefined;\n\nexport const getEventEmitter = () => {\n  if (internalEventEmiter === undefined) {\n    internalEventEmiter = new EventEmitter();\n  }\n  return internalEventEmiter;\n};\n","import { appStore } from \"./../immerReducers/appStore\";\nimport { Actions } from \"../immerReducers/store\";\nimport { generate } from \"shortid\";\n\n// import { EditorMode } from \"../editorObjects/Editor\";\n// import { setInterval } from \"timers\";\n// import RoundedBoxGeometry from './RoundedBoxGeometry'\n\nimport * as THREE from \"three\";\nimport { Bead, BeadTypes, Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { buildPoint, contain } from \"../editorObjects/Point\";\nimport { Vector2, BoxGeometry, SphereGeometry } from \"three\";\nimport { getEventEmitter } from \"../EventEmitter\";\nimport _ from \"lodash\";\n// import RoundedBoxGeometryInstance from \"./RoundedBoxGeometry\";\n\n// import {} from 'three/build/'\n// import * as THREE from \"../build/three.module.js\";\n\n// import Stats from \"./stats.module.js\";\n// import { GUI } from \"./dat.gui.module.js\";\n// import { OrbitControls } from \"./OrbitControls.js\";\nvar RoundedBoxGeometry = require(\"./RoundedBoxGeometry\")(THREE);\n\nexport const renderThreejs = (el: HTMLElement | null) => {\n  // console.log(\"renderThreejs?\", el, appStore);\n\n  initCanvasApp(el);\n};\n\nconst initCanvasApp = (el: HTMLElement | null) => {\n  var camera: THREE.OrthographicCamera,\n    scene: THREE.Scene,\n    renderer: THREE.WebGLRenderer;\n\n  // var mesh: THREE.InstancedMesh;\n  // var amount = 10;\n  // var count = Math.pow(amount, 3);\n\n  // var raycaster = new THREE.Raycaster();\n  var mouse_intercestion = new THREE.Vector2(1, 1);\n  // var mouse_2d = new THREE.Vector2(1, 1);\n\n  var rotationMatrix = new THREE.Matrix4().multiplyMatrices(\n    new THREE.Matrix4().makeRotationY(0.05),\n    new THREE.Matrix4().makeRotationZ(0.03)\n  );\n  // var rotationMatrix = new THREE.Matrix4().makeRotationZ(0.1);\n  // var instanceMatrix = new THREE.Matrix4();\n  // var matrix = new THREE.Matrix4();\n  const z_index = 100;\n  const intensivity = 1;\n  const distance = 900;\n  const color = 0xffffff;\n  const reflectivity = 1;\n\n  // const mouseSelection = {\n  //   isDragStarted: false,\n  //   isDragged: false,\n  //   start: { x: 0, y: 0 },\n  //   end: { x: 0, y: 0 }\n  // };\n\n  const eventEmitter = getEventEmitter();\n\n  const mouseSelectionBeads = new MouseSelection();\n  const mouseSelectionHelper = new MouseSelectionHelper();\n\n  init();\n  animate();\n\n  // eventEmitter.on(\n  //   \"IMMER_REDUCER:DraggableOperationsImmerReducer#action_updateSceneWrapperSize\",\n  //   (data: any) => {\n  //     console.log(\"odebranooo...\", data);\n  //   }\n  // );\n\n  // eventEmitter.on(\n  //   \"IMMER_REDUCER:DraggableOperationsImmerReducer#action_addBeadOnClick\",\n  //   (data: { x: number; y: number }) => {\n  //     console.log(\"dodaje nowy item...\", data);\n\n  //     // scene\n  //   }\n  // );\n\n  // eventEmitter.on(\n  //   \"IMMER_REDUCER:ChangeEditorModeImmerReducer#action_onChangeEditorMode\",\n  //   (data: EditorMode) => {\n  //     console.log(\"ustawiam mode na\", data);\n  //   }\n  // );\n\n  eventEmitter.on(\"action_changeSelectedBeads_color\", (data) => {\n    data.beadIds.forEach((id) => {\n      const child = scene.getObjectByName(id) as THREE.Mesh | undefined;\n      if (child === undefined) {\n        return;\n      }\n\n      (child.material as THREE.MeshPhysicalMaterial).color.set(data.color);\n    });\n  });\n\n  eventEmitter.on(\"action_selectBeads\", (data) => {\n    data.diffStates.forEach((bead) => {\n      const id = Object.keys(bead)[0];\n      const value = Object.values(bead)[0];\n      const child = scene.getObjectByName(id) as THREE.Mesh | undefined;\n      if (child === undefined) {\n        return;\n      }\n\n      if (value === true) {\n        (child.material as THREE.MeshPhysicalMaterial).emissive.set(0x171717);\n      } else {\n        (child.material as THREE.MeshPhysicalMaterial).emissive.set(0);\n      }\n    });\n  });\n\n  // beads.forEach((beadId, index) => {\n  //     const bead = state.appData.beads[beadId];\n  //     // console.log(\"renderBeads: add bead?\", bead);\n  //     // var transform = new THREE.Object3D();\n  //     // var shape = new THREE.SphereBufferGeometry(20)\n  //     // var transform = new RoundedBoxGeometry(50, 90, 40, 100, 10);\n  //     var transform = new THREE.Object3D();\n  //     transform.position.set(bead.position.x, bead.position.y, 0);\n  //     transform.updateMatrix();\n\n  //     let isSelected = false;\n\n  //     if (state.ui.selectedBeadsIdsCount > 0) {\n  //       isSelected = Object.keys(state.ui.selectedBeadsIds).includes(bead.id);\n  //     }\n\n  //     //  width, height, depth, radius, radiusSegments\n  //     // var geometry = new RoundedBoxGeometry(\n  //     //   bead.width,\n  //     //   bead.height,\n  //     //   Math.max(bead.width, bead.height),\n  //     //   bead.type === BeadTypes.BasicEllipse\n  //     //     ? Math.max(bead.width, bead.height)\n  //     //     : 0,\n  //     //   bead.type === BeadTypes.BasicEllipse\n  //     //     ? Math.max(bead.width, bead.height)\n  //     //     : 0\n  //     // );\n  //     // var geometry = new BoxGeometry(bead.width, bead.height, 10);\n  //     var geometry = new SphereGeometry(\n  //       Math.max(bead.width, bead.height),\n  //       32,\n  //       32\n  //     );\n  // var material = new THREE.MeshPhysicalMaterial({\n  //        flatShading: true,\n  //        reflectivity: reflectivity,\n  //        color: bead.color,\n  //      });\n  // if (isSelected) {\n  // -        material.emissive.set(0x888888);\n  //   -      // var geometry = new THREE.SphereBufferGeometry(20);\n  // -      // geometry.applyMatrix(transform.matrixWorld)\n  // -      // var material = new THREE.MeshBasicMaterial({ color: \"rgb(25, 118, 210)\" });\n  // -      var beadMesh = new THREE.Mesh(geometry, material);\n  // -      beadMesh.applyMatrix(new THREE.Matrix4().makeRotationZ(bead.rotate));\n  // -      beadMesh.applyMatrix(\n  // -        new THREE.Matrix4().makeTranslation(bead.position.x, bead.position.y, 0)\n  // -      );\n  // -      beadMesh.name = bead.id;\n  // -      basicMesh.push(beadMesh);\n  // -      scene.add(beadMesh);\n  // -\n  // -      // shape.applyMatrix(transform);\n  // -      // basicMesh.add(shape);\n  // -      // mesh.setMatrixAt(i++, transform.matrix);\n  // -      // mesh.matrixWorldNeedsUpdate = true;\n  // -    });\n\n  eventEmitter.on(\"action_addBeadOnClick\", (data) => {\n    // console.log(\"addBeadOnClick: ...\", );\n    const bead = data.bead as Bead;\n    const geometry = new SphereGeometry(\n      Math.max(bead.width, bead.height),\n      10,\n      10\n    );\n\n    // geometry.mergeVertices();\n    geometry.computeVertexNormals();\n\n    const material = new THREE.MeshPhysicalMaterial({\n      flatShading: true,\n      reflectivity: reflectivity,\n      color: bead.color,\n    });\n    const beadMesh = new THREE.Mesh(geometry, material);\n    beadMesh.applyMatrix4(\n      new THREE.Matrix4().makeRotationX(THREE.MathUtils.DEG2RAD * 90)\n    );\n    beadMesh.applyMatrix4(\n      new THREE.Matrix4().makeRotationZ(THREE.MathUtils.DEG2RAD * bead.rotate)\n    );\n    beadMesh.applyMatrix4(\n      new THREE.Matrix4().makeTranslation(bead.position.x, bead.position.y, 0)\n    );\n    basicMesh.push(beadMesh);\n    beadMesh.name = bead.id;\n    scene.add(beadMesh);\n  });\n\n  eventEmitter.on(\"action_updateLight\", (data: { name; field; value }) => {\n    console.log(\"co jest?\", data);\n\n    const light = scene.getObjectByName(data.name) as\n      | THREE.DirectionalLight\n      | undefined;\n    if (light !== undefined) {\n      if (data.field === \"color\") {\n        light.color = data.value;\n      }\n      if (data.field === \"intensity\") {\n        light.intensity = data.value;\n      }\n    }\n    // console.log('co to za swiatlo??', li)\n  });\n\n  eventEmitter.on(\"action_readSavedCanvas\", (data) => {});\n\n  eventEmitter.on(\"action_readSavedCanvas\", (data) => {\n    Object.keys(data.beads).forEach((id) => {\n      const bead = data.beads[id] as Bead;\n      const geometry = new SphereGeometry(\n        Math.max(bead.width, bead.height),\n        10,\n        10\n      );\n\n      // geometry.mergeVertices();\n      geometry.computeVertexNormals();\n\n      const material = new THREE.MeshPhysicalMaterial({\n        flatShading: true,\n        reflectivity: reflectivity,\n        color: bead.color,\n      });\n      const beadMesh = new THREE.Mesh(geometry, material);\n      beadMesh.applyMatrix4(\n        new THREE.Matrix4().makeRotationX(THREE.MathUtils.DEG2RAD * 90)\n      );\n      beadMesh.applyMatrix4(\n        new THREE.Matrix4().makeRotationZ(THREE.MathUtils.DEG2RAD * bead.rotate)\n      );\n      beadMesh.applyMatrix4(\n        new THREE.Matrix4().makeTranslation(bead.position.x, bead.position.y, 0)\n      );\n      basicMesh.push(beadMesh);\n      beadMesh.name = bead.id;\n      scene.add(beadMesh);\n    });\n  });\n\n  eventEmitter.on(\"startAppEvent\", (data: { state: Editor }) => {\n    console.log(\"startAppEvent: ...\", data.state.ui.lights);\n    if (data.state.ui.lights && data.state.ui.lights.length > 0) {\n      data.state.ui.lights.forEach((l) => {\n        if (l.type === \"THREE.DirectionalLight\") {\n          const light = new THREE.DirectionalLight(l.color, l.intensity);\n          light.position.set(\n            l.position?.x ?? 0,\n            l.position?.y ?? 0,\n            l.position?.z ?? 10\n          );\n          light.name = l.name;\n          scene.add(light);\n        }\n      });\n    }\n\n    // const { getState } = appStore;\n    // const state = getState();\n    // console.log(\"renderBeads: subscribe event \");\n\n    // scene.dispose();\n    // scene.remove(mesh);\n\n    // while (basicMesh.length) {\n    //   while (basicMesh[0].children.length) {\n    //     basicMesh[0].remove(basicMesh[0].children[0]);\n    //   }\n    //   basicMesh.shift();\n    // }\n\n    // while (scene.children.length > 0) {\n    //   scene.remove(scene.children[0]);\n    // }\n\n    // var light1 = new THREE.DirectionalLight(0xffffff, 1);\n    // light1.position.set(0, 0, 1);\n    // scene.add(light1);\n\n    // var light2 = new THREE.PointLight(color, intensivity, distance);\n    // light2.position.set(-300, -300, z_index);\n    // scene.add(light2);\n\n    // var light1 = new THREE.PointLight(color, intensivity, distance);\n    // light1.position.set(-300, 300, z_index);\n    // scene.add(light1);\n\n    // var light2 = new THREE.PointLight(color, intensivity, distance);\n    // light2.position.set(-300, -300, z_index);\n    // scene.add(light2);\n\n    // var light3 = new THREE.PointLight(color, intensivity, distance);\n    // light3.position.set(300, 300, z_index);\n    // scene.add(light3);\n\n    // var light4 = new THREE.PointLight(color, intensivity, distance);\n    // light4.position.set(300, -300, z_index);\n    // scene.add(light4);\n\n    // var light4 = new THREE.PointLight(color, 0.4, distance);\n    // light4.position.set(0, 0, z_index);\n    // scene.add(light4);\n\n    // var bg_geometry = new THREE.PlaneGeometry(1000, 1000, 1);\n    // var bg_material = new THREE.MeshBasicMaterial({\n    //   color: \"#ccc\",\n    //   side: THREE.DoubleSide,\n    // });\n\n    // var bg_plane = new THREE.Mesh(bg_geometry, bg_material);\n    // scene.add(bg_plane);\n\n    // const beads = Object.keys(state.appData.beads);\n\n    // mesh.count = beads.length;\n\n    // console.log(\"renderBeads: count?\", beads.length);\n\n    // var i = 0;\n    // beads.forEach((beadId, index) => {\n    //   const bead = state.appData.beads[beadId];\n    //   // console.log(\"renderBeads: add bead?\", bead);\n    //   // var transform = new THREE.Object3D();\n    //   // var shape = new THREE.SphereBufferGeometry(20)\n    //   // var transform = new RoundedBoxGeometry(50, 90, 40, 100, 10);\n    //   var transform = new THREE.Object3D();\n    //   transform.position.set(bead.position.x, bead.position.y, 0);\n    //   transform.updateMatrix();\n\n    //   let isSelected = false;\n\n    //   if (state.ui.selectedBeadsIdsCount > 0) {\n    //     isSelected = Object.keys(state.ui.selectedBeadsIds).includes(bead.id);\n    //   }\n\n    //   //  width, height, depth, radius, radiusSegments\n    //   // var geometry = new RoundedBoxGeometry(\n    //   //   bead.width,\n    //   //   bead.height,\n    //   //   Math.max(bead.width, bead.height),\n    //   //   bead.type === BeadTypes.BasicEllipse\n    //   //     ? Math.max(bead.width, bead.height)\n    //   //     : 0,\n    //   //   bead.type === BeadTypes.BasicEllipse\n    //   //     ? Math.max(bead.width, bead.height)\n    //   //     : 0\n    //   // );\n    //   // var geometry = new BoxGeometry(bead.width, bead.height, 10);\n\n    // for (let i = 0; i < 10 * 10; i = i + 10) {\n    //   for (let j = 0; j < 10 * 50; j = j + 10) {\n    //     var geometry = new SphereGeometry(Math.max(8, 8), 16, 16);\n    //     var material = new THREE.MeshPhongMaterial({\n    //       color: \"red\",\n    //     });\n    //     var beadMesh = new THREE.Mesh(geometry, material);\n    //     beadMesh.applyMatrix(\n    //       new THREE.Matrix4().makeRotationX(THREE.Math.DEG2RAD * 90)\n    //     );\n    //     beadMesh.applyMatrix(new THREE.Matrix4().makeTranslation(i, j, 0));\n    //     basicMesh.push(beadMesh);\n    //     const uuid1 = `${generate()}`;\n    //     beadMesh.name = uuid1;\n    //     scene.add(beadMesh);\n    //   }\n    // }\n\n    // console.log(scene.getObjectByName(uuid1));\n\n    //   // shape.applyMatrix(transform);\n    //   // basicMesh.add(shape);\n    //   // mesh.setMatrixAt(i++, transform.matrix);\n    //   // mesh.matrixWorldNeedsUpdate = true;\n    // });\n    // scene.add(basicMesh);\n\n    // setTimeout(() => {\n    //   basicMesh.matrixWorldNeedsUpdate = true;\n    //   basicMesh.translateX(1);\n    //   scene.visible = true;\n    //   render();\n    // }, 10);\n\n    // basicMesh.updateMatrixWorld();\n    // basicMesh.updateMorphTargets();\n    // basicMesh.updateWorldMatrix(true, true);\n    // basicMesh.updateMatrix();\n\n    // scene.matrixWorldNeedsUpdate = true;\n    // scene.add(basicMesh);\n\n    // console.log(\"mesh?\", basicMesh);\n    // renderer.render(scene, camera);\n  });\n\n  // const { dispatch, subscribe, getState } = appStore;\n\n  // subscribe(() => {\n  //   renderBeads();\n  // });\n  // dispatch({type: \"\"})\n\n  var basicMesh: THREE.Mesh[] = [];\n  var sceneScale = 1;\n\n  function init() {\n    if (el !== null) {\n      const { width, height } = el.getBoundingClientRect();\n\n      // camera = new THREE.PerspectiveCamera(60, width / height, 0.1, 100);\n      camera = new THREE.OrthographicCamera(\n        width / -2,\n        width / 2,\n        height / 2,\n        height / -2,\n        -1000,\n        1000\n      );\n    }\n    // camera.position.set(amount, amount, amount);\n    camera.position.set(0, 0, 500);\n    camera.lookAt(0, 0, 0);\n\n    // camera.zoom\n\n    scene = new THREE.Scene();\n\n    // var light = new THREE.HemisphereLight(0xffffff, 0x666, 1);\n    // light.position.set(0, 0, 1000);\n    // // light.position.set(-1, 1.5, 1);\n    // // light.position.set(-1, 1.5, 1);\n    // scene.add(light);\n\n    scene.background = new THREE.Color(\"#F1F3F3\");\n    // scene.background = new THREE.TextureLoader().load(require('./img/background.jpg').default);\n\n    // const l1 = new THREE.DirectionalLight(\"#FFF\", 0.99);\n    // const l1 = new THREE.DirectionalLight(\"#FFF\", 0.8);\n    // l1.position.set(0, 0, 1);\n    // l1.name = \"main_light_1\";\n    // scene.add(l1);\n\n    // const l2 = new THREE.AmbientLight(\"#FFF\", 0.1);\n    // const l2 = new THREE.AmbientLight(\"#FFF\", 0.2);\n    // l2.position.set(0, 0, 1);\n    // l2.name = \"main_light_2\";\n    // scene.add(l2);\n\n    // const directionalLight2 = new THREE.DirectionalLight(\"#FFF\", 0.99);\n    // directionalLight2.position.set(-10, -10, -10);\n    // scene.add(directionalLight2);\n\n    var bg_geometry = new THREE.PlaneGeometry(1000, 1000, 1);\n    var bg_material = new THREE.MeshBasicMaterial({\n      color: \"#ccc\",\n      side: THREE.DoubleSide,\n    });\n\n    var bg_plane = new THREE.Mesh(bg_geometry, bg_material);\n    scene.add(bg_plane);\n\n    // const li = scene.getObjectByName('main_light_1');\n    // console.log('co to za swiatlo??', li)\n\n    // var light1 = new THREE.PointLight(color, intensivity, distance);\n    // light1.position.set(-300, 300, z_index);\n    // scene.add(light1);\n\n    // var light2 = new THREE.PointLight(color, intensivity, distance);\n    // light2.position.set(-300, -300, z_index);\n    // scene.add(light2);\n\n    // var light3 = new THREE.PointLight(color, intensivity, distance);\n    // light3.position.set(300, 300, z_index);\n    // scene.add(light3);\n\n    // var light4 = new THREE.PointLight(color, intensivity, distance);\n    // light4.position.set(300, -300, z_index);\n    // scene.add(light4);\n\n    // var light4 = new THREE.PointLight(color, 0.4, distance);\n    // light4.position.set(0, 0, z_index);\n    // scene.add(light4);\n\n    var bg_geometry = new THREE.PlaneGeometry(1000, 1000, 1);\n    var bg_material = new THREE.MeshBasicMaterial({\n      color: \"#ccc\",\n      side: THREE.DoubleSide,\n    });\n\n    var bg_plane = new THREE.Mesh(bg_geometry, bg_material);\n    scene.add(bg_plane);\n\n    // var light = new THREE.HemisphereLight(0xffffff, 0x880000, 0.5);\n    // light.position.set(-1, -1.5, -1);\n    // scene.add(light);\n\n    // interface RoundedBoxGeometryProps{\n    //   width, height, depth, radius, radiusSegments\n    // }\n    // var __geometry = new RoundedBoxGeometry(50, 90, 40, 100, 10);\n    // var __material = new THREE.MeshPhysicalMaterial({\n    //   flatShading: true,\n    //   reflectivity: reflectivity,\n    //   color: \"red\"\n    // });\n\n    // mesh = new THREE.InstancedMesh(__geometry, __material, 20);\n    // var __transform = new THREE.Object3D();\n    // __transform.position.set(10, 10, 10);\n    // __transform.updateMatrix();\n    // mesh.setMatrixAt(0, __transform.matrix);\n    // scene.add(mesh);\n\n    // var geometry = new THREE.SphereBufferGeometry(20);\n    // var geometry = new THREE.BoxBufferGeometry(40, 40, 40);\n\n    // var material = new THREE.MeshPhysicalMaterial({\n    //   flatShading: true,\n    //   reflectivity: reflectivity,\n    //   color: \"rgb(25, 118, 210)\"\n    // });\n\n    // mesh = new THREE.InstancedMesh(geometry, material, count);\n\n    // var i = 0;\n    // var offset = (60 * (amount - 1)) / 2;\n\n    // var transform = new THREE.Object3D();\n\n    // for (var x = 0; x < amount; x++) {\n    //   for (var y = 0; y < amount; y++) {\n    //     // for (var z = 0; z < amount; z++) {\n    //     transform.position.set(\n    //       offset - x * 60,\n    //       offset - y * 60,\n    //       // offset - z * 60\n    //       0\n    //     );\n    //     transform.updateMatrix();\n\n    //     mesh.setMatrixAt(i++, transform.matrix);\n    //     // }\n    //   }\n    // }\n\n    // scene.add(mesh);\n\n    // const { dispatch, subscribe, getState } = appStore;\n    // const state = getState();\n\n    //\n\n    // var gui: any = new GUI();\n    // gui.add(mesh, \"count\", 0, count);\n\n    // console.log(\"init\");\n    renderer = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    if (el !== null) {\n      const { width, height } = el.getBoundingClientRect();\n      renderer.setSize(width, height);\n      el.appendChild(renderer.domElement);\n    }\n\n    // new OrbitControls(camera, renderer.domElement);\n\n    // stats = new (Stats as any)();\n    // if (el !== null) {\n    //   el.appendChild(stats.dom);\n    // }\n\n    window.addEventListener(\"resize\", onWindowResize, false);\n\n    if (el !== null) {\n      el.addEventListener(\"mousedown\", onMouseDown, false);\n      el.addEventListener(\"mousemove\", onMouseMove, false);\n      el.addEventListener(\"mouseup\", onMouseUp, false);\n      el.addEventListener(\"wheel\", onWheel, false);\n    }\n    mouseSelectionHelper.setRenderer(renderer);\n  }\n\n  function onWheel(event) {\n    event.preventDefault();\n    if (el !== null) {\n      const { width, height, top, left } = el.getBoundingClientRect();\n      // const __x1 = event.clientX - left - (width * sceneScale) / 2;\n      // const __y1 = (height * sceneScale) / 2 - (event.clientY - top);\n\n      const screenX = event.clientX - left;\n      const screenY = event.clientY - top;\n\n      const cameraX = camera.position.x;\n      const cameraY = camera.position.y;\n\n      const mouseXInWorldBefore = (screenX - width / 2) * sceneScale;\n      const mouseYInWorldBefore = -1 * (screenY - height / 2) * sceneScale;\n\n      const zoomChange = 0.02 * 5;\n      const zoomMax = 4;\n      const zoomMin = 0.125;\n      sceneScale += Math.sign(event.deltaY) * zoomChange;\n      sceneScale = Math.min(Math.max(zoomMin, sceneScale), zoomMax);\n\n      const mouseXInWorldAfter = (screenX - width / 2) * sceneScale;\n      const mouseYInWorldAfter = -1 * (screenY - height / 2) * sceneScale;\n\n      camera.left = (width * sceneScale) / -2;\n      camera.right = (width * sceneScale) / 2;\n      camera.top = (height * sceneScale) / 2;\n      camera.bottom = (height * sceneScale) / -2;\n      camera.updateProjectionMatrix();\n\n      const diffX = mouseXInWorldBefore - mouseXInWorldAfter;\n      const diffY = mouseYInWorldBefore - mouseYInWorldAfter;\n\n      camera.position.x = cameraX + diffX;\n      camera.position.y = cameraY + diffY;\n      camera.lookAt(camera.position.x, camera.position.y, 0);\n\n      // camera.zoom = sceneScale;\n      // console.log('co to jest w getBoundingClientRect:', width, height)\n\n      // const __x2 = event.clientX - left - (width * sceneScale) / 2;\n      // const __y2 = (height * sceneScale) / 2 - (event.clientY - top);\n\n      // const delta_x1 = __x1 - __x2;\n      // const delta_y1 = __y1 - __y2;\n\n      // console.log(\n      //   \"jaki jest scale?\",\n      //   event.clientX,\n      //   event.clientY,\n      //   sceneScale,\n      //   delta_x1,\n      //   delta_y1\n      // );\n\n      // camera.position.set(\n      //   camera.position.x - delta_x1,\n      //   camera.position.y - delta_y1,\n      //   camera.position.z\n      // );\n      // camera.lookAt(\n      //   camera.position.x - delta_x1,\n      //   camera.position.y - delta_y1,\n      //   0\n      // );\n    }\n  }\n\n  const screenToWorld = (clientX, clientY): THREE.Vector2 => {\n    if (el === null) {\n      throw new Error(\"no el in dom\");\n    }\n\n    const { width, height, top, left } = el.getBoundingClientRect();\n    const screenX = clientX - left;\n    const screenY = clientY - top;\n    const x = (screenX - width / 2) * sceneScale + camera.position.x;\n    const y = (-screenY + height / 2) * sceneScale + camera.position.y;\n    return new THREE.Vector2(x, y);\n  };\n\n  let isCameraGrabed = false;\n  let startDragMousePosition = new THREE.Vector2();\n  let startDragCamera = new THREE.Vector2();\n\n  let boundingClientRect;\n\n  function onMouseDown(event) {\n    const { getState } = appStore;\n    const state = getState();\n    if (state.mode === EditorMode.Idle) {\n      isCameraGrabed = true;\n      if (el !== null) {\n        const { width, height, top, left } = el.getBoundingClientRect();\n        boundingClientRect = el.getBoundingClientRect();\n\n        const screenX = event.clientX - left;\n        const screenY = event.clientY - top;\n        startDragMousePosition.x = screenX;\n        startDragMousePosition.y = screenY;\n\n        startDragCamera.x = camera.position.x;\n        startDragCamera.y = camera.position.y;\n      }\n    } else if (state.mode === EditorMode.EditBeads) {\n      if (el !== null) {\n        boundingClientRect = el.getBoundingClientRect();\n      }\n      const { x, y } = screenToWorld(event.clientX, event.clientY);\n      mouseSelectionBeads.onDown(x, y);\n      if (el === null) {\n        throw new Error(\"no el in dom\");\n      }\n      const { width, height, top, left } = el.getBoundingClientRect();\n      const screenX = event.clientX - left;\n      const screenY = event.clientY - top;\n      mouseSelectionHelper.onDown(screenX, screenY);\n    }\n  }\n\n  function onMouseUp(event) {\n    const { dispatch, getState } = appStore;\n    const state = getState();\n    if (state.mode === EditorMode.AddBeads) {\n      const { x, y } = screenToWorld(event.clientX, event.clientY);\n      dispatch(\n        Actions.Draggable.action_addBeadOnClick({\n          x,\n          y,\n        })\n      );\n    } else if (state.mode === EditorMode.Idle) {\n      if (isCameraGrabed === true) {\n        isCameraGrabed = false;\n      }\n    } else if (state.mode === EditorMode.EditBeads) {\n      if (mouseSelectionBeads.isDragged === true) {\n        // do nothing\n      } else if (\n        mouseSelectionBeads.isDragged === false &&\n        mouseSelectionBeads.isDragStarted === true\n      ) {\n        const { x, y } = screenToWorld(event.clientX, event.clientY);\n        const beadsIds: string[] = [];\n        Object.keys(state.appData.beads).forEach((beadId) => {\n          const bead = state.appData.beads[beadId];\n          const leftTop = buildPoint(\n            bead.position.x - bead.width / 2,\n            bead.position.y - bead.height / 2\n          );\n          const rightBottom = buildPoint(\n            bead.position.x + bead.width / 2,\n            bead.position.y + bead.height / 2\n          );\n          if (contain(leftTop, rightBottom, buildPoint(x, y))) {\n            beadsIds.push(beadId);\n          }\n        });\n        dispatch(Actions.MouseSelection.action_selectBeads(beadsIds));\n      } else {\n        dispatch(Actions.MouseSelection.action_selectBeads([]));\n      }\n      mouseSelectionBeads.onUp();\n      mouseSelectionHelper.onUp();\n    }\n  }\n\n  function onWindowResize() {\n    // console.log(\"onWindowResize\");\n    // const { dispatch, subscribe, getState } = appStore;\n    // const state = getState();\n\n    if (el !== null) {\n      const { width, height } = el.getBoundingClientRect();\n\n      // camera.aspect = width / height;\n      // (camera as THREE.OrthographicCamera)\n      camera.left = width / -2;\n      camera.right = width / 2;\n      camera.top = height / 2;\n      camera.bottom = height / -2;\n      camera.updateProjectionMatrix();\n      renderer.setSize(width, height);\n    }\n  }\n\n  function onMouseMove(event) {\n    if (boundingClientRect) {\n      // event.preventDefault();\n      const { width, height, top, left } = boundingClientRect;\n\n      // Used in: Clicked at item in world?\n      mouse_intercestion.x = ((event.clientX - left) / width) * 2 - 1;\n      mouse_intercestion.y = -((event.clientY - top) / height) * 2 + 1;\n\n      const screenX = event.clientX - left;\n      const screenY = event.clientY - top;\n\n      if (isCameraGrabed === true) {\n        const screenMouseDiffX = startDragMousePosition.x - screenX;\n        const screenMouseDiffY = startDragMousePosition.y - screenY;\n\n        const mouseDiffXInWorldSpace = screenMouseDiffX * sceneScale;\n        const mouseDiffYInWorldSpace = screenMouseDiffY * sceneScale;\n\n        const cameraX = startDragCamera.x + mouseDiffXInWorldSpace;\n        const cameraY = startDragCamera.y - mouseDiffYInWorldSpace;\n        camera.position.x = cameraX;\n        camera.position.y = cameraY;\n        camera.lookAt(cameraX, cameraY, 0);\n      }\n\n      const { dispatch, getState } = appStore;\n      const state = getState();\n\n      if (state.mode === EditorMode.EditBeads) {\n        if (mouseSelectionBeads.isDragStarted === true) {\n          const { x, y } = screenToWorld(event.clientX, event.clientY);\n          mouseSelectionBeads.onMove(x, y);\n          if (mouseSelectionBeads.isDragged === true) {\n            const beadsIds: string[] = [];\n            Object.keys(state.appData.beads).forEach((beadId) => {\n              const bead = state.appData.beads[beadId];\n              if (mouseSelectionBeads.contain(bead.position)) {\n                beadsIds.push(beadId);\n              }\n            });\n            dispatch(Actions.MouseSelection.action_selectBeads(beadsIds));\n          }\n        }\n        if (el === null) {\n          throw new Error(\"no el in dom\");\n        }\n        const { width, height, top, left } = el.getBoundingClientRect();\n        const screenX = event.clientX - left;\n        const screenY = event.clientY - top;\n        mouseSelectionHelper.onMove(screenX, screenY);\n      }\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame(animate);\n\n    render();\n  }\n\n  function render() {\n    // console.log('render camra')\n    // if (basicMesh !== undefined && basicMesh.length > 0) {\n    //   raycaster.setFromCamera(mouse_intercestion, camera);\n    //   var intersection: any = raycaster.intersectObject(basicMesh[0]);\n\n    //   if (intersection.length > 0) {\n    //     console.log(\"co zaznaczono?\", intersection);\n    //     //   var instanceId = intersection[0].instanceId;\n\n    //     //   mesh.getMatrixAt(instanceId, instanceMatrix);\n    //     //   matrix.multiplyMatrices(instanceMatrix, rotationMatrix);\n\n    //     //   mesh.setMatrixAt(instanceId, matrix);\n    //     //   mesh.instanceMatrix.needsUpdate = true;\n    //   }\n    // }\n\n    // if(mesh){\n    //   mesh.instanceMatrix.needsUpdate = true;\n    //   // mesh.rotateX(0.01)\n    // }\n\n    renderer.render(scene, camera);\n    // console.log(\"render\")\n\n    // stats.update();\n  }\n};\n\nclass MouseSelection {\n  isDragged: boolean = false;\n  isDragStarted: boolean = false;\n  end: { x: number; y: number } = { x: 0, y: 0 };\n  start: { x: number; y: number } = { x: 0, y: 0 };\n\n  onUp() {\n    this.isDragStarted = false;\n    this.isDragged = false;\n    this.start.x = 0;\n    this.start.y = 0;\n    this.end.x = 0;\n    this.end.y = 0;\n  }\n\n  onDown(x: number, y: number) {\n    this.isDragStarted = true;\n    this.start.x = x;\n    this.start.y = y;\n    this.end.x = x;\n    this.end.y = y;\n  }\n\n  onMove(x: number, y: number) {\n    if (this.isDragStarted == true) {\n      this.end.x = x;\n      this.end.y = y;\n      if (this.isDragged === false) {\n        const { start, end } = this;\n        const deltaX = end.x - start.x;\n        const deltaY = end.y - start.y;\n\n        if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n          this.isDragged = true;\n        }\n      }\n    }\n  }\n\n  contain(p: { x: number; y: number }) {\n    const { start, end } = this;\n\n    const p1_x = Math.min(start.x, end.x);\n    const p1_y = Math.min(start.y, end.y);\n\n    const p2_x = Math.max(start.x, end.x);\n    const p2_y = Math.max(start.y, end.y);\n\n    return p.x > p1_x && p.x < p2_x && p.y > p1_y && p.y < p2_y;\n  }\n}\n\nclass MouseSelectionHelper {\n  element: HTMLDivElement;\n  renderer: any;\n  startPoint: Vector2;\n  pointTopLeft: Vector2;\n  pointBottomRight: Vector2;\n  isDown: boolean;\n\n  constructor() {\n    this.element = document.createElement(\"div\");\n    this.element.style.pointerEvents = \"none\";\n    this.element.style.background = \"rgba(75, 160, 255, 0.3)\";\n    this.element.style.border = \"1px solid #55aaff\";\n    this.element.style.position = \"absolute\";\n    this.element.style.zIndex = \"2\";\n    this.startPoint = new Vector2();\n    this.pointTopLeft = new Vector2();\n    this.pointBottomRight = new Vector2();\n    this.isDown = false;\n  }\n\n  setRenderer(renderer) {\n    this.renderer = renderer;\n  }\n\n  onDown(screenX: number, screenY: number) {\n    this.isDown = true;\n    this.renderer.domElement.parentElement.appendChild(this.element);\n\n    // this.element.setAttribute(\"style\", `\n    //   left: ${screenX}px;\n    //   top: ${screenY}px;\n    //   width: 0px;\n    //   height: 0px;\n    // `);\n    this.element.style.left = screenX + \"px\";\n    this.element.style.top = screenY + \"px\";\n    this.element.style.width = \"0px\";\n    this.element.style.height = \"0px\";\n\n    this.startPoint.x = screenX;\n    this.startPoint.y = screenY;\n  }\n\n  onMove(screenX: number, screenY: number) {\n    if (this.isDown) {\n      this.pointBottomRight.x = Math.max(this.startPoint.x, screenX);\n      this.pointBottomRight.y = Math.max(this.startPoint.y, screenY);\n      this.pointTopLeft.x = Math.min(this.startPoint.x, screenX);\n      this.pointTopLeft.y = Math.min(this.startPoint.y, screenY);\n\n      this.element.style.left = this.pointTopLeft.x + \"px\";\n      this.element.style.top = this.pointTopLeft.y + \"px\";\n      this.element.style.width =\n        this.pointBottomRight.x - this.pointTopLeft.x + \"px\";\n      this.element.style.height =\n        this.pointBottomRight.y - this.pointTopLeft.y + \"px\";\n    }\n  }\n\n  onUp() {\n    if (this.element.parentElement !== null) {\n      this.element.parentElement.removeChild(this.element);\n    }\n  }\n\n  // this.renderer.domElement.addEventListener( 'mousedown', function ( event ) {\n\n  //   this.isDown = true;\n  //   this.onSelectStart( event );\n\n  // }.bind( this ), false );\n\n  // this.renderer.domElement.addEventListener( 'mousemove', function ( event ) {\n\n  //   if ( this.isDown ) {\n\n  //     this.onSelectMove( event );\n\n  //   }\n\n  // }.bind( this ), false );\n\n  // this.renderer.domElement.addEventListener( 'mouseup', function ( event ) {\n\n  //   this.isDown = false;\n  //   this.onSelectOver( event );\n\n  // }.bind( this ), false );\n}\n\n// SelectionHelper.prototype.onSelectStart = function ( event ) {\n\n//   this.renderer.domElement.parentElement.appendChild( this.element );\n\n//   this.element.style.left = event.clientX + 'px';\n//   this.element.style.top = event.clientY + 'px';\n//   this.element.style.width = '0px';\n//   this.element.style.height = '0px';\n\n//   this.startPoint.x = event.clientX;\n//   this.startPoint.y = event.clientY;\n\n// };\n\n// SelectionHelper.prototype.onSelectMove = function ( event ) {\n\n//   this.pointBottomRight.x = Math.max( this.startPoint.x, event.clientX );\n//   this.pointBottomRight.y = Math.max( this.startPoint.y, event.clientY );\n//   this.pointTopLeft.x = Math.min( this.startPoint.x, event.clientX );\n//   this.pointTopLeft.y = Math.min( this.startPoint.y, event.clientY );\n\n//   this.element.style.left = this.pointTopLeft.x + 'px';\n//   this.element.style.top = this.pointTopLeft.y + 'px';\n//   this.element.style.width = ( this.pointBottomRight.x - this.pointTopLeft.x ) + 'px';\n//   this.element.style.height = ( this.pointBottomRight.y - this.pointTopLeft.y ) + 'px';\n\n// };\n\n// SelectionHelper.prototype.onSelectOver = function () {\n\n//   this.element.parentElement.removeChild( this.element );\n\n// };\n","export const uiButton = \"#aeaeae\"\nexport const defaulBeadColor = \"#4fc3f7\";","import { Point } from \"./Editor\";\nimport { immerable } from \"immer\";\n\nexport const buildPoint = (x: number = 0, y: number = 0): Point => {\n  return {\n    x,\n    y,\n    [immerable]: true,\n  } as Point;\n};\n\nexport const getLength = (point: Point) => {\n  return Math.sqrt(point.x * point.x + point.y * point.y);\n};\n\nexport const normalize = (point: Point) => {\n  const length = getLength(point);\n  const useLen = length === 0;\n  const x = useLen ? 0 : point.x / length;\n  const y = useLen ? 0 : point.y / length;\n  return buildPoint(x, y);\n};\n\nexport const scale = (point: Point, scalar: number) => {\n  return buildPoint(point.x * scalar, point.y * scalar);\n};\n\nexport const add = (point: Point, x: number, y: number) => {\n  return buildPoint(point.x + x, point.y + y);\n};\n\nexport const sub = (point: Point, x: number, y: number) => {\n  return buildPoint(point.x - x, point.y - y);\n};\n\nexport const getDistance = (x1, y1, x2, y2): number => {\n  return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n};\n\nexport const getDistanceBetweenPoints = (start: Point, end: Point): number => {\n  return Math.sqrt(\n    (end.x - start.x) * (end.x - start.x) +\n      (end.y - start.y) * (end.y - start.y)\n  );\n};\n\nexport const getRotate = (y, x) => {\n  return Math.atan2(y, x);\n};\n\nexport const contain = (p1: Point, p2: Point, p: Point): boolean => {\n  return p.x > p1.x && p.x < p2.x && p.y > p1.y && p.y < p2.y;\n};\n\nexport const toRadian = (radians: number) => {\n  return (radians / 180) * Math.PI;\n};\n\nexport const toDeg = (radians: number) => {\n  return (radians * 180) / Math.PI;\n};\n","import { immerable } from \"immer\";\nimport { generate } from \"shortid\";\nimport { Bead, BeadTypes } from \"./Editor\";\nimport { DeepPartial } from \"ts-essentials\";\nimport { buildPoint } from \"./Point\";\nimport { merge } from \"lodash\";\nimport { defaulBeadColor } from \"../components/colors\";\n\nexport const buildBead = (props: DeepPartial<Bead>): Bead => {\n  const defaults: Bead = {\n    id: generate(),\n    position: buildPoint(0, 0),\n    type: BeadTypes.BasicEllipse,\n    rotate: 0,\n    lineRotate: 0,\n    color: defaulBeadColor,\n    height: 10,\n    width: 10,\n    keepAspectRatio: false,\n    [immerable]: true,\n  };\n  return merge(defaults, props);\n  // const id = generate();\n  // const beadType = type ? type : BeadTypes.BasicCircle;\n  // const common = {\n  //   id,\n  //   position,\n  //   [immerable]: true,\n  //   type: beadType,\n  // };\n\n  // if (beadType === BeadTypes.BasicCircle) {\n  //   return buildBead_BasicCircle(common);\n  // }\n\n  // if (beadType === BeadTypes.BasicRectangle) {\n  //   return buildBead_BasicRectangle(common);\n  // }\n\n  // return buildBead_BasicCircle(common);\n};\n\n// const buildBead_BasicCircle = common => {\n//   return {\n//     ...common,\n//     width: 20,\n//     height: 20,\n//     fill: `linear-gradient(\n//       to bottom,\n//       rgba(254, 204, 177, 1) 0%,\n//       rgba(241, 116, 50, 1) 50%,\n//       rgba(234, 85, 7, 1) 51%,\n//       rgba(251, 149, 94, 1) 100%\n//     )`,\n//     settings: {\n//       radius: 20,\n//     },\n//   } as Bead;\n// };\n\n// const buildBead_BasicRectangle = common => {\n//   return {\n//     ...common,\n//     width: 20,\n//     height: 40,\n//     fill: \"#b1b1b1\",\n//   } as Bead;\n// };\n","import { immerable } from \"immer\";\nimport { Line, Point } from \"./Editor\";\nimport { generate } from \"shortid\";\nimport { normalize, scale, add, buildPoint } from \"./Point\";\nimport { merge } from \"lodash\";\nimport { DeepPartial } from \"ts-essentials\";\nimport { buildBead } from \"./Bead\";\n\nexport const buildLine = (props: DeepPartial<Line>): Line => {\n  const __defaults = {\n    id: generate(),\n    start: buildPoint(10, 10),\n    end: buildPoint(100, 100),\n    beadIds: [],\n    settings: {\n      beadsCount: 0,\n      beadsAutoCount: true,\n      beadsSpacing: 0,\n      beadsAutoSpacing: false,\n      defaultBead: buildBead({}),\n    },\n    [immerable]: true,\n  };\n\n  return merge(__defaults, props);\n};\n\nexport const getLength = (line: Line): number => {\n  return Math.sqrt(\n    (line.end.x - line.start.x) * (line.end.x - line.start.x) +\n      (line.end.y - line.start.y) * (line.end.y - line.start.y)\n  );\n};\n\nexport const getPointFromStart = (line: Line, distance: number): Point => {\n  const x = line.end.x - line.start.x;\n  const y = line.end.y - line.start.y;\n  let point = buildPoint(x, y);\n  point = normalize(point);\n  point = scale(point, distance);\n  point = add(point, line.start.x, line.start.y);\n  return point;\n};\n\nexport const getPointFromStartLine = (\n  startX: number,\n  startY: number,\n  endX: number,\n  endY: number,\n  distance: number\n): Point => {\n  const x = endX - startX;\n  const y = endY - startY;\n  let point = buildPoint(x, y);\n  point = normalize(point);\n  point = scale(point, distance);\n  point = add(point, startX, startY);\n  return point;\n};\n","import { ImmerReducer } from \"immer-reducer\";\nimport { Editor, \n  // EditorMode, Point \n} from \"../editorObjects/Editor\";\nimport {\n  // buildPoint,\n  getDistanceBetweenPoints,\n  getRotate,\n  toDeg,\n} from \"../editorObjects/Point\";\nimport { buildBead } from \"../editorObjects/Bead\";\n// import { buildLine } from \"../editorObjects/Line\";\nimport { getPointFromStartLine } from \"../editorObjects/Line\";\n// import { merge } from \"lodash\";\n\nexport class BeadSnapperImmerReducer extends ImmerReducer<Editor> {\n  \n  // useHexGrid(){\n  //   xPos = P.transform.position[0];\n  //   yPos = P.transform.position[1];\n\n  //   cSize = L.effect(\"Cell Size\")(\"Slider\");\n  //   xOffset = L.effect(\"X Offset\")(\"Slider\");\n  //   yOffset = L.effect(\"Y Offset\")(\"Slider\");\n\n  //   // Convert size value into distance values between cells\n  //   cWidth = cSize*.75;\n  //   cHeight = cSize*13/15;\n\n  //   // Find new X and Y positions\n  //   yNew = yPos - yPos % cHeight + cHeight/2;\n  //   xNew = xPos - (xPos % cWidth) + (((yNew - cHeight/2).toFixed(2)/cHeight).toFixed(2) % 1) * (cWidth/2);\n\n  //   // Check for even/odd column, adjust properly\n  //   if (!(xNew % (cWidth*2) == 0)) yNew += cHeight/2;\n\n  //   // Implement offset\n  //   [xNew + xOffset, yNew+yOffset]\n  // }\n\n  updateBeadsPositions(lineId: string) {\n    // console.log(\"updateBeadsPositions: ---------------------- start\");\n    const currentLine = this.draftState.appData.lines[lineId];\n    const count = this.getLineBeadsCount(lineId);\n    const currentCount = currentLine.beadIds.length;\n    // console.log(\n    //   \"updateBeadsPositions: currentCount: \",\n    //   currentCount,\n    //   \" count\",\n    //   count\n    // );\n    if (count > currentCount) {\n      const remaining = count - currentCount;\n      this.addRemainingBeads(lineId, remaining);\n    } else if (count < currentCount) {\n      const overflow = currentCount - count;\n      this.removeOverflowBeads(lineId, overflow);\n    }\n    this.draftState.appData.lines[lineId].settings.beadsCount = count;\n    this.modifyBeadsPosition(lineId);\n    this.modifyBeadsRotate(lineId);\n    // console.log(\"updateBeadsPositions: ----------------------  end\");\n  }\n\n  getLineBeadsCount(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const {\n      beadsAutoCount,\n      beadsAutoSpacing,\n      beadsCount,\n      beadsSpacing,\n      defaultBead,\n    } = currentLine.settings;\n    const { start, end, beadIds } = currentLine;\n    const lineLen = getDistanceBetweenPoints(start, end);\n\n    // console.log(\n    //   \"getLineBeadsCount \",\n    //   lineLen,\n    //   beadsAutoCount === true,\n    //   beadsAutoSpacing === true\n    // );\n    if (beadsAutoCount === true && beadsAutoSpacing === true) {\n      // beadsy sa przyklejone do siebie. COunt powinien byc tyle ile sie zmiesci na lini\n      let beadsWidths: number[] = [];\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width = this.draftState.appData.beads[beadId].width;\n        beadsWidth = beadsWidth + width;\n        beadsWidths.push(width);\n      });\n      if (lineLen >= beadsWidth) {\n        // ile defaultsow trzeba dodac aby linia byla wypelniona?\n        const defaultBeadWidth = defaultBead.width ? defaultBead.width : 10;\n        const remainingSpace = lineLen - beadsWidth;\n        const count =\n          Math.floor(remainingSpace / defaultBeadWidth) + beadsWidths.length;\n\n        return count;\n      } else {\n        // trzeba odejmowac elementy z lini do momentu az wszystkie sie zmnieszcza\n        for (let i = beadsWidths.length - 1; i >= 0; i--) {\n          beadsWidth = beadsWidth - beadsWidths[i];\n          if (lineLen > beadsWidth) {\n            const count = i;\n            return count;\n          }\n        }\n        // nie powinno byc elementow na linie, bo nie ma miejsca z lineLen\n        return 0;\n      }\n    } else if (beadsAutoCount === false && beadsAutoSpacing === false) {\n      return beadsCount;\n    } else if (beadsAutoCount === true && beadsAutoSpacing === false) {\n      let beadsWidths: number[] = [];\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width =\n          this.draftState.appData.beads[beadId].width + beadsSpacing;\n        beadsWidth = beadsWidth + width;\n        beadsWidths.push(width);\n      });\n      if (lineLen >= beadsWidth - beadsSpacing) {\n        const defaultBeadWidth = defaultBead.width ? defaultBead.width : 10;\n        const remainingSpace = lineLen - (beadsWidth - beadsSpacing);\n        const count =\n          Math.floor(remainingSpace / (defaultBeadWidth + beadsSpacing)) +\n          beadsWidths.length;\n        return count;\n      } else {\n        for (let i = beadsWidths.length - 1; i >= 0; i--) {\n          beadsWidth = beadsWidth - beadsWidths[i];\n          if (lineLen > beadsWidth - beadsSpacing) {\n            const count = i;\n            return count;\n          }\n        }\n        return 0;\n      }\n    } else if (beadsAutoCount === false && beadsAutoSpacing === true) {\n      return beadsCount;\n    }\n    return 0;\n  }\n\n  addRemainingBeads(lineId, remainingCount) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    for (let i = 0; i < remainingCount; i++) {\n      let defaultBead: any = {};\n      if (currentLine.settings.defaultBead) {\n        defaultBead = { ...currentLine.settings.defaultBead };\n      } else if (\n        this.draftState.ui.lineSettings.settings &&\n        this.draftState.ui.lineSettings.settings.defaultBead\n      ) {\n        defaultBead = {\n          ...this.draftState.ui.lineSettings.settings.defaultBead,\n        };\n      }\n      defaultBead.id = undefined;\n      defaultBead.position = undefined;\n      const bead = buildBead(defaultBead);\n      this.draftState.appData.beads[bead.id] = bead;\n      this.draftState.appData.lines[lineId].beadIds.push(bead.id);\n    }\n  }\n\n  removeOverflowBeads(lineId, overflowCount) {\n    for (let i = 0; i < overflowCount; i++) {\n      const arrLen = this.draftState.appData.lines[lineId].beadIds.length;\n      const lastItemBeadId = this.draftState.appData.lines[\n        lineId\n      ].beadIds.splice(arrLen - 1, 1);\n      delete this.draftState.appData.beads[lastItemBeadId[0]];\n    }\n  }\n\n  modifyBeadsPosition(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const { start, end, beadIds } = currentLine;\n    const {\n      beadsAutoCount,\n      beadsAutoSpacing,\n      // beadsCount,\n      beadsSpacing,\n      // defaultBead,\n    } = currentLine.settings;\n\n    const standardLineHeight = 10;\n\n    if (beadsAutoCount === true && beadsAutoSpacing === true) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2;\n      });\n    } else if (beadsAutoCount === false && beadsAutoSpacing === false) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + beadsSpacing;\n      });\n    } else if (beadsAutoCount === true && beadsAutoSpacing === false) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + beadsSpacing;\n      });\n    } else if (beadsAutoCount === false && beadsAutoSpacing === true) {\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width = this.draftState.appData.beads[beadId].width;\n        beadsWidth = beadsWidth + width;\n      });\n      const lineLen = getDistanceBetweenPoints(start, end);\n      const avaiableSpace = lineLen - beadsWidth;\n      let dynamicBeadsSpacing = 0;\n      if (beadIds.length > 1) {\n        dynamicBeadsSpacing = avaiableSpace / (beadIds.length - 1);\n      }\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + dynamicBeadsSpacing;\n      });\n    }\n  }\n\n  modifyBeadsRotate(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const { start, end, beadIds } = currentLine;\n    const lineRotateRadian = getRotate(start.x - end.x, start.y - end.y);\n    beadIds.forEach(beadId => {\n      this.draftState.appData.beads[beadId].lineRotate =\n        toDeg(lineRotateRadian) * -1;\n    });\n  }\n}\n","import {\n  // Editor,\n  EditorMode,\n  Point,\n  EditorGridType,\n  Bead,\n} from \"../editorObjects/Editor\";\n// import { buildPoint, getDistanceBetweenPoints } from \"../editorObjects/Point\";\n// import { ImmerReducer } from \"immer-reducer\";\n// import { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\n// import { getPointFromStartLine } from \"../editorObjects/Line\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport {\n  buildPoint,\n  getDistanceBetweenPoints,\n  sub,\n  normalize,\n  scale,\n} from \"../editorObjects/Point\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nconst lineBoxOffset = 5;\n\nexport class DraggableOperationsImmerReducer extends BeadSnapperImmerReducer {\n  action_updateSceneZoom(event: any) {\n    this.draftState.ui.sceneWrapperPosition = event;\n  }\n  action_updateSceneWrapperSize({ width, height }) {\n    this.draftState.ui.sceneWrapperWidth = width;\n    this.draftState.ui.sceneWrapperHeight = height;\n  }\n\n  editorAppDataHasChanged() {\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = true;\n  }\n\n  action_onAddLine(start: Point, end: Point) {\n    const line = buildLine({ ...this.draftState.ui.lineSettings, start, end });\n    this.draftState.appData.lines[line.id] = line;\n    this.draftState.mode = EditorMode.EditLines;\n    this.updateBeadsPositions(line.id);\n    this.editorAppDataHasChanged();\n  }\n\n  action_onStartPointDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n    }\n  ) {\n    // console.log(\"action_onStartPointDrag\");\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        type,\n        hexSize,\n      } = this.draftState.ui.grid;\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.start.x = Math.round(data.x / width) * width - lineBoxOffset;\n          line.start.y = Math.round(data.y / height) * height - lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n          const changeX = Math.round(data.x / hSpace) * hSpace - lineBoxOffset;\n          const vLine = Math.round(data.y / vSpace);\n          const changeY = vLine * vSpace - lineBoxOffset - hexHeight / 4;\n          line.start.y = changeY;\n          if (vLine % 2 === 0) {\n            line.start.x = hSpace / 2 + changeX;\n          } else {\n            line.start.x = changeX;\n          }\n        }\n      } else {\n        line.start.x = data.x - lineBoxOffset;\n        line.start.y = data.y - lineBoxOffset;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onEndPointDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n    }\n  ) {\n    // console.log(\"action_onEndPointDrag\");\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        hexSize,\n        type,\n      } = this.draftState.ui.grid;\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.end.x = Math.round(data.x / width) * width - lineBoxOffset;\n          line.end.y = Math.round(data.y / height) * height - lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n          const changeX = Math.round(data.x / hSpace) * hSpace - lineBoxOffset;\n          const vLine = Math.round(data.y / vSpace);\n          const changeY = vLine * vSpace - lineBoxOffset - hexHeight / 4;\n          line.end.y = changeY;\n          if (vLine % 2 === 0) {\n            line.end.x = hSpace / 2 + changeX;\n          } else {\n            line.end.x = changeX;\n          }\n        }\n      } else {\n        line.end.x = data.x - lineBoxOffset;\n        line.end.y = data.y - lineBoxOffset;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onLineDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n      deltaX: number;\n      deltaY: number;\n      startX: number;\n      startY: number;\n      lineStart: Point | null;\n      lineEnd: Point | null;\n    }\n  ) {\n    const { startX, startY, lineStart, lineEnd, x, y } = data;\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        type,\n        hexSize,\n      } = this.draftState.ui.grid;\n\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.start.x =\n            Math.round((line.start.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.start.y =\n            Math.round((line.start.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n\n          line.end.x =\n            Math.round((line.end.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.end.y =\n            Math.round((line.end.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n\n          if (lineStart !== null) {\n            const newX = lineStart.x + (x - startX);\n            const newY = lineStart.y + (y - startY);\n            const changeX = Math.round(newX / hSpace) * hSpace - lineBoxOffset;\n\n            const vLine = Math.round(newY / vSpace);\n            const newChangeY = vLine * vSpace;\n            const temp = hexHeight / 4;\n            let changeY = newChangeY - lineBoxOffset - temp;\n            line.start.y = changeY;\n            if (vLine % 2 === 0) {\n              line.start.x = hSpace / 2 + changeX;\n            } else {\n              line.start.x = changeX;\n            }\n          }\n\n          if (lineEnd !== null) {\n            const newX = lineEnd.x + (x - startX);\n            const newY = lineEnd.y + (y - startY);\n            const changeX = Math.round(newX / hSpace) * hSpace - lineBoxOffset;\n\n            const vLine = Math.round(newY / vSpace);\n            const newChangeY = vLine * vSpace;\n            const temp = hexHeight / 4;\n            let changeY = newChangeY - lineBoxOffset - temp;\n            line.end.y = changeY;\n            if (vLine % 2 === 0) {\n              line.end.x = hSpace / 2 + changeX;\n            } else {\n              line.end.x = changeX;\n            }\n          }\n        }\n      } else {\n        line.start.x = line.start.x + data.deltaX;\n        line.start.y = line.start.y + data.deltaY;\n        line.end.x = line.end.x + data.deltaX;\n        line.end.y = line.end.y + data.deltaY;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onGroupLineDrag(data: { deltaX: number; deltaY: number }) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      if (this.draftState.appData.lines[lineId]) {\n        const line = this.draftState.appData.lines[lineId];\n        const { width, height, snapEnabled } = this.draftState.ui.grid;\n        if (snapEnabled === true) {\n          line.start.x =\n            Math.round((line.start.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.start.y =\n            Math.round((line.start.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n\n          line.end.x =\n            Math.round((line.end.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.end.y =\n            Math.round((line.end.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n        } else {\n          line.start.x = line.start.x + data.deltaX;\n          line.start.y = line.start.y + data.deltaY;\n          line.end.x = line.end.x + data.deltaX;\n          line.end.y = line.end.y + data.deltaY;\n        }\n        this.updateBeadsPositions(line.id);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_onGroupBeadsDrag(data: { deltaX: number; deltaY: number }) {}\n\n  action_onClickLine(lineId: string) {\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIds[lineId] = true;\n    this.draftState.ui.selectedLinesIdsCount = 1;\n  }\n\n  action_onClickLastestLine() {\n    const keys = Object.keys(this.draftState.appData.lines);\n    if (keys.length > 0) {\n      const lineId = keys[keys.length - 1];\n      this.action_onClickLine(lineId);\n    }\n  }\n\n  action_onClickBead(beadId: string) {\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIds[beadId] = true;\n    this.draftState.ui.selectedBeadsIdsCount = 1;\n  }\n\n  action_addBeads_onMouseDown({ x, y }) {\n    this.draftState.ui.currentBeadChain.isDragEnabled = true;\n\n    let defaultBead: Partial<Bead> = { ...this.draftState.ui.beadsTemplate };\n    defaultBead.id = undefined;\n    defaultBead.position = buildPoint(x, y);\n\n    const bead = buildBead(defaultBead);\n    bead.position.x = bead.position.x - bead.width / 2;\n    bead.position.y = bead.position.y - bead.height / 2;\n\n    this.draftState.appData.beads[bead.id] = bead;\n    this.draftState.ui.currentBeadChain.beadIds.push(bead.id);\n  }\n\n  action_addBeads_onMouseMove({ x, y }) {\n    if (this.draftState.ui.currentBeadChain.isDragEnabled) {\n      const len = this.draftState.ui.currentBeadChain.beadIds.length;\n      const lastBeadId = this.draftState.ui.currentBeadChain.beadIds[len - 1];\n      const lastBead = this.draftState.appData.beads[lastBeadId];\n      const position = buildPoint(x, y);\n\n      const lastPosition = buildPoint(\n        lastBead.position.x + lastBead.width / 2,\n        lastBead.position.y + lastBead.height / 2\n      );\n      const distance = getDistanceBetweenPoints(lastPosition, position);\n\n      if (distance > lastBead.width) {\n        const vec = sub(position, lastPosition.x, lastPosition.y);\n        const norm = normalize(vec);\n        const scaled = scale(norm, lastBead.width);\n\n        let defaultBead: Partial<Bead> = {\n          ...this.draftState.ui.beadsTemplate,\n        };\n        defaultBead.id = undefined;\n        const _x = lastPosition.x + scaled.x;\n        const _y = lastPosition.y + scaled.y;\n        defaultBead.position = buildPoint(_x, _y);\n\n        const bead = buildBead(defaultBead);\n        bead.position.x = bead.position.x - bead.width / 2;\n        bead.position.y = bead.position.y - bead.height / 2;\n\n        this.draftState.appData.beads[bead.id] = bead;\n        this.draftState.ui.currentBeadChain.beadIds.push(bead.id);\n      }\n    }\n  }\n\n  action_addBeadOnClick({ x, y }) {\n    // console.log(\"action_addBeadOnClick triggered\");\n    let defaultBead: Partial<Bead> = {\n      ...this.draftState.ui.beadsTemplate,\n    };\n    defaultBead.id = undefined;\n    defaultBead.position = buildPoint(x, y);\n    const bead = buildBead(defaultBead);\n    // console.log(\"??\", bead.width, bead.height);\n    bead.position.x = bead.position.x - bead.width / 2;\n    bead.position.y = bead.position.y - bead.height / 2;\n    this.draftState.appData.beads[bead.id] = bead;\n    // console.log(\"ile jest?\", Object.keys(this.draftState.appData.beads).length);\n    getEventEmitter().emit(\"action_addBeadOnClick\", { bead }, this.state);\n  }\n\n  action_addBeads_onMouseUp({ x, y }) {\n    this.draftState.ui.currentBeadChain.isDragEnabled = false;\n    this.draftState.ui.currentBeadChain.beadIds = [];\n  }\n}\n","import { Editor } from \"../editorObjects/Editor\";\n// import { ImmerReducer } from \"immer-reducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nexport class PersistImmerReducer extends BeadSnapperImmerReducer {\n  action_onClearCanvas() {\n    this.draftState.appData.beads = {};\n    this.draftState.appData.lines = {};\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIdsCount = 0;\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n  }\n\n  action_readSavedCanvas() {\n    console.log(\"action_readSavedCanvas\");\n    // const startBeads = {};\n    for (let i = 0; i < 10 * 10; i = i + 10) {\n      for (let j = 0; j < 10 * 50; j = j + 10) {\n        const b1 = buildBead({\n          width: 8,\n          height: 8,\n          position: {\n            x: i,\n            y: j,\n          },\n        });\n        this.draftState.appData.beads[b1.id] = b1;\n      }\n    }\n\n    getEventEmitter().emit(\n      \"action_readSavedCanvas\",\n      this.draftState.appData,\n      this.state\n    );\n\n    // if (\"localStorage\" in window) {\n    //   this.draftState.ui.saveInfo.saved = true;\n    //   this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n    //   const readedData = localStorage.getItem(\"appData\");\n    //   if (readedData !== null) {\n    //     try {\n    //       const cached = JSON.parse(readedData) as Editor[\"appData\"];\n    //       this.draftState.appData = {\n    //         beads: {},\n    //         lines: {},\n    //       };\n    //       Object.keys(cached.beads).forEach(beadId => {\n    //         const currBead = cached.beads[beadId];\n    //         const bead = buildBead(currBead);\n    //         this.draftState.appData.beads[beadId] = bead;\n    //       });\n    //       Object.keys(cached.lines).forEach(lineId => {\n    //         const currLine = cached.lines[lineId];\n    //         const line = buildLine(currLine);\n    //         this.draftState.appData.lines[lineId] = line;\n    //       });\n    //       Object.keys(this.draftState.appData.lines).forEach(lineId => {\n    //         this.updateBeadsPositions(lineId);\n    //       });\n    //       console.log(\"action_readSavedCanvas loaded\");\n    //     } catch (err) {\n    //       console.error(\"action_readSavedCanvas error: \", err);\n    //     }\n    //   } else {\n    //     console.info(\"No data in localstorage\");\n    //   }\n    // } else {\n    //   console.info(\"No localstorage available\");\n    // }\n  }\n\n  action_onSaveCanvas() {\n    if (\"localStorage\" in window) {\n      localStorage.setItem(\"appData\", JSON.stringify(this.draftState.appData));\n      this.draftState.ui.saveInfo.saved = true;\n      this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n      console.log(\"action_onSaveCanvas saved\");\n    } else {\n      this.draftState.ui.saveInfo.saved = false;\n      console.info(\"No localstorage available\");\n    }\n  }\n}\n\n// const a = {\n//   beads: {\n//     \"a19AKjQX-\": {\n//       id: \"a19AKjQX-\",\n//       position: { x: 124.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"KYwow-3r-\": {\n//       id: \"KYwow-3r-\",\n//       position: { x: 176.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"8Zv9yoc3O\": {\n//       id: \"8Zv9yoc3O\",\n//       position: { x: 228.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     Csyy61dk7: {\n//       id: \"Csyy61dk7\",\n//       position: { x: 280.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"K9seOU-sZ\": {\n//       id: \"K9seOU-sZ\",\n//       position: { x: 332.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4OluG2val\": {\n//       id: \"4OluG2val\",\n//       position: { x: 384.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     WyVILEjgG: {\n//       id: \"WyVILEjgG\",\n//       position: { x: 436.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     oQ14N6Po8: {\n//       id: \"oQ14N6Po8\",\n//       position: { x: 98.92304845413263, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     Av87g3peZ: {\n//       id: \"Av87g3peZ\",\n//       position: { x: 150.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     I2UB_GTly: {\n//       id: \"I2UB_GTly\",\n//       position: { x: 202.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     yGTQ4IT7l: {\n//       id: \"yGTQ4IT7l\",\n//       position: { x: 254.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     sAXQ7hsQP: {\n//       id: \"sAXQ7hsQP\",\n//       position: { x: 306.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     deV4qFK6b: {\n//       id: \"deV4qFK6b\",\n//       position: { x: 358.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     VKyNP8c6Q: {\n//       id: \"VKyNP8c6Q\",\n//       position: { x: 410.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     uwSd7QcQe: {\n//       id: \"uwSd7QcQe\",\n//       position: { x: 124.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     fnAnxCx1i: {\n//       id: \"fnAnxCx1i\",\n//       position: { x: 176.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     gZX7etv17: {\n//       id: \"gZX7etv17\",\n//       position: { x: 228.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"0tH_CViDI\": {\n//       id: \"0tH_CViDI\",\n//       position: { x: 280.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"8R3hzq0Kk\": {\n//       id: \"8R3hzq0Kk\",\n//       position: { x: 332.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4vauo8kt4\": {\n//       id: \"4vauo8kt4\",\n//       position: { x: 384.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"ZqMNO9Q5-\": {\n//       id: \"ZqMNO9Q5-\",\n//       position: { x: 436.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     wxjOD75mB: {\n//       id: \"wxjOD75mB\",\n//       position: { x: 98.92304845413263, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     EyabW_7SH: {\n//       id: \"EyabW_7SH\",\n//       position: { x: 150.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"QX-VSqWHJ\": {\n//       id: \"QX-VSqWHJ\",\n//       position: { x: 202.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     YRjrowdYg: {\n//       id: \"YRjrowdYg\",\n//       position: { x: 254.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     NwMuNbOKC: {\n//       id: \"NwMuNbOKC\",\n//       position: { x: 306.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     Nia0xNTig: {\n//       id: \"Nia0xNTig\",\n//       position: { x: 358.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4t8McpTRT\": {\n//       id: \"4t8McpTRT\",\n//       position: { x: 410.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     QZM85vE4H: {\n//       id: \"QZM85vE4H\",\n//       position: { x: 124.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     m6NK9xpnJ: {\n//       id: \"m6NK9xpnJ\",\n//       position: { x: 176.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4SXetBeWL\": {\n//       id: \"4SXetBeWL\",\n//       position: { x: 228.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     UhzJs0GPl: {\n//       id: \"UhzJs0GPl\",\n//       position: { x: 280.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     yeLLzgEY6: {\n//       id: \"yeLLzgEY6\",\n//       position: { x: 332.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     ZEU_ZVZik: {\n//       id: \"ZEU_ZVZik\",\n//       position: { x: 384.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"5GbXtZC9B\": {\n//       id: \"5GbXtZC9B\",\n//       position: { x: 98.92304845413263, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     N8qDr6L3f: {\n//       id: \"N8qDr6L3f\",\n//       position: { x: 150.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"9IUytGuY1\": {\n//       id: \"9IUytGuY1\",\n//       position: { x: 202.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     WPv1QJeJa: {\n//       id: \"WPv1QJeJa\",\n//       position: { x: 254.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     dVhb5iUkr: {\n//       id: \"dVhb5iUkr\",\n//       position: { x: 306.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     LlVZEDtJ9: {\n//       id: \"LlVZEDtJ9\",\n//       position: { x: 358.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"yQ-h8_tm0\": {\n//       id: \"yQ-h8_tm0\",\n//       position: { x: 410.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//   },\n//   lines: {\n//     \"YaQ3-jOG\": {\n//       id: \"YaQ3-jOG\",\n//       start: { x: 124.90381056766579, y: 70 },\n//       end: { x: 540.5960043841962, y: 70 },\n//       beadIds: [\n//         \"a19AKjQX-\",\n//         \"KYwow-3r-\",\n//         \"8Zv9yoc3O\",\n//         \"Csyy61dk7\",\n//         \"K9seOU-sZ\",\n//         \"4OluG2val\",\n//         \"WyVILEjgG\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"dZjyRBQrH\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     CRcLEam9P: {\n//       id: \"CRcLEam9P\",\n//       start: { x: 98.92304845413263, y: 115 },\n//       end: { x: 514.6152422706631, y: 115 },\n//       beadIds: [\n//         \"oQ14N6Po8\",\n//         \"Av87g3peZ\",\n//         \"I2UB_GTly\",\n//         \"yGTQ4IT7l\",\n//         \"sAXQ7hsQP\",\n//         \"deV4qFK6b\",\n//         \"VKyNP8c6Q\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"ILgHjX7En\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     Tml7p6ZKI: {\n//       id: \"Tml7p6ZKI\",\n//       start: { x: 124.90381056766579, y: 160 },\n//       end: { x: 540.5960043841962, y: 160 },\n//       beadIds: [\n//         \"uwSd7QcQe\",\n//         \"fnAnxCx1i\",\n//         \"gZX7etv17\",\n//         \"0tH_CViDI\",\n//         \"8R3hzq0Kk\",\n//         \"4vauo8kt4\",\n//         \"ZqMNO9Q5-\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"ibloOzyTR\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     Bq4W3C3Ew: {\n//       id: \"Bq4W3C3Ew\",\n//       start: { x: 98.92304845413263, y: 205 },\n//       end: { x: 514.6152422706631, y: 205 },\n//       beadIds: [\n//         \"wxjOD75mB\",\n//         \"EyabW_7SH\",\n//         \"QX-VSqWHJ\",\n//         \"YRjrowdYg\",\n//         \"NwMuNbOKC\",\n//         \"Nia0xNTig\",\n//         \"4t8McpTRT\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"w648Um7U6\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     mJvdHpK60: {\n//       id: \"mJvdHpK60\",\n//       start: { x: 124.90381056766579, y: 250 },\n//       end: { x: 488.63448015713, y: 250 },\n//       beadIds: [\n//         \"QZM85vE4H\",\n//         \"m6NK9xpnJ\",\n//         \"4SXetBeWL\",\n//         \"UhzJs0GPl\",\n//         \"yeLLzgEY6\",\n//         \"ZEU_ZVZik\",\n//       ],\n//       settings: {\n//         beadsCount: 6,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"irTbjtCzJ\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     pA1FF6_zm: {\n//       id: \"pA1FF6_zm\",\n//       start: { x: 98.92304845413263, y: 295 },\n//       end: { x: 514.6152422706631, y: 295 },\n//       beadIds: [\n//         \"5GbXtZC9B\",\n//         \"N8qDr6L3f\",\n//         \"9IUytGuY1\",\n//         \"WPv1QJeJa\",\n//         \"dVhb5iUkr\",\n//         \"LlVZEDtJ9\",\n//         \"yQ-h8_tm0\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"MtRiOzAsd\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//   },\n// };\n","import { Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\n\nexport class ChangeEditorModeImmerReducer extends ImmerReducer<Editor> {\n  action_onChangeEditorMode(newEditorMode: EditorMode) {\n    this.draftState.mode = newEditorMode;\n    this.clearSelectedBeads();\n    this.clearSelectedLines();\n  }\n  private clearSelectedBeads = () => {\n    if (this.draftState.ui.selectedBeadsIdsCount > 0) {\n      this.draftState.ui.selectedBeadsIds = {};\n      this.draftState.ui.selectedBeadsIdsCount = 0;\n    }\n  };\n  private clearSelectedLines = () => {\n    if (this.draftState.ui.selectedLinesIdsCount) {\n      this.draftState.ui.selectedLinesIds = {};\n      this.draftState.ui.selectedLinesIdsCount = 0;\n    }\n  };\n  action_setSaveInfo(newValue: boolean) {\n    this.draftState.ui.saveInfo.saved = newValue;\n  }\n}\n","import { Editor } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\n\nexport class MainImmerReducer extends ImmerReducer<Editor> {\n  action_test() {}\n  action_restoreState() {}\n}\n","import { Editor } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildPoint } from \"../editorObjects/Point\";\nimport { contain } from \"../editorObjects/Point\";\nimport { getEventEmitter } from \"../EventEmitter\";\nimport _ from \"lodash\";\n// import { difference } from \"lodash\";\n\nexport class MouseSelectionImmerReducer extends ImmerReducer<Editor> {\n  action_onEditBeadsMouseDown(x, y) {\n    console.log(\"action_onEditBeadsMouseDown??\");\n    this.draftState.ui.mouseSelection.isDragStarted = true;\n\n    this.draftState.ui.mouseSelection.start.x = x;\n    this.draftState.ui.mouseSelection.start.y = y;\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n  }\n\n  action_onEditBeadsMouseMove(x, y) {\n    console.log(\"action_onEditBeadsMouseMove??\");\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const deltaX = end.x - start.x;\n      const deltaY = end.y - start.y;\n\n      if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n        this.draftState.ui.mouseSelection.isDragged = true;\n      }\n    }\n\n    if (this.draftState.ui.mouseSelection.isDragged === true) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const p1 = buildPoint(Math.min(start.x, end.x), Math.min(start.y, end.y));\n      const p2 = buildPoint(Math.max(start.x, end.x), Math.max(start.y, end.y));\n\n      // const selectedIds = Object.keys(this.draftState.ui.selectedBeadsIds);\n      // const newIds: string[] = [];\n\n      // Object.keys(this.draftState.appData.beads).forEach(beadId => {\n      //   const bead = this.draftState.appData.beads[beadId];\n      //   const p3 = buildPoint(bead.position.x + 10, bead.position.y + 10);\n      //   if (contain(p1, p2, p3)) {\n      //     newIds.push(beadId);\n      //   }\n      // });\n\n      // const diff = difference(newIds, selectedIds);\n\n      // if (diff.length > 0) {\n      //   this.draftState.ui.selectedBeadsIds = {};\n      //   this.draftState.ui.selectedBeadsIdsCount = 0;\n      //   newIds.forEach(id => {\n      //     this.draftState.ui.selectedBeadsIds[id] = true;\n      //     this.draftState.ui.selectedBeadsIdsCount =\n      //       this.draftState.ui.selectedBeadsIdsCount + 1;\n      //   });\n      // }\n\n      this.draftState.ui.selectedBeadsIds = {};\n      this.draftState.ui.selectedBeadsIdsCount = 0;\n      Object.keys(this.draftState.appData.beads).forEach((beadId) => {\n        const bead = this.draftState.appData.beads[beadId];\n        const p3 = buildPoint(bead.position.x + 10, bead.position.y + 10);\n        if (contain(p1, p2, p3)) {\n          this.draftState.ui.selectedBeadsIds[beadId] = true;\n          this.draftState.ui.selectedBeadsIdsCount =\n            this.draftState.ui.selectedBeadsIdsCount + 1;\n        }\n      });\n    }\n  }\n\n  action_selectBeads(beadsIds: string[]) {\n    const prevSelectedIds = Object.keys(this.draftState.ui.selectedBeadsIds);\n\n    const diffIds = _.xor(prevSelectedIds, beadsIds);\n    const diffStates = diffIds.map((id) => {\n      if (prevSelectedIds.includes(id)) {\n        return { [id]: false };\n      } else {\n        return { [id]: true };\n      }\n    });\n\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIdsCount = 0;\n    if (beadsIds.length > 0) {\n      Object.keys(this.draftState.appData.beads).forEach((beadId) => {\n        if (beadsIds.includes(beadId)) {\n          this.draftState.ui.selectedBeadsIds[beadId] = true;\n          this.draftState.ui.selectedBeadsIdsCount =\n            this.draftState.ui.selectedBeadsIdsCount + 1;\n        }\n      });\n    }\n\n    getEventEmitter().emit(\"action_selectBeads\", { diffStates }, this.state);\n  }\n\n  action_onEditBeadsMouseUp() {\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      if (this.draftState.ui.selectedBeadsIdsCount > 0) {\n        this.draftState.ui.selectedBeadsIds = {};\n        this.draftState.ui.selectedBeadsIdsCount = 0;\n      }\n    }\n\n    this.draftState.ui.mouseSelection.isDragStarted = false;\n    this.draftState.ui.mouseSelection.isDragged = false;\n    this.draftState.ui.mouseSelection.start.x = 0;\n    this.draftState.ui.mouseSelection.start.y = 0;\n    this.draftState.ui.mouseSelection.end.x = 0;\n    this.draftState.ui.mouseSelection.end.y = 0;\n  }\n\n  action_onEditLinesMouseDown(x: number, y: number) {\n    this.draftState.ui.mouseSelection.isDragStarted = true;\n    this.draftState.ui.mouseSelection.start.x = x;\n    this.draftState.ui.mouseSelection.start.y = y;\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n  }\n\n  action_onEditLinesMouseMove(x: number, y: number) {\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const deltaX = end.x - start.x;\n      const deltaY = end.y - start.y;\n      if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n        this.draftState.ui.mouseSelection.isDragged = true;\n      }\n    }\n\n    if (this.draftState.ui.mouseSelection.isDragged === true) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const p1 = buildPoint(Math.min(start.x, end.x), Math.min(start.y, end.y));\n      const p2 = buildPoint(Math.max(start.x, end.x), Math.max(start.y, end.y));\n\n      // const selectedIds = Object.keys(this.draftState.ui.selectedLinesIds);\n      // const newIds: string[] = [];\n\n      // Object.keys(this.draftState.appData.lines).forEach(lineId => {\n      //   const line = this.draftState.appData.lines[lineId];\n      //   if (contain(p1, p2, line.start) || contain(p1, p2, line.end)) {\n      //     newIds.push(lineId);\n      //   }\n      // });\n\n      // const diff = difference(newIds, selectedIds);\n\n      // if (diff.length > 0) {\n      //   this.draftState.ui.selectedLinesIds = {};\n      //   this.draftState.ui.selectedLinesIdsCount = 0;\n      //   newIds.forEach(id => {\n      //     this.draftState.ui.selectedLinesIds[id] = true;\n      //     this.draftState.ui.selectedLinesIdsCount =\n      //       this.draftState.ui.selectedLinesIdsCount + 1;\n      //   });\n      // }\n      this.draftState.ui.selectedLinesIds = {};\n      this.draftState.ui.selectedLinesIdsCount = 0;\n      Object.keys(this.draftState.appData.lines).forEach((lineId) => {\n        const line = this.draftState.appData.lines[lineId];\n        if (contain(p1, p2, line.start) || contain(p1, p2, line.end)) {\n          this.draftState.ui.selectedLinesIds[lineId] = true;\n          this.draftState.ui.selectedLinesIdsCount =\n            this.draftState.ui.selectedLinesIdsCount + 1;\n        }\n      });\n    }\n  }\n\n  action_onEditLinesMouseUp() {\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      if (this.draftState.ui.selectedLinesIdsCount > 0) {\n        this.draftState.ui.selectedLinesIds = {};\n        this.draftState.ui.selectedLinesIdsCount = 0;\n      }\n    }\n\n    this.draftState.ui.mouseSelection.isDragStarted = false;\n    this.draftState.ui.mouseSelection.isDragged = false;\n    this.draftState.ui.mouseSelection.start.x = 0;\n    this.draftState.ui.mouseSelection.start.y = 0;\n    this.draftState.ui.mouseSelection.end.x = 0;\n    this.draftState.ui.mouseSelection.end.y = 0;\n  }\n}\n","import { BeadTypes } from \"../editorObjects/Editor\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { merge } from \"lodash\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nexport class ToolbarImmerReducer extends BeadSnapperImmerReducer {\n  editorAppDataHasChanged() {\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = true;\n  }\n  action_changeBeadFill(color: string) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].color = color;\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_updateLight(index: number, field: string, value: any) {\n    if (this.draftState.ui.lights[index][field]) {\n      const light = this.draftState.ui.lights[index];\n      light[field] = value;\n      const name = light.name;\n      this.editorAppDataHasChanged();\n      getEventEmitter().emit(\n        \"action_updateLight\",\n        { name, field, value },\n        this.state\n      );\n    }\n  }\n\n  action_changeBeadType(type: BeadTypes) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].type = type;\n    });\n    this.editorAppDataHasChanged();\n  }\n  action_onBeadRotate(beadId, { deg }) {}\n  action_onBeadsRotate({ deg }) {}\n\n  action_changeSelectedLinesBeadsSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsAutoSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsAutoCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_resetSelectedLines() {\n    const firstLineId = Object.keys(this.draftState.ui.selectedLinesIds)[0];\n    const firstLine = this.draftState.appData.lines[firstLineId];\n    const defaultBead = { ...firstLine.settings.defaultBead };\n\n    defaultBead.id = undefined;\n    defaultBead.position = undefined;\n\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].beadIds.forEach((beadId) => {\n        if (defaultBead) {\n          this.draftState.appData.beads[beadId] = merge(\n            this.draftState.appData.beads[beadId],\n            defaultBead\n          );\n        }\n      });\n      this.draftState.appData.lines[id].settings.defaultBead = merge(\n        this.draftState.appData.lines[id].settings.defaultBead,\n        defaultBead\n      );\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_deleteSelectedLines() {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].beadIds.forEach((beadId) => {\n        delete this.draftState.appData.beads[beadId];\n      });\n      delete this.draftState.appData.lines[id];\n    });\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n    this.editorAppDataHasChanged();\n  }\n\n  action_cloneSelectedLines() {\n    const moveX = 20;\n    const moveY = 20;\n    const newLinesIds: string[] = [];\n\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      const newLine = buildLine({\n        ...this.draftState.appData.lines[id],\n        id: undefined,\n        beadIds: [],\n      });\n      newLine.start.x = newLine.start.x + moveX;\n      newLine.start.y = newLine.start.y + moveY;\n      newLine.end.x = newLine.end.x + moveX;\n      newLine.end.y = newLine.end.y + moveY;\n\n      this.draftState.appData.lines[id].beadIds.forEach((beadId) => {\n        const newBead = buildBead({\n          ...this.draftState.appData.beads[beadId],\n          id: undefined,\n        });\n        newBead.position.x = newBead.position.x + moveX;\n        newBead.position.y = newBead.position.y + moveY;\n        this.draftState.appData.beads[newBead.id] = newBead;\n        newLine.beadIds.push(newBead.id);\n      });\n\n      newLinesIds.push(newLine.id);\n      this.draftState.appData.lines[newLine.id] = newLine;\n    });\n\n    newLinesIds.forEach((lineId) => {\n      this.updateBeadsPositions(lineId);\n    });\n\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n\n    newLinesIds.forEach((lineId) => {\n      this.draftState.ui.selectedLinesIds[lineId] = true;\n      this.draftState.ui.selectedLinesIdsCount =\n        this.draftState.ui.selectedLinesIdsCount + 1;\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  /**\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeDefaultLineBeadsCount(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsCount = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsAutoCount(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsAutoCount = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsSpacing(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsSpacing = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsAutoSpacing(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsAutoSpacing = value;\n    }\n  }\n\n  action_changeDefaultLineBeadType(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      if (this.draftState.ui.lineSettings.settings.defaultBead) {\n        this.draftState.ui.lineSettings.settings.defaultBead.type = value;\n      }\n    }\n  }\n\n  action_changeDefaultLineColor(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      if (this.draftState.ui.lineSettings.settings.defaultBead) {\n        this.draftState.ui.lineSettings.settings.defaultBead.color = value;\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadHeight(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        const {\n          width,\n          height,\n          keepAspectRatio,\n        } = lineSettings.settings.defaultBead;\n        if (keepAspectRatio && width && height) {\n          if (height >= 1) {\n            const ratio = width / height;\n            lineSettings.settings.defaultBead.width = value * ratio;\n            lineSettings.settings.defaultBead.height = value;\n          } else {\n            lineSettings.settings.defaultBead.height = 1;\n          }\n        } else {\n          lineSettings.settings.defaultBead.height = value;\n        }\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadWidth(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        const {\n          width,\n          height,\n          keepAspectRatio,\n        } = lineSettings.settings.defaultBead;\n        if (keepAspectRatio && width && height) {\n          if (width >= 1) {\n            const ratio = height / width;\n            lineSettings.settings.defaultBead.width = value;\n            lineSettings.settings.defaultBead.height = value * ratio;\n          } else {\n            lineSettings.settings.defaultBead.width = 1;\n          }\n        } else {\n          lineSettings.settings.defaultBead.width = value;\n        }\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadKeepAspectRatio(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        lineSettings.settings.defaultBead.keepAspectRatio = value;\n      }\n    }\n  }\n  action_changeDefaultLineBeadRotate(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        lineSettings.settings.defaultBead.rotate = value;\n      }\n    }\n  }\n\n  /**\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeSelectedLines_settings_beadsCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsAutoCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsAutoSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_type(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.type = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].type = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_color(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.color = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].color = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_height(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      const currLine = this.draftState.appData.lines[lineId];\n      let { width, height, keepAspectRatio } = currLine.settings.defaultBead;\n\n      if (keepAspectRatio === false) {\n        currLine.settings.defaultBead.height = value;\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          this.draftState.appData.beads[beadId].height = value;\n        });\n        this.updateBeadsPositions(lineId);\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n            height = value;\n          }\n\n          currLine.settings.defaultBead.width = width;\n          currLine.settings.defaultBead.height = height;\n        }\n\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          if (width && height) {\n            this.draftState.appData.beads[beadId].width = width;\n            this.draftState.appData.beads[beadId].height = height;\n          }\n        });\n\n        this.updateBeadsPositions(lineId);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_width(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      const currLine = this.draftState.appData.lines[lineId];\n      let { width, height, keepAspectRatio } = currLine.settings.defaultBead;\n\n      if (keepAspectRatio === false) {\n        currLine.settings.defaultBead.width = value;\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          this.draftState.appData.beads[beadId].width = value;\n        });\n        this.updateBeadsPositions(lineId);\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = height / width;\n            width = value;\n            height = value * ratio;\n          }\n\n          currLine.settings.defaultBead.width = width;\n          currLine.settings.defaultBead.height = height;\n        }\n\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          if (width && height) {\n            this.draftState.appData.beads[beadId].width = width;\n            this.draftState.appData.beads[beadId].height = height;\n          }\n        });\n\n        this.updateBeadsPositions(lineId);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_keepAspectRatio(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[\n        lineId\n      ].settings.defaultBead.keepAspectRatio = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].keepAspectRatio = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_rotate(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.rotate = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].rotate = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  /****\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeSelectedBeads_type(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].type = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_color(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].color = value;\n    });\n    getEventEmitter().emit(\n      \"action_changeSelectedBeads_color\",\n      {\n        beadIds: Object.keys(this.draftState.ui.selectedBeadsIds),\n        color: value,\n      },\n      this.state\n    );\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_height(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      const currBead = this.draftState.appData.beads[beadId];\n      let { width, height, keepAspectRatio } = currBead;\n\n      if (keepAspectRatio === false) {\n        this.draftState.appData.beads[beadId].height = value;\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n            height = value;\n          }\n        }\n        this.draftState.appData.beads[beadId].width = width;\n        this.draftState.appData.beads[beadId].height = height;\n      }\n    });\n\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_width(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      const currBead = this.draftState.appData.beads[beadId];\n      let { width, height, keepAspectRatio } = currBead;\n\n      if (keepAspectRatio === false) {\n        this.draftState.appData.beads[beadId].width = value;\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = height / width;\n            width = value;\n            height = value * ratio;\n          }\n        }\n        this.draftState.appData.beads[beadId].width = width;\n        this.draftState.appData.beads[beadId].height = height;\n      }\n    });\n\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_keepAspectRatio(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].keepAspectRatio = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_rotate(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].rotate = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  updateLineFromSelectedBeads() {\n    const results: string[] = [];\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      for (const lineId of Object.keys(this.draftState.appData.lines)) {\n        if (\n          this.draftState.appData.lines[lineId].beadIds.indexOf(beadId) !== -1\n        ) {\n          if (results.indexOf(lineId) === -1) {\n            results.push(lineId);\n            break;\n          }\n        }\n      }\n    });\n    for (const lineId of results) {\n      this.updateBeadsPositions(lineId);\n    }\n  }\n\n  /****\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_updateBrushSize(value) {\n    this.draftState.ui.brush.size = value;\n  }\n\n  action_updateBrushColor(value) {\n    this.draftState.ui.brush.color = value;\n  }\n\n  action_updateBeadsTemplate(key: string, value: any) {\n    if (this.draftState.ui.beadsTemplate[key] !== undefined) {\n      let { keepAspectRatio, width, height } = this.draftState.ui.beadsTemplate;\n\n      if (keepAspectRatio === true) {\n        if (key === \"width\") {\n          if (value >= 1) {\n            const ratio = height / width;\n            height = value * ratio;\n          }\n          this.draftState.ui.beadsTemplate.height = height;\n        }\n        if (key === \"height\") {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n          }\n          this.draftState.ui.beadsTemplate.width = width;\n        }\n      }\n\n      this.draftState.ui.beadsTemplate[key] = value;\n    } else {\n      console.warn(`action_updateBeadsTemplate: key dont exists ${key}`);\n    }\n  }\n}\n","import { Editor, EditorMenuMain } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildPoint } from \"../editorObjects/Point\";\n\nexport class TopbarImmerReducer extends ImmerReducer<Editor> {\n  action_toggleMenuFile() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.File) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.File;\n    }\n  }\n  action_toggleMenuSettings() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.Grid) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.Grid;\n    }\n  }\n  action_toggleMenuBackground() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.Background) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.Background;\n    }\n  }\n  action_toggleGridSnapEnabled() {\n    this.draftState.ui.grid.snapEnabled = !this.draftState.ui.grid.snapEnabled;\n  }\n  action_toggleGridIsVisible() {\n    this.draftState.ui.grid.isVisible = !this.draftState.ui.grid.isVisible;\n  }\n  action_setGridWidth(value) {\n    this.draftState.ui.grid.width = value;\n  }\n  action_setGridHeight(value) {\n    this.draftState.ui.grid.height = value;\n  }\n  action_setGridType(value) {\n    this.draftState.ui.grid.type = value;\n  }\n  action_setGridHexSize(value) {\n    this.draftState.ui.grid.hexSize = value;\n  }\n\n  action_background_image_clear() {\n    this.draftState.ui.background.image.position = buildPoint(0, 0);\n    this.draftState.ui.background.image.scale = 1;\n    this.draftState.ui.background.image.url = \"\";\n  }\n  action_background_image_upload(value) {\n    this.draftState.ui.background.image.url = value;\n  }\n  action_background_image_pointX(value) {\n    this.draftState.ui.background.image.position.x = value;\n  }\n  action_background_image_pointY(value) {\n    this.draftState.ui.background.image.position.y = value;\n  }\n  action_background_image_scale(value) {\n    this.draftState.ui.background.image.scale = value;\n  }\n  action_background_image_opacity(value) {\n    this.draftState.ui.background.image.opacity = value;\n  }\n  \n}\n","import { Editor, BrushType } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { getDistanceBetweenPoints, buildPoint } from \"../editorObjects/Point\";\n\nexport class PaintImmerReducer extends ImmerReducer<Editor> {\n  action_applyColorBrush(x, y) {\n    const { color, type, size } = this.draftState.ui.brush;\n    if (type === BrushType.Color) {\n      const mousePoint = buildPoint(x + size / 2, y + size /2);\n      Object.keys(this.draftState.appData.beads).forEach(beadId => {\n        const currBead = this.draftState.appData.beads[beadId];\n        if (currBead.color !== color) {\n          const centerPoint = buildPoint(\n            currBead.position.x + currBead.width / 2,\n            currBead.position.y + currBead.height / 2\n          );\n          const len = getDistanceBetweenPoints(centerPoint, mousePoint);\n          const brush = size / 2 + Math.min(currBead.width , currBead.height) / 2;\n          if (len < brush) {\n            this.draftState.appData.beads[beadId].color = color;\n          }\n        }\n      });\n    }\n  }\n}\n","import {\n  Editor,\n  EditorMode,\n  BeadTypes,\n  EditorMenuMain,\n  EditorGridType,\n  BrushType,\n} from \"../editorObjects/Editor\";\nimport { Reducer } from \"redux\";\nimport { buildPoint } from \"../editorObjects/Point\";\nimport { composeReducers } from \"immer-reducer\";\nimport { createActionCreators, createReducerFunction } from \"immer-reducer\";\nimport { DraggableOperationsImmerReducer } from \"./DraggableOperationsImmerReducer\";\nimport { PersistImmerReducer } from \"./PersistImmerReducer\";\nimport { ChangeEditorModeImmerReducer } from \"./ChangeEditorModeImmerReducer\";\nimport { MainImmerReducer } from \"./MainImmerReducer\";\nimport { MouseSelectionImmerReducer } from \"./MouseSelectionImmerReducer\";\nimport { ToolbarImmerReducer } from \"./ToolbarImmerReducer\";\nimport { defaulBeadColor } from \"../components/colors\";\nimport { TopbarImmerReducer } from \"./TopbarImmerReducer\";\nimport { PaintImmerReducer } from \"./PaintImmerReducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { produce } from \"immer\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nconst defaultBead = buildBead({});\n\nconst defaultAppData: Editor = {\n  appData: {\n    beads: {},\n    lines: {},\n  },\n  ui: {\n    lights: [\n      {\n        type: \"THREE.DirectionalLight\",\n        name: \"main_light_1\",\n        color: \"#FFF\",\n        intensity: 0.8,\n        position: {\n          x: 0,\n          y: 0,\n          z: 10,\n        },\n      },\n      {\n        type: \"THREE.DirectionalLight\",\n        name: \"main_light_2\",\n        color: \"#FFF\",\n        intensity: 0.4,\n        position: {\n          x: 0,\n          y: 0,\n          z: 10,\n        },\n      },\n    ],\n    lineSettings: {\n      settings: {\n        beadsAutoCount: true,\n        beadsAutoSpacing: true,\n        beadsCount: 0,\n        beadsSpacing: 0,\n        defaultBead: {\n          type: BeadTypes.BasicEllipse,\n          rotate: 0,\n          color: defaulBeadColor,\n          height: 52,\n          width: 52,\n          keepAspectRatio: false,\n        },\n      },\n    },\n    saveInfo: {\n      saved: false,\n      haveUnsavedChanges: false,\n    },\n    selectedLinesIds: {},\n    selectedLinesIdsCount: 0,\n    selectedBeadsIds: {},\n    selectedBeadsIdsCount: 0,\n    mouseSelection: {\n      start: buildPoint(0, 0),\n      end: buildPoint(0, 0),\n      isDragStarted: false,\n      isDragged: false,\n    },\n    currentMenuMainOpen: EditorMenuMain.None,\n    grid: {\n      type: EditorGridType.Hex,\n      hexSize: 30,\n      snapEnabled: true,\n      isVisible: true,\n      width: 30,\n      height: 30,\n    },\n    brush: {\n      type: BrushType.Color,\n      size: 50,\n      color: defaulBeadColor,\n    },\n    background: {\n      image: {\n        url: \"\",\n        scale: 1,\n        position: buildPoint(0, 0),\n        opacity: 0.5,\n      },\n    },\n    beadsTemplate: {\n      color: defaultBead.color,\n      width: defaultBead.width,\n      height: defaultBead.height,\n      keepAspectRatio: defaultBead.keepAspectRatio,\n      rotate: defaultBead.rotate,\n      type: defaultBead.type,\n    },\n    currentBeadChain: {\n      isDragEnabled: false,\n      beadIds: [],\n    },\n    sceneWrapperWidth: 0,\n    sceneWrapperHeight: 0,\n    sceneWrapperPosition: {\n      x: 0,\n      y: 0,\n      angle: 0,\n      scale: 0,\n      top: 0,\n      left: 0,\n    },\n  },\n  mode: EditorMode.Idle,\n};\n\nexport const Actions = {\n  Main: createActionCreators(MainImmerReducer),\n  Draggable: createActionCreators(DraggableOperationsImmerReducer),\n  Persist: createActionCreators(PersistImmerReducer),\n  ChangeEditorMode: createActionCreators(ChangeEditorModeImmerReducer),\n  MouseSelection: createActionCreators(MouseSelectionImmerReducer),\n  Toolbar: createActionCreators(ToolbarImmerReducer),\n  Topbar: createActionCreators(TopbarImmerReducer),\n  Paint: createActionCreators(PaintImmerReducer),\n};\n\nconst eventEmitter = getEventEmitter();\n\nconst reducerForEventEmitter = produce((state, action) => {\n  eventEmitter.emit(action.type, action.payload, state);\n}, {});\n\nexport const store = composeReducers(\n  createReducerFunction(MainImmerReducer, defaultAppData),\n  createReducerFunction(DraggableOperationsImmerReducer, defaultAppData),\n  createReducerFunction(PersistImmerReducer, defaultAppData),\n  createReducerFunction(ToolbarImmerReducer, defaultAppData),\n  createReducerFunction(TopbarImmerReducer, defaultAppData),\n  createReducerFunction(ChangeEditorModeImmerReducer, defaultAppData),\n  createReducerFunction(MouseSelectionImmerReducer, defaultAppData),\n  createReducerFunction(PaintImmerReducer, defaultAppData),\n  reducerForEventEmitter\n);\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faPlus,\n  faEdit,\n  faArrowsAlt,\n  faPaintBrush\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { EditorMode } from \"../../editorObjects/Editor\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch } from \"react-redux\";\nimport { Actions } from \"../../immerReducers/store\";\n\nexport const EditorModes = ({ editorMode }) => {\n  const dispatch = useDispatch();\n\n  const onChangeEditorMode = (newEditorMode: EditorMode) => {\n    dispatch(Actions.ChangeEditorMode.action_onChangeEditorMode(newEditorMode));\n  };\n\n  return (\n    <div className=\"\">\n      <StateButton\n        label={\"Idle\"}\n        icon={<FontAwesomeIcon icon={faArrowsAlt} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.Idle)}\n        isSelected={editorMode === EditorMode.Idle}\n      />\n\n      {/* <StateButton\n        label={\"Edit Lines\"}\n        icon={<FontAwesomeIcon icon={faEdit} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.EditLines)}\n        isSelected={editorMode === EditorMode.EditLines}\n      /> */}\n\n      <StateButton\n        label={\"Edit\"}\n        icon={<FontAwesomeIcon icon={faEdit} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.EditBeads)}\n        isSelected={editorMode === EditorMode.EditBeads}\n      />\n\n      {/* <StateButton\n        label={\"AddLine\"}\n        icon={<FontAwesomeIcon icon={faPlus} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.AddLine)}\n        isSelected={editorMode === EditorMode.AddLine}\n      /> */}\n\n      <StateButton\n        label={\"Add\"}\n        icon={<FontAwesomeIcon icon={faPaintBrush} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.AddBeads)}\n        isSelected={editorMode === EditorMode.AddBeads}\n      />\n\n      <StateButton\n        label={\"Paint\"}\n        icon={<FontAwesomeIcon icon={faPaintBrush} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.PaintBeads)}\n        isSelected={editorMode === EditorMode.PaintBeads}\n      />\n\n      <StateButton\n        label={\"Delete\"}\n        icon={<FontAwesomeIcon icon={faPaintBrush} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.DeleteBeads)}\n        isSelected={editorMode === EditorMode.DeleteBeads}\n      />\n    </div>\n  );\n};\n\nconst StateButton = ({ label, isSelected, onClick, icon }) => {\n  return (\n    <div\n      className={`\n              button \n              ${isSelected ? \"is-active\" : \"\"}\n            `}\n      onClick={onClick}\n    >\n      <span className=\"icon is-small\">{icon}</span>\n      <span>{label}</span>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Bead, BeadTypes } from \"../../editorObjects/Editor\";\nimport { getTranslate3dCss } from \"../operations/MapValuesToCss\";\nimport { Actions } from \"../../immerReducers/store\";\nimport { useDispatch } from \"react-redux\";\n\nexport const DisplayBead = (props: {\n  bead: Bead;\n  opacity?: number;\n  zIndex?: number;\n  isSelected: boolean;\n  isSelectable: boolean;\n}) => {\n  const { bead, opacity, zIndex, isSelected, isSelectable } = props;\n  const isOpacity = opacity !== undefined && opacity >= 0 && opacity <= 1;\n  const isZindex = zIndex !== undefined && zIndex >= 0 && zIndex <= 9999;\n\n  const dispatch = useDispatch();\n  const onClick = () => {\n    if (isSelectable) {\n      dispatch(Actions.Draggable.action_onClickBead(bead.id));\n    }\n  };\n\n  const translate3d = getTranslate3dCss(bead.position.x, bead.position.y);\n  const rotate = bead.rotate + bead.lineRotate;\n  const rotateCss = !rotate ? \"rotateZ(0deg)\" : `rotateZ(${rotate}deg)`;\n  let styles: React.CSSProperties = {\n    transform: `${translate3d} ${rotateCss}`,\n    opacity: isOpacity ? opacity : 1,\n    zIndex: isZindex ? zIndex : undefined,\n    border: isSelected ? \"1px solid #000\" : \"\",\n    width: `${bead.width}px`,\n    height: `${bead.height}px`,\n    background: bead.color\n  };\n\n  if (bead.type === BeadTypes.BasicEllipse) {\n    styles.borderRadius = \"100%\";\n  }\n\n  return (\n    <div className=\"bead-item\" onClick={onClick} style={styles}>\n      &nbsp;\n    </div>\n  );\n};\n","export const getTranslate3dCss = (x, y, z = 1) => {\n  return `translate3d(${x}px, ${y}px, ${z}px)`;\n};\n\nexport const getRotateCss = rotate => {\n  return `rotate(${rotate}rad)`;\n};\n","import React from \"react\";\nimport { DisplayBead } from \"../../Bead/DisplayBead\";\nimport { buildBead } from \"../../../editorObjects/Bead\";\nimport { buildPoint } from \"../../../editorObjects/Point\";\n\nexport const FieldBeadPreview = ({ bead }) => {\n  const displayBead = buildBead({\n    ...bead,\n    position: buildPoint(0, 0),\n  });\n  return (\n    <div\n      style={{\n        marginTop: \"20px\",\n        marginBottom: \"20px\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        height: \"100px\",\n        boxSizing: \"border-box\",\n      }}\n    >\n      <div\n        style={{\n          position: \"relative\",\n          top: `${(-1 * bead.height) / 2}px`,\n          left: `${(-1 * bead.width) / 2}px`,\n        }}\n      >\n        <DisplayBead\n          bead={displayBead}\n          isSelected={false}\n          isSelectable={false}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport const ToolbarField = ({ label, icon, value, onToggle }) => {\n  return (\n    <div\n      className={\"fieldset\"}\n      onClick={onToggle}\n      style={{ cursor: \"pointer\" }}\n    >\n      <div className=\"label\">\n        {icon ? (\n          <div\n            style={{\n              width: \"30px\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              height: \"30px\",\n              marginRight: \"10px\",\n            }}\n          >\n            {icon}\n          </div>\n        ) : null}\n        {label ? <div>{label}</div> : null}\n      </div>\n\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          justifyContent: \"flex-end\",\n          alignItems: \"center\",\n          boxSizing: \"border-box\",\n          paddingLeft: \"10px\",\n          paddingRight: \"20px\",\n          width: \"100%\",\n        }}\n      >\n        <div>{value !== undefined ? value : \"-\"}</div>\n      </div>\n    </div>\n  );\n};\n","import React, { useState } from \"react\";\nimport { ToolbarField } from \"./ToolbarField\";\n\nexport const ToolbarFieldSet = ({ selected, label, icon, children }) => {\n  const [isPickerOpen, setIsPickerOpen] = useState(false);\n  const onToggle = () => {\n    setIsPickerOpen(!isPickerOpen);\n  };\n  return (\n    <div\n      style={{\n        // borderBottom: \"1px solid #dfdfdf\",\n        borderTop: \"1px solid #dfdfdf\",\n      }}\n    >\n      <ToolbarField\n        label={label}\n        onToggle={onToggle}\n        icon={icon}\n        value={selected}\n      />\n\n      {isPickerOpen === true ? (\n        <div style={{ background: \"#fff\" }}>{React.cloneElement(children)}</div>\n      ) : null}\n    </div>\n  );\n};\n","import React from \"react\";\nimport * as material from \"material-colors\";\n\nexport const FieldColorPicker = ({ value, onChange, ...props }) => {\n  const colors = [\n    [\n      material.red[\"900\"],\n      material.red[\"700\"],\n      material.red[\"500\"],\n      material.red[\"300\"],\n      material.red[\"100\"],\n    ],\n    [\n      material.pink[\"900\"],\n      material.pink[\"700\"],\n      material.pink[\"500\"],\n      material.pink[\"300\"],\n      material.pink[\"100\"],\n    ],\n    [\n      material.purple[\"900\"],\n      material.purple[\"700\"],\n      material.purple[\"500\"],\n      material.purple[\"300\"],\n      material.purple[\"100\"],\n    ],\n    [\n      material.deepPurple[\"900\"],\n      material.deepPurple[\"700\"],\n      material.deepPurple[\"500\"],\n      material.deepPurple[\"300\"],\n      material.deepPurple[\"100\"],\n    ],\n    [\n      material.indigo[\"900\"],\n      material.indigo[\"700\"],\n      material.indigo[\"500\"],\n      material.indigo[\"300\"],\n      material.indigo[\"100\"],\n    ],\n    [\n      material.blue[\"900\"],\n      material.blue[\"700\"],\n      material.blue[\"500\"],\n      material.blue[\"300\"],\n      material.blue[\"100\"],\n    ],\n    [\n      material.lightBlue[\"900\"],\n      material.lightBlue[\"700\"],\n      material.lightBlue[\"500\"],\n      material.lightBlue[\"300\"],\n      material.lightBlue[\"100\"],\n    ],\n    [\n      material.cyan[\"900\"],\n      material.cyan[\"700\"],\n      material.cyan[\"500\"],\n      material.cyan[\"300\"],\n      material.cyan[\"100\"],\n    ],\n    [\n      material.teal[\"900\"],\n      material.teal[\"700\"],\n      material.teal[\"500\"],\n      material.teal[\"300\"],\n      material.teal[\"100\"],\n    ],\n    [\n      \"#194D33\",\n      material.green[\"700\"],\n      material.green[\"500\"],\n      material.green[\"300\"],\n      material.green[\"100\"],\n    ],\n    [\n      material.lightGreen[\"900\"],\n      material.lightGreen[\"700\"],\n      material.lightGreen[\"500\"],\n      material.lightGreen[\"300\"],\n      material.lightGreen[\"100\"],\n    ],\n    [\n      material.lime[\"900\"],\n      material.lime[\"700\"],\n      material.lime[\"500\"],\n      material.lime[\"300\"],\n      material.lime[\"100\"],\n    ],\n    [\n      material.yellow[\"900\"],\n      material.yellow[\"700\"],\n      material.yellow[\"500\"],\n      material.yellow[\"300\"],\n      material.yellow[\"100\"],\n    ],\n    [\n      material.amber[\"900\"],\n      material.amber[\"700\"],\n      material.amber[\"500\"],\n      material.amber[\"300\"],\n      material.amber[\"100\"],\n    ],\n    [\n      material.orange[\"900\"],\n      material.orange[\"700\"],\n      material.orange[\"500\"],\n      material.orange[\"300\"],\n      material.orange[\"100\"],\n    ],\n    [\n      material.deepOrange[\"900\"],\n      material.deepOrange[\"700\"],\n      material.deepOrange[\"500\"],\n      material.deepOrange[\"300\"],\n      material.deepOrange[\"100\"],\n    ],\n    [\n      material.brown[\"900\"],\n      material.brown[\"700\"],\n      material.brown[\"500\"],\n      material.brown[\"300\"],\n      material.brown[\"100\"],\n    ],\n    [\n      material.blueGrey[\"900\"],\n      material.blueGrey[\"700\"],\n      material.blueGrey[\"500\"],\n      material.blueGrey[\"300\"],\n      material.blueGrey[\"100\"],\n    ],\n    [\"#000000\", \"#525252\", \"#969696\", \"#D9D9D9\", \"#FFFFFF\"],\n  ];\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        paddingTop: \"20px\",\n        paddingBottom: \"30px\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n      }}\n    >\n      <DisplayColorsGroup colors={colors} onClick={onChange} />\n      {/* <CirclePicker\n        color={value}\n        onChangeComplete={color => onChange(color.hex)}\n        colors={[\"#000\"]}\n      /> */}\n      {/* <SwatchesPicker\n        width={258}\n        height={240}\n        onChangeComplete={color => onChange(color.hex)}\n        color={value}\n      /> */}\n    </div>\n  );\n};\n\nconst DisplayColorsGroup = ({ colors, onClick }) => {\n  return (\n    <div>\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"flex-start\",\n          alignItems: \"center\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        {colors.map(group => {\n          return (\n            <div key={group.toString()} style={{ marginBottom: \"10px\" }}>\n              {group.map(color => {\n                return (\n                  <div\n                    key={color}\n                    style={{\n                      cursor: \"pointer\",\n                      border: \"3px solid transparent\",\n                      boxSizing: \"border-box\",\n                    }}\n                  >\n                    <div\n                      onClick={() => onClick(color)}\n                      style={{\n                        boxSizing: \"border-box\",\n                        background: color,\n                        width: \"28px\",\n                        height: \"28px\",\n                        borderRadius: \"100%\",\n                        border: \"none\",\n                      }}\n                    />\n                  </div>\n                );\n              })}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\n\n\n// const colors = [\n//   material.red[\"900\"],\n//   material.red[\"700\"],\n//   material.red[\"500\"],\n//   material.red[\"300\"],\n//   material.red[\"100\"],\n//   material.pink[\"900\"],\n//   material.pink[\"700\"],\n//   material.pink[\"500\"],\n//   material.pink[\"300\"],\n//   material.pink[\"100\"],\n//   material.purple[\"900\"],\n//   material.purple[\"700\"],\n//   material.purple[\"500\"],\n//   material.purple[\"300\"],\n//   material.purple[\"100\"],\n//   material.deepPurple[\"900\"],\n//   material.deepPurple[\"700\"],\n//   material.deepPurple[\"500\"],\n//   material.deepPurple[\"300\"],\n//   material.deepPurple[\"100\"],\n//   material.indigo[\"900\"],\n//   material.indigo[\"700\"],\n//   material.indigo[\"500\"],\n//   material.indigo[\"300\"],\n//   material.indigo[\"100\"],\n//   material.blue[\"900\"],\n//   material.blue[\"700\"],\n//   material.blue[\"500\"],\n//   material.blue[\"300\"],\n//   material.blue[\"100\"],\n//   material.lightBlue[\"900\"],\n//   material.lightBlue[\"700\"],\n//   material.lightBlue[\"500\"],\n//   material.lightBlue[\"300\"],\n//   material.lightBlue[\"100\"],\n//   material.cyan[\"900\"],\n//   material.cyan[\"700\"],\n//   material.cyan[\"500\"],\n//   material.cyan[\"300\"],\n//   material.cyan[\"100\"],\n//   material.teal[\"900\"],\n//   material.teal[\"700\"],\n//   material.teal[\"500\"],\n//   material.teal[\"300\"],\n//   material.teal[\"100\"],\n//   \"#194D33\",\n//   material.green[\"700\"],\n//   material.green[\"500\"],\n//   material.green[\"300\"],\n//   material.green[\"100\"],\n//   material.lightGreen[\"900\"],\n//   material.lightGreen[\"700\"],\n//   material.lightGreen[\"500\"],\n//   material.lightGreen[\"300\"],\n//   material.lightGreen[\"100\"],\n//   material.lime[\"900\"],\n//   material.lime[\"700\"],\n//   material.lime[\"500\"],\n//   material.lime[\"300\"],\n//   material.lime[\"100\"],\n//   material.yellow[\"900\"],\n//   material.yellow[\"700\"],\n//   material.yellow[\"500\"],\n//   material.yellow[\"300\"],\n//   material.yellow[\"100\"],\n//   material.amber[\"900\"],\n//   material.amber[\"700\"],\n//   material.amber[\"500\"],\n//   material.amber[\"300\"],\n//   material.amber[\"100\"],\n//   material.orange[\"900\"],\n//   material.orange[\"700\"],\n//   material.orange[\"500\"],\n//   material.orange[\"300\"],\n//   material.orange[\"100\"],\n//   material.deepOrange[\"900\"],\n//   material.deepOrange[\"700\"],\n//   material.deepOrange[\"500\"],\n//   material.deepOrange[\"300\"],\n//   material.deepOrange[\"100\"],\n//   material.brown[\"900\"],\n//   material.brown[\"700\"],\n//   material.brown[\"500\"],\n//   material.brown[\"300\"],\n//   material.brown[\"100\"],\n//   material.blueGrey[\"900\"],\n//   material.blueGrey[\"700\"],\n//   material.blueGrey[\"500\"],\n//   material.blueGrey[\"300\"],\n//   material.blueGrey[\"100\"],\n\n//   \"#000000\",\n//   \"#525252\",\n//   \"#969696\",\n//   \"#D9D9D9\",\n//   \"#FFFFFF\",\n// ];\n","import React from \"react\";\n\nexport const FieldColor = ({ value, isSelected, onClick }) => {\n  return (\n    <div style={{ border: \"5px solid transparent\" }}>\n      <div\n        onClick={onClick ? () => onClick(value) : undefined}\n        style={{\n          width: 25,\n          height: 25,\n          background: value,\n          marginBottom: 0,\n          marginRight: 0,\n          border: isSelected ? \"2px solid #000\" : \"2px solid #000\",\n          boxShadow: isSelected\n            ? \"2px 2px 2px rgba(0,0,0,1)\"\n            : \"2px 2px 2px rgba(0,0,0,0.1)\",\n        }}\n      ></div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPalette } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { FieldColorPicker } from \"./FieldColorPicker\";\nimport { FieldColor } from \"./FieldColor\";\n\nexport const FieldsetColor = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={\n        <FieldColor value={value} isSelected={false} onClick={undefined} />\n      }\n      label={\"Color\"}\n      icon={<FontAwesomeIcon icon={faPalette} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldColorPicker value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { BeadTypes } from \"../../../editorObjects/Editor\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCircle, faExpand } from \"@fortawesome/free-solid-svg-icons\";\n\nexport const BeadTypesIcons = {\n  [BeadTypes.BasicEllipse]: \"circle\",\n  [BeadTypes.BasicRectangle]: \"rectangle-wide\",\n};\n\nexport const FieldBeadTypePicker = ({ value, onChange }) => {\n  return (\n    <DisplayAvailableBeadTypes\n      types={BeadTypesIcons}\n      selectedType={value}\n      onClick={onChange}\n    />\n  );\n};\n\nconst DisplayAvailableBeadTypes = ({ types, selectedType, onClick }) => {\n  // console.log(\"jak jest?\", types);\n  return (\n    <div className=\"fieldset\" style={{}}>\n      <div className=\"label\"></div>\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          justifyContent: \"flex-start\",\n          alignItems: \"center\",\n          boxSizing: \"border-box\",\n          paddingLeft: \"10px\",\n          paddingRight: \"20px\",\n          width: \"100%\",\n        }}\n      >\n        {Object.keys(types).map((type, index) => {\n          return (\n            <DisplayBeadType\n              icon={types[type]}\n              type={type}\n              key={index}\n              isSelected={selectedType === type}\n              onClick={onClick}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport const DisplayBeadType = ({ icon, type, isSelected, onClick }) => {\n  return (\n    <div style={{ border: \"5px solid transparent\" }}>\n      <div\n        onClick={onClick ? () => onClick(type) : undefined}\n        style={{\n          width: 25,\n          height: 25,\n          background: \"#eee\",\n          marginBottom: 0,\n          marginRight: 0,\n          border: isSelected ? \"2px solid #000\" : \"2px solid #000\",\n          boxShadow: isSelected\n            ? \"2px 2px 2px rgba(0,0,0,1)\"\n            : \"2px 2px 2px rgba(0,0,0,0.1)\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n        }}\n      >\n        {icon === \"circle\" ? <FontAwesomeIcon icon={faCircle} /> : null}\n        {icon === \"rectangle-wide\" ? <FontAwesomeIcon icon={faExpand} /> : null}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faShapes } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport {\n  FieldBeadTypePicker,\n  BeadTypesIcons,\n  DisplayBeadType,\n} from \"./FieldBeadTypePicker\";\n\nexport const FieldsetBeadType = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={\n        <DisplayBeadType\n          icon={value ? BeadTypesIcons[value] : undefined}\n          type={value}\n          isSelected={false}\n          onClick={undefined}\n        />\n      }\n      label={\"Type\"}\n      icon={<FontAwesomeIcon icon={faShapes} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldBeadTypePicker value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport \"rc-slider/assets/index.css\";\nimport Slider, { createSliderWithTooltip } from \"rc-slider\";\n\nexport const SliderWithTooltip = createSliderWithTooltip(Slider);\n\nexport const FieldSliderWithLabel = ({ value, onChange, label, icon }) => {\n  return (\n    <div\n      className={\"fieldset\"}\n      style={{\n        paddingTop: \"10px\",\n        paddingBottom: \"10px\",\n        paddingLeft: \"10px\",\n        paddingRight: \"10px\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        justifyContent: \"space-between\",\n        background: \"#fff\",\n        borderBottom: 0,\n      }}\n    >\n      <div className=\"label\" style={{ padding: 0, width: \"105px\" }}>\n        {icon ? (\n          <div\n            style={{\n              width: \"30px\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              height: \"30px\",\n              marginRight: \"10px\",\n            }}\n          >\n            {icon}\n          </div>\n        ) : null}\n        {label ? <div>{label}</div> : null}\n      </div>\n\n      <div\n        style={{\n          boxSizing: \"border-box\",\n          flexGrow: 1,\n          paddingRight: \"10px\",\n          paddingBottom: \"10px\",\n        }}\n      >\n        <SliderWithTooltip\n          max={100}\n          min={1}\n          step={1}\n          value={value}\n          onChange={value => onChange(value)}\n          defaultValue={10}\n          marks={{\n            0: \"0\",\n            50: \"50\",\n            100: \"100\",\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport const FieldCheckbox = ({ label, value, onChange, isDisabled }) => {\n  return (\n    <div className={\"fieldset\"}>\n      <div className=\"label\">{label}</div>\n      <input\n        type=\"checkbox\"\n        disabled={isDisabled}\n        value={value === true ? 1 : 0}\n        checked={value === true}\n        onChange={event => onChange(event.target.value === \"0\")}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\n// import { FieldsetHeight } from \"./FieldsetHeight\";\n// import { FieldsetWidth } from \"./FieldsetWidth\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faExpandArrowsAlt,\n  faArrowsAltV,\n  faArrowsAltH,\n  faLink,\n  faUnlink,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../../colors\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { FieldSliderWithLabel } from \"./FieldSliderWithLabel\";\nimport { FieldCheckbox } from \"./FieldCheckbox\";\n\nexport const FieldsetWidthAndHeight = ({\n  height,\n  width,\n  keepAspectRatio,\n  onChange_beadHeight,\n  onChange_beadWidth,\n  onChange_keepAspectRatio,\n}) => {\n  const format = value =>\n    value.toLocaleString(undefined, {\n      maximumFractionDigits: 2,\n      style: \"decimal\",\n    });\n  const value = `${format(width)} x ${format(height)}`;\n  return (\n    <div>\n      <ToolbarFieldSet\n        selected={value}\n        label={\"Size\"}\n        icon={\n          <FontAwesomeIcon\n            icon={faExpandArrowsAlt}\n            color={uiButton}\n            size={\"lg\"}\n          />\n        }\n      >\n        <div>\n          <div style={{ width: \"100%\", background: \"#fff\" }}>\n            <FieldCheckbox\n              label={\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexWrap: \"nowrap\",\n                    justifyContent: \"space\",\n                  }}\n                >\n                  <div\n                    style={{\n                      width: \"30px\",\n                      display: \"flex\",\n                      justifyContent: \"center\",\n                      alignItems: \"center\",\n                      height: \"30px\",\n                      marginRight: \"10px\",\n                      background: \"#fff\",\n                    }}\n                  >\n                    <FontAwesomeIcon\n                      icon={keepAspectRatio === true ? faLink : faUnlink}\n                      color={uiButton}\n                      size={\"lg\"}\n                    />\n                  </div>\n                  <div>Keep aspect ratio</div>\n                </div>\n              }\n              value={keepAspectRatio}\n              onChange={onChange_keepAspectRatio}\n              isDisabled={false}\n            />\n          </div>\n\n          <FieldSliderWithLabel\n            label={\"Width\"}\n            icon={\n              <FontAwesomeIcon\n                icon={faArrowsAltH}\n                color={uiButton}\n                size={\"lg\"}\n              />\n            }\n            value={width}\n            onChange={onChange_beadWidth}\n          />\n\n          <FieldSliderWithLabel\n            label={\"Height\"}\n            icon={\n              <FontAwesomeIcon\n                icon={faArrowsAltV}\n                color={uiButton}\n                size={\"lg\"}\n              />\n            }\n            value={height}\n            onChange={onChange_beadHeight}\n          />\n        </div>\n      </ToolbarFieldSet>\n    </div>\n  );\n};\n","import React from \"react\";\nimport \"rc-slider/assets/index.css\";\nimport Slider, { createSliderWithTooltip } from \"rc-slider\";\n\nexport const SliderWithTooltip = createSliderWithTooltip(Slider);\n\nexport const FieldSlider = ({ value, onChange, ...props }) => {\n  return (\n    <div\n      style={{\n        background: \"#fff\",\n        width: \"100%\",\n        paddingTop: \"20px\",\n        paddingBottom: \"30px\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n      }}\n    >\n      <SliderWithTooltip\n        max={100}\n        min={1}\n        step={1}\n        value={value}\n        onChange={value => onChange(value)}\n        defaultValue={10}\n        marks={{\n          0: \"0\",\n          50: \"50\",\n          100: \"100\",\n        }}\n        {...props}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSyncAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport { FieldSlider } from \"./FieldSlider\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport NumberFormat from \"react-number-format\";\n\nexport const FieldsetBeadRotate = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={`${value}deg`}\n      label={\"Rotate\"}\n      icon={<FontAwesomeIcon icon={faSyncAlt} color={uiButton} size={\"lg\"} />}\n    >\n      <React.Fragment>\n        <FieldSlider\n          value={value}\n          onChange={value => {\n            // console.log(\"FieldSlider\", value);\n            onChange(value);\n          }}\n          max={180}\n          min={-180}\n          defaultValue={0}\n          marks={{\n            \"-180\": \"-180\",\n            \"0\": \"0\",\n            \"180\": \"180\",\n          }}\n        />\n        <NumberFormat\n          suffix={\"deg\"}\n          allowNegative={true}\n          allowEmptyFormatting={true}\n          value={value}\n          onValueChange={event => {\n            onChange(event.floatValue);\n          }}\n          placeholder=\" deg\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"1em\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"3px 10px\",\n            marginBottom: \"15px\",\n            marginTop: \"5px\",\n          }}\n        />\n      </React.Fragment>\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { FieldBeadPreview } from \"../ui/FieldBeadPreview\";\nimport { Actions } from \"../../../immerReducers/store\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetBeadType } from \"../ui/FieldsetBeadType\";\n// import { FieldsetBeadSpacing } from \"../ui/FieldsetBeadSpacing\";\n// import { FieldsetBeadCount } from \"../ui/FieldsetBeadCount\";\nimport { FieldsetWidthAndHeight } from \"../ui/FieldsetWidthAndHeight\";\n// import { FieldDeleteAndCopy } from \"../ui/FieldDeleteAndCopy\";\nimport { FieldsetBeadRotate } from \"../ui/FieldsetBeadRotate\";\n\nexport const ToolbarEditBeads = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <ContentWrapper />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst ContentWrapper = () => {\n  const showToolbar = useSelector((state: Editor) => {\n    return state.ui.selectedBeadsIdsCount >= 1;\n  });\n  if (showToolbar) {\n    return <Content />;\n  }\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BeadPreview />\n      <BeadSize />\n      <BeadColor />\n      <BeadType />\n      <BeadsRotate />\n    </React.Fragment>\n  );\n};\n\nconst BeadsRotate = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsRotate = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_rotate(newValue));\n  };\n\n  return (\n    <FieldsetBeadRotate\n      value={selected.rotate}\n      onChange={onChange_beadsRotate}\n    />\n  );\n};\n\nconst BeadSize = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadWidth = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_width(value));\n  };\n  const onChange_beadHeight = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_height(value));\n  };\n  const onChange_keepAspectRatio = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_keepAspectRatio(value));\n  };\n  const width = selected.width ? selected.width : 10;\n  const height = selected.height ? selected.height : 10;\n  const keepAspectRatio = selected.keepAspectRatio\n    ? selected.keepAspectRatio\n    : false;\n\n  return (\n    <div>\n      <FieldsetWidthAndHeight\n        height={height}\n        width={width}\n        keepAspectRatio={keepAspectRatio}\n        onChange_beadHeight={onChange_beadHeight}\n        onChange_beadWidth={onChange_beadWidth}\n        onChange_keepAspectRatio={onChange_keepAspectRatio}\n      />\n    </div>\n  );\n};\n\nconst BeadType = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  if (!selected.type) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = type => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_type(type));\n  };\n\n  return <FieldsetBeadType onChange={onSelect} value={selected.type} />;\n};\n\nconst BeadColor = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  if (!selected.color) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = color => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_color(color));\n  };\n\n  return <FieldsetColor onChange={onSelect} value={selected.color} />;\n};\n\nconst BeadPreview = () => {\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  return <FieldBeadPreview bead={selected} />;\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { ToolbarField } from \"../ui/ToolbarField\";\n\nexport const ToolbarIdle = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  const linesLen = useSelector((state: Editor) => {\n    return Object.keys(state.appData.lines).length;\n  });\n\n  const beadsLen = useSelector((state: Editor) => {\n    return Object.keys(state.appData.beads).length;\n  });\n\n  return (\n    <div>\n      <ToolbarField\n        label={\"Beads\"}\n        onToggle={undefined}\n        value={beadsLen}\n        icon={undefined}\n      />\n\n      <ToolbarField\n        label={\"Lines\"}\n        onToggle={undefined}\n        value={linesLen}\n        icon={undefined}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faFileAlt, faCog, faImage } from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Actions } from \"../../immerReducers/store\";\nimport { Editor, EditorMenuMain } from \"../../editorObjects/Editor\";\n\nexport const TopbarMain = () => {\n  const dispatch = useDispatch();\n  const currentMenuMainOpen = useSelector((state: Editor) => {\n    return state.ui.currentMenuMainOpen;\n  });\n  const onClick_file = () => {\n    dispatch(Actions.Topbar.action_toggleMenuFile());\n  };\n  const onClick_grid = () => {\n    dispatch(Actions.Topbar.action_toggleMenuSettings());\n  };\n  const onClick_background = () => {\n    dispatch(Actions.Topbar.action_toggleMenuBackground());\n  };\n  return (\n    <div\n      className=\"field has-addons\"\n      style={{ margin: 0, border: \"1px solid #e0e0e0\", paddingBottom: \"0px\" }}\n    >\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.File ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_file}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faFileAlt} color={uiButton} />\n          </span>\n          <span>File</span>\n        </div>\n      </div>\n\n      {/* <div className=\"control\">\n        <div className={`button`} onClick={onClick_selection}>\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faMarker} />\n          </span>\n          <span>Canvas</span>\n        </div>\n      </div> */}\n\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.Grid ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_grid}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faCog} color={uiButton} />\n          </span>\n          <span>Grid</span>\n        </div>\n      </div>\n\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.Background ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_background}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faImage} color={uiButton} />\n          </span>\n          <span>Background</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes, faSave, faDownload } from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Editor } from \"../../editorObjects/Editor\";\nimport { Actions } from \"../../immerReducers/store\";\n\nexport const EditorChangeState = () => {\n  const dispatch = useDispatch();\n  const isSaved = useSelector((state: Editor) => {\n    return state.ui.saveInfo.saved;\n  });\n  const haveUnsavedChanges = useSelector((state: Editor) => {\n    return state.ui.saveInfo.haveUnsavedChanges;\n  });\n\n  const onClearCanvas = () => {\n    dispatch(Actions.Persist.action_onClearCanvas());\n  };\n\n  const readSavedCanvas = () => {\n    dispatch(Actions.Persist.action_readSavedCanvas());\n  };\n\n  const onSaveCanvas = () => {\n    dispatch(Actions.Persist.action_onSaveCanvas());\n  };\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n      <div\n        className=\"field has-addons\"\n        style={{ width: \"auto\", flexWrap: \"nowrap\", marginBottom: \"0\" }}\n      >\n        <div className=\"control\">\n          <div className={` button is-light `} onClick={onClearCanvas}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faTimes} color={uiButton} />\n            </span>\n            <span>New project</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div\n            className={` button is-light ${\n              isSaved === true ? \"is-success\" : \"\"\n            }`}\n            onClick={onSaveCanvas}\n          >\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faSave} color={uiButton} />\n            </span>\n            <span>Save</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={`button is-light `} onClick={readSavedCanvas}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faDownload} color={uiButton} />\n            </span>\n            <span>Load local</span>\n          </div>\n        </div>\n      </div>\n      <div\n        style={{\n          fontFamily: \"Open Sans, sans-serif\",\n          fontSize: \"13px\",\n          alignSelf: \"center\"\n        }}\n      >\n        {haveUnsavedChanges === true ? (\n          <div>You have unsaved changes</div>\n        ) : (\n          <div>No changes to save</div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  Editor,\n  EditorMenuMain,\n  EditorGridType\n} from \"../../editorObjects/Editor\";\nimport { EditorChangeState } from \"../Toolbar/EditorChangeState\";\nimport { FieldCheckbox } from \"../Toolbar/ui/FieldCheckbox\";\nimport NumberFormat from \"react-number-format\";\nimport { Actions } from \"../../immerReducers/store\";\nimport { SliderWithTooltip } from \"../Toolbar/ui/FieldSlider\";\n\nexport const TopbarSecoundary = () => {\n  const currentMenuMainOpen = useSelector((state: Editor) => {\n    return state.ui.currentMenuMainOpen;\n  });\n  if (currentMenuMainOpen === EditorMenuMain.File) {\n    return <SubMenuFile />;\n  }\n  if (currentMenuMainOpen === EditorMenuMain.Grid) {\n    return <SubMenuGrid />;\n  }\n  if (currentMenuMainOpen === EditorMenuMain.Background) {\n    return <SubMenuBackground />;\n  }\n  return <React.Fragment />;\n};\n\nconst SubMenuFile = () => {\n  // const dispatch = useDispatch();\n  return (\n    <div>\n      <EditorChangeState />\n    </div>\n  );\n};\n\nconst SubMenuBackground = () => {\n  const dispatch = useDispatch();\n  const image = useSelector((state: Editor) => {\n    return state.ui.background.image;\n  });\n\n  const { position, scale, opacity } = image;\n  const onChange_clear = () => {\n    dispatch(Actions.Topbar.action_background_image_clear());\n  };\n  const onChange_upload = event => {\n    const selectedFiles: FileList = event.target.files;\n    const files = Array.from(selectedFiles);\n    if (files.length === 0) {\n      console.error(\"no files selected\");\n      return;\n    }\n    let file = files[0];\n    const types = [\"image/png\", \"image/jpeg\", \"image/gif\"];\n    if (types.every(type => file.type !== type)) {\n      console.error(`'${file.type}' is not a supported format`);\n      return;\n    }\n    if (file.size > 1 * 1024 * 1024) {\n      console.error(`'${file.name}' is too large, please pick a smaller file`);\n      return;\n    }\n    let reader = new FileReader();\n    reader.onloadend = () => {\n      dispatch(Actions.Topbar.action_background_image_upload(reader.result));\n    };\n    reader.readAsDataURL(file);\n    event.preventDefault();\n  };\n  const onChange_pointX = value => {\n    dispatch(Actions.Topbar.action_background_image_pointX(value));\n  };\n  const onChange_pointY = value => {\n    dispatch(Actions.Topbar.action_background_image_pointY(value));\n  };\n  const onChange_scale = value => {\n    dispatch(Actions.Topbar.action_background_image_scale(value));\n  };\n  const onChange_opacity = value => {\n    dispatch(Actions.Topbar.action_background_image_opacity(value));\n  };\n  return (\n    <div\n      style={{ flexWrap: \"nowrap\", display: \"flex\", alignItems: \"flex-start\" }}\n    >\n      <div style={{ flexWrap: \"nowrap\", display: \"flex\", marginTop: \"4px\" }}>\n        <div className=\"control\">\n          <div className={` button is-light `} onClick={onChange_clear}>\n            <span>Clear</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={` button is-light `} style={{ position: \"relative\" }}>\n            <input\n              type=\"file\"\n              onChange={onChange_upload}\n              style={{\n                position: \"absolute\",\n                top: 0,\n                left: 0,\n                width: \"100%\",\n                height: \"100%\",\n                opacity: 0,\n                zIndex: 2\n              }}\n            />\n            <span>Upload</span>\n          </div>\n        </div>\n      </div>\n\n      <div\n        style={{\n          display: \"flex\",\n          marginLeft: \"10px\",\n          marginRight: \"10px\",\n          flexWrap: \"nowrap\",\n          alignItems: \"flex-start\"\n        }}\n      >\n        <div\n          className={\"fieldset\"}\n          style={{\n            width: \"100px\",\n            whiteSpace: \"nowrap\",\n            flexWrap: \"nowrap\",\n            display: \"flex\",\n            alignItems: \"flex-start\"\n          }}\n        >\n          <div\n            className=\"label\"\n            style={{ whiteSpace: \"nowrap\" }}\n          >{`Scale: ${scale}`}</div>\n        </div>\n        <div style={{ width: \"100px\", marginLeft: \"20px\", marginTop: \"13px\" }}>\n          <SliderWithTooltip\n            max={16}\n            min={0.2}\n            step={0.1}\n            value={scale}\n            onChange={value => onChange_scale(value)}\n            defaultValue={1}\n            // marks={{\n            //   0.2: \"0.2\",\n            //   4: \"4\",\n            //   8: \"8\",\n            // }}\n          />\n        </div>\n      </div>\n\n      <BackgroundPosition\n        pointX={position.x}\n        onChange_pointX={onChange_pointX}\n        pointY={position.y}\n        onChange_pointY={onChange_pointY}\n      />\n\n      <div\n        style={{\n          display: \"flex\",\n          marginLeft: \"10px\",\n          marginRight: \"10px\",\n          flexWrap: \"nowrap\",\n          alignItems: \"flex-start\"\n        }}\n      >\n        <div className={\"fieldset\"} style={{ width: \"85px\" }}>\n          <div\n            className=\"label\"\n            style={{ flexWrap: \"nowrap\", whiteSpace: \"nowrap\" }}\n          >\n            Opacity: {opacity}\n          </div>\n        </div>\n        <div style={{ width: \"80px\", marginLeft: \"10px\", marginTop: \"13px\" }}>\n          <SliderWithTooltip\n            max={1}\n            min={0}\n            step={0.1}\n            value={opacity}\n            onChange={value => onChange_opacity(value)}\n            defaultValue={1}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst BackgroundPosition = ({\n  pointX,\n  onChange_pointX,\n  pointY,\n  onChange_pointY\n}) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\"\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Image position: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={999}\n          min={-999}\n          maxLength={3}\n          value={pointX}\n          onValueChange={event => {\n            onChange_pointX(event.floatValue);\n          }}\n          placeholder=\"x\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\"\n          }}\n        />\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={999}\n          min={-999}\n          maxLength={3}\n          value={pointY}\n          onValueChange={event => {\n            onChange_pointY(event.floatValue);\n          }}\n          placeholder=\"y\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\"\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nconst SubMenuGrid = () => {\n  const dispatch = useDispatch();\n  const grid = useSelector((state: Editor) => {\n    return state.ui.grid;\n  });\n\n  const { height, width, hexSize, type, snapEnabled, isVisible } = grid;\n  const onChange_isVisible = () => {\n    dispatch(Actions.Topbar.action_toggleGridIsVisible());\n  };\n  const onChange_snapEnabled = () => {\n    dispatch(Actions.Topbar.action_toggleGridSnapEnabled());\n  };\n  const onChange_gridItemW = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridWidth(newValue));\n  };\n  const onChange_gridItemH = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridHeight(newValue));\n  };\n  const onClick_selectTypeHex = () => {\n    dispatch(Actions.Topbar.action_setGridType(EditorGridType.Hex));\n  };\n  const onClick_selectTypeBox = () => {\n    dispatch(Actions.Topbar.action_setGridType(EditorGridType.Box));\n  };\n  const onChange_hexSize = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridHexSize(newValue));\n  };\n\n  return (\n    <div style={{ display: \"flex\", flexWrap: \"nowrap\", alignItems: \"center\" }}>\n      <GridOptions\n        isVisible={isVisible}\n        onChange_isVisible={onChange_isVisible}\n        snapEnabled={snapEnabled}\n        onChange_snapEnabled={onChange_snapEnabled}\n        type={type}\n        onClick_selectTypeHex={onClick_selectTypeHex}\n        onClick_selectTypeBox={onClick_selectTypeBox}\n      />\n\n      {type === EditorGridType.Box ? (\n        <GridBoxSettings\n          gridItemW={width}\n          onChange_gridItemW={onChange_gridItemW}\n          gridItemH={height}\n          onChange_gridItemH={onChange_gridItemH}\n        />\n      ) : null}\n\n      {type === EditorGridType.Hex ? (\n        <GridHexSettings\n          hexSize={hexSize}\n          onChange_hexSize={onChange_hexSize}\n        />\n      ) : null}\n    </div>\n  );\n};\n\nconst GridOptions = ({\n  isVisible,\n  onChange_isVisible,\n  snapEnabled,\n  onChange_snapEnabled,\n  type,\n  onClick_selectTypeHex,\n  onClick_selectTypeBox\n}) => {\n  return (\n    <React.Fragment>\n      <div\n        style={{\n          marginRight: \"15px\"\n        }}\n      >\n        <FieldCheckbox\n          label={\"Show grid\"}\n          value={isVisible}\n          onChange={onChange_isVisible}\n          isDisabled={false}\n        />\n      </div>\n\n      <div\n        style={{\n          marginRight: \"15px\"\n        }}\n      >\n        <FieldCheckbox\n          label={\"Snap to grid\"}\n          value={snapEnabled}\n          onChange={onChange_snapEnabled}\n          isDisabled={false}\n        />\n      </div>\n\n      <div\n        style={{\n          marginRight: \"15px\"\n        }}\n      >\n        <div className={\"fieldset\"}>\n          <div className=\"label\">Grid type: </div>\n          <div className=\"control\">\n            <div\n              className={` button is-light ${\n                type === EditorGridType.Hex ? \"is-dark\" : \"\"\n              } `}\n              onClick={onClick_selectTypeHex}\n            >\n              <span>Hexagon</span>\n            </div>\n          </div>\n\n          <div className=\"control\">\n            <div\n              className={` button is-light ${\n                type === EditorGridType.Box ? \"is-dark\" : \"\"\n              }`}\n              onClick={onClick_selectTypeBox}\n            >\n              <span>Rectangle</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\nconst GridBoxSettings = ({\n  gridItemW,\n  onChange_gridItemW,\n  gridItemH,\n  onChange_gridItemH\n}) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\"\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Grid size: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={1}\n          maxLength={2}\n          value={gridItemW}\n          onValueChange={event => {\n            onChange_gridItemW(event.floatValue);\n          }}\n          placeholder=\"width\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\"\n          }}\n        />\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={1}\n          maxLength={2}\n          value={gridItemH}\n          onValueChange={event => {\n            onChange_gridItemH(event.floatValue);\n          }}\n          placeholder=\"height\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\"\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nconst GridHexSettings = ({ hexSize, onChange_hexSize }) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\"\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Hex size: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={5}\n          maxLength={2}\n          value={hexSize}\n          onValueChange={event => {\n            onChange_hexSize(event.floatValue);\n          }}\n          placeholder=\"width\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\"\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowsAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport { FieldSlider } from \"./FieldSlider\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\n\nexport const FieldsetSize = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={value}\n      label={\"Size\"}\n      icon={<FontAwesomeIcon icon={faArrowsAlt} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldSlider value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { Actions } from \"../../../immerReducers/store\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetSize } from \"../ui/FieldsetSize\";\n\nexport const ToolbarPaint = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BrushSize />\n      <BrushColor />\n    </React.Fragment>\n  );\n};\n\nconst BrushSize = () => {\n  const dispatch = useDispatch();\n  const size = useSelector((state: Editor) => {\n    return state.ui.brush.size;\n  });\n\n  if (!size) {\n    return <React.Fragment />;\n  }\n\n  const onChange = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_updateBrushSize(newValue));\n  };\n\n  return <FieldsetSize value={size} onChange={onChange} />;\n};\n\nconst BrushColor = () => {\n  const dispatch = useDispatch();\n  const color = useSelector((state: Editor) => {\n    return state.ui.brush.color;\n  });\n\n  if (!color) {\n    return <React.Fragment />;\n  }\n\n  const onChange = color => {\n    dispatch(Actions.Toolbar.action_updateBrushColor(color));\n  };\n\n  return <FieldsetColor onChange={onChange} value={color} />;\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { FieldBeadPreview } from \"../ui/FieldBeadPreview\";\nimport { Actions } from \"../../../immerReducers/store\";\n// import { FieldsetWidth } from \"../ui/FieldsetWidth\";\n// import { FieldsetHeight } from \"../ui/FieldsetHeight\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetBeadType } from \"../ui/FieldsetBeadType\";\nimport { FieldsetWidthAndHeight } from \"../ui/FieldsetWidthAndHeight\";\nimport { FieldsetBeadRotate } from \"../ui/FieldsetBeadRotate\";\nimport { buildBead } from \"../../../editorObjects/Bead\";\n\nexport const ToolbarAddBeads = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BeadPreview />\n      <BeadSize />\n      <BeadColor />\n      <BeadType />\n      <BeadsRotate />\n    </React.Fragment>\n  );\n};\n\nconst BeadsRotate = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onChange_beadsRotate = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"rotate\", newValue));\n  };\n\n  return (\n    <FieldsetBeadRotate\n      value={beadsTemplate.rotate}\n      onChange={onChange_beadsRotate}\n    />\n  );\n};\n\nconst BeadSize = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onChange_beadWidth = value => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"width\", value));\n  };\n\n  const onChange_beadHeight = value => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"height\", value));\n  };\n\n  const onChange_keepAspectRatio = value => {\n    dispatch(\n      Actions.Toolbar.action_updateBeadsTemplate(\"keepAspectRatio\", value)\n    );\n  };\n\n  const width = beadsTemplate.width ? beadsTemplate.width : 10;\n  const height = beadsTemplate.height ? beadsTemplate.height : 10;\n  const keepAspectRatio = beadsTemplate.keepAspectRatio\n    ? beadsTemplate.keepAspectRatio\n    : false;\n\n  return (\n    <div>\n      <FieldsetWidthAndHeight\n        height={height}\n        width={width}\n        keepAspectRatio={keepAspectRatio}\n        onChange_beadHeight={onChange_beadHeight}\n        onChange_beadWidth={onChange_beadWidth}\n        onChange_keepAspectRatio={onChange_keepAspectRatio}\n      />\n    </div>\n  );\n};\n\nconst BeadType = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onSelect = type => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"type\", type));\n  };\n\n  return <FieldsetBeadType onChange={onSelect} value={beadsTemplate.type} />;\n};\n\nconst BeadColor = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onSelect = color => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"color\", color));\n  };\n\n  return <FieldsetColor onChange={onSelect} value={beadsTemplate.color} />;\n};\n\nconst BeadPreview = () => {\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const bead = buildBead(beadsTemplate);\n\n  return <FieldBeadPreview bead={bead} />;\n};\n","import React, { useRef, useState } from \"react\";\nimport { Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { EditorModes } from \"./Toolbar/EditorModes\";\n// import { AddLineMode } from \"./Line/AddLineMode\";\n// import { EditorChangeState } from \"./Toolbar/EditorChangeState\";\nimport { useSelector, useStore, useDispatch } from \"react-redux\";\nimport { MouseSelectionBeads } from \"./Bead/MouseSelectionBeads\";\n// import { MouseSelectionLines } from \"./Line/MouseSelectionLines\";\nimport { DisplayBeads } from \"./Bead/DisplayBeads\";\n// import { DisplayLines } from \"./Line/DisplayLines\";\nimport { GroupSelectionPlaceholder } from \"./operations/GroupSelectionPlaceholder\";\n// import { PickBeadColor } from \"./Toolbar/PickColor\";\n// import { ChangeLinePosition } from \"./Toolbar/ChangeLinePosition\";\n// import { PickBeadType } from \"./Toolbar/PickBeadType\";\n// import { ChangeBeadRotate } from \"./Toolbar/ChangeBeadRotate\";\n// import { LineInspector } from \"./Toolbar/LineInspector\";\n// import { Actions } from \"../store\";\n// import { EditToolbar } from \"./Toolbar/EditToolbar\";\n// import { ToolbarEditLines } from \"./Toolbar/Modes/ToolbarEditLines\";\nimport { ToolbarEditBeads } from \"./Toolbar/Modes/ToolbarEditBeads\";\n// import { ToolbarAddLine } from \"./Toolbar/Modes/ToolbarAddLine\";\nimport { ToolbarIdle } from \"./Toolbar/Modes/ToolbarIdle\";\nimport { DisplayGridLines } from \"./operations/DisplayGridLines\";\nimport { TopbarMain } from \"./Topbar/TopbarMain\";\nimport { TopbarSecoundary } from \"./Topbar/TopbarSecoundary\";\nimport { Brush } from \"./operations/Brush\";\nimport { ToolbarPaint } from \"./Toolbar/Modes/ToolbarPaint\";\nimport { BackgroundImage } from \"./operations/BackgroundImage\";\nimport { AddBeadsMode } from \"./Bead/AddBeadsMode\";\nimport { ToolbarAddBeads } from \"./Toolbar/Modes/ToolbarAddBeads\";\nimport { PanZoom } from \"react-easy-panzoom\";\nimport { Actions } from \"../immerReducers/store\";\nimport { ReactReduxContext } from \"react-redux\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport styled from \"styled-components\";\n\nexport const EditorScene = () => {\n  const dispatch = useDispatch();\n  const editorMode = useSelector((state: Editor) => {\n    return state.mode;\n  });\n  const store = useStore();\n  const state = store.getState();\n  console.log(\"EditorRerender: \", state);\n\n  // @TODO: Dodac funkcje ktora zostaje uruchomiona po rozpoczeciu aplikajci\n  // const dispatch = useDispatch();\n  // const [firstPass, setFirstPass] = useState(false);\n  // useEffect(() => {\n  //   if (process.env.NODE_ENV && process.env.NODE_ENV === \"development\") {\n  //     if (firstPass === false) {\n  //       dispatch(Actions.Persist.action_readSavedCanvas());\n  //       // dispatch(\n  //       //   Actions.ChangeEditorMode.action_onChangeEditorMode(\n  //       //     EditorMode.EditLines\n  //       //   )\n  //       // );\n  //       // dispatch(Actions.Draggable.action_onClickLastestLine());\n  //       setFirstPass(true);\n  //     }\n  //   }\n  // });\n\n  const panZoomRef = useRef<any>(null);\n\n  if (!state) {\n    return <div>Error in app</div>;\n  }\n\n  // const preventPan = (event, x, y) => {\n  //   console.log('??', event, x, y)\n  //   return true;\n  // }\n\n  const onStateChange = (event) => {\n    if (panZoomRef && panZoomRef.current !== null) {\n      const boundingClientRect = panZoomRef.current.getContainerBoundingRect();\n      dispatch(\n        Actions.Draggable.action_updateSceneZoom({\n          ...event,\n          top: boundingClientRect.top,\n          left: boundingClientRect.left,\n        })\n      );\n    } else {\n      dispatch(\n        Actions.Draggable.action_updateSceneZoom({\n          ...event,\n          top: 0,\n          left: 0,\n        })\n      );\n    }\n  };\n  const onResizeSceneWrapper = (width, height) => {\n    dispatch(\n      Actions.Draggable.action_updateSceneWrapperSize({\n        width,\n        height,\n      })\n    );\n  };\n\n  // const updatePosition = (event) => {\n  //   dispatch(Actions.Draggable.action_updatePanZoomWrapperRect(event));\n  // }\n\n  return (\n    <div className=\"scene\">\n      <div className=\"topbar-wrapper\">\n        <TopbarMain />\n        <TopbarSecoundary />\n      </div>\n\n      <div className=\"actions-wrapper\">\n        <EditorModes editorMode={editorMode} />\n      </div>\n\n      <div className={\"scene-wrapper\"}>\n        <ReactResizeDetector\n          handleWidth\n          handleHeight\n          skipOnMount={false}\n          onResize={onResizeSceneWrapper}\n        />\n        {/* <PanZoom\n          style={{ width: \"100%\", height: \"100%\", position: \"absolute\" }}\n          disabled={editorMode !== EditorMode.Idle}\n          ref={panZoomRef}\n          onStateChange={onStateChange}\n          keyMapping={{\n            \"87\": { x: 0, y: -1, z: 0 },\n            \"83\": { x: 0, y: 1, z: 0 },\n            \"65\": { x: -1, y: 0, z: 0 },\n            \"68\": { x: 1, y: 0, z: 0 }\n          }}\n        >\n          <div>{`This content can be panned and zoomed.`}</div>\n          <BackgroundImage />\n\n          <AddBeadsMode isActive={editorMode === EditorMode.AddBeads} />\n\n          <MouseSelectionBeads\n            isVisible={editorMode === EditorMode.EditBeads}\n          />\n\n          <DisplayBeads mode={editorMode} />\n\n         \n\n          <DisplayGridLines isVisible={editorMode === EditorMode.EditLines} />\n\n          <GroupSelectionPlaceholder mode={editorMode} />\n\n          <Brush isVisible={editorMode === EditorMode.PaintBeads} />\n        </PanZoom> */}\n        {/* <DisplayLines mode={editorMode} /> */}\n        {/* <AddLineMode isActive={editorMode === EditorMode.AddLine} /> */}\n\n        {/* <MouseSelectionLines isVisible={editorMode === EditorMode.EditLines} /> */}\n      </div>\n\n      <div className={\"toolbar-wrapper\"}>\n        <ToolBarStyles>\n          {/* <ToolbarEditLines isVisible={editorMode === EditorMode.EditLines} /> */}\n          <ToolbarEditBeads isVisible={editorMode === EditorMode.EditBeads} />\n          {/* <ToolbarAddLine isVisible={editorMode === EditorMode.AddLine} /> */}\n          <ToolbarIdle isVisible={editorMode === EditorMode.Idle} />\n          <ToolbarPaint isVisible={editorMode === EditorMode.PaintBeads} />\n          <ToolbarAddBeads isVisible={editorMode === EditorMode.AddBeads} />\n\n          <Lights />\n          {/* <ChangeLinePosition mode={editorMode} />\n\n        <PickBeadType mode={editorMode} />\n        <ChangeBeadRotate mode={editorMode} />\n        <PickBeadColor mode={editorMode} />\n        <LineInspector mode={editorMode} />\n\n        <EditToolbar mode={editorMode} /> */}\n        </ToolBarStyles>\n      </div>\n    </div>\n  );\n};\n\nconst ToolBarStyles = styled.div`\n  .fieldset {\n    /* border-top: 1px solid #dfdfdf;\n  border-bottom: 1px solid #dfdfdf; */\n    padding-bottom: 5px;\n    padding-top: 5px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n  }\n\n  .fieldset .label {\n    font-family: \"Open Sans\", sans-serif;\n    font-size: 16px;\n    line-height: 30px;\n    font-weight: 300;\n    padding: 0;\n    margin: 0;\n    padding-left: 10px;\n    padding-right: 10px;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    align-items: center;\n  }\n\n  .fieldset .input {\n    border: none;\n    background: none;\n    border-bottom: 1px solid #dfdfdf;\n    color: #6e6e6e;\n    font-size: 14px;\n    line-height: 30px;\n    font-family: \"Open Sans\", sans-serif;\n    box-shadow: none;\n    max-width: 200px;\n    padding: 0;\n    margin: 0;\n  }\n\n  .fieldset .input[type=\"number\"] {\n    max-width: 50px;\n  }\n`;\n\n// class PanZoomWrapper extends React.Component<{ children, updatePosition }> {\n//   htmlDivInstance: HTMLDivElement | null = null;\n//   componentDidMount() {\n//     if (this.htmlDivInstance !== null) {\n//       const boundingClientRect = this.htmlDivInstance.getBoundingClientRect();\n//       this.props.updatePosition(boundingClientRect);\n//     }\n//   }\n//   render() {\n//     return (\n//       <div ref={refInstance => this.htmlDivInstance = refInstance}>\n//         {this.props.children}\n//       </div>\n//     )\n//   }\n// }\n\nconst Lights: React.FC<{}> = (props) => {\n  const dispatch = useDispatch();\n  const lights = useSelector((state: Editor) => {\n    return state.ui.lights;\n  });\n  return (\n    <LightsStyles>\n      <div className={\"toolbar-lights\"}>\n        {lights.map((l, index) => {\n          const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n            const newValue = Number(event.target.value) / 100;\n            console.log(\"co mam?\", newValue);\n            dispatch(\n              Actions.Toolbar.action_updateLight(index, \"intensity\", newValue)\n            );\n          };\n          return (\n            <div key={l.name} className={\"light\"}>\n              <div className={\"info\"}>{JSON.stringify(l)}</div>\n              <div className={\"fields\"}>\n                <fieldset>\n                  <label>intensity: </label>\n                  <input\n                    type=\"range\"\n                    name={`${l.name}_${l.intensity}`}\n                    value={(l.intensity ?? 0) * 100}\n                    onChange={onChange}\n                    min=\"1\"\n                    max=\"99\"\n                    step=\"1\"\n                  />\n                </fieldset>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </LightsStyles>\n  );\n};\nconst LightsStyles = styled.div`\n  .toolbar-lights {\n    background: #ddd;\n    width: 100%;\n    border: none;\n    box-sizing: border-box;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n  }\n  .light {\n    border: 1px solid #000;\n    border-radius: 3px;\n    margin-bottom: 10px;\n    padding: 10px;\n  }\n  .light .info {\n    font-size: 11px;\n    line-height: 13px;\n    display: block;\n    margin-bottom: 5px;\n    width: 100%;\n    overflow: hidden;\n    word-break: break-all;\n    white-space: pre-line;\n  }\n  .light .fields {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  .light .fields fieldset {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    column-gap: 10px;\n  }\n`;\n","import { createStore } from \"redux\";\nimport { store } from \"./store\";\n\nexport const appStore = createStore(\n  store\n  // \"__REDUX_DEVTOOLS_EXTENSION__\" in window &&\n  //   (window as any).__REDUX_DEVTOOLS_EXTENSION__()\n);\n","import React from \"react\";\nimport \"bulma/css/bulma.css\";\nimport \"./App.css\";\nimport { EditorScene } from \"./components/Editor\";\nimport { Provider } from \"react-redux\";\nimport { appStore } from \"./immerReducers/appStore\";\nimport { buildBead } from \"./editorObjects/Bead\";\nimport { Actions } from \"./immerReducers/store\";\n\nconst App: React.FC = () => {\n  console.log(\"render App.tsx\");\n\n  React.useEffect(() => {\n    appStore.dispatch({\n      type: \"startAppEvent\",\n      payload: { state: appStore.getState() },\n    });\n\n    appStore.dispatch(Actions.Persist.action_readSavedCanvas());\n  }, []);\n\n  return (\n    <div className=\"App\">\n      <Provider store={appStore}>\n        <EditorScene />\n      </Provider>\n    </div>\n  );\n};\n\nexport default App;\n\n// \"homepage\": \"https://rpcal.github.io/coralinio-preview/build/\",\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n// import * as Sentry from '@sentry/browser';\nimport { renderThreejs } from './threejs/renderThreejs';\n// import { EventEmitter } from 'stream';\n\n// Sentry.init({dsn: \"https://94d8408ba8ab4a369c83de035643afa2@sentry.io/1807713\"});\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nrenderThreejs(document.getElementById('threejs'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}