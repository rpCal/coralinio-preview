{"version":3,"sources":["editorObjects/Editor.tsx","components/colors.ts","editorObjects/Point.ts","editorObjects/Bead.ts","editorObjects/Line.ts","immerReducers/BeadSnapperImmerReducer.tsx","immerReducers/DraggableOperationsImmerReducer.tsx","immerReducers/PersistImmerReducer.tsx","immerReducers/ChangeEditorModeImmerReducer.tsx","immerReducers/MainImmerReducer.tsx","immerReducers/MouseSelectionImmerReducer.tsx","immerReducers/ToolbarImmerReducer.tsx","immerReducers/TopbarImmerReducer.tsx","immerReducers/PaintImmerReducer.tsx","store.tsx","components/Toolbar/EditorModes.tsx","components/operations/MapValuesToCss.tsx","components/Line/StraightLine.tsx","components/Line/AddLineMode.tsx","components/operations/MouseSelection.tsx","components/Bead/MouseSelectionBeads.tsx","components/Line/MouseSelectionLines.tsx","components/Bead/DisplayBead.tsx","components/Bead/DisplayBeads.tsx","components/Line/SelectionStraightLine.tsx","components/Line/SelectedStraightLine.tsx","components/Line/DisplayLine.tsx","components/Line/DraggableLines.tsx","components/Line/DisplaySimpleLine.tsx","components/Line/DisplayLines.tsx","components/operations/DisplayGroupLines.tsx","components/operations/getGroupPositionFromLines.ts","components/operations/DisplayLinesGroup.tsx","components/operations/DisplayGroupBeads.tsx","components/operations/getGroupPositionFromBeads.ts","components/operations/DisplayBeadsGroup.tsx","components/operations/GroupSelectionPlaceholder.tsx","components/Toolbar/ui/FieldBeadPreview.tsx","components/Toolbar/ui/ToolbarField.tsx","components/Toolbar/ui/ToolbarFieldSet.tsx","components/Toolbar/ui/FieldColorPicker.tsx","components/Toolbar/ui/FieldColor.tsx","components/Toolbar/ui/FieldsetColor.tsx","components/Toolbar/ui/FieldBeadTypePicker.tsx","components/Toolbar/ui/FieldsetBeadType.tsx","components/Toolbar/ui/FieldSlider.tsx","components/Toolbar/ui/FieldCheckbox.tsx","components/Toolbar/ui/FieldsetBeadSpacing.tsx","components/Toolbar/ui/FieldsetBeadCount.tsx","components/Toolbar/ui/FieldSliderWithLabel.tsx","components/Toolbar/ui/FieldsetWidthAndHeight.tsx","components/Toolbar/ui/FieldDeleteAndCopy.tsx","components/Toolbar/ui/FieldsetBeadRotate.tsx","components/Toolbar/Modes/ToolbarEditLines.tsx","components/Toolbar/Modes/ToolbarEditBeads.tsx","components/Toolbar/Modes/ToolbarAddLine.tsx","components/Toolbar/Modes/ToolbarIdle.tsx","components/operations/DisplayGridLines.tsx","components/Topbar/TopbarMain.tsx","components/Toolbar/EditorChangeState.tsx","components/Topbar/TopbarSecoundary.tsx","components/operations/Brush.tsx","components/Toolbar/ui/FieldsetSize.tsx","components/Toolbar/Modes/ToolbarPaint.tsx","components/operations/BackgroundImage.tsx","components/Editor.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["BeadTypes","EditorMode","EditorMenuMain","EditorGridType","BrushType","uiButton","buildPoint","x","y","immerable","normalize","point","length","Math","sqrt","getLength","useLen","scale","scalar","add","getDistanceBetweenPoints","start","end","getRotate","atan2","contain","p1","p2","p","buildBead","props","defaults","id","generate","position","type","BasicEllipse","rotate","lineRotate","color","height","width","keepAspectRatio","merge","buildLine","__defaults","beadIds","settings","beadsCount","beadsAutoCount","beadsSpacing","beadsAutoSpacing","defaultBead","getPointFromStartLine","startX","startY","endX","endY","distance","BeadSnapperImmerReducer","lineId","currentLine","this","draftState","appData","lines","count","getLineBeadsCount","currentCount","remaining","addRemainingBeads","overflow","removeOverflowBeads","modifyBeadsPosition","modifyBeadsRotate","lineLen","beadsWidths","beadsWidth","forEach","beadId","beads","push","defaultBeadWidth","remainingSpace","floor","i","remainingCount","ui","lineSettings","undefined","bead","overflowCount","arrLen","lastItemBeadId","splice","currentDistance","newPosition","standardLineHeight","avaiableSpace","dynamicBeadsSpacing","lineRotateRadian","PI","ImmerReducer","DraggableOperationsImmerReducer","saveInfo","saved","haveUnsavedChanges","line","mode","EditLines","updateBeadsPositions","editorAppDataHasChanged","key","data","grid","snapEnabled","hexSize","Box","round","Hex","hSpace","hexHeight","vSpace","changeX","vLine","changeY","lineStart","lineEnd","deltaX","deltaY","newX","newY","Object","keys","selectedLinesIds","selectedLinesIdsCount","action_onClickLine","selectedBeadsIds","selectedBeadsIdsCount","PersistImmerReducer","console","log","window","readedData","localStorage","getItem","cached","JSON","parse","currBead","currLine","err","error","info","setItem","stringify","ChangeEditorModeImmerReducer","clearSelectedBeads","clearSelectedLines","newEditorMode","newValue","MainImmerReducer","MouseSelectionImmerReducer","mouseSelection","isDragStarted","isDragged","abs","min","max","p3","ToolbarImmerReducer","deg","value","firstLineId","newLinesIds","newLine","newBead","ratio","updateLineFromSelectedBeads","results","indexOf","brush","size","TopbarImmerReducer","currentMenuMainOpen","File","None","Grid","Background","isVisible","background","image","url","opacity","PaintImmerReducer","Color","mousePoint","centerPoint","defaultAppData","Idle","Actions","Main","createActionCreators","Draggable","Persist","ChangeEditorMode","MouseSelection","Toolbar","Topbar","Paint","store","composeReducers","createReducerFunction","EditorModes","editorMode","dispatch","useDispatch","onChangeEditorMode","action_onChangeEditorMode","className","label","icon","faArrowsAlt","onClick","isSelected","faEdit","EditBeads","faPlus","AddLine","faPaintBrush","StateButton","getTranslate3dCss","z","getRotateCss","StraightLine","style","transform","transformOrigin","AddLineMode","isActive","Fragment","AddLineModeContent","useState","startPoint","setStartPoint","endPoint","setEndPoint","isDragEnabled","setIsDragEnabled","lineRef","useRef","onMouseUp","event","current","rect","getBoundingClientRect","clientX","left","clientY","top","onAddLine","action_onAddLine","onMouseDown","onMouseMove","onMouseLeave","ref","sceneWrapperRef","useSelector","state","mouseSelectionIsDragStarted","zIndex","backgroundColor","border","MouseSelectionBeads","action_onEditBeadsMouseDown","action_onEditBeadsMouseMove","action_onEditBeadsMouseUp","MouseSelectionLines","action_onEditLinesMouseDown","action_onEditLinesMouseMove","action_onEditLinesMouseUp","DisplayBead","isSelectable","isOpacity","isZindex","translate3d","rotateCss","styles","borderRadius","action_onClickBead","DisplayBeads","fadeOut","onTop","values","map","SelectionStraightLine","cursor","SelectedStraightLine","snapToGrid","gridItemW","gridItemH","set_tempX","set_tempY","set_lineStart","set_lineEnd","onStart","_","onDrag","action_onLineDrag","onStop","disabled","DisplayLine","action_onStartPointDrag","action_onEndPointDrag","DraggableLines","backend","HTML5Backend","DisplaySimpleLine","DisplayLines","isEditable","DisplayGroupLines","location","w","h","getSelectedLines","MemoizedDisplayLinesGroup","React","memo","selectedLines","xMin","Number","MAX_SAFE_INTEGER","xMax","yMin","yMax","getGroupPositionFromLines","action_onGroupLineDrag","DisplayGroupBeads","getSelectedBeads","MemoizedDisplayBeadsGroup","selectedBeads","getGroupPositionFromBeads","GroupSelectionPlaceholder","FieldBeadPreview","displayBead","marginTop","marginBottom","display","justifyContent","alignItems","boxSizing","ToolbarField","onToggle","marginRight","flexDirection","paddingLeft","paddingRight","ToolbarFieldSet","selected","children","isPickerOpen","setIsPickerOpen","borderTop","cloneElement","FieldColorPicker","onChange","colors","material","paddingTop","paddingBottom","DisplayColorsGroup","flexWrap","group","toString","FieldColor","boxShadow","FieldsetColor","faPalette","BeadTypesIcons","BasicRectangle","FieldBeadTypePicker","types","selectedType","DisplayAvailableBeadTypes","index","DisplayBeadType","faCircle","faExpand","FieldsetBeadType","faShapes","SliderWithTooltip","createSliderWithTooltip","Slider","FieldSlider","step","defaultValue","marks","0","50","100","FieldCheckbox","isDisabled","checked","target","FieldsetBeadSpacing","onChange_beadsSpacing","onChange_beadsAutoSpacing","faDivide","FieldsetBeadCount","onChange_beadsCount","onChange_beadsAutoCount","faDiceSix","1","FieldSliderWithLabel","borderBottom","padding","flexGrow","FieldsetWidthAndHeight","onChange_beadHeight","onChange_beadWidth","onChange_keepAspectRatio","format","toLocaleString","maximumFractionDigits","faExpandArrowsAlt","faLink","faUnlink","faArrowsAltH","faArrowsAltV","FieldDeleteAndCopy","onDelete","onClone","onReset","faTrash","faClone","faDizzy","FieldsetBeadRotate","faSyncAlt","suffix","allowNegative","allowEmptyFormatting","onValueChange","floatValue","placeholder","textAlign","fontFamily","fontSize","fontWeight","lineHeight","ToolbarEditLines","ToolbarEditLinesWrapper","Content","BeadsRotate","isNaN","action_changeSelectedLines_defaultBead_rotate","BeadSize","action_changeSelectedLines_defaultBead_height","action_changeSelectedLines_defaultBead_width","action_changeSelectedLines_defaultBead_keepAspectRatio","BeadsCount","action_changeSelectedLines_settings_beadsAutoCount","action_changeSelectedLines_settings_beadsCount","BeadsSpacing","action_changeSelectedLines_settings_beadsAutoSpacing","action_changeSelectedLines_settings_beadsSpacing","BeadType","action_changeSelectedLines_defaultBead_type","BeadColor","action_changeSelectedLines_defaultBead_color","BeadPreview","DeleteAndClone","action_deleteSelectedLines","action_cloneSelectedLines","action_resetSelectedLines","ToolbarEditBeads","ContentWrapper","action_changeSelectedBeads_rotate","action_changeSelectedBeads_height","action_changeSelectedBeads_width","action_changeSelectedBeads_keepAspectRatio","action_changeSelectedBeads_type","action_changeSelectedBeads_color","ToolbarAddLine","action_changeDefaultLineBeadRotate","action_changeDefaultLineBeadHeight","action_changeDefaultLineBeadWidth","action_changeDefaultLineBeadKeepAspectRatio","action_changeDefaultLineBeadsAutoCount","action_changeDefaultLineBeadsCount","action_changeDefaultLineBeadsAutoSpacing","action_changeDefaultLineBeadsSpacing","action_changeDefaultLineBeadType","action_changeDefaultLineColor","ToolbarIdle","linesLen","beadsLen","DisplayGridLines","GridBox","svg","backgroundUrl","backgroundImage","backgroundRepeat","backgroundPosition","pointy_hex_corner","center","angle_deg","angle_rad","cos","sin","GridHex","movedPoint","moreMovedPoint","evenmoreMovedPoint","boxH","points","a","b","TopbarMain","margin","action_toggleMenuFile","faFileAlt","action_toggleMenuSettings","faCog","action_toggleMenuBackground","faImage","EditorChangeState","isSaved","action_onClearCanvas","faTimes","action_onSaveCanvas","faSave","action_readSavedCanvas","faDownload","alignSelf","TopbarSecoundary","SubMenuFile","SubMenuBackground","action_background_image_clear","selectedFiles","files","Array","from","file","every","name","reader","FileReader","onloadend","action_background_image_upload","result","readAsDataURL","preventDefault","marginLeft","whiteSpace","action_background_image_scale","onChange_scale","pointX","onChange_pointX","action_background_image_pointX","pointY","onChange_pointY","action_background_image_pointY","action_background_image_opacity","onChange_opacity","BackgroundPosition","maxLength","maxWidth","SubMenuGrid","onChange_isVisible","action_toggleGridIsVisible","onChange_snapEnabled","action_toggleGridSnapEnabled","onClick_selectTypeHex","action_setGridType","onClick_selectTypeBox","onChange_gridItemW","action_setGridWidth","onChange_gridItemH","action_setGridHeight","onChange_hexSize","action_setGridHexSize","GridOptions","GridBoxSettings","GridHexSettings","Brush","ColorBrush","set_isVisible","isActivated","set_isActivated","set_pointX","set_pointY","set_rect","action_applyColorBrush","onMouseEnter","BrushElement","FieldsetSize","ToolbarPaint","BrushSize","action_updateBrushSize","BrushColor","action_updateBrushColor","BackgroundImage","src","EditorScene","useStore","getState","App","rootStore","createStore","Boolean","hostname","match","Sentry","dsn","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"qMASYA,EAsCAC,EAOAC,EAMAC,EAIAC,E,0EAvDAJ,K,gCAAAA,E,6BAAAA,M,cAsCAC,K,YAAAA,E,sBAAAA,E,kBAAAA,E,sBAAAA,E,oBAAAA,M,cAOAC,K,YAAAA,E,YAAAA,E,YAAAA,E,yBAAAA,M,cAMAC,K,UAAAA,E,WAAAA,M,cAIAC,K,eAAAA,M,uBChECC,EAAW,U,eCGXC,EAAa,WAA0C,IAAzCC,EAAwC,uDAA5B,EAAGC,EAAyB,uDAAb,EACpD,OAAO,aACLD,IACAC,KACCC,KAAY,IAQJC,EAAY,SAACC,GACxB,IAAMC,EALiB,SAACD,GACxB,OAAOE,KAAKC,KAAKH,EAAMJ,EAAII,EAAMJ,EAAII,EAAMH,EAAIG,EAAMH,GAItCO,CAAUJ,GACnBK,EAAoB,IAAXJ,EACTL,EAAIS,EAAS,EAAIL,EAAMJ,EAAIK,EAC3BJ,EAAIQ,EAAS,EAAIL,EAAMH,EAAII,EACjC,OAAON,EAAWC,EAAGC,IAGVS,EAAQ,SAACN,EAAcO,GAClC,OAAOZ,EAAWK,EAAMJ,EAAIW,EAAQP,EAAMH,EAAIU,IAGnCC,EAAM,SAACR,EAAcJ,EAAWC,GAC3C,OAAOF,EAAWK,EAAMJ,EAAIA,EAAGI,EAAMH,EAAIA,IAO9BY,EAA2B,SAACC,EAAcC,GACrD,OAAOT,KAAKC,MACTQ,EAAIf,EAAIc,EAAMd,IAAMe,EAAIf,EAAIc,EAAMd,IAChCe,EAAId,EAAIa,EAAMb,IAAMc,EAAId,EAAIa,EAAMb,KAI5Be,EAAY,SAACf,EAAGD,GAC3B,OAAOM,KAAKW,MAAMhB,EAAGD,IAGVkB,EAAU,SAACC,EAAWC,EAAWC,GAC5C,OAAOA,EAAErB,EAAImB,EAAGnB,GAAKqB,EAAErB,EAAIoB,EAAGpB,GAAKqB,EAAEpB,EAAIkB,EAAGlB,GAAKoB,EAAEpB,EAAImB,EAAGnB,G,gECvC/CqB,EAAY,SAACC,GACxB,IAAMC,EAAc,aAClBC,GAAIC,qBACJC,SAAU5B,EAAW,EAAG,GACxB6B,KAAMnC,EAAUoC,aAChBC,OAAQ,EACRC,WAAY,EACZC,MFd2B,UEe3BC,OAAQ,GACRC,MAAO,GACPC,iBAAiB,GAChBjC,KAAY,GAEf,OAAOkC,gBAAMZ,EAAUD,ICbZc,EAAY,SAACd,GACxB,IAAMe,EAAU,aACdb,GAAIC,qBACJZ,MAAOf,EAAW,GAAI,IACtBgB,IAAKhB,EAAW,IAAK,KACrBwC,QAAS,GACTC,SAAU,CACRC,WAAY,EACZC,gBAAgB,EAChBC,aAAc,EACdC,kBAAkB,EAClBC,YAAavB,EAAU,MAExBpB,KAAY,GAGf,OAAOkC,gBAAME,EAAYf,IAoBduB,EAAwB,SACnCC,EACAC,EACAC,EACAC,EACAC,GAEA,IAEI/C,EAAQL,EAFFkD,EAAOF,EACPG,EAAOF,GAKjB,OAHA5C,EAAQD,EAAUC,GAClBA,EAAQM,EAAMN,EAAO+C,GACrB/C,EAAQQ,EAAIR,EAAO2C,EAAQC,I,yjBC3CtB,IAAMI,EAAb,6LAyBuBC,GAEnB,IAAMC,EAAcC,KAAKC,WAAWC,QAAQC,MAAML,GAC5CM,EAAQJ,KAAKK,kBAAkBP,GAC/BQ,EAAeP,EAAYf,QAAQlC,OAOzC,GAAIsD,EAAQE,EAAc,CACxB,IAAMC,EAAYH,EAAQE,EAC1BN,KAAKQ,kBAAkBV,EAAQS,QAC1B,GAAIH,EAAQE,EAAc,CAC/B,IAAMG,EAAWH,EAAeF,EAChCJ,KAAKU,oBAAoBZ,EAAQW,GAEnCT,KAAKC,WAAWC,QAAQC,MAAML,GAAQb,SAASC,WAAakB,EAC5DJ,KAAKW,oBAAoBb,GACzBE,KAAKY,kBAAkBd,KA7C3B,wCAiDoBA,GAAS,IAAD,OAClBC,EAAcC,KAAKC,WAAWC,QAAQC,MAAML,GAD1B,EAQpBC,EAAYd,SALdE,EAHsB,EAGtBA,eACAE,EAJsB,EAItBA,iBACAH,EALsB,EAKtBA,WACAE,EANsB,EAMtBA,aACAE,EAPsB,EAOtBA,YAEM/B,EAAwBwC,EAAxBxC,MAAOC,EAAiBuC,EAAjBvC,IAAKwB,EAAYe,EAAZf,QACd6B,EAAUvD,EAAyBC,EAAOC,GAQhD,IAAuB,IAAnB2B,IAAgD,IAArBE,EAA2B,CAExD,IAAIyB,EAAwB,GACxBC,EAAa,EAMjB,GALA/B,EAAQgC,SAAQ,SAAAC,GACd,IAAMtC,EAAQ,EAAKsB,WAAWC,QAAQgB,MAAMD,GAAQtC,MACpDoC,GAA0BpC,EAC1BmC,EAAYK,KAAKxC,MAEfkC,GAAWE,EAAY,CAEzB,IAAMK,EAAmB9B,EAAYX,MAAQW,EAAYX,MAAQ,GAC3D0C,EAAiBR,EAAUE,EAIjC,OAFEhE,KAAKuE,MAAMD,EAAiBD,GAAoBN,EAAYhE,OAK9D,IAAK,IAAIyE,EAAIT,EAAYhE,OAAS,EAAGyE,GAAK,EAAGA,IAAK,CAEhD,GAAIV,GADJE,GAA0BD,EAAYS,IAGpC,OADcA,EAKlB,OAAO,EAEJ,IAAuB,IAAnBpC,IAAiD,IAArBE,EACrC,OAAOH,EACF,IAAuB,IAAnBC,IAAgD,IAArBE,EAA4B,CAChE,IAAIyB,EAAwB,GACxBC,EAAa,EAOjB,GANA/B,EAAQgC,SAAQ,SAAAC,GACd,IAAMtC,EACJ,EAAKsB,WAAWC,QAAQgB,MAAMD,GAAQtC,MAAQS,EAChD2B,GAA0BpC,EAC1BmC,EAAYK,KAAKxC,MAEfkC,GAAWE,EAAa3B,EAAc,CACxC,IAAMgC,EAAmB9B,EAAYX,MAAQW,EAAYX,MAAQ,GAC3D0C,EAAiBR,GAAWE,EAAa3B,GAI/C,OAFErC,KAAKuE,MAAMD,GAAkBD,EAAmBhC,IAChD0B,EAAYhE,OAGd,IAAK,IAAIyE,EAAIT,EAAYhE,OAAS,EAAGyE,GAAK,EAAGA,IAAK,CAEhD,GAAIV,GADJE,GAA0BD,EAAYS,IACXnC,EAEzB,OADcmC,EAIlB,OAAO,EAEJ,OAAuB,IAAnBpC,IAAiD,IAArBE,EAC9BH,EAEF,IA/HX,wCAkIoBY,EAAQ0B,GAExB,IADA,IAAMzB,EAAcC,KAAKC,WAAWC,QAAQC,MAAML,GACzCyB,EAAI,EAAGA,EAAIC,EAAgBD,IAAK,CACvC,IAAIjC,EAAmB,GACnBS,EAAYd,SAASK,YACvBA,EAAW,KAAQS,EAAYd,SAASK,aAExCU,KAAKC,WAAWwB,GAAGC,aAAazC,UAChCe,KAAKC,WAAWwB,GAAGC,aAAazC,SAASK,cAEzCA,EAAW,KACNU,KAAKC,WAAWwB,GAAGC,aAAazC,SAASK,cAGhDA,EAAYpB,QAAKyD,EACjBrC,EAAYlB,cAAWuD,EACvB,IAAMC,EAAO7D,EAAUuB,GACvBU,KAAKC,WAAWC,QAAQgB,MAAMU,EAAK1D,IAAM0D,EACzC5B,KAAKC,WAAWC,QAAQC,MAAML,GAAQd,QAAQmC,KAAKS,EAAK1D,OApJ9D,0CAwJsB4B,EAAQ+B,GAC1B,IAAK,IAAIN,EAAI,EAAGA,EAAIM,EAAeN,IAAK,CACtC,IAAMO,EAAS9B,KAAKC,WAAWC,QAAQC,MAAML,GAAQd,QAAQlC,OACvDiF,EAAiB/B,KAAKC,WAAWC,QAAQC,MAC7CL,GACAd,QAAQgD,OAAOF,EAAS,EAAG,UACtB9B,KAAKC,WAAWC,QAAQgB,MAAMa,EAAe,OA9J1D,0CAkKsBjC,GAAS,IAAD,OACpBC,EAAcC,KAAKC,WAAWC,QAAQC,MAAML,GAC1CvC,EAAwBwC,EAAxBxC,MAAOC,EAAiBuC,EAAjBvC,IAAKwB,EAAYe,EAAZf,QAFM,EAStBe,EAAYd,SALdE,EAJwB,EAIxBA,eACAE,EALwB,EAKxBA,iBAEAD,GAPwB,EAMxBF,WANwB,EAOxBE,cAPwB,EAQxBE,YAKF,IAAuB,IAAnBH,IAAgD,IAArBE,EAA2B,CACxD,IAAI4C,EAAkB,EACtBjC,KAAKC,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GAAW,IAAD,EACpC,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAhDtC,EADsD,EACtDA,MAAOD,EAD+C,EAC/CA,OACfuD,GAAoCtD,EAAQ,EAC5C,IAAMuD,EAAc3C,EAClBhC,EAAMd,EACNc,EAAMb,EACNc,EAAIf,EACJe,EAAId,EACJuF,GAEIxF,EAAIyF,EAAYzF,EAAIkC,EAAQ,EAC5BjC,EAAIwF,EAAYxF,EAAIgC,EAAS,EAAIyD,EACvC,EAAKlC,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS3B,EAAIA,EACnD,EAAKwD,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS1B,EAAIA,EACnDuF,GAAoCtD,EAAQ,UAEzC,IAAuB,IAAnBQ,IAAiD,IAArBE,EAA4B,CACjE,IAAI4C,EAAkB,EACtBjC,KAAKC,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GAAW,IAAD,EACpC,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAhDtC,EADsD,EACtDA,MAAOD,EAD+C,EAC/CA,OACfuD,GAAoCtD,EAAQ,EAC5C,IAAMuD,EAAc3C,EAClBhC,EAAMd,EACNc,EAAMb,EACNc,EAAIf,EACJe,EAAId,EACJuF,GAEIxF,EAAIyF,EAAYzF,EAAIkC,EAAQ,EAC5BjC,EAAIwF,EAAYxF,EAAIgC,EAAS,EAAIyD,EACvC,EAAKlC,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS3B,EAAIA,EACnD,EAAKwD,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS1B,EAAIA,EACnDuF,EAAkBA,EAAkBtD,EAAQ,EAAIS,UAE7C,IAAuB,IAAnBD,IAAgD,IAArBE,EAA4B,CAChE,IAAI4C,EAAkB,EACtBjC,KAAKC,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GAAW,IAAD,EACpC,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAhDtC,EADsD,EACtDA,MAAOD,EAD+C,EAC/CA,OAEfuD,GAAoCtD,EAAQ,EAC5C,IAAMuD,EAAc3C,EAClBhC,EAAMd,EACNc,EAAMb,EACNc,EAAIf,EACJe,EAAId,EACJuF,GAEIxF,EAAIyF,EAAYzF,EAAIkC,EAAQ,EAC5BjC,EAAIwF,EAAYxF,EAAIgC,EAAS,EAAIyD,EACvC,EAAKlC,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS3B,EAAIA,EACnD,EAAKwD,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS1B,EAAIA,EACnDuF,EAAkBA,EAAkBtD,EAAQ,EAAIS,UAE7C,IAAuB,IAAnBD,IAAiD,IAArBE,EAA2B,CAChE,IAAI0B,EAAa,EACjB/B,EAAQgC,SAAQ,SAAAC,GACd,IAAMtC,EAAQ,EAAKsB,WAAWC,QAAQgB,MAAMD,GAAQtC,MACpDoC,GAA0BpC,KAE5B,IACMyD,EADU9E,EAAyBC,EAAOC,GAChBuD,EAC5BsB,EAAsB,EACtBrD,EAAQlC,OAAS,IACnBuF,EAAsBD,GAAiBpD,EAAQlC,OAAS,IAE1D,IAAImF,EAAkB,EACtBjC,KAAKC,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GAAW,IAAD,EACpC,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAhDtC,EADsD,EACtDA,MAAOD,EAD+C,EAC/CA,OACfuD,GAAoCtD,EAAQ,EAC5C,IAAMuD,EAAc3C,EAClBhC,EAAMd,EACNc,EAAMb,EACNc,EAAIf,EACJe,EAAId,EACJuF,GAEIxF,EAAIyF,EAAYzF,EAAIkC,EAAQ,EAC5BjC,EAAIwF,EAAYxF,EAAIgC,EAAS,EAAIyD,EACvC,EAAKlC,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS3B,EAAIA,EACnD,EAAKwD,WAAWC,QAAQgB,MAAMD,GAAQ7C,SAAS1B,EAAIA,EACnDuF,EAAkBA,EAAkBtD,EAAQ,EAAI0D,QAjQxD,wCAsQoBvC,GAAS,IAAD,OAClBC,EAAcC,KAAKC,WAAWC,QAAQC,MAAML,GAC1CvC,EAAwBwC,EAAxBxC,MAAOC,EAAiBuC,EAAjBvC,IAAKwB,EAAYe,EAAZf,QACdsD,EAAmB7E,EAAUF,EAAMd,EAAIe,EAAIf,EAAGc,EAAMb,EAAIc,EAAId,GAClEsC,EAAQgC,SAAQ,SAAAC,GACd,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQzC,YACT,GHlOf,IGkON8D,EHlOavF,KAAKwF,WG1ChC,GAA6CC,gB,8NCA7C,IAEaC,EAAb,kMAEIzC,KAAKC,WAAWwB,GAAGiB,SAASC,OAAQ,EACpC3C,KAAKC,WAAWwB,GAAGiB,SAASE,oBAAqB,IAHrD,uCAMmBrF,EAAcC,GAC7B,IAAMqF,EAAO/D,E,yVAAU,IAAKkB,KAAKC,WAAWwB,GAAGC,aAAzB,CAAuCnE,QAAOC,SACpEwC,KAAKC,WAAWC,QAAQC,MAAM0C,EAAK3E,IAAM2E,EACzC7C,KAAKC,WAAW6C,KAAO3G,EAAW4G,UAClC/C,KAAKgD,qBAAqBH,EAAK3E,IAC/B8B,KAAKiD,4BAXT,8CAeIC,EACAC,GAMA,GAAInD,KAAKC,WAAWC,QAAQC,MAAM+C,GAAM,CACtC,IAAML,EAAO7C,KAAKC,WAAWC,QAAQC,MAAM+C,GADL,EAQlClD,KAAKC,WAAWwB,GAAG2B,KALrBzE,EAHoC,EAGpCA,MACAD,EAJoC,EAIpCA,OACA2E,EALoC,EAKpCA,YACAhF,EANoC,EAMpCA,KACAiF,EAPoC,EAOpCA,QAEF,IAAoB,IAAhBD,GACF,GAAIhF,IAAShC,EAAekH,IAC1BV,EAAKtF,MAAMd,EAAIM,KAAKyG,MAAML,EAAK1G,EAAIkC,GAASA,EAnChC,EAoCZkE,EAAKtF,MAAMb,EAAIK,KAAKyG,MAAML,EAAKzG,EAAIgC,GAAUA,EApCjC,OAqCP,GAAIL,IAAShC,EAAeoH,IAAK,CACtC,IACMC,EADW3G,KAAKC,KAAK,GAAKsG,EAE1BK,EAAY,EAAIL,EAChBM,EAAkB,IAATD,EACTE,EAAU9G,KAAKyG,MAAML,EAAK1G,EAAIiH,GAAUA,EA1ClC,EA2CNI,EAAQ/G,KAAKyG,MAAML,EAAKzG,EAAIkH,GAC5BG,EAAUD,EAAQF,EA5CZ,EA4CqCD,EAAY,EAC7Dd,EAAKtF,MAAMb,EAAIqH,EAEblB,EAAKtF,MAAMd,EADTqH,EAAQ,IAAM,EACDJ,EAAS,EAAIG,EAEbA,QAInBhB,EAAKtF,MAAMd,EAAI0G,EAAK1G,EArDN,EAsDdoG,EAAKtF,MAAMb,EAAIyG,EAAKzG,EAtDN,EAwDhBsD,KAAKgD,qBAAqBH,EAAK3E,IAC/B8B,KAAKiD,6BAvDX,4CA4DIC,EACAC,GAMA,GAAInD,KAAKC,WAAWC,QAAQC,MAAM+C,GAAM,CACtC,IAAML,EAAO7C,KAAKC,WAAWC,QAAQC,MAAM+C,GADL,EAQlClD,KAAKC,WAAWwB,GAAG2B,KALrBzE,EAHoC,EAGpCA,MACAD,EAJoC,EAIpCA,OACA2E,EALoC,EAKpCA,YACAC,EANoC,EAMpCA,QACAjF,EAPoC,EAOpCA,KAEF,IAAoB,IAAhBgF,GACF,GAAIhF,IAAShC,EAAekH,IAC1BV,EAAKrF,IAAIf,EAAIM,KAAKyG,MAAML,EAAK1G,EAAIkC,GAASA,EAhF9B,EAiFZkE,EAAKrF,IAAId,EAAIK,KAAKyG,MAAML,EAAKzG,EAAIgC,GAAUA,EAjF/B,OAkFP,GAAIL,IAAShC,EAAeoH,IAAK,CACtC,IACMC,EADW3G,KAAKC,KAAK,GAAKsG,EAE1BK,EAAY,EAAIL,EAChBM,EAAkB,IAATD,EACTE,EAAU9G,KAAKyG,MAAML,EAAK1G,EAAIiH,GAAUA,EAvFlC,EAwFNI,EAAQ/G,KAAKyG,MAAML,EAAKzG,EAAIkH,GAC5BG,EAAUD,EAAQF,EAzFZ,EAyFqCD,EAAY,EAC7Dd,EAAKrF,IAAId,EAAIqH,EAEXlB,EAAKrF,IAAIf,EADPqH,EAAQ,IAAM,EACHJ,EAAS,EAAIG,EAEbA,QAIjBhB,EAAKrF,IAAIf,EAAI0G,EAAK1G,EAlGJ,EAmGdoG,EAAKrF,IAAId,EAAIyG,EAAKzG,EAnGJ,EAqGhBsD,KAAKgD,qBAAqBH,EAAK3E,IAC/B8B,KAAKiD,6BApGX,wCAyGIC,EACAC,GAUC,IACO3D,EAA6C2D,EAA7C3D,OAAQC,EAAqC0D,EAArC1D,OAAQuE,EAA6Bb,EAA7Ba,UAAWC,EAAkBd,EAAlBc,QAASxH,EAAS0G,EAAT1G,EAAGC,EAAMyG,EAANzG,EAC/C,GAAIsD,KAAKC,WAAWC,QAAQC,MAAM+C,GAAM,CACtC,IAAML,EAAO7C,KAAKC,WAAWC,QAAQC,MAAM+C,GADL,EAQlClD,KAAKC,WAAWwB,GAAG2B,KALrBzE,EAHoC,EAGpCA,MACAD,EAJoC,EAIpCA,OACA2E,EALoC,EAKpCA,YACAhF,EANoC,EAMpCA,KACAiF,EAPoC,EAOpCA,QAGF,IAAoB,IAAhBD,GACF,GAAIhF,IAAShC,EAAekH,IAC1BV,EAAKtF,MAAMd,EACTM,KAAKyG,OAAOX,EAAKtF,MAAMd,EAAI0G,EAAKe,QAAUvF,GAASA,EArIzC,EAwIZkE,EAAKtF,MAAMb,EACTK,KAAKyG,OAAOX,EAAKtF,MAAMb,EAAIyG,EAAKgB,QAAUzF,GAAUA,EAzI1C,EA4IZmE,EAAKrF,IAAIf,EACPM,KAAKyG,OAAOX,EAAKrF,IAAIf,EAAI0G,EAAKe,QAAUvF,GAASA,EA7IvC,EAgJZkE,EAAKrF,IAAId,EACPK,KAAKyG,OAAOX,EAAKrF,IAAId,EAAIyG,EAAKgB,QAAUzF,GAAUA,EAjJxC,OAmJP,GAAIL,IAAShC,EAAeoH,IAAK,CACtC,IACMC,EADW3G,KAAKC,KAAK,GAAKsG,EAE1BK,EAAY,EAAIL,EAChBM,EAAkB,IAATD,EAEf,GAAkB,OAAdK,EAAoB,CACtB,IAAMI,EAAOJ,EAAUvH,GAAKA,EAAI+C,GAC1B6E,EAAOL,EAAUtH,GAAKA,EAAI+C,GAC1BoE,EAAU9G,KAAKyG,MAAMY,EAAOV,GAAUA,EA5JlC,EA8JJI,EAAQ/G,KAAKyG,MAAMa,EAAOT,GAG5BG,EAFeD,EAAQF,EA/JjB,EAgKGD,EAAY,EAEzBd,EAAKtF,MAAMb,EAAIqH,EAEblB,EAAKtF,MAAMd,EADTqH,EAAQ,IAAM,EACDJ,EAAS,EAAIG,EAEbA,EAInB,GAAgB,OAAZI,EAAkB,CACpB,IAAMG,EAAOH,EAAQxH,GAAKA,EAAI+C,GACxB6E,EAAOJ,EAAQvH,GAAKA,EAAI+C,GACxBoE,EAAU9G,KAAKyG,MAAMY,EAAOV,GAAUA,EA7KlC,EA+KJI,EAAQ/G,KAAKyG,MAAMa,EAAOT,GAG5BG,EAFeD,EAAQF,EAhLjB,EAiLGD,EAAY,EAEzBd,EAAKrF,IAAId,EAAIqH,EAEXlB,EAAKrF,IAAIf,EADPqH,EAAQ,IAAM,EACHJ,EAAS,EAAIG,EAEbA,SAKnBhB,EAAKtF,MAAMd,EAAIoG,EAAKtF,MAAMd,EAAI0G,EAAKe,OACnCrB,EAAKtF,MAAMb,EAAImG,EAAKtF,MAAMb,EAAIyG,EAAKgB,OACnCtB,EAAKrF,IAAIf,EAAIoG,EAAKrF,IAAIf,EAAI0G,EAAKe,OAC/BrB,EAAKrF,IAAId,EAAImG,EAAKrF,IAAId,EAAIyG,EAAKgB,OAEjCnE,KAAKgD,qBAAqBH,EAAK3E,IAC/B8B,KAAKiD,6BAhMX,6CAoMyBE,GAA2C,IAAD,OAC/DmB,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAAlB,GACvD,GAAI,EAAKG,WAAWC,QAAQC,MAAML,GAAS,CACzC,IAAM+C,EAAO,EAAK5C,WAAWC,QAAQC,MAAML,GADF,EAEF,EAAKG,WAAWwB,GAAG2B,KAAlDzE,EAFiC,EAEjCA,MAAOD,EAF0B,EAE1BA,QACK,IAHqB,EAElB2E,aAErBR,EAAKtF,MAAMd,EACTM,KAAKyG,OAAOX,EAAKtF,MAAMd,EAAI0G,EAAKe,QAAUvF,GAASA,EA7MzC,EAgNZkE,EAAKtF,MAAMb,EACTK,KAAKyG,OAAOX,EAAKtF,MAAMb,EAAIyG,EAAKgB,QAAUzF,GAAUA,EAjN1C,EAoNZmE,EAAKrF,IAAIf,EACPM,KAAKyG,OAAOX,EAAKrF,IAAIf,EAAI0G,EAAKe,QAAUvF,GAASA,EArNvC,EAwNZkE,EAAKrF,IAAId,EACPK,KAAKyG,OAAOX,EAAKrF,IAAId,EAAIyG,EAAKgB,QAAUzF,GAAUA,EAzNxC,IA4NZmE,EAAKtF,MAAMd,EAAIoG,EAAKtF,MAAMd,EAAI0G,EAAKe,OACnCrB,EAAKtF,MAAMb,EAAImG,EAAKtF,MAAMb,EAAIyG,EAAKgB,OACnCtB,EAAKrF,IAAIf,EAAIoG,EAAKrF,IAAIf,EAAI0G,EAAKe,OAC/BrB,EAAKrF,IAAId,EAAImG,EAAKrF,IAAId,EAAIyG,EAAKgB,QAEjC,EAAKnB,qBAAqBH,EAAK3E,QAGnC8B,KAAKiD,4BAlOT,8CAqO0BE,MArO1B,yCAuOqBrD,GACjBE,KAAKC,WAAWwB,GAAG+C,iBAAmB,GACtCxE,KAAKC,WAAWwB,GAAG+C,iBAAiB1E,IAAU,EAC9CE,KAAKC,WAAWwB,GAAGgD,sBAAwB,IA1O/C,kDA8OI,IAAMF,EAAOD,OAAOC,KAAKvE,KAAKC,WAAWC,QAAQC,OACjD,GAAIoE,EAAKzH,OAAS,EAAG,CACnB,IAAMgD,EAASyE,EAAKA,EAAKzH,OAAS,GAClCkD,KAAK0E,mBAAmB5E,MAjP9B,yCAqPqBmB,GACjBjB,KAAKC,WAAWwB,GAAGkD,iBAAmB,GACtC3E,KAAKC,WAAWwB,GAAGkD,iBAAiB1D,IAAU,EAC9CjB,KAAKC,WAAWwB,GAAGmD,sBAAwB,MAxP/C,GAAqD/E,GCTxCgF,EAAb,+LAEI7E,KAAKC,WAAWC,QAAQgB,MAAQ,GAChClB,KAAKC,WAAWC,QAAQC,MAAQ,GAChCH,KAAKC,WAAWwB,GAAGkD,iBAAmB,GACtC3E,KAAKC,WAAWwB,GAAGmD,sBAAwB,EAC3C5E,KAAKC,WAAWwB,GAAG+C,iBAAmB,GACtCxE,KAAKC,WAAWwB,GAAGgD,sBAAwB,EAC3CzE,KAAKC,WAAWwB,GAAGiB,SAASC,OAAQ,EACpC3C,KAAKC,WAAWwB,GAAGiB,SAASE,oBAAqB,IATrD,+CAY4B,IAAD,OAEvB,GADAkC,QAAQC,IAAI,0BACR,iBAAkBC,OAAQ,CAC5BhF,KAAKC,WAAWwB,GAAGiB,SAASC,OAAQ,EACpC3C,KAAKC,WAAWwB,GAAGiB,SAASE,oBAAqB,EACjD,IAAMqC,EAAaC,aAAaC,QAAQ,WACxC,GAAmB,OAAfF,EACF,IACE,IAAMG,EAASC,KAAKC,MAAML,GAC1BjF,KAAKC,WAAWC,QAAU,CACxBgB,MAAO,GACPf,MAAO,IAETmE,OAAOC,KAAKa,EAAOlE,OAAOF,SAAQ,SAAAC,GAChC,IAAMsE,EAAWH,EAAOlE,MAAMD,GACxBW,EAAO7D,EAAUwH,GACvB,EAAKtF,WAAWC,QAAQgB,MAAMD,GAAUW,KAE1C0C,OAAOC,KAAKa,EAAOjF,OAAOa,SAAQ,SAAAlB,GAChC,IAAM0F,EAAWJ,EAAOjF,MAAML,GACxB+C,EAAO/D,EAAU0G,GACvB,EAAKvF,WAAWC,QAAQC,MAAML,GAAU+C,KAE1CyB,OAAOC,KAAKvE,KAAKC,WAAWC,QAAQC,OAAOa,SAAQ,SAAAlB,GACjD,EAAKkD,qBAAqBlD,MAE5BgF,QAAQC,IAAI,iCACZ,MAAOU,GACPX,QAAQY,MAAM,iCAAkCD,QAGlDX,QAAQa,KAAK,gCAGfb,QAAQa,KAAK,+BA9CnB,4CAmDQ,iBAAkBX,QACpBE,aAAaU,QAAQ,UAAWP,KAAKQ,UAAU7F,KAAKC,WAAWC,UAC/DF,KAAKC,WAAWwB,GAAGiB,SAASC,OAAQ,EACpC3C,KAAKC,WAAWwB,GAAGiB,SAASE,oBAAqB,EACjDkC,QAAQC,IAAI,+BAEZ/E,KAAKC,WAAWwB,GAAGiB,SAASC,OAAQ,EACpCmC,QAAQa,KAAK,kCA1DnB,GAAyC9F,GCH5BiG,EAAb,2MAMUC,mBAAqB,WACvB,EAAK9F,WAAWwB,GAAGmD,sBAAwB,IAC7C,EAAK3E,WAAWwB,GAAGkD,iBAAmB,GACtC,EAAK1E,WAAWwB,GAAGmD,sBAAwB,IATjD,EAYUoB,mBAAqB,WACvB,EAAK/F,WAAWwB,GAAGgD,wBACrB,EAAKxE,WAAWwB,GAAG+C,iBAAmB,GACtC,EAAKvE,WAAWwB,GAAGgD,sBAAwB,IAfjD,yFAC4BwB,GACxBjG,KAAKC,WAAW6C,KAAOmD,EACvBjG,KAAK+F,qBACL/F,KAAKgG,uBAJT,yCAkBqBE,GACjBlG,KAAKC,WAAWwB,GAAGiB,SAASC,MAAQuD,MAnBxC,GAAkD1D,gBCArC2D,EAAb,6OAAsC3D,gBCGzB4D,EAAb,oMAC8B3J,EAAGC,GAC7BsD,KAAKC,WAAWwB,GAAG4E,eAAeC,eAAgB,EAElDtG,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMd,EAAIA,EAC5CuD,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMb,EAAIA,EAC5CsD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAIf,EAAIA,EAC1CuD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAId,EAAIA,IAP9C,kDAU8BD,EAAGC,GAAI,IAAD,OAIhC,GAHAsD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAIf,EAAIA,EAC1CuD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAId,EAAIA,GAEU,IAAhDsD,KAAKC,WAAWwB,GAAG4E,eAAeE,UAAqB,CAAC,IAAD,EAClCvG,KAAKC,WAAWwB,GAAG4E,eAAlC9I,EADiD,EACjDA,MAAOC,EAD0C,EAC1CA,IACT0G,EAAS1G,EAAIf,EAAIc,EAAMd,EACvB0H,EAAS3G,EAAId,EAAIa,EAAMb,GAEzBK,KAAKyJ,IAAItC,GAAU,GAAKnH,KAAKyJ,IAAIrC,GAAU,KAC7CnE,KAAKC,WAAWwB,GAAG4E,eAAeE,WAAY,GAIlD,IAAoD,IAAhDvG,KAAKC,WAAWwB,GAAG4E,eAAeE,UAAoB,CAAC,IAAD,EACjCvG,KAAKC,WAAWwB,GAAG4E,eAAlC9I,EADgD,EAChDA,MAAOC,EADyC,EACzCA,IACTI,EAAKpB,EAAWO,KAAK0J,IAAIlJ,EAAMd,EAAGe,EAAIf,GAAIM,KAAK0J,IAAIlJ,EAAMb,EAAGc,EAAId,IAChEmB,EAAKrB,EAAWO,KAAK2J,IAAInJ,EAAMd,EAAGe,EAAIf,GAAIM,KAAK2J,IAAInJ,EAAMb,EAAGc,EAAId,IAyBtEsD,KAAKC,WAAWwB,GAAGkD,iBAAmB,GACtC3E,KAAKC,WAAWwB,GAAGmD,sBAAwB,EAC3CN,OAAOC,KAAKvE,KAAKC,WAAWC,QAAQgB,OAAOF,SAAQ,SAAAC,GACjD,IAAMW,EAAO,EAAK3B,WAAWC,QAAQgB,MAAMD,GACrC0F,EAAKnK,EAAWoF,EAAKxD,SAAS3B,EAAI,GAAImF,EAAKxD,SAAS1B,EAAI,IAC1DiB,EAAQC,EAAIC,EAAI8I,KAClB,EAAK1G,WAAWwB,GAAGkD,iBAAiB1D,IAAU,EAC9C,EAAKhB,WAAWwB,GAAGmD,sBACjB,EAAK3E,WAAWwB,GAAGmD,sBAAwB,SA5DvD,mDAmEwD,IAAhD5E,KAAKC,WAAWwB,GAAG4E,eAAeE,WAChCvG,KAAKC,WAAWwB,GAAGmD,sBAAwB,IAC7C5E,KAAKC,WAAWwB,GAAGkD,iBAAmB,GACtC3E,KAAKC,WAAWwB,GAAGmD,sBAAwB,GAI/C5E,KAAKC,WAAWwB,GAAG4E,eAAeC,eAAgB,EAClDtG,KAAKC,WAAWwB,GAAG4E,eAAeE,WAAY,EAC9CvG,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMd,EAAI,EAC5CuD,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMb,EAAI,EAC5CsD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAIf,EAAI,EAC1CuD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAId,EAAI,IA/E9C,kDAkF8BD,EAAWC,GACrCsD,KAAKC,WAAWwB,GAAG4E,eAAeC,eAAgB,EAClDtG,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMd,EAAIA,EAC5CuD,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMb,EAAIA,EAC5CsD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAIf,EAAIA,EAC1CuD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAId,EAAIA,IAvF9C,kDA0F8BD,EAAWC,GAAY,IAAD,OAIhD,GAHAsD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAIf,EAAIA,EAC1CuD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAId,EAAIA,GAEU,IAAhDsD,KAAKC,WAAWwB,GAAG4E,eAAeE,UAAqB,CAAC,IAAD,EAClCvG,KAAKC,WAAWwB,GAAG4E,eAAlC9I,EADiD,EACjDA,MAAOC,EAD0C,EAC1CA,IACT0G,EAAS1G,EAAIf,EAAIc,EAAMd,EACvB0H,EAAS3G,EAAId,EAAIa,EAAMb,GACzBK,KAAKyJ,IAAItC,GAAU,GAAKnH,KAAKyJ,IAAIrC,GAAU,KAC7CnE,KAAKC,WAAWwB,GAAG4E,eAAeE,WAAY,GAIlD,IAAoD,IAAhDvG,KAAKC,WAAWwB,GAAG4E,eAAeE,UAAoB,CAAC,IAAD,EACjCvG,KAAKC,WAAWwB,GAAG4E,eAAlC9I,EADgD,EAChDA,MAAOC,EADyC,EACzCA,IACTI,EAAKpB,EAAWO,KAAK0J,IAAIlJ,EAAMd,EAAGe,EAAIf,GAAIM,KAAK0J,IAAIlJ,EAAMb,EAAGc,EAAId,IAChEmB,EAAKrB,EAAWO,KAAK2J,IAAInJ,EAAMd,EAAGe,EAAIf,GAAIM,KAAK2J,IAAInJ,EAAMb,EAAGc,EAAId,IAuBtEsD,KAAKC,WAAWwB,GAAG+C,iBAAmB,GACtCxE,KAAKC,WAAWwB,GAAGgD,sBAAwB,EAC3CH,OAAOC,KAAKvE,KAAKC,WAAWC,QAAQC,OAAOa,SAAQ,SAAAlB,GACjD,IAAM+C,EAAO,EAAK5C,WAAWC,QAAQC,MAAML,IACvCnC,EAAQC,EAAIC,EAAIgF,EAAKtF,QAAUI,EAAQC,EAAIC,EAAIgF,EAAKrF,QACtD,EAAKyC,WAAWwB,GAAG+C,iBAAiB1E,IAAU,EAC9C,EAAKG,WAAWwB,GAAGgD,sBACjB,EAAKxE,WAAWwB,GAAGgD,sBAAwB,SAxIvD,mDA+IwD,IAAhDzE,KAAKC,WAAWwB,GAAG4E,eAAeE,WAChCvG,KAAKC,WAAWwB,GAAGgD,sBAAwB,IAC7CzE,KAAKC,WAAWwB,GAAG+C,iBAAmB,GACtCxE,KAAKC,WAAWwB,GAAGgD,sBAAwB,GAI/CzE,KAAKC,WAAWwB,GAAG4E,eAAeC,eAAgB,EAClDtG,KAAKC,WAAWwB,GAAG4E,eAAeE,WAAY,EAC9CvG,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMd,EAAI,EAC5CuD,KAAKC,WAAWwB,GAAG4E,eAAe9I,MAAMb,EAAI,EAC5CsD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAIf,EAAI,EAC1CuD,KAAKC,WAAWwB,GAAG4E,eAAe7I,IAAId,EAAI,MA3J9C,GAAgD8F,gB,yjBCAzC,IAAMoE,EAAb,kMAEI5G,KAAKC,WAAWwB,GAAGiB,SAASC,OAAQ,EACpC3C,KAAKC,WAAWwB,GAAGiB,SAASE,oBAAqB,IAHrD,4CAKwBnE,GAAgB,IAAD,OACnC6F,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQxC,MAAQA,KAEhDuB,KAAKiD,4BATT,4CAYwB5E,GAAkB,IAAD,OACrCiG,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQ5C,KAAOA,KAE/C2B,KAAKiD,4BAhBT,0CAkBsBhC,EAlBtB,GAkBuC,EAAP4F,MAlBhC,8CAmBgC,EAAPA,MAnBzB,6DAqByCC,GAAQ,IAAD,OAC5CxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASG,aAAe0H,EAC1D,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BA1BT,iEA6B6C6D,GAAQ,IAAD,OAChDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASI,iBAAmByH,EAC9D,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BAlCT,2DAqCuC6D,GAAQ,IAAD,OAC1CxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASC,WAAa4H,EACxD,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BA1CT,+DA6C2C6D,GAAQ,IAAD,OAC9CxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASE,eAAiB2H,EAC5D,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BAlDT,kDAqD+B,IAAD,OACpB8D,EAAczC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkB,GAE/DlF,EAAW,KADCU,KAAKC,WAAWC,QAAQC,MAAM4G,GACb9H,SAASK,aAE5CA,EAAYpB,QAAKyD,EACjBrC,EAAYlB,cAAWuD,EAEvB2C,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIc,QAAQgC,SAAQ,SAAAC,GAC5C3B,IACF,EAAKW,WAAWC,QAAQgB,MAAMD,GAAUpC,gBACtC,EAAKoB,WAAWC,QAAQgB,MAAMD,GAC9B3B,OAIN,EAAKW,WAAWC,QAAQC,MAAMjC,GAAIe,SAASK,YAAcT,gBACvD,EAAKoB,WAAWC,QAAQC,MAAMjC,GAAIe,SAASK,YAC3CA,GAEF,EAAK0D,qBAAqB9E,MAE5B8B,KAAKiD,4BA5ET,mDA+EgC,IAAD,OAC3BqB,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIc,QAAQgC,SAAQ,SAAAC,UACzC,EAAKhB,WAAWC,QAAQgB,MAAMD,aAEhC,EAAKhB,WAAWC,QAAQC,MAAMjC,MAEvC8B,KAAKC,WAAWwB,GAAG+C,iBAAmB,GACtCxE,KAAKC,WAAWwB,GAAGgD,sBAAwB,EAC3CzE,KAAKiD,4BAxFT,kDA2F+B,IAAD,OAGpB+D,EAAwB,GAE9B1C,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,IAAM+I,EAAUnI,EAAU,KACrB,EAAKmB,WAAWC,QAAQC,MAAMjC,GADV,CAEvBA,QAAIyD,EACJ3C,QAAS,MAEXiI,EAAQ1J,MAAMd,EAAIwK,EAAQ1J,MAAMd,EAVpB,GAWZwK,EAAQ1J,MAAMb,EAAIuK,EAAQ1J,MAAMb,EAVpB,GAWZuK,EAAQzJ,IAAIf,EAAIwK,EAAQzJ,IAAIf,EAZhB,GAaZwK,EAAQzJ,IAAId,EAAIuK,EAAQzJ,IAAId,EAZhB,GAcZ,EAAKuD,WAAWC,QAAQC,MAAMjC,GAAIc,QAAQgC,SAAQ,SAAAC,GAChD,IAAMiG,EAAUnJ,EAAU,KACrB,EAAKkC,WAAWC,QAAQgB,MAAMD,GADV,CAEvB/C,QAAIyD,KAENuF,EAAQ9I,SAAS3B,EAAIyK,EAAQ9I,SAAS3B,EApB5B,GAqBVyK,EAAQ9I,SAAS1B,EAAIwK,EAAQ9I,SAAS1B,EApB5B,GAqBV,EAAKuD,WAAWC,QAAQgB,MAAMgG,EAAQhJ,IAAMgJ,EAC5CD,EAAQjI,QAAQmC,KAAK+F,EAAQhJ,OAG/B8I,EAAY7F,KAAK8F,EAAQ/I,IACzB,EAAK+B,WAAWC,QAAQC,MAAM8G,EAAQ/I,IAAM+I,KAG9CD,EAAYhG,SAAQ,SAAAlB,GAClB,EAAKkD,qBAAqBlD,MAG5BE,KAAKC,WAAWwB,GAAG+C,iBAAmB,GACtCxE,KAAKC,WAAWwB,GAAGgD,sBAAwB,EAE3CuC,EAAYhG,SAAQ,SAAAlB,GAClB,EAAKG,WAAWwB,GAAG+C,iBAAiB1E,IAAU,EAC9C,EAAKG,WAAWwB,GAAGgD,sBACjB,EAAKxE,WAAWwB,GAAGgD,sBAAwB,KAE/CzE,KAAKiD,4BAtIT,yDA0JqC6D,GAC7B9G,KAAKC,WAAWwB,GAAGC,aAAazC,WAClCe,KAAKC,WAAWwB,GAAGC,aAAazC,SAASC,WAAa4H,KA5J5D,6DAgKyCA,GACjC9G,KAAKC,WAAWwB,GAAGC,aAAazC,WAClCe,KAAKC,WAAWwB,GAAGC,aAAazC,SAASE,eAAiB2H,KAlKhE,2DAsKuCA,GAC/B9G,KAAKC,WAAWwB,GAAGC,aAAazC,WAClCe,KAAKC,WAAWwB,GAAGC,aAAazC,SAASG,aAAe0H,KAxK9D,+DA4K2CA,GACnC9G,KAAKC,WAAWwB,GAAGC,aAAazC,WAClCe,KAAKC,WAAWwB,GAAGC,aAAazC,SAASI,iBAAmByH,KA9KlE,uDAkLmCA,GAC3B9G,KAAKC,WAAWwB,GAAGC,aAAazC,UAC9Be,KAAKC,WAAWwB,GAAGC,aAAazC,SAASK,cAC3CU,KAAKC,WAAWwB,GAAGC,aAAazC,SAASK,YAAYjB,KAAOyI,KArLpE,oDA0LgCA,GACxB9G,KAAKC,WAAWwB,GAAGC,aAAazC,UAC9Be,KAAKC,WAAWwB,GAAGC,aAAazC,SAASK,cAC3CU,KAAKC,WAAWwB,GAAGC,aAAazC,SAASK,YAAYb,MAAQqI,KA7LrE,yDAkMqCA,GAAQ,IACjCpF,EAAiB1B,KAAKC,WAAWwB,GAAjCC,aACR,GAAIA,EAAazC,UACXyC,EAAazC,SAASK,YAAa,CAAC,IAAD,EAKjCoC,EAAazC,SAASK,YAHxBX,EAFmC,EAEnCA,MACAD,EAHmC,EAGnCA,OAGF,GANqC,EAInCE,iBAEqBD,GAASD,EAC9B,GAAIA,GAAU,EAAG,CACf,IAAMyI,EAAQxI,EAAQD,EACtBgD,EAAazC,SAASK,YAAYX,MAAQmI,EAAQK,EAClDzF,EAAazC,SAASK,YAAYZ,OAASoI,OAE3CpF,EAAazC,SAASK,YAAYZ,OAAS,OAG7CgD,EAAazC,SAASK,YAAYZ,OAASoI,KApNrD,wDA0NoCA,GAAQ,IAChCpF,EAAiB1B,KAAKC,WAAWwB,GAAjCC,aACR,GAAIA,EAAazC,UACXyC,EAAazC,SAASK,YAAa,CAAC,IAAD,EAKjCoC,EAAazC,SAASK,YAHxBX,EAFmC,EAEnCA,MACAD,EAHmC,EAGnCA,OAGF,GANqC,EAInCE,iBAEqBD,GAASD,EAC9B,GAAIC,GAAS,EAAG,CACd,IAAMwI,EAAQzI,EAASC,EACvB+C,EAAazC,SAASK,YAAYX,MAAQmI,EAC1CpF,EAAazC,SAASK,YAAYZ,OAASoI,EAAQK,OAEnDzF,EAAazC,SAASK,YAAYX,MAAQ,OAG5C+C,EAAazC,SAASK,YAAYX,MAAQmI,KA5OpD,kEAkP8CA,GAAQ,IAC1CpF,EAAiB1B,KAAKC,WAAWwB,GAAjCC,aACJA,EAAazC,UACXyC,EAAazC,SAASK,cACxBoC,EAAazC,SAASK,YAAYV,gBAAkBkI,KAtP5D,yDA0PqCA,GAAQ,IACjCpF,EAAiB1B,KAAKC,WAAWwB,GAAjCC,aACJA,EAAazC,UACXyC,EAAazC,SAASK,cACxBoC,EAAazC,SAASK,YAAYf,OAASuI,KA9PnD,qEAoRiDA,GAAQ,IAAD,OACpDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASC,WAAa4H,EACxD,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BAzRT,yEA4RqD6D,GAAQ,IAAD,OACxDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASE,eAAiB2H,EAC5D,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BAjST,uEAoSmD6D,GAAQ,IAAD,OACtDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASG,aAAe0H,EAC1D,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BAzST,2EA4SuD6D,GAAQ,IAAD,OAC1DxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAA9C,GACvD,EAAK+B,WAAWC,QAAQC,MAAMjC,GAAIe,SAASI,iBAAmByH,EAC9D,EAAK9D,qBAAqB9E,MAE5B8B,KAAKiD,4BAjTT,kEAoT8C6D,GAAQ,IAAD,OACjDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAAlB,GACvD,EAAKG,WAAWC,QAAQC,MAAML,GAAQb,SAASK,YAAYjB,KAAOyI,EAClE,EAAK7G,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GACpD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQ5C,KAAOyI,KAE/C,EAAK9D,qBAAqBlD,MAE5BE,KAAKiD,4BA5TT,mEA+T+C6D,GAAQ,IAAD,OAClDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAAlB,GACvD,EAAKG,WAAWC,QAAQC,MAAML,GAAQb,SAASK,YAAYb,MAAQqI,EACnE,EAAK7G,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GACpD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQxC,MAAQqI,KAEhD,EAAK9D,qBAAqBlD,MAE5BE,KAAKiD,4BAvUT,oEA0UgD6D,GAAQ,IAAD,OACnDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAAlB,GACvD,IAAM0F,EAAW,EAAKvF,WAAWC,QAAQC,MAAML,GADkB,EAExB0F,EAASvG,SAASK,YAArDX,EAF2D,EAE3DA,MAAOD,EAFoD,EAEpDA,OAEb,IAAwB,IAJyC,EAE5CE,gBAGnB4G,EAASvG,SAASK,YAAYZ,OAASoI,EACvC,EAAK7G,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GACpD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQvC,OAASoI,KAEjD,EAAK9D,qBAAqBlD,OACrB,CACL,GAAInB,GAASD,EAAQ,CACnB,GAAIoI,GAAS,EAEXnI,EAAQmI,GADMnI,EAAQD,GAEtBA,EAASoI,EAGXtB,EAASvG,SAASK,YAAYX,MAAQA,EACtC6G,EAASvG,SAASK,YAAYZ,OAASA,EAGzC,EAAKuB,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GAChDtC,GAASD,IACX,EAAKuB,WAAWC,QAAQgB,MAAMD,GAAQtC,MAAQA,EAC9C,EAAKsB,WAAWC,QAAQgB,MAAMD,GAAQvC,OAASA,MAInD,EAAKsE,qBAAqBlD,OAG9BE,KAAKiD,4BA3WT,mEA8W+C6D,GAAQ,IAAD,OAClDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAAlB,GACvD,IAAM0F,EAAW,EAAKvF,WAAWC,QAAQC,MAAML,GADkB,EAExB0F,EAASvG,SAASK,YAArDX,EAF2D,EAE3DA,MAAOD,EAFoD,EAEpDA,OAEb,IAAwB,IAJyC,EAE5CE,gBAGnB4G,EAASvG,SAASK,YAAYX,MAAQmI,EACtC,EAAK7G,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GACpD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQtC,MAAQmI,KAEhD,EAAK9D,qBAAqBlD,OACrB,CACL,GAAInB,GAASD,EAAQ,CACnB,GAAIoI,GAAS,EAAG,CACd,IAAMK,EAAQzI,EAASC,EACvBA,EAAQmI,EACRpI,EAASoI,EAAQK,EAGnB3B,EAASvG,SAASK,YAAYX,MAAQA,EACtC6G,EAASvG,SAASK,YAAYZ,OAASA,EAGzC,EAAKuB,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GAChDtC,GAASD,IACX,EAAKuB,WAAWC,QAAQgB,MAAMD,GAAQtC,MAAQA,EAC9C,EAAKsB,WAAWC,QAAQgB,MAAMD,GAAQvC,OAASA,MAInD,EAAKsE,qBAAqBlD,OAG9BE,KAAKiD,4BA/YT,6EAkZyD6D,GAAQ,IAAD,OAC5DxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAAlB,GACvD,EAAKG,WAAWC,QAAQC,MACtBL,GACAb,SAASK,YAAYV,gBAAkBkI,EACzC,EAAK7G,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GACpD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQrC,gBAAkBkI,KAE1D,EAAK9D,qBAAqBlD,MAE5BE,KAAKiD,4BA5ZT,oEA+ZgD6D,GAAQ,IAAD,OACnDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAG+C,kBAAkBxD,SAAQ,SAAAlB,GACvD,EAAKG,WAAWC,QAAQC,MAAML,GAAQb,SAASK,YAAYf,OAASuI,EACpE,EAAK7G,WAAWC,QAAQC,MAAML,GAAQd,QAAQgC,SAAQ,SAAAC,GACpD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQ1C,OAASuI,KAEjD,EAAK9D,qBAAqBlD,MAE5BE,KAAKiD,4BAvaT,sDAqbkC6D,GAAQ,IAAD,OACrCxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQ5C,KAAOyI,KAE/C9G,KAAKoH,gCAzbT,uDA4bmCN,GAAQ,IAAD,OACtCxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQxC,MAAQqI,KAEhD9G,KAAKoH,gCAhcT,wDAmcoCN,GAAQ,IAAD,OACvCxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,IAAMsE,EAAW,EAAKtF,WAAWC,QAAQgB,MAAMD,GACzCtC,EAAmC4G,EAAnC5G,MAAOD,EAA4B6G,EAA5B7G,OAEb,IAAwB,IAFiB6G,EAApB3G,gBAGnB,EAAKqB,WAAWC,QAAQgB,MAAMD,GAAQvC,OAASoI,MAC1C,CACL,GAAInI,GAASD,EACX,GAAIoI,GAAS,EAEXnI,EAAQmI,GADMnI,EAAQD,GAEtBA,EAASoI,EAGb,EAAK7G,WAAWC,QAAQgB,MAAMD,GAAQtC,MAAQA,EAC9C,EAAKsB,WAAWC,QAAQgB,MAAMD,GAAQvC,OAASA,MAInDsB,KAAKoH,gCAvdT,uDA0dmCN,GAAQ,IAAD,OACtCxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,IAAMsE,EAAW,EAAKtF,WAAWC,QAAQgB,MAAMD,GACzCtC,EAAmC4G,EAAnC5G,MAAOD,EAA4B6G,EAA5B7G,OAEb,IAAwB,IAFiB6G,EAApB3G,gBAGnB,EAAKqB,WAAWC,QAAQgB,MAAMD,GAAQtC,MAAQmI,MACzC,CACL,GAAInI,GAASD,GACPoI,GAAS,EAAG,CACd,IAAMK,EAAQzI,EAASC,EACvBA,EAAQmI,EACRpI,EAASoI,EAAQK,EAGrB,EAAKlH,WAAWC,QAAQgB,MAAMD,GAAQtC,MAAQA,EAC9C,EAAKsB,WAAWC,QAAQgB,MAAMD,GAAQvC,OAASA,MAInDsB,KAAKoH,gCA9eT,iEAif6CN,GAAQ,IAAD,OAChDxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQrC,gBAAkBkI,KAE1D9G,KAAKoH,gCArfT,wDAwfoCN,GAAQ,IAAD,OACvCxC,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,EAAKhB,WAAWC,QAAQgB,MAAMD,GAAQ1C,OAASuI,KAEjD9G,KAAKoH,gCA5fT,oDA+fiC,IAAD,OACtBC,EAAoB,GAC1B/C,OAAOC,KAAKvE,KAAKC,WAAWwB,GAAGkD,kBAAkB3D,SAAQ,SAAAC,GACvD,cAAqBqD,OAAOC,KAAK,EAAKtE,WAAWC,QAAQC,OAAzD,eAAiE,CAA5D,IAAML,EAAM,KACf,IACqE,IAAnE,EAAKG,WAAWC,QAAQC,MAAML,GAAQd,QAAQsI,QAAQrG,KAErB,IAA7BoG,EAAQC,QAAQxH,GAAgB,CAClCuH,EAAQlG,KAAKrB,GACb,WAKR,cAAqBuH,EAArB,eAA8B,CAAzB,IAAMvH,EAAM,KACfE,KAAKgD,qBAAqBlD,MA9gBhC,6CA+hByBgH,GACrB9G,KAAKC,WAAWwB,GAAG8F,MAAMC,KAAOV,IAhiBpC,8CAmiB0BA,GACtB9G,KAAKC,WAAWwB,GAAG8F,MAAM9I,MAAQqI,MApiBrC,GAAyCjH,GCF5B4H,EAAb,gMAEQzH,KAAKC,WAAWwB,GAAGiG,sBAAwBtL,EAAeuL,KAC5D3H,KAAKC,WAAWwB,GAAGiG,oBAAsBtL,EAAewL,KAExD5H,KAAKC,WAAWwB,GAAGiG,oBAAsBtL,EAAeuL,OAL9D,kDASQ3H,KAAKC,WAAWwB,GAAGiG,sBAAwBtL,EAAeyL,KAC5D7H,KAAKC,WAAWwB,GAAGiG,oBAAsBtL,EAAewL,KAExD5H,KAAKC,WAAWwB,GAAGiG,oBAAsBtL,EAAeyL,OAZ9D,oDAgBQ7H,KAAKC,WAAWwB,GAAGiG,sBAAwBtL,EAAe0L,WAC5D9H,KAAKC,WAAWwB,GAAGiG,oBAAsBtL,EAAewL,KAExD5H,KAAKC,WAAWwB,GAAGiG,oBAAsBtL,EAAe0L,aAnB9D,qDAuBI9H,KAAKC,WAAWwB,GAAG2B,KAAKC,aAAerD,KAAKC,WAAWwB,GAAG2B,KAAKC,cAvBnE,mDA0BIrD,KAAKC,WAAWwB,GAAG2B,KAAK2E,WAAa/H,KAAKC,WAAWwB,GAAG2B,KAAK2E,YA1BjE,0CA4BsBjB,GAClB9G,KAAKC,WAAWwB,GAAG2B,KAAKzE,MAAQmI,IA7BpC,2CA+BuBA,GACnB9G,KAAKC,WAAWwB,GAAG2B,KAAK1E,OAASoI,IAhCrC,yCAkCqBA,GACjB9G,KAAKC,WAAWwB,GAAG2B,KAAK/E,KAAOyI,IAnCnC,4CAqCwBA,GACpB9G,KAAKC,WAAWwB,GAAG2B,KAAKE,QAAUwD,IAtCtC,sDA0CI9G,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAM7J,SAAW5B,EAAW,EAAG,GAC7DwD,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAM9K,MAAQ,EAC5C6C,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAMC,IAAM,KA5C9C,qDA8CiCpB,GAC7B9G,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAMC,IAAMpB,IA/C9C,qDAiDiCA,GAC7B9G,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAM7J,SAAS3B,EAAIqK,IAlDrD,qDAoDiCA,GAC7B9G,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAM7J,SAAS1B,EAAIoK,IArDrD,oDAuDgCA,GAC5B9G,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAM9K,MAAQ2J,IAxDhD,sDA0DkCA,GAC9B9G,KAAKC,WAAWwB,GAAGuG,WAAWC,MAAME,QAAUrB,MA3DlD,GAAwCtE,gBCA3B4F,EAAb,+LACyB3L,EAAGC,GAAI,IAAD,SACGsD,KAAKC,WAAWwB,GAAG8F,MAAzC9I,EADmB,EACnBA,MAAOJ,EADY,EACZA,KAAMmJ,EADM,EACNA,KACrB,GAAInJ,IAAS/B,EAAU+L,MAAO,CAC5B,IAAMC,EAAa9L,EAAWC,EAAI+K,EAAO,EAAG9K,EAAI8K,EAAM,GACtDlD,OAAOC,KAAKvE,KAAKC,WAAWC,QAAQgB,OAAOF,SAAQ,SAAAC,GACjD,IAAMsE,EAAW,EAAKtF,WAAWC,QAAQgB,MAAMD,GAC/C,GAAIsE,EAAS9G,QAAUA,EAAO,CAC5B,IAAM8J,EAAc/L,EAClB+I,EAASnH,SAAS3B,EAAI8I,EAAS5G,MAAQ,EACvC4G,EAASnH,SAAS1B,EAAI6I,EAAS7G,OAAS,GAE9BpB,EAAyBiL,EAAaD,GACpCd,EAAO,EAAIzK,KAAK0J,IAAIlB,EAAS5G,MAAQ4G,EAAS7G,QAAU,IAEpE,EAAKuB,WAAWC,QAAQgB,MAAMD,GAAQxC,MAAQA,YAf1D,GAAuC+D,gBCiBjCgG,EAAyB,CAC7BtI,QAAS,CACPgB,MAAO,GACPf,MAAO,IAETsB,GAAI,CACFC,aAAc,CACZzC,SAAU,CACRE,gBAAgB,EAChBE,kBAAkB,EAClBH,WAAY,EACZE,aAAc,EACdE,YAAa,CACXjB,KAAMnC,EAAUoC,aAChBC,OAAQ,EACRE,MbnCqB,UaoCrBC,OAAQ,GACRC,MAAO,GACPC,iBAAiB,KAIvB8D,SAAU,CACRC,OAAO,EACPC,oBAAoB,GAEtB4B,iBAAkB,GAClBC,sBAAuB,EACvBE,iBAAkB,GAClBC,sBAAuB,EACvByB,eAAgB,CACd9I,MAAOf,EAAW,EAAG,GACrBgB,IAAKhB,EAAW,EAAG,GACnB8J,eAAe,EACfC,WAAW,GAEbmB,oBAAqBtL,EAAewL,KACpCxE,KAAM,CACJ/E,KAAMhC,EAAeoH,IACrBH,QAAS,GACTD,aAAa,EACb0E,WAAW,EACXpJ,MAAO,GACPD,OAAQ,IAEV6I,MAAO,CACLlJ,KAAM/B,EAAU+L,MAChBb,KAAM,GACN/I,MbpEyB,WasE3BuJ,WAAY,CACVC,MAAO,CACLC,IAAK,GACL/K,MAAO,EACPiB,SAAU5B,EAAW,EAAG,GACxB2L,QAAS,MAIfrF,KAAM3G,EAAWsM,MAGNC,EAAU,CACrBC,KAAMC,+BAAqBzC,GAC3B0C,UAAWD,+BAAqBnG,GAChCqG,QAASF,+BAAqB/D,GAC9BkE,iBAAkBH,+BAAqB9C,GACvCkD,eAAgBJ,+BAAqBxC,GACrC6C,QAASL,+BAAqBhC,GAC9BsC,OAAQN,+BAAqBnB,GAC7B0B,MAAOP,+BAAqBR,IAGjBgB,EAAQC,0BACnBC,gCAAsBnD,EAAkBqC,GACxCc,gCAAsB7G,EAAiC+F,GACvDc,gCAAsBzE,EAAqB2D,GAC3Cc,gCAAsB1C,EAAqB4B,GAC3Cc,gCAAsB7B,EAAoBe,GAC1Cc,gCAAsBxD,EAA8B0C,GACpDc,gCAAsBlD,EAA4BoC,GAClDc,gCAAsBlB,EAAmBI,ICzF9Be,EAAc,SAAC,GAAoB,IAAlBC,EAAiB,EAAjBA,WACtBC,EAAWC,cAEXC,EAAqB,SAAC1D,GAC1BwD,EAASf,EAAQK,iBAAiBa,0BAA0B3D,KAG9D,OACE,yBAAK4D,UAAU,IACb,kBAAC,GAAD,CACEC,MAAO,OACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMC,IAAavL,MAAOlC,IACjD0N,QAAS,kBAAMN,EAAmBxN,EAAWsM,OAC7CyB,WAAYV,IAAerN,EAAWsM,OAGxC,kBAAC,GAAD,CACEqB,MAAO,aACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMI,IAAQ1L,MAAOlC,IAC5C0N,QAAS,kBAAMN,EAAmBxN,EAAW4G,YAC7CmH,WAAYV,IAAerN,EAAW4G,YAGxC,kBAAC,GAAD,CACE+G,MAAO,aACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMI,IAAQ1L,MAAOlC,IAC5C0N,QAAS,kBAAMN,EAAmBxN,EAAWiO,YAC7CF,WAAYV,IAAerN,EAAWiO,YAGxC,kBAAC,GAAD,CACEN,MAAO,UACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMM,IAAQ5L,MAAOlC,IAC5C0N,QAAS,kBAAMN,EAAmBxN,EAAWmO,UAC7CJ,WAAYV,IAAerN,EAAWmO,UAGxC,kBAAC,GAAD,CACER,MAAO,QACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMQ,IAAc9L,MAAOlC,IAClD0N,QAAS,kBAAMN,EAAmBxN,EAAWgN,QAC7Ce,WAAYV,IAAerN,EAAWgN,UAMxCqB,GAAc,SAAC,GAA0C,IAAxCV,EAAuC,EAAvCA,MAAOI,EAAgC,EAAhCA,WAAYD,EAAoB,EAApBA,QAASF,EAAW,EAAXA,KACjD,OACE,yBACEF,UAAS,iDAECK,EAAa,YAAc,GAF5B,kBAITD,QAASA,GAET,0BAAMJ,UAAU,iBAAiBE,GACjC,8BAAOD,K,SCtEAW,GAAoB,SAAChO,EAAGC,GAAc,IAAXgO,EAAU,uDAAN,EAC1C,MAAM,eAAN,OAAsBjO,EAAtB,eAA8BC,EAA9B,eAAsCgO,EAAtC,QAGWC,GAAe,SAAApM,GAC1B,MAAM,UAAN,OAAiBA,EAAjB,SCDWqM,GAAe,SAAC,GAAoB,IAAlBrN,EAAiB,EAAjBA,MAAOC,EAAU,EAAVA,IAG9BmB,EAAQrB,EAAyBC,EAAOC,GACxCe,EAASd,EAAUD,EAAId,EAAIa,EAAMb,EAAGc,EAAIf,EAAIc,EAAMd,GACxD,OACE,yBACEoO,MAAO,CACLnM,OANS,EAOTC,QACAmM,UAAU,GAAD,OAAKL,GACZlN,EAAMd,EAVD,EAWLc,EAAMb,EAXD,GASE,YAGJiO,GAAapM,IAClBwM,gBAAiB,eAEnBlB,UAAU,QAVZ,SCHSmB,GAAc,SAAC,GAC1B,OAAiB,IAD0B,EAAfC,SAEnB,kBAAC,IAAMC,SAAP,MAGF,kBAAC,GAAD,OAGHC,GAAqB,WAAO,IAAD,EAKKC,mBAAsB,CACxD3O,EAAG,EACHC,EAAG,IAP0B,oBAKxB2O,EALwB,KAKZC,EALY,OASCF,mBAAsB,CACpD3O,EAAG,EACHC,EAAG,IAX0B,oBASxB6O,EATwB,KASdC,EATc,OAaWJ,oBAAkB,GAb7B,oBAaxBK,EAbwB,KAaTC,EAbS,KAczBC,EAAUC,iBAAuB,MAWjCC,EAAY,SAACC,GACjB,GAAIL,GACEE,EAAQI,QAAS,CACnB,IAAMC,EAAOL,EAAQI,QAAQE,wBACvBxP,EAAIqP,EAAMI,QAAUF,EAAKG,KACzBzP,EAAIoP,EAAMM,QAAUJ,EAAKK,IAC/Bb,EAAY,CAAE/O,IAAGC,MACjB4P,EAAUjB,EAAYE,GACtBG,GAAiB,KAcjBjC,EAAWC,cAEX4C,EAAY,SAAC/O,EAAoBC,GACrCiM,EAASf,EAAQG,UAAU0D,iBAAiBhP,EAAgBC,KAG9D,OACE,6BACE,yBACEgP,YAzCc,SAACV,GACnB,GAAIH,EAAQI,QAAS,CACnB,IAAMC,EAAOL,EAAQI,QAAQE,wBACvBxP,EAAIqP,EAAMI,QAAUF,EAAKG,KACzBzP,EAAIoP,EAAMM,QAAUJ,EAAKK,IAC/Bf,EAAc,CAAE7O,IAAGC,MACnB8O,EAAY,CAAE/O,IAAGC,MACjBgP,GAAiB,KAmCfG,UAAWA,EACXY,YArBc,SAACX,GACnB,GAAIL,GACEE,EAAQI,QAAS,CACnB,IAAMC,EAAOL,EAAQI,QAAQE,wBACvBxP,EAAIqP,EAAMI,QAAUF,EAAKG,KACzBzP,EAAIoP,EAAMM,QAAUJ,EAAKK,IAC/Bb,EAAY,CAAE/O,IAAGC,QAgBjBgQ,aAAcb,EACdhC,UAAU,mBACV8C,IAAKhB,IAGNF,EACC,6BACE,yBACEZ,MAAO,CACLC,UAAWL,GAAkBY,EAAW5O,EAAG4O,EAAW3O,GACtDiC,MAAO,GACPD,OAAQ,IAEVmL,UAAW,cANb,QAUA,yBACEgB,MAAO,CACLC,UAAWL,GAAkBc,EAAS9O,EAAG8O,EAAS7O,GAClDiC,MAAO,GACPD,OAAQ,IAEVmL,UAAW,YANb,QAUA,kBAAC,GAAD,CAActM,MAAO8N,EAAY7N,IAAK+N,KAEtC,OClGGvC,GAAiB,SAAChL,GAKxB,IACG+J,EAAc/J,EAAd+J,UACF6E,EAAkBhB,iBAAuB,MAEzCrO,EAAQsP,aAAY,SAACC,GACzB,OAAOA,EAAMrL,GAAG4E,eAAe9I,SAG3BC,EAAMqP,aAAY,SAACC,GACvB,OAAOA,EAAMrL,GAAG4E,eAAe7I,OAG3BuP,EAA8BF,aAAY,SAACC,GAC/C,OAAOA,EAAMrL,GAAG4E,eAAeC,iBAGjC,IAAkB,IAAdyB,EACF,OAAO,kBAAC,IAAMmD,SAAP,MAGT,IAAMD,GAA2C,IAAhC8B,EACTP,EAAwCxO,EAAxCwO,YAAaX,EAA2B7N,EAA3B6N,UAAWY,EAAgBzO,EAAhByO,YA0B1B9N,EAAQ5B,KAAKyJ,IAAIhJ,EAAIf,EAAIc,EAAMd,GAC/BiC,EAAS3B,KAAKyJ,IAAIhJ,EAAId,EAAIa,EAAMb,GAChC2P,EAAMtP,KAAK0J,IAAIjJ,EAAIf,EAAGc,EAAMd,GAC5B0P,EAAOpP,KAAK0J,IAAIjJ,EAAId,EAAGa,EAAMb,GAInC,OACE,yBACEmN,UAAW,kBACX8C,IAAKC,EACLJ,YAnCuB,SAACV,GAC1B,GAAIc,EAAgBb,QAAS,CAC3B,IAAMC,EAAOY,EAAgBb,QAAQE,wBAC/BxP,EAAIqP,EAAMI,QAAUF,EAAKG,KACzBzP,EAAIoP,EAAMM,QAAUJ,EAAKK,IAC/BG,EAAY/P,EAAGC,KA+BfmP,UA3BqB,SAACC,GACxBD,KA4BEY,YAzBuB,SAACX,GAC1B,GAAIb,GACE2B,EAAgBb,QAAS,CAC3B,IAAMC,EAAOY,EAAgBb,QAAQE,wBAC/BxP,EAAIqP,EAAMI,QAAUF,EAAKG,KACzBzP,EAAIoP,EAAMM,QAAUJ,EAAKK,IAC/BI,EAAYhQ,EAAGC,KAoBjBmO,MAAO,CACLmC,OAAQ/B,EAAW,GAAK,IAGzBA,EACC,yBACEJ,MAAO,CACLlM,QACAD,SACAuO,gBAAiB,oBACjBC,OAAQ,2BACRpC,UAAWL,GAAkB4B,EAAKF,MAGpC,OCjFGgB,GAAsB,SAAC,GAAmB,IAAjBpF,EAAgB,EAAhBA,UAC9B0B,EAAWC,cAcjB,OACE,kBAAC,GAAD,CACE3B,UAAWA,EACXyE,YAfgB,SAAC/P,EAAGC,GACtB+M,EAASf,EAAQM,eAAeoE,4BAA4B3Q,EAAGC,KAe7D+P,YAZgB,SAAChQ,EAAGC,GACtB+M,EAASf,EAAQM,eAAeqE,4BAA4B5Q,EAAGC,KAY7DmP,UATc,WAChBpC,EAASf,EAAQM,eAAesE,iCCZvBC,GAAsB,SAAC,GAAmB,IAAjBxF,EAAgB,EAAhBA,UAC9B0B,EAAWC,cAcjB,OACE,kBAAC,GAAD,CACE3B,UAAWA,EACXyE,YAfgB,SAAC/P,EAAGC,GACtB+M,EAASf,EAAQM,eAAewE,4BAA4B/Q,EAAGC,KAe7D+P,YAZgB,SAAChQ,EAAGC,GACtB+M,EAASf,EAAQM,eAAeyE,4BAA4BhR,EAAGC,KAY7DmP,UATc,WAChBpC,EAASf,EAAQM,eAAe0E,iCCXvBC,GAAc,SAAC3P,GAMrB,IACG4D,EAAoD5D,EAApD4D,KAAMuG,EAA8CnK,EAA9CmK,QAAS6E,EAAqChP,EAArCgP,OAAQ9C,EAA6BlM,EAA7BkM,WAAY0D,EAAiB5P,EAAjB4P,aACrCC,OAAwBlM,IAAZwG,GAAyBA,GAAW,GAAKA,GAAW,EAChE2F,OAAsBnM,IAAXqL,GAAwBA,GAAU,GAAKA,GAAU,KAE5DvD,EAAWC,cAOXqE,EAActD,GAAkB7I,EAAKxD,SAAS3B,EAAGmF,EAAKxD,SAAS1B,GAC/D6B,EAASqD,EAAKrD,OAASqD,EAAKpD,WAC5BwP,EAAazP,EAAD,kBAAuCA,EAAvC,QAAU,gBACxB0P,EAA8B,CAChCnD,UAAU,GAAD,OAAKiD,EAAL,YAAoBC,GAC7B7F,QAAS0F,EAAY1F,EAAU,EAC/B6E,OAAQc,EAAWd,OAASrL,EAC5BuL,OAAQhD,EAAa,iBAAmB,GACxCvL,MAAM,GAAD,OAAKiD,EAAKjD,MAAV,MACLD,OAAO,GAAD,OAAKkD,EAAKlD,OAAV,MACNsJ,WAAYpG,EAAKnD,OAOnB,OAJImD,EAAKvD,OAASnC,EAAUoC,eAC1B2P,EAAOC,aAAe,QAItB,yBAAKrE,UAAU,YAAYI,QAxBb,WACV2D,GACFnE,EAASf,EAAQG,UAAUsF,mBAAmBvM,EAAK1D,MAsBR2M,MAAOoD,GAApD,SCrCSG,GAAe,SAAC,GAAc,IAAZtL,EAAW,EAAXA,KACvBuL,EAAUvL,IAAS3G,EAAW4G,UAC9BuL,EAAQxL,IAAS3G,EAAWiO,UAC5BwD,EAAe9K,IAAS3G,EAAWiO,UACnClJ,EAAQ2L,aAAY,SAACC,GACzB,OAAOxI,OAAOiK,OAAOzB,EAAM5M,QAAQgB,UAE/ByD,EAAmBkI,aAAY,SAACC,GACpC,OAAOA,EAAMrL,GAAGkD,oBAGlB,OACE,kBAAC,IAAMuG,SAAP,KACGhK,EAAMsN,KAAI,SAAA5M,GACT,OAEE,kBAAC,GAAD,CACEsB,IAAKtB,EAAK1D,GACV0D,KAAMA,EACNuG,QAASkG,EAAU,GAAM,EACzBnE,gBAA0CvI,IAA9BgD,EAAiB/C,EAAK1D,IAClC0P,aAAcA,EACdZ,OAAQqB,EAAU,GAAKC,EAAQ,QAAK3M,S,kBCvBnC8M,GAAwB,SAAC,GAA6B,IAA3BlR,EAA0B,EAA1BA,MAAOC,EAAmB,EAAnBA,IAAKyM,EAAc,EAAdA,QAG5CtL,EAAQrB,EAAyBC,EAAOC,GACxCe,EAASd,EAAUD,EAAId,EAAIa,EAAMb,EAAGc,EAAIf,EAAIc,EAAMd,GAExD,OACE,yBACEoO,MAAO,CACLnM,OAPS,GAQTC,QACAsO,gBAAiB,kBACjBnC,UAAU,GAAD,OAAKL,GACZlN,EAAMd,EAZD,EAaLc,EAAMb,EAbD,GAWE,YAGJiO,GAAapM,IAClBwM,gBAAiB,cACjB2D,OAAQ,UACR1B,OAAQ,IAEV/C,QAASA,EACTJ,UAAU,QAdZ,S,6jBCHG,IAAM8E,GAAuB,SAAC,GAA4B,IAA1B7O,EAAyB,EAAzBA,OAAQvC,EAAiB,EAAjBA,MAAOC,EAAU,EAAVA,IAG9CmB,EAAQrB,EAAyBC,EAAOC,GACxCe,EAASd,EAAUD,EAAId,EAAIa,EAAMb,EAAGc,EAAIf,EAAIc,EAAMd,GAElDgN,EAAWC,cAEXkF,EAAa/B,aAAY,SAACC,GAC9B,OAAOA,EAAMrL,GAAG2B,KAAKC,eAEjBwL,EAAYhC,aAAY,SAACC,GAC7B,OAAOA,EAAMrL,GAAG2B,KAAKzE,SAEjBmQ,EAAYjC,aAAY,SAACC,GAC7B,OAAOA,EAAMrL,GAAG2B,KAAK1E,UAGjBL,EAAOwO,aAAY,SAACC,GACxB,OAAOA,EAAMrL,GAAG2B,KAAK/E,QAnBuC,EAsBlC+M,mBAAS,GAtByB,oBAsBvD5L,EAtBuD,KAsB/CuP,EAtB+C,OAuBlC3D,mBAAS,GAvByB,oBAuBvD3L,EAvBuD,KAuB/CuP,EAvB+C,OAyB3B5D,mBAAuB,MAzBI,oBAyBvDpH,EAzBuD,KAyB5CiL,EAzB4C,OA0B/B7D,mBAAuB,MA1BQ,oBA0BvDnH,EA1BuD,KA0B9CiL,EA1B8C,KAyD9D,OACE,kBAAC,iBAAD,CACEC,QA/BY,SAACC,EAAD,GAAiC,IAA3B3S,EAA0B,EAA1BA,EAAGC,EAAuB,EAAvBA,EACvBoI,QAAQC,IAAI,eAAgBxH,EAAOC,EAAKf,EAAGC,GAC3CqS,EAAUtS,GACVuS,EAAUtS,GACVuS,EAAc,MAAK1R,IACnB2R,EAAY,MAAK1R,KA2Bf6R,OAlBW,SAACD,EAAD,GAAiD,IAA3C3S,EAA0C,EAA1CA,EAAGC,EAAuC,EAAvCA,EAAGwH,EAAoC,EAApCA,OAAQC,EAA4B,EAA5BA,OACjCsF,EACEf,EAAQG,UAAUyG,kBAAkBxP,EAAQ,CAC1CrD,IACAC,IACAwH,SACAC,SACA3E,SACAC,SACAuE,YACAC,cASFsL,OA1BW,SAACH,EAAD,GAAiC,IAA3B3S,EAA0B,EAA1BA,EAAGC,EAAuB,EAAvBA,EACtBoI,QAAQC,IAAI,gBAAiBxH,EAAOC,EAAKf,EAAGC,GAC5CqS,EAAU,GACVC,EAAU,GACVC,EAAc,MACdC,EAAY,OAsBV9L,MACiB,IAAfwL,GAAuBvQ,IAAShC,EAAekH,IAC3C,CAACsL,EAAWC,QACZnN,EAEN6N,UAAU,EACVrS,MAAO,GAEP,yBACE0N,MAAO,CACLnM,OAtEO,GAuEPC,QACAsO,gBAAiB,mBACjBC,OAAQ,8BACRpC,UAAU,GAAD,OAAKL,GACZlN,EAAMd,EA5EH,EA6EHc,EAAMb,EA7EH,GA2EI,YAGJiO,GAAapM,IAClBwM,gBAAiB,cACjB2D,OAAQ,OACR1B,OAAQ,IAEVnD,UAAU,QAdZ,UCpEO4F,GAAc,SAACzR,GAAgD,IAClEkM,EAAqBlM,EAArBkM,WAAYrH,EAAS7E,EAAT6E,KACd4G,EAAWC,cAYXkF,EAAa/B,aAAY,SAACC,GAC9B,OAAOA,EAAMrL,GAAG2B,KAAKC,eAEjBwL,EAAYhC,aAAY,SAACC,GAC7B,OAAOA,EAAMrL,GAAG2B,KAAKzE,SAEjBmQ,EAAYjC,aAAY,SAACC,GAC7B,OAAOA,EAAMrL,GAAG2B,KAAK1E,UAEjBL,EAAOwO,aAAY,SAACC,GACxB,OAAOA,EAAMrL,GAAG2B,KAAK/E,QAEvB,OACE,6BACE,kBAAC,iBAAD,CAEEgR,OA3ByB,SAACD,EAAD,GAAiC,IAA3B3S,EAA0B,EAA1BA,EAAGC,EAAuB,EAAvBA,EACtC+M,EAASf,EAAQG,UAAU6G,wBAAwB7M,EAAK3E,GAAI,CAAEzB,IAAGC,QA4B7D0G,MAAqB,IAAfwL,GAAuBvQ,IAAShC,EAAekH,IAAM,CAACsL,EAAWC,QAAanN,EACpFxE,MAAO,EACPqS,UAAU,GAEV,yBACE3E,MAAO,CACLC,UAAWL,GAAkB5H,EAAKtF,MAAMd,EAAGoG,EAAKtF,MAAMb,GACtDsQ,QAAuB,IAAf9C,EAAsB,GAAK,GACnCvL,MA5BQ,GA6BRD,OA5BS,IA8BXmL,UAAW,cAPb,SAaF,kBAAC,iBAAD,CAEEwF,OA7CuB,SAACD,EAAD,GAAiC,IAA3B3S,EAA0B,EAA1BA,EAAGC,EAAuB,EAAvBA,EACpC+M,EAASf,EAAQG,UAAU8G,sBAAsB9M,EAAK3E,GAAI,CAAEzB,IAAGC,QA8C3D0G,MAAqB,IAAfwL,GAAuBvQ,IAAShC,EAAekH,IAAM,CAACsL,EAAWC,QAAanN,EACpF6N,UAAU,EACVrS,MAAO,GAEP,yBACE0N,MAAO,CACLC,UAAWL,GAAkB5H,EAAKrF,IAAIf,EAAGoG,EAAKrF,IAAId,GAClDsQ,QAAuB,IAAf9C,EAAsB,GAAK,GACnCvL,MAjDQ,GAkDRD,OAjDS,IAmDXmL,UAAW,iBAPb,UAac,IAAfK,EACC,kBAAC,GAAD,CACE3M,MAAOsF,EAAKtF,MACZC,IAAKqF,EAAKrF,IACVsC,OAAQ+C,EAAK3E,KAGf,kBAAC,GAAD,CACEX,MAAOsF,EAAKtF,MACZC,IAAKqF,EAAKrF,IACVyM,QAvEQ,WACdR,EAASf,EAAQG,UAAUnE,mBAAmB7B,EAAK3E,QA0EjD,kBAAC,GAAD,CAAcX,MAAOsF,EAAKtF,MAAOC,IAAKqF,EAAKrF,Q,SCzFpCoS,GAAiB,SAAC,GAAiC,IAA/BzP,EAA8B,EAA9BA,MAAOqE,EAAuB,EAAvBA,iBACtC,OACE,kBAAC,KAAD,CAAaqL,QAASC,MACnB3P,EAAMqO,KAAI,SAAA3L,GACT,OACE,kBAAC,GAAD,CACEK,IAAKL,EAAK3E,GACV2E,KAAMA,EACNqH,gBAA0CvI,IAA9B6C,EAAiB3B,EAAK3E,WCTjC6R,GAAoB,SAAC/R,GAA2B,IACnD6E,EAAS7E,EAAT6E,KACR,OACE,6BACE,kBAAC,GAAD,CAActF,MAAOsF,EAAKtF,MAAOC,IAAKqF,EAAKrF,QCFpCwS,GAAe,SAAC,GAAc,IAAZlN,EAAW,EAAXA,KACvBmN,EAAanN,IAAS3G,EAAW4G,UACjC5C,EAAQ0M,aAAY,SAACC,GACzB,OAAOxI,OAAOiK,OAAOzB,EAAM5M,QAAQC,UAE/BqE,EAAmBqI,aAAY,SAACC,GACpC,OAAOA,EAAMrL,GAAG+C,oBAKlB,OAFiB1B,IAAS3G,EAAWsM,KAG5B,kBAAC,IAAMyC,SAAP,MAGL+E,EACK,kBAAC,GAAD,CAAgB9P,MAAOA,EAAOqE,iBAAkBA,IAIvD,kBAAC,IAAM0G,SAAP,KACG/K,EAAMqO,KAAI,SAAA3L,GACT,OAAO,kBAAC,GAAD,CAAmBK,IAAKL,EAAK3E,GAAI2E,KAAMA,SCpBzCqN,GAAoB,SAAC,GAA0B,IAAxBC,EAAuB,EAAvBA,SAAUd,EAAa,EAAbA,OACpC5S,EAAe0T,EAAf1T,EAAGC,EAAYyT,EAAZzT,EAAG0T,EAASD,EAATC,EAAGC,EAAMF,EAANE,EAEXzB,EAAa/B,aAAY,SAACC,GAC9B,OAAOA,EAAMrL,GAAG2B,KAAKC,eAEjBwL,EAAYhC,aAAY,SAACC,GAC7B,OAAOA,EAAMrL,GAAG2B,KAAKzE,SAEjBmQ,EAAYjC,aAAY,SAACC,GAC7B,OAAOA,EAAMrL,GAAG2B,KAAK1E,UAGjBL,EAAOwO,aAAY,SAACC,GACxB,OAAOA,EAAMrL,GAAG2B,KAAK/E,QAGvB,OACE,kBAAC,KAAD,CAAawR,QAASC,MACpB,kBAAC,iBAAD,CAEET,OAAQA,EAERjM,MACiB,IAAfwL,GAAuBvQ,IAAShC,EAAekH,IAC3C,CAACsL,EAAWC,QACZnN,EAENxE,MAAO,EACPqS,UAAU,GAEV,yBACE3E,MAAO,CACLzM,SAAU,WACViO,IAAK,EACLF,KAAM,EACNxN,MAAOyR,EACP1R,OAAQ2R,EACRvF,UAAWL,GAAkBhO,EAAGC,GAChCyL,QAAS,EACT6E,OAAQ,GACRE,OAAQ,6BACRlF,WAAY,mBACZ0G,OAAQ,SAZZ,WChBK4B,GAAmB,SAACxD,GAC/B,OAAOxI,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkBgK,KAAI,SAAA1O,GAChD,OAAOgN,EAAM5M,QAAQC,MAAML,OCRlByQ,GAA4BC,IAAMC,MAVd,SAAC,GAA8B,EAA5BhM,sBAA6B,IACzDgF,EAAWC,cAEXyG,EDRiC,SAACO,GACxC,IAAIC,EAAeC,OAAOC,iBACtBC,GAA0C,EAA3BF,OAAOC,iBACtBE,EAAeH,OAAOC,iBACtBG,GAA0C,EAA3BJ,OAAOC,iBAS1B,OARAH,EAAc1P,SAAQ,SAAA6B,GACpB,IAAMtF,EAAQsF,EAAKtF,MACbC,EAAMqF,EAAKrF,IACjBmT,EAAO5T,KAAK0J,IAAIkK,EAAMpT,EAAMd,EAAGe,EAAIf,GACnCqU,EAAO/T,KAAK2J,IAAIoK,EAAMvT,EAAMd,EAAGe,EAAIf,GACnCsU,EAAOhU,KAAK0J,IAAIsK,EAAMxT,EAAMb,EAAGc,EAAId,GACnCsU,EAAOjU,KAAK2J,IAAIsK,EAAMzT,EAAMb,EAAGc,EAAId,MAE9B,CACLD,EAAGkU,EACHjU,EAAGqU,EACHX,EAAGU,EAAOH,EAAO,GACjBN,EAAGW,EAAOD,EAAO,ICTFE,CADKpE,YAAYyD,KAKlC,OAAO,kBAAC,GAAD,CAAmBH,SAAUA,EAAUd,OAHrB,SAACD,EAAD,GAA2C,IAArClL,EAAoC,EAApCA,OAAQC,EAA4B,EAA5BA,OACrCsF,EAASf,EAAQG,UAAUqI,uBAAuB,CAAEhN,SAAQC,kBCTnDgN,GAAoB,SAAC,GAAkB,IAAhBhB,EAAe,EAAfA,SAC1B1T,EAAe0T,EAAf1T,EAAGC,EAAYyT,EAAZzT,EAAG0T,EAASD,EAATC,EAAGC,EAAMF,EAANE,EACjB,OACE,yBACExF,MAAO,CACLzM,SAAU,WACViO,IAAK,EACLF,KAAM,EACNxN,MAAOyR,EACP1R,OAAQ2R,EACRvF,UAAWL,GAAkBhO,EAAGC,GAChCyL,QAAS,EACT6E,OAAQ,GACRE,OAAQ,6BACRlF,WAAY,qBAXhB,SCmBSoJ,GAAmB,SAACtE,GAC/B,OAAOxI,OAAOC,KAAKuI,EAAMrL,GAAGkD,kBAAkB6J,KAAI,SAAAvN,GAChD,OAAO6L,EAAM5M,QAAQgB,MAAMD,OCZlBoQ,GAA4Bb,IAAMC,MAPd,SAAC,GAA8B,EAA5B7L,sBAA6B,IAEzDuL,EDRiC,SAACmB,GACxC,IAAIX,EAAeC,OAAOC,iBACtBC,GAA0C,EAA3BF,OAAOC,iBACtBE,EAAeH,OAAOC,iBACtBG,GAA0C,EAA3BJ,OAAOC,iBAW1B,OAVAS,EAActQ,SAAQ,SAAAY,GACpB,IAAMpC,EAASoC,EAAKxD,SAAS3B,EACvBiD,EAAOkC,EAAKxD,SAAS3B,EAAI,GACzBgD,EAASmC,EAAKxD,SAAS1B,EACvBiD,EAAOiC,EAAKxD,SAAS1B,EAAI,GAC/BiU,EAAO5T,KAAK0J,IAAIkK,EAAMnR,EAAQE,GAC9BoR,EAAO/T,KAAK2J,IAAIoK,EAAMtR,EAAQE,GAC9BqR,EAAOhU,KAAK0J,IAAIsK,EAAMtR,EAAQE,GAC9BqR,EAAOjU,KAAK2J,IAAIsK,EAAMvR,EAAQE,MAEzB,CACLlD,EAAGkU,EACHjU,EAAGqU,EACHX,EAAGU,EAAOH,EAAO,GACjBN,EAAGW,EAAOD,EAAO,ICXFQ,CADI1E,YAAYuE,KAGjC,OAAO,kBAAC,GAAD,CAAmBjB,SAAUA,OCNzBqB,GAA4B,SAAC,GAAc,IAAZ1O,EAAW,EAAXA,KACpC8B,EAAwBiI,aAAY,SAACC,GACzC,OAAOA,EAAMrL,GAAGmD,yBAGZH,EAAwBoI,aAAY,SAACC,GACzC,OAAOA,EAAMrL,GAAGgD,yBAGlB,OAAI3B,IAAS3G,EAAWiO,WAAaxF,GAAyB,EAE1D,kBAACyM,GAAD,CACEzM,sBAAuBA,IAKzB9B,IAAS3G,EAAW4G,WAAa0B,GAAyB,EAE1D,kBAAC8L,GAAD,CACE9L,sBAAuBA,IAItB,kBAAC,IAAMyG,SAAP,O,wOCzBF,I,GAAMuG,GAAmB,SAAC,GAAc,IAAZ7P,EAAW,EAAXA,KAC3B8P,EAAc3T,E,2VAAU,IACzB6D,EADwB,CAE3BxD,SAAU5B,EAAW,EAAG,MAE1B,OACE,yBACEqO,MAAO,CACL8G,UAAW,OACXC,aAAc,OACdC,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZrT,OAAQ,QACRsT,UAAW,eAGb,yBACEnH,MAAO,CACLzM,SAAU,WACViO,IAAI,GAAD,QAAO,EAAIzK,EAAKlD,OAAU,EAA1B,MACHyN,KAAK,GAAD,QAAO,EAAIvK,EAAKjD,MAAS,EAAzB,QAGN,kBAAC,GAAD,CACEiD,KAAM8P,EACNxH,YAAY,EACZ0D,cAAc,OC9BXqE,GAAe,SAAC,GAAsC,IAApCnI,EAAmC,EAAnCA,MAAOC,EAA4B,EAA5BA,KAAMjD,EAAsB,EAAtBA,MAAOoL,EAAe,EAAfA,SACjD,OACE,yBACErI,UAAW,WACXI,QAASiI,EACTrH,MAAO,CAAE6D,OAAQ,YAEjB,yBAAK7E,UAAU,SACZE,EACC,yBACEc,MAAO,CACLlM,MAAO,OACPkT,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZrT,OAAQ,OACRyT,YAAa,SAGdpI,GAED,KACHD,EAAQ,6BAAMA,GAAe,MAGhC,yBACEe,MAAO,CACLgH,QAAS,OACTO,cAAe,MACfN,eAAgB,WAChBC,WAAY,SACZC,UAAW,aACXK,YAAa,OACbC,aAAc,OACd3T,MAAO,SAGT,kCAAgBgD,IAAVmF,EAAsBA,EAAQ,QCpC/ByL,GAAkB,SAAC,GAAyC,IAAvCC,EAAsC,EAAtCA,SAAU1I,EAA4B,EAA5BA,MAAOC,EAAqB,EAArBA,KAAM0I,EAAe,EAAfA,SAAe,EAC9BrH,oBAAS,GADqB,oBAC/DsH,EAD+D,KACjDC,EADiD,KAKtE,OACE,yBACE9H,MAAO,CAEL+H,UAAW,sBAGb,kBAAC,GAAD,CACE9I,MAAOA,EACPoI,SAZW,WACfS,GAAiBD,IAYb3I,KAAMA,EACNjD,MAAO0L,KAGS,IAAjBE,EACC,yBAAK7H,MAAO,CAAE7C,WAAY,SAAWwI,IAAMqC,aAAaJ,IACtD,O,iBCrBGK,GAAmB,SAAC,GAAkC,EAAhChM,MAAiC,IAA1BiM,EAAyB,EAAzBA,SAClCC,GAD2D,qCAClD,CACb,CACEC,KAAa,KACbA,KAAa,KACbA,KAAa,KACbA,KAAa,KACbA,KAAa,MAEf,CACEA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,MAEhB,CACEA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,MAElB,CACEA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,MAEtB,CACEA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,MAElB,CACEA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,MAEhB,CACEA,KAAmB,KACnBA,KAAmB,KACnBA,KAAmB,KACnBA,KAAmB,KACnBA,KAAmB,MAErB,CACEA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,MAEhB,CACEA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,MAEhB,CACE,UACAA,KAAe,KACfA,KAAe,KACfA,KAAe,KACfA,KAAe,MAEjB,CACEA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,MAEtB,CACEA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,KACdA,KAAc,MAEhB,CACEA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,MAElB,CACEA,KAAe,KACfA,KAAe,KACfA,KAAe,KACfA,KAAe,KACfA,KAAe,MAEjB,CACEA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,KAChBA,KAAgB,MAElB,CACEA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,KACpBA,KAAoB,MAEtB,CACEA,KAAe,KACfA,KAAe,KACfA,KAAe,KACfA,KAAe,KACfA,KAAe,MAEjB,CACEA,KAAkB,KAClBA,KAAkB,KAClBA,KAAkB,KAClBA,KAAkB,KAClBA,KAAkB,MAEpB,CAAC,UAAW,UAAW,UAAW,UAAW,aAE/C,OACE,yBACEpI,MAAO,CACLlM,MAAO,OACPuU,WAAY,OACZC,cAAe,OACfd,YAAa,OACbC,aAAc,SAGhB,kBAAC,GAAD,CAAoBU,OAAQA,EAAQ/I,QAAS8I,MAgB7CK,GAAqB,SAAC,GAAyB,IAAvBJ,EAAsB,EAAtBA,OAAQ/I,EAAc,EAAdA,QACpC,OACE,6BACE,yBACEY,MAAO,CACLgH,QAAS,OACTC,eAAgB,aAChBC,WAAY,SACZsB,SAAU,SAGXL,EAAOxE,KAAI,SAAA8E,GACV,OACE,yBAAKpQ,IAAKoQ,EAAMC,WAAY1I,MAAO,CAAE+G,aAAc,SAChD0B,EAAM9E,KAAI,SAAA/P,GACT,OACE,yBACEyE,IAAKzE,EACLoM,MAAO,CACL6D,OAAQ,UACRxB,OAAQ,wBACR8E,UAAW,eAGb,yBACE/H,QAAS,kBAAMA,EAAQxL,IACvBoM,MAAO,CACLmH,UAAW,aACXhK,WAAYvJ,EACZE,MAAO,OACPD,OAAQ,OACRwP,aAAc,OACdhB,OAAQ,qBC7LnBsG,GAAa,SAAC,GAAoC,IAAlC1M,EAAiC,EAAjCA,MAAOoD,EAA0B,EAA1BA,WAAYD,EAAc,EAAdA,QAC9C,OACE,yBAAKY,MAAO,CAAEqC,OAAQ,0BACpB,yBACEjD,QAASA,EAAU,kBAAMA,EAAQnD,SAASnF,EAC1CkJ,MAAO,CACLlM,MAAO,GACPD,OAAQ,GACRsJ,WAAYlB,EACZ8K,aAAc,EACdO,YAAa,EACbjF,OAAqB,iBACrBuG,UAAWvJ,EACP,4BACA,mCCRDwJ,GAAgB,SAAC,GAAyB,IAAvB5M,EAAsB,EAAtBA,MAAOiM,EAAe,EAAfA,SACrC,OACE,kBAAC,GAAD,CACEP,SACE,kBAAC,GAAD,CAAY1L,MAAOA,EAAOoD,YAAY,EAAOD,aAAStI,IAExDmI,MAAO,QACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAM4J,IAAWlV,MAAOlC,EAAUiL,KAAM,QAE/D,kBAAC,GAAD,CAAkBV,MAAOA,EAAOiM,SAAUA,MCZnCa,IAAc,qBACxB1X,EAAUoC,aAAe,UADD,eAExBpC,EAAU2X,eAAiB,kBAFH,IAKdC,GAAsB,SAAC,GAAyB,IAAvBhN,EAAsB,EAAtBA,MAAOiM,EAAe,EAAfA,SAC3C,OACE,kBAAC,GAAD,CACEgB,MAAOH,GACPI,aAAclN,EACdmD,QAAS8I,KAKTkB,GAA4B,SAAC,GAAsC,IAApCF,EAAmC,EAAnCA,MAAOC,EAA4B,EAA5BA,aAAc/J,EAAc,EAAdA,QAExD,OADAnF,QAAQC,IAAI,YAAagP,GAEvB,yBAAKlK,UAAU,WAAWgB,MAAO,IAC/B,yBAAKhB,UAAU,UACf,yBACEgB,MAAO,CACLgH,QAAS,OACTO,cAAe,MACfN,eAAgB,aAChBC,WAAY,SACZC,UAAW,aACXK,YAAa,OACbC,aAAc,OACd3T,MAAO,SAGR2F,OAAOC,KAAKwP,GAAOvF,KAAI,SAACnQ,EAAM6V,GAC7B,OACE,kBAAC,GAAD,CACEnK,KAAMgK,EAAM1V,GACZA,KAAMA,EACN6E,IAAKgR,EACLhK,WAAY8J,IAAiB3V,EAC7B4L,QAASA,UASVkK,GAAkB,SAAC,GAAyC,IAAvCpK,EAAsC,EAAtCA,KAAM1L,EAAgC,EAAhCA,KAAM6L,EAA0B,EAA1BA,WAAYD,EAAc,EAAdA,QACxD,OACE,yBAAKY,MAAO,CAAEqC,OAAQ,0BACpB,yBACEjD,QAASA,EAAU,kBAAMA,EAAQ5L,SAAQsD,EACzCkJ,MAAO,CACLlM,MAAO,GACPD,OAAQ,GACRsJ,WAAY,OACZ4J,aAAc,EACdO,YAAa,EACbjF,OAAqB,iBACrBuG,UAAWvJ,EACP,4BACA,8BACJ2H,QAAS,OACTC,eAAgB,SAChBC,WAAY,WAGJ,WAAThI,EAAoB,kBAAC,IAAD,CAAiBA,KAAMqK,MAAe,KACjD,mBAATrK,EAA4B,kBAAC,IAAD,CAAiBA,KAAMsK,MAAe,QC/D9DC,GAAmB,SAAC,GAAyB,IAAvBxN,EAAsB,EAAtBA,MAAOiM,EAAe,EAAfA,SACxC,OACE,kBAAC,GAAD,CACEP,SACE,kBAAC,GAAD,CACEzI,KAAMjD,EAAQ8M,GAAe9M,QAASnF,EACtCtD,KAAMyI,EACNoD,YAAY,EACZD,aAAStI,IAGbmI,MAAO,OACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMwK,IAAU9V,MAAOlC,EAAUiL,KAAM,QAE9D,kBAAC,GAAD,CAAqBV,MAAOA,EAAOiM,SAAUA,M,iBCrBtCyB,GAAoBC,aAAwBC,MAE5CC,GAAc,SAAC,GAAmC,IAAjC7N,EAAgC,EAAhCA,MAAOiM,EAAyB,EAAzBA,SAAa/U,EAAY,qCAC5D,OACE,yBACE6M,MAAO,CACL7C,WAAY,OACZrJ,MAAO,OACPuU,WAAY,OACZC,cAAe,OACfd,YAAa,OACbC,aAAc,SAGhB,kBAACkC,GAAD,eACE9N,IAAK,IACLD,IAAK,EACLmO,KAAM,EACN9N,MAAOA,EACPiM,SAAU,SAAAjM,GAAK,OAAIiM,EAASjM,IAC5B+N,aAAc,GACdC,MAAO,CACLC,EAAG,IACHC,GAAI,KACJC,IAAK,QAEHjX,MC5BCkX,GAAgB,SAAC,GAA4C,IAA1CpL,EAAyC,EAAzCA,MAAOhD,EAAkC,EAAlCA,MAAOiM,EAA2B,EAA3BA,SAAUoC,EAAiB,EAAjBA,WACtD,OACE,yBAAKtL,UAAW,YACd,yBAAKA,UAAU,SAASC,GACxB,2BACEzL,KAAK,WACLmR,SAAU2F,EACVrO,OAAiB,IAAVA,EAAiB,EAAI,EAC5BsO,SAAmB,IAAVtO,EACTiM,SAAU,SAAAjH,GAAK,OAAIiH,EAAgC,MAAvBjH,EAAMuJ,OAAOvO,YCHpCwO,GAAsB,SAAC,GAK7B,IAJLjW,EAII,EAJJA,iBACAD,EAGI,EAHJA,aACAmW,EAEI,EAFJA,sBACAC,EACI,EADJA,0BAEM1L,GACiB,IAArBzK,EACI,YACiBsC,IAAjBvC,EACA,IACAA,EACN,OACE,kBAAC,GAAD,CACEoT,SAAU1I,EACVA,MAAO,UACPC,KACE,kBAAC,IAAD,CACEA,KAAM0L,IACNhX,MAAOlC,EACPiL,KAAM,KACNqD,MAAO,CAAEC,UAAW,oBAIxB,6BACE,yBAAKD,MAAO,CAAElM,MAAO,SACnB,kBAAC,GAAD,CACEmL,MAAO,QACPhD,MAAOzH,EACP0T,SAAUyC,EACVL,YAAY,KAIhB,yBACEtK,MAAO,CACLlM,MAAO,OACPuU,WAAY,OACZC,cAAe,OACfd,YAAa,OACbC,aAAc,SAGhB,kBAACkC,GAAD,CACE9N,IAAK,IACLD,IAAK,EACLmO,KAAM,EACN9N,MAAO1H,EACPoQ,UAA+B,IAArBnQ,EACV0T,SAAU,SAAAjM,GAAK,OAAIyO,EAAsBzO,IACzC+N,aAAc,GACdC,MAAO,CACLC,EAAG,IACHC,GAAI,KACJC,IAAK,aCvDNS,GAAoB,SAAC,GAK3B,IAAD,EAJJvW,EAII,EAJJA,eACAD,EAGI,EAHJA,WACAyW,EAEI,EAFJA,oBACAC,EACI,EADJA,wBAEM9L,GACe,IAAnB3K,EACI,YACewC,IAAfzC,EACA,IACAA,EAGN,OACE,kBAAC,GAAD,CACEsT,SAAU1I,EACVA,MAAO,SACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAM8L,IAAWpX,MAAOlC,EAAUiL,KAAM,QAE/D,6BACE,yBAAKqD,MAAO,CAAElM,MAAO,SACnB,kBAAC,GAAD,CACEmL,MAAO,QACPhD,MAAO3H,EACP4T,SAAU6C,EACVT,YAAY,KAIhB,yBACEtK,MAAO,CACLlM,MAAO,OACPuU,WAAY,OACZC,cAAe,OACfd,YAAa,OACbC,aAAc,SAGhB,kBAACkC,GAAD,CACE9N,IA3BE,IA4BFD,IAAK,EACLmO,KAAM,EACN9N,MAAO5H,EACPsQ,UAA6B,IAAnBrQ,EACV4T,SAAU,SAAAjM,GAAK,OAAI6O,EAAoB7O,IACvC+N,aAAc,GACdC,OAAK,GACHgB,EAAG,KADA,cAEFpP,IAFE,UAEWA,MAFX,cAlCH,IAkCG,UAlCH,MAkCG,SCnDJ8N,GAAoBC,aAAwBC,MAE5CqB,GAAuB,SAAC,GAAsC,IAApCjP,EAAmC,EAAnCA,MAAOiM,EAA4B,EAA5BA,SAAUjJ,EAAkB,EAAlBA,MAAOC,EAAW,EAAXA,KAC7D,OACE,yBACEF,UAAW,WACXgB,MAAO,CACLqI,WAAY,OACZC,cAAe,OACfd,YAAa,OACbC,aAAc,OACdT,QAAS,OACTO,cAAe,MACfN,eAAgB,gBAChB9J,WAAY,OACZgO,aAAc,IAGhB,yBAAKnM,UAAU,QAAQgB,MAAO,CAAEoL,QAAS,EAAGtX,MAAO,UAChDoL,EACC,yBACEc,MAAO,CACLlM,MAAO,OACPkT,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZrT,OAAQ,OACRyT,YAAa,SAGdpI,GAED,KACHD,EAAQ,6BAAMA,GAAe,MAGhC,yBACEe,MAAO,CACLmH,UAAW,aACXkE,SAAU,EACV5D,aAAc,OACda,cAAe,SAGjB,kBAAC,GAAD,CACEzM,IAAK,IACLD,IAAK,EACLmO,KAAM,EACN9N,MAAOA,EACPiM,SAAU,SAAAjM,GAAK,OAAIiM,EAASjM,IAC5B+N,aAAc,GACdC,MAAO,CACLC,EAAG,IACHC,GAAI,KACJC,IAAK,YC1CJkB,GAAyB,SAAC,GAOhC,IANLzX,EAMI,EANJA,OACAC,EAKI,EALJA,MACAC,EAII,EAJJA,gBACAwX,EAGI,EAHJA,oBACAC,EAEI,EAFJA,mBACAC,EACI,EADJA,yBAEMC,EAAS,SAAAzP,GAAK,OAClBA,EAAM0P,oBAAe7U,EAAW,CAC9B8U,sBAAuB,EACvB5L,MAAO,aAEL/D,EAAK,UAAMyP,EAAO5X,GAAb,cAAyB4X,EAAO7X,IAC3C,OACE,6BACE,kBAAC,GAAD,CACE8T,SAAU1L,EACVgD,MAAO,OACPC,KACE,kBAAC,IAAD,CACEA,KAAM2M,IACNjY,MAAOlC,EACPiL,KAAM,QAIV,6BACE,yBAAKqD,MAAO,CAAElM,MAAO,OAAQqJ,WAAY,SACvC,kBAAC,GAAD,CACE8B,MACE,yBACEe,MAAO,CACLgH,QAAS,OACTwB,SAAU,SACVvB,eAAgB,UAGlB,yBACEjH,MAAO,CACLlM,MAAO,OACPkT,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZrT,OAAQ,OACRyT,YAAa,OACbnK,WAAY,SAGd,kBAAC,IAAD,CACE+B,MAA0B,IAApBnL,EAA2B+X,IAASC,IAC1CnY,MAAOlC,EACPiL,KAAM,QAGV,mDAGJV,MAAOlI,EACPmU,SAAUuD,EACVnB,YAAY,KAIhB,kBAAC,GAAD,CACErL,MAAO,QACPC,KACE,kBAAC,IAAD,CACEA,KAAM8M,IACNpY,MAAOlC,EACPiL,KAAM,OAGVV,MAAOnI,EACPoU,SAAUsD,IAGZ,kBAAC,GAAD,CACEvM,MAAO,SACPC,KACE,kBAAC,IAAD,CACEA,KAAM+M,IACNrY,MAAOlC,EACPiL,KAAM,OAGVV,MAAOpI,EACPqU,SAAUqD,QClGTW,GAAqB,SAAC,GAAoC,IAAlCC,EAAiC,EAAjCA,SAAUC,EAAuB,EAAvBA,QAASC,EAAc,EAAdA,QACtD,OACE,yBACErN,UAAU,WACVgB,MAAO,CAAEwH,YAAa,OAAQC,aAAc,SAE5C,yBAAKzI,UAAU,oBACb,yBAAKA,UAAU,WACb,yBAAKA,UAAS,WAAcI,QAAS+M,GACnC,0BAAMnN,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAMoN,IAAS1Y,MAAOlC,KAEzC,0CAIJ,yBAAKsN,UAAU,WACb,yBAAKA,UAAS,WAAcI,QAASgN,GACnC,0BAAMpN,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAMqN,IAAS3Y,MAAOlC,KAEzC,yCAIJ,yBAAKsN,UAAU,WACb,yBAAKA,UAAS,WAAcI,QAASiN,GACnC,0BAAMrN,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAMsN,IAAS5Y,MAAOlC,KAEzC,kD,SC3BC+a,GAAqB,SAAC,GAAyB,IAAvBxQ,EAAsB,EAAtBA,MAAOiM,EAAe,EAAfA,SAC1C,OACE,kBAAC,GAAD,CACEP,SAAQ,UAAK1L,EAAL,OACRgD,MAAO,SACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMwN,IAAW9Y,MAAOlC,EAAUiL,KAAM,QAE/D,kBAAC,IAAM0D,SAAP,KACE,kBAAC,GAAD,CACEpE,MAAOA,EACPiM,SAAU,SAAAjM,GACRhC,QAAQC,IAAI,cAAe+B,GAC3BiM,EAASjM,IAEXJ,IAAK,IACLD,KAAM,IACNoO,aAAc,EACdC,MAAO,CACL,OAAQ,OACR,EAAK,IACL,IAAO,SAGX,kBAAC,KAAD,CACE0C,OAAQ,MACRC,eAAe,EACfC,sBAAsB,EACtB5Q,MAAOA,EACP6Q,cAAe,SAAA7L,GACbiH,EAASjH,EAAM8L,aAEjBC,YAAY,OACZhN,MAAO,CACLpM,MAAO,UACPqZ,UAAW,SACX5K,OAAQ,oBACR6K,WAAY,wBACZC,SAAU,MACVC,WAAY,IACZC,WAAY,MACZjC,QAAS,WACTrE,aAAc,OACdD,UAAW,YCnCVwG,GAAmB,SAAC,GAC/B,OAAkB,IAD+B,EAAhBpQ,UAExB,kBAAC,GAAD,MAGF,kBAAC,IAAMmD,SAAP,OAGHkN,GAA0B,SAAC,GAI/B,OAJuC,gBACnBvL,aAAY,SAACC,GAC/B,OAAOA,EAAMrL,GAAGgD,uBAAyB,KAGlC,kBAAC,GAAD,MAEF,kBAAC,IAAMyG,SAAP,OAGHmN,GAAU,WACd,OACE,kBAAC,IAAMnN,SAAP,KACE,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,QAKAoN,GAAc,WAClB,IAAM7O,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAMhN,EAASwE,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkB,GACtD,OAAOsI,EAAM5M,QAAQC,MAAML,MAE7B,IAAK0S,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAPe,IAShBjM,EAAauT,EAAbvT,SAER,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAGT,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAaT,OACE,kBAAC,GAAD,CACEpE,MAAO7H,EAASK,YAAYf,OAC5BwU,SAbyB,SAAAjM,GAC3B,IAAIZ,EAAWY,OACDnF,IAAVmF,GAAiC,OAAVA,IAAmC,IAAjByR,MAAMzR,KACjDZ,EAAW,GAEbuD,EACEf,EAAQO,QAAQuP,8CAA8CtS,QAY9DuS,GAAW,WACf,IAAMhP,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAMhN,EAASwE,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkB,GACtD,OAAOsI,EAAM5M,QAAQC,MAAML,MAE7B,IAAK0S,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAPY,IASbjM,EAAauT,EAAbvT,SAmBR,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAET,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAET,IAAMvM,EAAQM,EAASK,YAAYX,MAAQM,EAASK,YAAYX,MAAQ,GAClED,EAASO,EAASK,YAAYZ,OAASO,EAASK,YAAYZ,OAAS,GACrEE,IAAkBK,EAASK,YAAYV,iBACzCK,EAASK,YAAYV,gBAGzB,OACE,6BACE,kBAAC,GAAD,CACEF,OAAQA,EACRC,MAAOA,EACPC,gBAAiBA,EACjBwX,oBA9BsB,SAAAtP,GAC1B2C,EACEf,EAAQO,QAAQyP,8CAA8C5R,KA6B5DuP,mBApCqB,SAAAvP,GACzB2C,EACEf,EAAQO,QAAQ0P,6CAA6C7R,KAmC3DwP,yBA3B2B,SAAAxP,GAC/B2C,EACEf,EAAQO,QAAQ2P,uDACd9R,SA8BF+R,GAAa,WACjB,IAAMpP,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAMhN,EAASwE,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkB,GACtD,OAAOsI,EAAM5M,QAAQC,MAAML,MAE7B,IAAK0S,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAPc,IASfjM,EAAauT,EAAbvT,SAER,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAoBT,OACE,kBAAC,GAAD,CACE/L,eAAgBF,EAASE,eACzBD,WAAYD,EAASC,WACrB0W,wBAV4B,SAAA9O,GAC9B2C,EACEf,EAAQO,QAAQ6P,mDAAmDhS,KASnE6O,oBAtBwB,SAAA7O,GACrBA,GAGL2C,EACEf,EAAQO,QAAQ8P,+CACdnI,OAAO9J,SAqBTkS,GAAe,WACnB,IAAMvP,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAMhN,EAASwE,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkB,GACtD,OAAOsI,EAAM5M,QAAQC,MAAML,MAE7B,IAAK0S,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAPgB,IASjBjM,EAAauT,EAAbvT,SAER,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAsBT,OACE,kBAAC,GAAD,CACE7L,iBAAkBJ,EAASI,iBAC3BD,aAAcH,EAASG,aACvBoW,0BAZ8B,SAAA1O,GAChC2C,EACEf,EAAQO,QAAQgQ,qDACdnS,KAUFyO,sBAxB0B,SAAAzO,GACvBA,GAGL2C,EACEf,EAAQO,QAAQiQ,iDACdtI,OAAO9J,SAuBTqS,GAAW,WACf,IAAM1P,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAMhN,EAASwE,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkB,GACtD,OAAOsI,EAAM5M,QAAQC,MAAML,MAE7B,IAAK0S,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAPY,IASbjM,EAAauT,EAAbvT,SAER,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAET,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAET,IAAKjM,EAASK,YAAYjB,KACxB,OAAO,kBAAC,IAAM6M,SAAP,MAOT,OACE,kBAAC,GAAD,CAAkB6H,SALH,SAAA1U,GACfoL,EAASf,EAAQO,QAAQmQ,4CAA4C/a,KAI/ByI,MAAO7H,EAASK,YAAYjB,QAIhEgb,GAAY,WAChB,IAAM5P,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAMhN,EAASwE,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkB,GACtD,OAAOsI,EAAM5M,QAAQC,MAAML,MAE7B,IAAK0S,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAPa,IASdjM,EAAauT,EAAbvT,SAER,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAET,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAET,IAAKjM,EAASK,YAAYb,MACxB,OAAO,kBAAC,IAAMyM,SAAP,MAST,OACE,kBAAC,GAAD,CAAe6H,SAPA,SAAAtU,GACfgL,EACEf,EAAQO,QAAQqQ,6CAA6C7a,KAK5BqI,MAAO7H,EAASK,YAAYb,SAI7D8a,GAAc,WAClB,IAAM/G,EAAW3F,aAAY,SAACC,GAC5B,IAAMhN,EAASwE,OAAOC,KAAKuI,EAAMrL,GAAG+C,kBAAkB,GACtD,OAAOsI,EAAM5M,QAAQC,MAAML,MAE7B,IAAK0S,EACH,OAAO,kBAAC,IAAMtH,SAAP,MANe,IAQhBjM,EAAauT,EAAbvT,SAER,OAAKA,GAGAA,EAASK,YAGP,kBAAC,GAAD,CAAkBsC,KAAM3C,EAASK,cAL/B,kBAAC,IAAM4L,SAAP,OAQLsO,GAAiB,WACrB,IAAM/P,EAAWC,cAWjB,OACE,kBAAC,IAAMwB,SAAP,KACE,kBAAC,GAAD,CACE8L,SAbgB,WACpBvN,EAASf,EAAQO,QAAQwQ,+BAarBxC,QAXe,WACnBxN,EAASf,EAAQO,QAAQyQ,8BAWrBxC,QATe,WACnBzN,EAASf,EAAQO,QAAQ0Q,kCC9ShBC,GAAmB,SAAC,GAC/B,OAAkB,IAD+B,EAAhB7R,UAExB,kBAAC,GAAD,MAGF,kBAAC,IAAMmD,SAAP,OAGH2O,GAAiB,SAAC,GAItB,OAJ8B,gBACVhN,aAAY,SAACC,GAC/B,OAAOA,EAAMrL,GAAGmD,uBAAyB,KAGlC,kBAAC,GAAD,MAEF,kBAAC,IAAMsG,SAAP,OAGHmN,GAAU,WACd,OACE,kBAAC,IAAMnN,SAAP,KACE,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,QAKAoN,GAAc,WAClB,IAAM7O,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAM7L,EAASqD,OAAOC,KAAKuI,EAAMrL,GAAGkD,kBAAkB,GACtD,OAAOmI,EAAM5M,QAAQgB,MAAMD,MAG7B,IAAKuR,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAWT,OACE,kBAAC,GAAD,CACEpE,MAAO0L,EAASjU,OAChBwU,SAXyB,SAAAjM,GAC3B,IAAIZ,EAAWY,OACDnF,IAAVmF,GAAiC,OAAVA,IAAmC,IAAjByR,MAAMzR,KACjDZ,EAAW,GAEbuD,EAASf,EAAQO,QAAQ6Q,kCAAkC5T,QAWzDuS,GAAW,WACf,IAAMhP,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAM7L,EAASqD,OAAOC,KAAKuI,EAAMrL,GAAGkD,kBAAkB,GACtD,OAAOmI,EAAM5M,QAAQgB,MAAMD,MAG7B,IAAKuR,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAGT,IASMvM,EAAQ6T,EAAS7T,MAAQ6T,EAAS7T,MAAQ,GAC1CD,EAAS8T,EAAS9T,OAAS8T,EAAS9T,OAAS,GAC7CE,IAAkB4T,EAAS5T,iBAC7B4T,EAAS5T,gBAGb,OACE,6BACE,kBAAC,GAAD,CACEF,OAAQA,EACRC,MAAOA,EACPC,gBAAiBA,EACjBwX,oBAlBsB,SAAAtP,GAC1B2C,EAASf,EAAQO,QAAQ8Q,kCAAkCjT,KAkBvDuP,mBAtBqB,SAAAvP,GACzB2C,EAASf,EAAQO,QAAQ+Q,iCAAiClT,KAsBtDwP,yBAjB2B,SAAAxP,GAC/B2C,EAASf,EAAQO,QAAQgR,2CAA2CnT,SAsBlEqS,GAAW,WACf,IAAM1P,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAM7L,EAASqD,OAAOC,KAAKuI,EAAMrL,GAAGkD,kBAAkB,GACtD,OAAOmI,EAAM5M,QAAQgB,MAAMD,MAG7B,IAAKuR,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAET,IAAKsH,EAASnU,KACZ,OAAO,kBAAC,IAAM6M,SAAP,MAOT,OAAO,kBAAC,GAAD,CAAkB6H,SAJR,SAAA1U,GACfoL,EAASf,EAAQO,QAAQiR,gCAAgC7b,KAGdyI,MAAO0L,EAASnU,QAGzDgb,GAAY,WAChB,IAAM5P,EAAWC,cACX8I,EAAW3F,aAAY,SAACC,GAC5B,IAAM7L,EAASqD,OAAOC,KAAKuI,EAAMrL,GAAGkD,kBAAkB,GACtD,OAAOmI,EAAM5M,QAAQgB,MAAMD,MAG7B,IAAKuR,EACH,OAAO,kBAAC,IAAMtH,SAAP,MAGT,IAAKsH,EAAS/T,MACZ,OAAO,kBAAC,IAAMyM,SAAP,MAOT,OAAO,kBAAC,GAAD,CAAe6H,SAJL,SAAAtU,GACfgL,EAASf,EAAQO,QAAQkR,iCAAiC1b,KAGlBqI,MAAO0L,EAAS/T,SAGtD8a,GAAc,WAClB,IAAM/G,EAAW3F,aAAY,SAACC,GAC5B,IAAM7L,EAASqD,OAAOC,KAAKuI,EAAMrL,GAAGkD,kBAAkB,GACtD,OAAOmI,EAAM5M,QAAQgB,MAAMD,MAG7B,OAAKuR,EAGE,kBAAC,GAAD,CAAkB5Q,KAAM4Q,IAFtB,kBAAC,IAAMtH,SAAP,OClJEkP,GAAiB,SAAC,GAC7B,OAAkB,IAD6B,EAAhBrS,UAEtB,kBAAC,GAAD,MAGF,kBAAC,IAAMmD,SAAP,OAGHmN,GAAU,WACd,OACE,kBAAC,IAAMnN,SAAP,KACE,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,MACA,kBAAC,GAAD,QAKAoN,GAAc,WAClB,IAAM7O,EAAWC,cACXzK,EAAW4N,aAAY,SAACC,GAC5B,OAAOA,EAAMrL,GAAGC,aAAazC,YAE/B,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAGT,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAWT,OACE,kBAAC,GAAD,CACEpE,MAAO7H,EAASK,YAAYf,OAC5BwU,SAXyB,SAAAjM,GAC3B,IAAIZ,EAAWY,OACDnF,IAAVmF,GAAiC,OAAVA,IAAmC,IAAjByR,MAAMzR,KACjDZ,EAAW,GAEbuD,EAASf,EAAQO,QAAQoR,mCAAmCnU,QAW1DuS,GAAW,WACf,IAAMhP,EAAWC,cACXzK,EAAW4N,aAAY,SAACC,GAC5B,OAAOA,EAAMrL,GAAGC,aAAazC,YAa/B,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAET,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAET,IAAMvM,EAAQM,EAASK,YAAYX,MAAQM,EAASK,YAAYX,MAAQ,GAClED,EAASO,EAASK,YAAYZ,OAASO,EAASK,YAAYZ,OAAS,GACrEE,IAAkBK,EAASK,YAAYV,iBACzCK,EAASK,YAAYV,gBAGzB,OACE,6BACE,kBAAC,GAAD,CACEF,OAAQA,EACRC,MAAOA,EACPC,gBAAiBA,EACjBwX,oBA1BsB,SAAAtP,GAC1B2C,EAASf,EAAQO,QAAQqR,mCAAmCxT,KA0BxDuP,mBA9BqB,SAAAvP,GACzB2C,EAASf,EAAQO,QAAQsR,kCAAkCzT,KA8BvDwP,yBAzB2B,SAAAxP,GAC/B2C,EACEf,EAAQO,QAAQuR,4CAA4C1T,SA6B5D+R,GAAa,WACjB,IAAMpP,EAAWC,cACXzK,EAAW4N,aAAY,SAACC,GAC5B,OAAOA,EAAMrL,GAAGC,aAAazC,YAG/B,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAcT,OACE,kBAAC,GAAD,CACE/L,eAAgBF,EAASE,eACzBD,WAAYD,EAASC,WACrB0W,wBAR4B,SAAA9O,GAC9B2C,EAASf,EAAQO,QAAQwR,uCAAuC3T,KAQ9D6O,oBAhBwB,SAAA7O,GACrBA,GAGL2C,EAASf,EAAQO,QAAQyR,mCAAmC9J,OAAO9J,SAiBjEkS,GAAe,WACnB,IAAMvP,EAAWC,cACXzK,EAAW4N,aAAY,SAACC,GAC5B,OAAOA,EAAMrL,GAAGC,aAAazC,YAG/B,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAgBT,OACE,kBAAC,GAAD,CACE7L,iBAAkBJ,EAASI,iBAC3BD,aAAcH,EAASG,aACvBoW,0BAR8B,SAAA1O,GAChC2C,EAASf,EAAQO,QAAQ0R,yCAAyC7T,KAQhEyO,sBAlB0B,SAAAzO,GACvBA,GAGL2C,EACEf,EAAQO,QAAQ2R,qCAAqChK,OAAO9J,SAkB5DqS,GAAW,WACf,IAAM1P,EAAWC,cACXzK,EAAW4N,aAAY,SAACC,GAC5B,OAAOA,EAAMrL,GAAGC,aAAazC,YAG/B,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAET,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAET,IAAKjM,EAASK,YAAYjB,KACxB,OAAO,kBAAC,IAAM6M,SAAP,MAOT,OACE,kBAAC,GAAD,CAAkB6H,SALH,SAAA1U,GACfoL,EAASf,EAAQO,QAAQ4R,iCAAiCxc,KAIpByI,MAAO7H,EAASK,YAAYjB,QAIhEgb,GAAY,WAChB,IAAM5P,EAAWC,cACXzK,EAAW4N,aAAY,SAACC,GAC5B,OAAOA,EAAMrL,GAAGC,aAAazC,YAG/B,IAAKA,EACH,OAAO,kBAAC,IAAMiM,SAAP,MAET,IAAKjM,EAASK,YACZ,OAAO,kBAAC,IAAM4L,SAAP,MAET,IAAKjM,EAASK,YAAYb,MACxB,OAAO,kBAAC,IAAMyM,SAAP,MAOT,OACE,kBAAC,GAAD,CAAe6H,SALA,SAAAtU,GACfgL,EAASf,EAAQO,QAAQ6R,8BAA8Brc,KAIpBqI,MAAO7H,EAASK,YAAYb,SAI7D8a,GAAc,WAClB,IAAMta,EAAW4N,aAAY,SAACC,GAC5B,OAAOA,EAAMrL,GAAGC,aAAazC,YAE/B,OAAKA,GAGAA,EAASK,YAGP,kBAAC,GAAD,CAAkBsC,KAAM3C,EAASK,cAL/B,kBAAC,IAAM4L,SAAP,OC7NE6P,GAAc,SAAC,GAC1B,OAAkB,IAD0B,EAAhBhT,UAEnB,kBAAC,GAAD,MAGF,kBAAC,IAAMmD,SAAP,OAGHmN,GAAU,WACd,IAAM2C,EAAWnO,aAAY,SAACC,GAC5B,OAAOxI,OAAOC,KAAKuI,EAAM5M,QAAQC,OAAOrD,UAGpCme,EAAWpO,aAAY,SAACC,GAC5B,OAAOxI,OAAOC,KAAKuI,EAAM5M,QAAQgB,OAAOpE,UAG1C,OACE,6BACE,kBAAC,GAAD,CACEgN,MAAO,QACPoI,cAAUvQ,EACVmF,MAAOmU,EACPlR,UAAMpI,IAGR,kBAAC,GAAD,CACEmI,MAAO,QACPoI,cAAUvQ,EACVmF,MAAOkU,EACPjR,UAAMpI,MC7BDuZ,GAAmB,SAAC,GAC/B,OAAkB,IAD+B,EAAhBnT,UAExB,kBAAC,IAAMmD,SAAP,MAGF,kBAAC,GAAD,OAGHmN,GAAU,WACd,IAAMjV,EAAOyJ,aAAY,SAACC,GACxB,OAAOA,EAAMrL,GAAG2B,QAGV1E,EAA4C0E,EAA5C1E,OAAQC,EAAoCyE,EAApCzE,MAAO2E,EAA6BF,EAA7BE,QAASjF,EAAoB+E,EAApB/E,KAEhC,OAAkB,IAFkC+E,EAAd2E,UAG7B,kBAAC,IAAMmD,SAAP,MAGL7M,IAAShC,EAAekH,IACnB,kBAAC,GAAD,CAAS7E,OAAQA,EAAQC,MAAOA,IAGrCN,IAAShC,EAAeoH,IACnB,kBAAC,GAAD,CAASH,QAASA,IAGpB,kBAAC,IAAM4H,SAAP,OAGHiQ,GAAU,SAAC,GAAuB,IAArBzc,EAAoB,EAApBA,OACXmQ,EAD+B,EAAZlQ,MAEnBmQ,EAAYpQ,EAGZ0c,EACJ,yDAAkDvM,EAAlD,qBAAwEC,EAAxE,4BACeD,EAAY,EAD3B,wBAC4CA,EAC1C,EAFF,iBAEYC,EAFZ,2BAHoB,mBAGpB,yBAF0B,EAE1B,qCAGsBA,EAAY,EAHlC,iBAG4CD,EAH5C,iBAG8DC,EAC5D,EAJF,2BAHoB,mBAGpB,yBAF0B,EAE1B,QAKA,SACIuM,EAAa,uCAAmCD,EAAnC,MACnB,OACE,yBACEvQ,MAAO,CACLnM,OAAQ,OACRC,MAAO,OACPP,SAAU,WACViO,IAAK,EACLF,KAAM,EACNmP,gBAAiBD,EACjBE,iBAAkB,SAClBC,mBAAmB,GAAD,OAAK3M,EAAY,EAAjB,cAAwBC,EAAY,EAApC,MAClB9B,OAAQ,MAMVyO,GAAoB,SAACC,EAAQlU,EAAMjG,GACvC,IAAIoa,EAAY,GAAKpa,EAAI,GACrBqa,EAAa7e,KAAKwF,GAAK,IAAOoZ,EAClC,OAAOnf,EACLkf,EAAOjf,EAAI+K,EAAOzK,KAAK8e,IAAID,GAC3BF,EAAOhf,EAAI8K,EAAOzK,KAAK+e,IAAIF,KAOzBG,GAAU,SAAC,GAAiB,IAAfzY,EAAc,EAAdA,QAIXkE,EAAOlE,EACP3E,EAAQ5B,KAAKC,KAAK,GAAKwK,EACvB9I,EAAS,EAAI8I,EACb6D,EAAa7O,EAAW,EAAGgL,GAC3BwU,EAAaxf,EAAW6O,EAAW5O,EAAG4O,EAAW3O,GACvDsf,EAAWvf,EAAIuf,EAAWvf,EAAIkC,EAC9B,IAAMsd,EAAiBzf,EAAW6O,EAAW5O,EAAG4O,EAAW3O,GAC3Duf,EAAexf,EAAIwf,EAAexf,EAAIkC,EAAQ,EAC9Csd,EAAevf,EAAIuf,EAAevf,EAAU,IAANgC,EACtC,IAAMwd,EAAqB1f,EAAW6O,EAAW5O,EAAG4O,EAAW3O,GAC/Dwf,EAAmBzf,EAAIyf,EAAmBzf,EAAIkC,EAAQ,EACtDud,EAAmBxf,EAAIwf,EAAmBxf,EAAU,IAANgC,EAC9C,IAAMyB,EAAQ,CACZ,CACEsb,GAAkBpQ,EAAY7D,EAAM,GACpCiU,GAAkBpQ,EAAY7D,EAAM,IAEtC,CACEiU,GAAkBpQ,EAAY7D,EAAM,GACpCiU,GAAkBpQ,EAAY7D,EAAM,IAEtC,CACEiU,GAAkBpQ,EAAY7D,EAAM,GACpCiU,GAAkBpQ,EAAY7D,EAAM,IAEtC,CACEiU,GAAkBO,EAAYxU,EAAM,GACpCiU,GAAkBO,EAAYxU,EAAM,IAEtC,CACEiU,GAAkBO,EAAYxU,EAAM,GACpCiU,GAAkBO,EAAYxU,EAAM,IAEtC,CACEiU,GAAkBO,EAAYxU,EAAM,GACpCiU,GAAkBO,EAAYxU,EAAM,IAEtC,CACEiU,GAAkBQ,EAAgBzU,EAAM,GACxCiU,GAAkBQ,EAAgBzU,EAAM,IAE1C,CACEiU,GAAkBS,EAAoB1U,EAAM,GAC5CiU,GAAkBS,EAAoB1U,EAAM,KAK1C2U,EAAO,IAAMzd,EAEf0c,EAAG,yDAHMzc,EAGN,qBAAsEwd,EAAtE,MACPhc,EAAMa,SAAQ,SAAAob,GAAW,IAAD,eACPA,EADO,GACfC,EADe,KACZC,EADY,KAEhBzZ,EACJ,oBAAawZ,EAAE5f,EAAf,iBAAyB4f,EAAE3f,EAA3B,iBAAqC4f,EAAE7f,EAAvC,iBAAiD6f,EAAE5f,EAAnD,8BAzDkB,kBAyDlB,yBAxDwB,EAwDxB,QAEF0e,GAAYvY,KAId,IAAMwY,EAAa,uCAFnBD,GAAY,SAEO,MAEnB,OACE,yBACEvQ,MAAO,CACLnM,OAAQ,OACRC,MAAO,OACPP,SAAU,WACViO,IAAK,EACLF,KAAM,EACNmP,gBAAiBD,EACjBE,iBAAkB,SAClBC,mBAAmB,UACnBxO,OAAQ,MC9IHuP,GAAa,WACxB,IAAM9S,EAAWC,cACXhC,EAAsBmF,aAAY,SAACC,GACvC,OAAOA,EAAMrL,GAAGiG,uBAWlB,OACE,yBACEmC,UAAU,mBACVgB,MAAO,CAAE2R,OAAQ,EAAGtP,OAAQ,oBAAqBiG,cAAe,QAEhE,yBAAKtJ,UAAU,WACb,yBACEA,UAAS,0BACPnC,IAAwBtL,EAAeuL,KAAO,UAAY,IAE5DsC,QAnBa,WACnBR,EAASf,EAAQQ,OAAOuT,0BAmBlB5R,MAAO,CAAEnM,OAAQ,OAAQuX,QAAS,aAElC,0BAAMpM,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAM2S,IAAWje,MAAOlC,KAE3C,wCAaJ,yBAAKsN,UAAU,WACb,yBACEA,UAAS,0BACPnC,IAAwBtL,EAAeyL,KAAO,UAAY,IAE5DoC,QAxCa,WACnBR,EAASf,EAAQQ,OAAOyT,8BAwClB9R,MAAO,CAAEnM,OAAQ,OAAQuX,QAAS,aAElC,0BAAMpM,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAM6S,IAAOne,MAAOlC,KAEvC,wCAIJ,yBAAKsN,UAAU,WACb,yBACEA,UAAS,0BACPnC,IAAwBtL,EAAe0L,WAAa,UAAY,IAElEmC,QApDmB,WACzBR,EAASf,EAAQQ,OAAO2T,gCAoDlBhS,MAAO,CAAEnM,OAAQ,OAAQuX,QAAS,aAElC,0BAAMpM,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAM+S,IAASre,MAAOlC,KAEzC,gDC1EGwgB,GAAoB,WAC/B,IAAMtT,EAAWC,cACXsT,EAAUnQ,aAAY,SAACC,GAC3B,OAAOA,EAAMrL,GAAGiB,SAASC,SAErBC,EAAqBiK,aAAY,SAACC,GACtC,OAAOA,EAAMrL,GAAGiB,SAASE,sBAe3B,OACE,yBAAKiI,MAAO,CAAEgH,QAAS,OAAQO,cAAe,QAC5C,yBACEvI,UAAU,mBACVgB,MAAO,CAAElM,MAAO,OAAQ0U,SAAU,SAAUzB,aAAc,MAE1D,yBAAK/H,UAAU,WACb,yBAAKA,UAAS,oBAAuBI,QAnBvB,WACpBR,EAASf,EAAQI,QAAQmU,0BAmBjB,0BAAMpT,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAMmT,IAASze,MAAOlC,KAEzC,+CAIJ,yBAAKsN,UAAU,WACb,yBACEA,UAAS,4BACK,IAAZmT,EAAmB,aAAe,IAEpC/S,QAxBW,WACnBR,EAASf,EAAQI,QAAQqU,yBAyBjB,0BAAMtT,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAMqT,IAAQ3e,MAAOlC,KAExC,wCAIJ,yBAAKsN,UAAU,WACb,yBAAKA,UAAS,mBAAsBI,QAtCpB,WACtBR,EAASf,EAAQI,QAAQuU,4BAsCjB,0BAAMxT,UAAU,iBACd,kBAAC,IAAD,CAAiBE,KAAMuT,IAAY7e,MAAOlC,KAE5C,+CAIN,yBACEsO,MAAO,CACLkN,WAAY,wBACZC,SAAU,OACVuF,UAAW,YAGW,IAAvB3a,EACC,yDAEA,sDChEG4a,GAAmB,WAC9B,IAAM9V,EAAsBmF,aAAY,SAACC,GACvC,OAAOA,EAAMrL,GAAGiG,uBAElB,OAAIA,IAAwBtL,EAAeuL,KAClC,kBAAC,GAAD,MAELD,IAAwBtL,EAAeyL,KAClC,kBAAC,GAAD,MAELH,IAAwBtL,EAAe0L,WAClC,kBAAC,GAAD,MAEF,kBAAC,IAAMoD,SAAP,OAGHuS,GAAc,WACD/T,cACjB,OACE,6BACE,kBAAC,GAAD,QAKAgU,GAAoB,WACxB,IAAMjU,EAAWC,cACXzB,EAAQ4E,aAAY,SAACC,GACzB,OAAOA,EAAMrL,GAAGuG,WAAWC,SAGrB7J,EAAkC6J,EAAlC7J,SAAejB,GAAmB8K,EAAxBC,IAAwBD,EAAnB9K,OAAOgL,EAAYF,EAAZE,QAwC9B,OACE,yBACE0C,MAAO,CAAEwI,SAAU,SAAUxB,QAAS,OAAQE,WAAY,eAE1D,yBAAKlH,MAAO,CAAEwI,SAAU,SAAUxB,QAAS,OAAQF,UAAW,QAC5D,yBAAK9H,UAAU,WACb,yBAAKA,UAAS,oBAAuBI,QA7CtB,WACrBR,EAASf,EAAQQ,OAAOyU,mCA6ChB,yCAIJ,yBAAK9T,UAAU,WACb,yBAAKA,UAAS,oBAAuBgB,MAAO,CAAEzM,SAAU,aACtD,2BACEC,KAAK,OACL0U,SAnDY,SAAAjH,GACtB,IAAM8R,EAA0B9R,EAAMuJ,OAAOwI,MACvCA,EAAQC,MAAMC,KAAKH,GACzB,GAAqB,IAAjBC,EAAM/gB,OAAV,CAIA,IAAIkhB,EAAOH,EAAM,GAEjB,GADc,CAAC,YAAa,aAAc,aAChCI,OAAM,SAAA5f,GAAI,OAAI2f,EAAK3f,OAASA,KACpCyG,QAAQY,MAAR,WAAkBsY,EAAK3f,KAAvB,qCAGF,GAAI2f,EAAKxW,KAAO,QACd1C,QAAQY,MAAR,WAAkBsY,EAAKE,KAAvB,mDADF,CAIA,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,UAAY,WACjB5U,EAASf,EAAQQ,OAAOoV,+BAA+BH,EAAOI,UAEhEJ,EAAOK,cAAcR,GACrBlS,EAAM2S,uBAlBJ3Z,QAAQY,MAAM,sBAgDNmF,MAAO,CACLzM,SAAU,WACViO,IAAK,EACLF,KAAM,EACNxN,MAAO,OACPD,OAAQ,OACRyJ,QAAS,EACT6E,OAAQ,KAGZ,2CAKN,yBACEnC,MAAO,CACLgH,QAAS,OACT6M,WAAY,OACZvM,YAAa,OACbkB,SAAU,SACVtB,WAAY,eAGd,yBACElI,UAAW,WACXgB,MAAO,CACLlM,MAAO,QACPggB,WAAY,SACZtL,SAAU,SACVxB,QAAS,OACTE,WAAY,eAGd,yBACElI,UAAU,QACVgB,MAAO,CAAE8T,WAAY,WAFvB,iBAGYxhB,KAEd,yBAAK0N,MAAO,CAAElM,MAAO,QAAS+f,WAAY,OAAQ/M,UAAW,SAC3D,kBAAC6C,GAAD,CACE9N,IAAK,GACLD,IAAK,GACLmO,KAAM,GACN9N,MAAO3J,EACP4V,SAAU,SAAAjM,GAAK,OAnEF,SAAAA,GACrB2C,EAASf,EAAQQ,OAAO0V,8BAA8B9X,IAkE3B+X,CAAe/X,IAClC+N,aAAc,MAUpB,kBAAC,GAAD,CACEiK,OAAQ1gB,EAAS3B,EACjBsiB,gBAtFkB,SAAAjY,GACtB2C,EAASf,EAAQQ,OAAO8V,+BAA+BlY,KAsFnDmY,OAAQ7gB,EAAS1B,EACjBwiB,gBArFkB,SAAApY,GACtB2C,EAASf,EAAQQ,OAAOiW,+BAA+BrY,OAuFrD,yBACE+D,MAAO,CACLgH,QAAS,OACT6M,WAAY,OACZvM,YAAa,OACbkB,SAAU,SACVtB,WAAY,eAGd,yBAAKlI,UAAW,WAAYgB,MAAO,CAAElM,MAAO,SAC1C,yBACEkL,UAAU,QACVgB,MAAO,CAAEwI,SAAU,SAAUsL,WAAY,WAF3C,YAIYxW,IAGd,yBAAK0C,MAAO,CAAElM,MAAO,OAAQ+f,WAAY,OAAQ/M,UAAW,SAC1D,kBAAC6C,GAAD,CACE9N,IAAK,EACLD,IAAK,EACLmO,KAAM,GACN9N,MAAOqB,EACP4K,SAAU,SAAAjM,GAAK,OAzGA,SAAAA,GACvB2C,EAASf,EAAQQ,OAAOkW,gCAAgCtY,IAwG7BuY,CAAiBvY,IACpC+N,aAAc,QAQpByK,GAAqB,SAAC,GAKrB,IAJLR,EAII,EAJJA,OACAC,EAGI,EAHJA,gBACAE,EAEI,EAFJA,OACAC,EACI,EADJA,gBAEA,OACE,yBACErU,MAAO,CACLgH,QAAS,OACTwB,SAAU,SACVtB,WAAY,SACZI,YAAa,SAGf,yBAAKtI,UAAW,YACd,yBAAKA,UAAU,SAAf,oBAEA,kBAAC,KAAD,CACE4N,eAAe,EACfC,sBAAsB,EACtBhR,IAAK,IACLD,KAAM,IACN8Y,UAAW,EACXzY,MAAOgY,EACPnH,cAAe,SAAA7L,GACbiT,EAAgBjT,EAAM8L,aAExBC,YAAY,IACZhN,MAAO,CACLpM,MAAO,UACPqZ,UAAW,SACX5K,OAAQ,oBACR6K,WAAY,wBACZC,SAAU,OACVC,WAAY,IACZC,WAAY,MACZjC,QAAS,WACTrE,aAAc,MACdD,UAAW,MACX6N,SAAU,OACVrN,YAAa,SAGjB,kBAAC,KAAD,CACEsF,eAAe,EACfC,sBAAsB,EACtBhR,IAAK,IACLD,KAAM,IACN8Y,UAAW,EACXzY,MAAOmY,EACPtH,cAAe,SAAA7L,GACboT,EAAgBpT,EAAM8L,aAExBC,YAAY,IACZhN,MAAO,CACLpM,MAAO,UACPqZ,UAAW,SACX5K,OAAQ,oBACR6K,WAAY,wBACZC,SAAU,OACVC,WAAY,IACZC,WAAY,MACZjC,QAAS,WACTrE,aAAc,MACdD,UAAW,MACX6N,SAAU,aAQhBC,GAAc,WAClB,IAAMhW,EAAWC,cACXtG,EAAOyJ,aAAY,SAACC,GACxB,OAAOA,EAAMrL,GAAG2B,QAGV1E,EAAyD0E,EAAzD1E,OAAQC,EAAiDyE,EAAjDzE,MAAO2E,EAA0CF,EAA1CE,QAASjF,EAAiC+E,EAAjC/E,KAAMgF,EAA2BD,EAA3BC,YAAa0E,EAAc3E,EAAd2E,UAwDnD,OACE,yBAAK8C,MAAO,CAAEgH,QAAS,OAAQwB,SAAU,SAAUtB,WAAY,WAC7D,kBAAC,GAAD,CACEhK,UAAWA,EACX2X,mBA3DqB,WACzBjW,EAASf,EAAQQ,OAAOyW,+BA2DpBtc,YAAaA,EACbuc,qBA1DuB,WAC3BnW,EAASf,EAAQQ,OAAO2W,iCA0DpBxhB,KAAMA,EACNyhB,sBA7BwB,WAC5BrW,EAASf,EAAQQ,OAAO6W,mBAAmB1jB,EAAeoH,OA6BtDuc,sBA3BwB,WAC5BvW,EAASf,EAAQQ,OAAO6W,mBAAmB1jB,EAAekH,SA6BvDlF,IAAShC,EAAekH,IACvB,kBAAC,GAAD,CACEsL,UAAWlQ,EACXshB,mBAhEmB,SAAAnZ,GACzB,IAAIZ,EAAWY,OACDnF,IAAVmF,GAAiC,OAAVA,IAAmC,IAAjByR,MAAMzR,IAI/CZ,EAAW,IACbA,EAAW,GAETA,EAAW,MACbA,EAAW,KAEbuD,EAASf,EAAQQ,OAAOgX,oBAAoBha,KAT1CA,EAAW,GA8DP4I,UAAWpQ,EACXyhB,mBApDmB,SAAArZ,GACzB,IAAIZ,EAAWY,OACDnF,IAAVmF,GAAiC,OAAVA,IAAmC,IAAjByR,MAAMzR,IAI/CZ,EAAW,IACbA,EAAW,GAETA,EAAW,MACbA,EAAW,KAEbuD,EAASf,EAAQQ,OAAOkX,qBAAqBla,KAT3CA,EAAW,KAmDP,KAEH7H,IAAShC,EAAeoH,IACvB,kBAAC,GAAD,CACEH,QAASA,EACT+c,iBAvCiB,SAAAvZ,GACvB,IAAIZ,EAAWY,OACDnF,IAAVmF,GAAiC,OAAVA,IAAmC,IAAjByR,MAAMzR,IAI/CZ,EAAW,IACbA,EAAW,GAETA,EAAW,MACbA,EAAW,KAEbuD,EAASf,EAAQQ,OAAOoX,sBAAsBpa,KAT5CA,EAAW,KAsCP,OAKJqa,GAAc,SAAC,GAQd,IAPLxY,EAOI,EAPJA,UACA2X,EAMI,EANJA,mBACArc,EAKI,EALJA,YACAuc,EAII,EAJJA,qBACAvhB,EAGI,EAHJA,KACAyhB,EAEI,EAFJA,sBACAE,EACI,EADJA,sBAEA,OACE,kBAAC,IAAM9U,SAAP,KACE,yBACEL,MAAO,CACLsH,YAAa,SAGf,kBAAC,GAAD,CACErI,MAAO,YACPhD,MAAOiB,EACPgL,SAAU2M,EACVvK,YAAY,KAIhB,yBACEtK,MAAO,CACLsH,YAAa,SAGf,kBAAC,GAAD,CACErI,MAAO,eACPhD,MAAOzD,EACP0P,SAAU6M,EACVzK,YAAY,KAIhB,yBACEtK,MAAO,CACLsH,YAAa,SAGf,yBAAKtI,UAAW,YACd,yBAAKA,UAAU,SAAf,eACA,yBAAKA,UAAU,WACb,yBACEA,UAAS,2BACPxL,IAAShC,EAAeoH,IAAM,UAAY,GADnC,KAGTwG,QAAS6V,GAET,2CAIJ,yBAAKjW,UAAU,WACb,yBACEA,UAAS,2BACPxL,IAAShC,EAAekH,IAAM,UAAY,IAE5C0G,QAAS+V,GAET,iDASRQ,GAAkB,SAAC,GAKlB,IAJL3R,EAII,EAJJA,UACAoR,EAGI,EAHJA,mBACAnR,EAEI,EAFJA,UACAqR,EACI,EADJA,mBAEA,OACE,yBACEtV,MAAO,CACLgH,QAAS,OACTwB,SAAU,SACVtB,WAAY,SACZI,YAAa,SAGf,yBAAKtI,UAAW,YACd,yBAAKA,UAAU,SAAf,eAEA,kBAAC,KAAD,CACE4N,eAAe,EACfC,sBAAsB,EACtBhR,IAAK,GACLD,IAAK,EACL8Y,UAAW,EACXzY,MAAO+H,EACP8I,cAAe,SAAA7L,GACbmU,EAAmBnU,EAAM8L,aAE3BC,YAAY,QACZhN,MAAO,CACLpM,MAAO,UACPqZ,UAAW,SACX5K,OAAQ,oBACR6K,WAAY,wBACZC,SAAU,OACVC,WAAY,IACZC,WAAY,MACZjC,QAAS,WACTrE,aAAc,MACdD,UAAW,MACX6N,SAAU,OACVrN,YAAa,SAGjB,kBAAC,KAAD,CACEsF,eAAe,EACfC,sBAAsB,EACtBhR,IAAK,GACLD,IAAK,EACL8Y,UAAW,EACXzY,MAAOgI,EACP6I,cAAe,SAAA7L,GACbqU,EAAmBrU,EAAM8L,aAE3BC,YAAY,SACZhN,MAAO,CACLpM,MAAO,UACPqZ,UAAW,SACX5K,OAAQ,oBACR6K,WAAY,wBACZC,SAAU,OACVC,WAAY,IACZC,WAAY,MACZjC,QAAS,WACTrE,aAAc,MACdD,UAAW,MACX6N,SAAU,aAQhBiB,GAAkB,SAAC,GAAmC,IAAjCnd,EAAgC,EAAhCA,QAAS+c,EAAuB,EAAvBA,iBAClC,OACE,yBACExV,MAAO,CACLgH,QAAS,OACTwB,SAAU,SACVtB,WAAY,SACZI,YAAa,SAGf,yBAAKtI,UAAW,YACd,yBAAKA,UAAU,SAAf,cAEA,kBAAC,KAAD,CACE4N,eAAe,EACfC,sBAAsB,EACtBhR,IAAK,GACLD,IAAK,EACL8Y,UAAW,EACXzY,MAAOxD,EACPqU,cAAe,SAAA7L,GACbuU,EAAiBvU,EAAM8L,aAEzBC,YAAY,QACZhN,MAAO,CACLpM,MAAO,UACPqZ,UAAW,SACX5K,OAAQ,oBACR6K,WAAY,wBACZC,SAAU,OACVC,WAAY,IACZC,WAAY,MACZjC,QAAS,WACTrE,aAAc,MACdD,UAAW,MACX6N,SAAU,OACVrN,YAAa,YCzhBZuO,GAAQ,SAAC,GACpB,OAAkB,IADoB,EAAhB3Y,UAEb,kBAAC,GAAD,MAEF,kBAAC,IAAMmD,SAAP,OAGHmN,GAAU,WACd,IAAM9Q,EAAQsF,aAAY,SAACC,GACzB,OAAOA,EAAMrL,GAAG8F,SAEVlJ,EAAsBkJ,EAAtBlJ,KAAMI,EAAgB8I,EAAhB9I,MAAO+I,EAASD,EAATC,KACrB,OAAInJ,IAAS/B,EAAU+L,MACd,kBAAC,GAAD,CAAY5J,MAAOA,EAAO+I,KAAMA,IAElC,kBAAC,IAAM0D,SAAP,OAGHyV,GAAa,SAAC,GAAqB,IAAnBliB,EAAkB,EAAlBA,MAAO+I,EAAW,EAAXA,KACrBiC,EAAWC,cADqB,EAEH0B,oBAAS,GAFN,oBAE/BrD,EAF+B,KAEpB6Y,EAFoB,OAGCxV,oBAAS,GAHV,oBAG/ByV,EAH+B,KAGlBC,EAHkB,OAIT1V,mBAAS,GAJA,oBAI/B0T,EAJ+B,KAIvBiC,EAJuB,OAKT3V,mBAAS,GALA,oBAK/B6T,EAL+B,KAKvB+B,EALuB,OAMb5V,mBAA4B,MANf,oBAM/BY,EAN+B,KAMzBiV,EANyB,KAOhCrU,EAAkBhB,iBAAuB,MA+C/C,OACE,kBAAC,IAAMV,SAAP,KACE,yBACEL,MAAO,CACLzM,SAAU,WACViO,IAAK,EACLF,KAAM,EACNxN,MAAO,OACPD,OAAQ,OACRuO,gBAAiB,cACjBD,OAAQ,GACR0B,OAAQ,QAEV/B,IAAKC,EACLJ,YAtCc,SAACV,GAEnB,GADAgV,GAAgB,GACH,OAAT9U,GACEY,EAAgBb,QAAS,CAC3B,IAAMC,EAAOY,EAAgBb,QAAQE,wBACrCgV,EAASjV,GACT,IAAMvP,EAAIqP,EAAMI,QAAUF,EAAKG,KAAO3E,EAAO,EACvC9K,EAAIoP,EAAMM,QAAUJ,EAAKK,IAAM7E,EAAO,EAC5CuZ,EAAWtkB,GACXukB,EAAWtkB,GACX+M,EAASf,EAAQS,MAAM+X,uBAAuBzkB,EAAGC,IAGrD,GAAa,OAATsP,EAAe,CACjB,IAAMvP,EAAIqP,EAAMI,QAAUF,EAAKG,KAAO3E,EAAO,EACvC9K,EAAIoP,EAAMM,QAAUJ,EAAKK,IAAM7E,EAAO,EAC5CuZ,EAAWtkB,GACXukB,EAAWtkB,GACX+M,EAASf,EAAQS,MAAM+X,uBAAuBzkB,EAAGC,MAqB/CmP,UAlBY,SAACC,GACjBgV,GAAgB,IAkBZK,aA9De,SAACrV,GACpB8U,GAAc,IA8DVlU,aA5De,SAACZ,GACpB8U,GAAc,IA4DVnU,YA1Dc,SAACX,GAMnB,GALa,OAATE,GACEY,EAAgBb,SAClBkV,EAASrU,EAAgBb,QAAQE,yBAGxB,OAATD,EAAe,CACjB,IAAMvP,EAAIqP,EAAMI,QAAUF,EAAKG,KAAO3E,EAAO,EACvC9K,EAAIoP,EAAMM,QAAUJ,EAAKK,IAAM7E,EAAO,EAC5CuZ,EAAWtkB,GACXukB,EAAWtkB,GACPmkB,GACFpX,EAASf,EAAQS,MAAM+X,uBAAuBzkB,EAAGC,QAiDnD,kBAAC,GAAD,CACEA,EAAGuiB,EACHxiB,EAAGqiB,EACHrgB,MAAOA,EACP+I,KAAMA,EACNO,UAAWA,MAMbqZ,GAAe,SAAC,GAAsC,IAApC3kB,EAAmC,EAAnCA,EAAGC,EAAgC,EAAhCA,EAAG+B,EAA6B,EAA7BA,MAAO+I,EAAsB,EAAtBA,KAAMO,EAAgB,EAAhBA,UACzC,OACE,yBACE8C,MAAO,CACLzM,SAAU,WACViO,IAAK,EACLF,KAAM,EACNrB,UAAWL,GAAkBhO,EAAGC,GAChCuQ,gBAAiBxO,EACjBE,MAAO6I,EACP9I,OAAQ8I,EACR0F,OAAQ,oBACRgB,aAAc,OACd/F,SAAuB,IAAdJ,EAAqB,GAAM,EACpCiF,OAAQ,KAZZ,SCzGSqU,GAAe,SAAC,GAAyB,IAAvBva,EAAsB,EAAtBA,MAAOiM,EAAe,EAAfA,SACpC,OACE,kBAAC,GAAD,CACEP,SAAU1L,EACVgD,MAAO,OACPC,KAAM,kBAAC,IAAD,CAAiBA,KAAMC,IAAavL,MAAOlC,EAAUiL,KAAM,QAEjE,kBAAC,GAAD,CAAaV,MAAOA,EAAOiM,SAAUA,MCP9BuO,GAAe,SAAC,GAC3B,OAAkB,IAD2B,EAAhBvZ,UAEpB,kBAAC,GAAD,MAGF,kBAAC,IAAMmD,SAAP,OAGHmN,GAAU,WACd,OACE,kBAAC,IAAMnN,SAAP,KACE,kBAAC,GAAD,MACA,kBAAC,GAAD,QAKAqW,GAAY,WAChB,IAAM9X,EAAWC,cACXlC,EAAOqF,aAAY,SAACC,GACxB,OAAOA,EAAMrL,GAAG8F,MAAMC,QAGxB,IAAKA,EACH,OAAO,kBAAC,IAAM0D,SAAP,MAWT,OAAO,kBAAC,GAAD,CAAcpE,MAAOU,EAAMuL,SARjB,SAAAjM,GACf,IAAIZ,EAAWY,OACDnF,IAAVmF,GAAiC,OAAVA,IAAmC,IAAjByR,MAAMzR,KACjDZ,EAAW,GAEbuD,EAASf,EAAQO,QAAQuY,uBAAuBtb,QAM9Cub,GAAa,WACjB,IAAMhY,EAAWC,cACXjL,EAAQoO,aAAY,SAACC,GACzB,OAAOA,EAAMrL,GAAG8F,MAAM9I,SAGxB,IAAKA,EACH,OAAO,kBAAC,IAAMyM,SAAP,MAOT,OAAO,kBAAC,GAAD,CAAe6H,SAJL,SAAAtU,GACfgL,EAASf,EAAQO,QAAQyY,wBAAwBjjB,KAGTqI,MAAOrI,KCvDtCkjB,GAAkB,WAC7B,IAAM1Z,EAAQ4E,aAAY,SAACC,GACzB,OAAOA,EAAMrL,GAAGuG,WAAWC,SAGrB7J,EAAkC6J,EAAlC7J,SAAU8J,EAAwBD,EAAxBC,IAAK/K,EAAmB8K,EAAnB9K,MAAOgL,EAAYF,EAAZE,QAE9B,OAAKD,EAKH,yBACE0Z,IAAK1Z,EACL2C,MAAO,CACLzM,SAAU,WACViO,IAAK,EACLF,KAAM,EAGNa,OAAQ,EACRlC,UAAU,eAAD,OAAiB1M,EAAS3B,EAA1B,eAAkC2B,EAAS1B,EAA3C,0BAA8DS,EAA9D,KACT4N,gBAAiB,WACjB5C,aAfG,kBAAC,IAAM+C,SAAP,OCiBE2W,GAAc,WACzB,IAAMrY,EAAaqD,aAAY,SAACC,GAC9B,OAAOA,EAAMhK,QAGTgK,EADQgV,cACMC,WAqBpB,OApBAjd,QAAQC,IAAI,mBAAoB+H,GAoB3BA,EAKH,yBAAKjD,UAAU,SACb,yBAAKA,UAAU,kBACb,kBAAC,GAAD,MACA,kBAAC,GAAD,OAGF,yBAAKA,UAAU,mBACb,kBAAC,EAAD,CAAaL,WAAYA,KAG3B,yBAAKK,UAAW,iBACd,kBAAC,GAAD,MAEA,kBAAC,GAAD,CAAaoB,SAAUzB,IAAerN,EAAWmO,UAEjD,kBAAC,GAAD,CAAqBvC,UAAWyB,IAAerN,EAAW4G,YAE1D,kBAAC,GAAD,CAAqBgF,UAAWyB,IAAerN,EAAWiO,YAE1D,kBAAC,GAAD,CAActH,KAAM0G,IAEpB,kBAAC,GAAD,CAAc1G,KAAM0G,IAEpB,kBAAC,GAAD,CAAkBzB,UAAWyB,IAAerN,EAAW4G,YAEvD,kBAAC,GAAD,CAA2BD,KAAM0G,IAEjC,kBAAC,GAAD,CAAOzB,UAAWyB,IAAerN,EAAWgN,SAG9C,yBAAKU,UAAW,mBACd,kBAAC,GAAD,CAAkB9B,UAAWyB,IAAerN,EAAW4G,YACvD,kBAAC,GAAD,CAAkBgF,UAAWyB,IAAerN,EAAWiO,YACvD,kBAAC,GAAD,CAAgBrC,UAAWyB,IAAerN,EAAWmO,UACrD,kBAAC,GAAD,CAAavC,UAAWyB,IAAerN,EAAWsM,OAClD,kBAAC,GAAD,CAAcV,UAAWyB,IAAerN,EAAWgN,UAvChD,8C,SCjCI6Y,GAfO,WACpB,IAAMC,EAAYC,aAChB9Y,GAIF,OACE,yBAAKS,UAAU,OACb,kBAAC,IAAD,CAAUT,MAAO6Y,GACf,kBAAC,GAAD,SCLYE,QACW,cAA7Bnd,OAAOmL,SAASiS,UAEe,UAA7Bpd,OAAOmL,SAASiS,UAEhBpd,OAAOmL,SAASiS,SAASC,MACvB,2D,OCXNC,EAAY,CAACC,IAAK,+DAElBC,IAASC,OAAO,kBAAC,GAAD,MAASC,SAASC,eAAe,SDgI3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.0f7306ad.chunk.js","sourcesContent":["import { immerable } from \"immer\";\nimport { DeepPartial } from \"ts-essentials\";\n\nexport interface Point {\n  x: number;\n  y: number;\n  [immerable]: boolean;\n}\n\nexport enum BeadTypes {\n  BasicRectangle = \"BasicRectangle\",\n  BasicEllipse = \"BasicEllipse\",\n}\n\nexport interface Bead {\n  id: string;\n  position: Point;\n  [immerable]: boolean;\n  width: number;\n  height: number;\n  type: BeadTypes;\n  color: string;\n  rotate: number;\n  lineRotate: number;\n  keepAspectRatio: boolean;\n}\n\nexport interface Line {\n  id: string;\n  start: Point;\n  end: Point;\n  beadIds: string[];\n  [immerable]: boolean;\n  settings: {\n    beadsCount: number;\n    beadsAutoCount: boolean;\n    beadsSpacing: number;\n    beadsAutoSpacing: boolean;\n    defaultBead: Partial<Bead>;\n  };\n}\n\nexport interface AppData {\n  beads: { [s: string]: Bead };\n  lines: { [s: string]: Line };\n}\n\nexport enum EditorMode {\n  Idle = \"Idle\",\n  EditLines = \"EditLines\",\n  AddLine = \"AddLine\",\n  EditBeads = \"EditBeads\",\n  Paint = \"ColorPaint\",\n}\nexport enum EditorMenuMain {\n  None = \"None\",\n  File = \"File\",\n  Grid = \"Grid\",\n  Background = \"Background\",\n}\nexport enum EditorGridType {\n  Hex = \"Hex\",\n  Box = \"Box\",\n}\nexport enum BrushType {\n  Color = \"Color\",\n}\n\nexport interface EditorUi {\n  lineSettings: DeepPartial<Line>;\n  saveInfo: {\n    saved: boolean;\n    haveUnsavedChanges: boolean;\n  };\n  selectedLinesIds: { [s: string]: boolean };\n  selectedLinesIdsCount: number;\n  selectedBeadsIds: { [s: string]: boolean };\n  selectedBeadsIdsCount: number;\n  mouseSelection: {\n    start: Point;\n    end: Point;\n    isDragStarted: boolean;\n    isDragged: boolean;\n  };\n  currentMenuMainOpen: EditorMenuMain;\n  grid: {\n    type: EditorGridType;\n    hexSize: number;\n    snapEnabled: boolean;\n    isVisible: boolean;\n    width: number;\n    height: number;\n  };\n  brush: {\n    type: BrushType;\n    size: number;\n    color: string;\n  };\n  background: {\n    image: {\n      url: string;\n      scale: number;\n      position: Point;\n      opacity: number;\n    };\n  };\n}\n\nexport interface Editor {\n  appData: AppData;\n  ui: EditorUi;\n  mode: EditorMode;\n}\n","export const uiButton = \"#aeaeae\"\nexport const defaulBeadColor = \"#4fc3f7\";","import { Point } from \"./Editor\";\nimport { immerable } from \"immer\";\n\nexport const buildPoint = (x: number = 0, y: number = 0): Point => {\n  return {\n    x,\n    y,\n    [immerable]: true,\n  } as Point;\n};\n\nexport const getLength = (point: Point) => {\n  return Math.sqrt(point.x * point.x + point.y * point.y);\n};\n\nexport const normalize = (point: Point) => {\n  const length = getLength(point);\n  const useLen = length === 0;\n  const x = useLen ? 0 : point.x / length;\n  const y = useLen ? 0 : point.y / length;\n  return buildPoint(x, y);\n};\n\nexport const scale = (point: Point, scalar: number) => {\n  return buildPoint(point.x * scalar, point.y * scalar);\n};\n\nexport const add = (point: Point, x: number, y: number) => {\n  return buildPoint(point.x + x, point.y + y);\n};\n\nexport const getDistance = (x1, y1, x2, y2): number => {\n  return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n};\n\nexport const getDistanceBetweenPoints = (start: Point, end: Point): number => {\n  return Math.sqrt(\n    (end.x - start.x) * (end.x - start.x) +\n      (end.y - start.y) * (end.y - start.y)\n  );\n};\n\nexport const getRotate = (y, x) => {\n  return Math.atan2(y, x);\n};\n\nexport const contain = (p1: Point, p2: Point, p: Point): boolean => {\n  return p.x > p1.x && p.x < p2.x && p.y > p1.y && p.y < p2.y;\n};\n\nexport const toRadian = (radians: number) => {\n  return (radians / 180) * Math.PI;\n};\n\nexport const toDeg = (radians: number) => {\n  return (radians * 180) / Math.PI;\n};\n","import { immerable } from \"immer\";\nimport { generate } from \"shortid\";\nimport { Point, Bead, BeadTypes } from \"./Editor\";\nimport { DeepPartial } from \"ts-essentials\";\nimport { buildPoint } from \"./Point\";\nimport { merge } from \"lodash\";\nimport { defaulBeadColor } from \"../components/colors\";\n\nexport const buildBead = (props: DeepPartial<Bead>): Bead => {\n  const defaults: Bead = {\n    id: generate(),\n    position: buildPoint(0, 0),\n    type: BeadTypes.BasicEllipse,\n    rotate: 0,\n    lineRotate: 0,\n    color: defaulBeadColor,\n    height: 10,\n    width: 10,\n    keepAspectRatio: false,\n    [immerable]: true,\n  };\n  return merge(defaults, props);\n  // const id = generate();\n  // const beadType = type ? type : BeadTypes.BasicCircle;\n  // const common = {\n  //   id,\n  //   position,\n  //   [immerable]: true,\n  //   type: beadType,\n  // };\n\n  // if (beadType === BeadTypes.BasicCircle) {\n  //   return buildBead_BasicCircle(common);\n  // }\n\n  // if (beadType === BeadTypes.BasicRectangle) {\n  //   return buildBead_BasicRectangle(common);\n  // }\n\n  // return buildBead_BasicCircle(common);\n};\n\n// const buildBead_BasicCircle = common => {\n//   return {\n//     ...common,\n//     width: 20,\n//     height: 20,\n//     fill: `linear-gradient(\n//       to bottom,\n//       rgba(254, 204, 177, 1) 0%,\n//       rgba(241, 116, 50, 1) 50%,\n//       rgba(234, 85, 7, 1) 51%,\n//       rgba(251, 149, 94, 1) 100%\n//     )`,\n//     settings: {\n//       radius: 20,\n//     },\n//   } as Bead;\n// };\n\n// const buildBead_BasicRectangle = common => {\n//   return {\n//     ...common,\n//     width: 20,\n//     height: 40,\n//     fill: \"#b1b1b1\",\n//   } as Bead;\n// };\n","import { immerable } from \"immer\";\nimport { Line, Point } from \"./Editor\";\nimport { generate } from \"shortid\";\nimport { normalize, scale, add, buildPoint } from \"./Point\";\nimport { merge } from \"lodash\";\nimport { DeepPartial } from \"ts-essentials\";\nimport { buildBead } from \"./Bead\";\n\nexport const buildLine = (props: DeepPartial<Line>): Line => {\n  const __defaults = {\n    id: generate(),\n    start: buildPoint(10, 10),\n    end: buildPoint(100, 100),\n    beadIds: [],\n    settings: {\n      beadsCount: 0,\n      beadsAutoCount: true,\n      beadsSpacing: 0,\n      beadsAutoSpacing: false,\n      defaultBead: buildBead({}),\n    },\n    [immerable]: true,\n  };\n\n  return merge(__defaults, props);\n};\n\nexport const getLength = (line: Line): number => {\n  return Math.sqrt(\n    (line.end.x - line.start.x) * (line.end.x - line.start.x) +\n      (line.end.y - line.start.y) * (line.end.y - line.start.y)\n  );\n};\n\nexport const getPointFromStart = (line: Line, distance: number): Point => {\n  const x = line.end.x - line.start.x;\n  const y = line.end.y - line.start.y;\n  let point = buildPoint(x, y);\n  point = normalize(point);\n  point = scale(point, distance);\n  point = add(point, line.start.x, line.start.y);\n  return point;\n};\n\nexport const getPointFromStartLine = (\n  startX: number,\n  startY: number,\n  endX: number,\n  endY: number,\n  distance: number\n): Point => {\n  const x = endX - startX;\n  const y = endY - startY;\n  let point = buildPoint(x, y);\n  point = normalize(point);\n  point = scale(point, distance);\n  point = add(point, startX, startY);\n  return point;\n};\n","import { ImmerReducer } from \"immer-reducer\";\nimport { Editor, EditorMode, Point } from \"../editorObjects/Editor\";\nimport {\n  buildPoint,\n  getDistanceBetweenPoints,\n  getRotate,\n  toDeg,\n} from \"../editorObjects/Point\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { getPointFromStartLine } from \"../editorObjects/Line\";\nimport { merge } from \"lodash\";\n\nexport class BeadSnapperImmerReducer extends ImmerReducer<Editor> {\n  \n  // useHexGrid(){\n  //   xPos = P.transform.position[0];\n  //   yPos = P.transform.position[1];\n\n  //   cSize = L.effect(\"Cell Size\")(\"Slider\");\n  //   xOffset = L.effect(\"X Offset\")(\"Slider\");\n  //   yOffset = L.effect(\"Y Offset\")(\"Slider\");\n\n  //   // Convert size value into distance values between cells\n  //   cWidth = cSize*.75;\n  //   cHeight = cSize*13/15;\n\n  //   // Find new X and Y positions\n  //   yNew = yPos - yPos % cHeight + cHeight/2;\n  //   xNew = xPos - (xPos % cWidth) + (((yNew - cHeight/2).toFixed(2)/cHeight).toFixed(2) % 1) * (cWidth/2);\n\n  //   // Check for even/odd column, adjust properly\n  //   if (!(xNew % (cWidth*2) == 0)) yNew += cHeight/2;\n\n  //   // Implement offset\n  //   [xNew + xOffset, yNew+yOffset]\n  // }\n\n  updateBeadsPositions(lineId: string) {\n    // console.log(\"updateBeadsPositions: ---------------------- start\");\n    const currentLine = this.draftState.appData.lines[lineId];\n    const count = this.getLineBeadsCount(lineId);\n    const currentCount = currentLine.beadIds.length;\n    // console.log(\n    //   \"updateBeadsPositions: currentCount: \",\n    //   currentCount,\n    //   \" count\",\n    //   count\n    // );\n    if (count > currentCount) {\n      const remaining = count - currentCount;\n      this.addRemainingBeads(lineId, remaining);\n    } else if (count < currentCount) {\n      const overflow = currentCount - count;\n      this.removeOverflowBeads(lineId, overflow);\n    }\n    this.draftState.appData.lines[lineId].settings.beadsCount = count;\n    this.modifyBeadsPosition(lineId);\n    this.modifyBeadsRotate(lineId);\n    // console.log(\"updateBeadsPositions: ----------------------  end\");\n  }\n\n  getLineBeadsCount(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const {\n      beadsAutoCount,\n      beadsAutoSpacing,\n      beadsCount,\n      beadsSpacing,\n      defaultBead,\n    } = currentLine.settings;\n    const { start, end, beadIds } = currentLine;\n    const lineLen = getDistanceBetweenPoints(start, end);\n\n    // console.log(\n    //   \"getLineBeadsCount \",\n    //   lineLen,\n    //   beadsAutoCount === true,\n    //   beadsAutoSpacing === true\n    // );\n    if (beadsAutoCount === true && beadsAutoSpacing === true) {\n      // beadsy sa przyklejone do siebie. COunt powinien byc tyle ile sie zmiesci na lini\n      let beadsWidths: number[] = [];\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width = this.draftState.appData.beads[beadId].width;\n        beadsWidth = beadsWidth + width;\n        beadsWidths.push(width);\n      });\n      if (lineLen >= beadsWidth) {\n        // ile defaultsow trzeba dodac aby linia byla wypelniona?\n        const defaultBeadWidth = defaultBead.width ? defaultBead.width : 10;\n        const remainingSpace = lineLen - beadsWidth;\n        const count =\n          Math.floor(remainingSpace / defaultBeadWidth) + beadsWidths.length;\n\n        return count;\n      } else {\n        // trzeba odejmowac elementy z lini do momentu az wszystkie sie zmnieszcza\n        for (let i = beadsWidths.length - 1; i >= 0; i--) {\n          beadsWidth = beadsWidth - beadsWidths[i];\n          if (lineLen > beadsWidth) {\n            const count = i;\n            return count;\n          }\n        }\n        // nie powinno byc elementow na linie, bo nie ma miejsca z lineLen\n        return 0;\n      }\n    } else if (beadsAutoCount === false && beadsAutoSpacing === false) {\n      return beadsCount;\n    } else if (beadsAutoCount === true && beadsAutoSpacing === false) {\n      let beadsWidths: number[] = [];\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width =\n          this.draftState.appData.beads[beadId].width + beadsSpacing;\n        beadsWidth = beadsWidth + width;\n        beadsWidths.push(width);\n      });\n      if (lineLen >= beadsWidth - beadsSpacing) {\n        const defaultBeadWidth = defaultBead.width ? defaultBead.width : 10;\n        const remainingSpace = lineLen - (beadsWidth - beadsSpacing);\n        const count =\n          Math.floor(remainingSpace / (defaultBeadWidth + beadsSpacing)) +\n          beadsWidths.length;\n        return count;\n      } else {\n        for (let i = beadsWidths.length - 1; i >= 0; i--) {\n          beadsWidth = beadsWidth - beadsWidths[i];\n          if (lineLen > beadsWidth - beadsSpacing) {\n            const count = i;\n            return count;\n          }\n        }\n        return 0;\n      }\n    } else if (beadsAutoCount === false && beadsAutoSpacing === true) {\n      return beadsCount;\n    }\n    return 0;\n  }\n\n  addRemainingBeads(lineId, remainingCount) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    for (let i = 0; i < remainingCount; i++) {\n      let defaultBead: any = {};\n      if (currentLine.settings.defaultBead) {\n        defaultBead = { ...currentLine.settings.defaultBead };\n      } else if (\n        this.draftState.ui.lineSettings.settings &&\n        this.draftState.ui.lineSettings.settings.defaultBead\n      ) {\n        defaultBead = {\n          ...this.draftState.ui.lineSettings.settings.defaultBead,\n        };\n      }\n      defaultBead.id = undefined;\n      defaultBead.position = undefined;\n      const bead = buildBead(defaultBead);\n      this.draftState.appData.beads[bead.id] = bead;\n      this.draftState.appData.lines[lineId].beadIds.push(bead.id);\n    }\n  }\n\n  removeOverflowBeads(lineId, overflowCount) {\n    for (let i = 0; i < overflowCount; i++) {\n      const arrLen = this.draftState.appData.lines[lineId].beadIds.length;\n      const lastItemBeadId = this.draftState.appData.lines[\n        lineId\n      ].beadIds.splice(arrLen - 1, 1);\n      delete this.draftState.appData.beads[lastItemBeadId[0]];\n    }\n  }\n\n  modifyBeadsPosition(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const { start, end, beadIds } = currentLine;\n    const {\n      beadsAutoCount,\n      beadsAutoSpacing,\n      beadsCount,\n      beadsSpacing,\n      defaultBead,\n    } = currentLine.settings;\n\n    const standardLineHeight = 10;\n\n    if (beadsAutoCount === true && beadsAutoSpacing === true) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2;\n      });\n    } else if (beadsAutoCount === false && beadsAutoSpacing === false) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + beadsSpacing;\n      });\n    } else if (beadsAutoCount === true && beadsAutoSpacing === false) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + beadsSpacing;\n      });\n    } else if (beadsAutoCount === false && beadsAutoSpacing === true) {\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width = this.draftState.appData.beads[beadId].width;\n        beadsWidth = beadsWidth + width;\n      });\n      const lineLen = getDistanceBetweenPoints(start, end);\n      const avaiableSpace = lineLen - beadsWidth;\n      let dynamicBeadsSpacing = 0;\n      if (beadIds.length > 1) {\n        dynamicBeadsSpacing = avaiableSpace / (beadIds.length - 1);\n      }\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + dynamicBeadsSpacing;\n      });\n    }\n  }\n\n  modifyBeadsRotate(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const { start, end, beadIds } = currentLine;\n    const lineRotateRadian = getRotate(start.x - end.x, start.y - end.y);\n    beadIds.forEach(beadId => {\n      this.draftState.appData.beads[beadId].lineRotate =\n        toDeg(lineRotateRadian) * -1;\n    });\n  }\n}\n","import {\n  Editor,\n  EditorMode,\n  Point,\n  EditorGridType,\n} from \"../editorObjects/Editor\";\nimport { buildPoint, getDistanceBetweenPoints } from \"../editorObjects/Point\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { getPointFromStartLine } from \"../editorObjects/Line\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\n\nconst lineBoxOffset = 5;\n\nexport class DraggableOperationsImmerReducer extends BeadSnapperImmerReducer {\n  editorAppDataHasChanged() {\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = true;\n  }\n\n  action_onAddLine(start: Point, end: Point) {\n    const line = buildLine({ ...this.draftState.ui.lineSettings, start, end });\n    this.draftState.appData.lines[line.id] = line;\n    this.draftState.mode = EditorMode.EditLines;\n    this.updateBeadsPositions(line.id);\n    this.editorAppDataHasChanged();\n  }\n\n  action_onStartPointDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n    }\n  ) {\n    // console.log(\"action_onStartPointDrag\");\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        type,\n        hexSize,\n      } = this.draftState.ui.grid;\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.start.x = Math.round(data.x / width) * width - lineBoxOffset;\n          line.start.y = Math.round(data.y / height) * height - lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n          const changeX = Math.round(data.x / hSpace) * hSpace - lineBoxOffset;\n          const vLine = Math.round(data.y / vSpace);\n          const changeY = vLine * vSpace - lineBoxOffset - hexHeight / 4;\n          line.start.y = changeY;\n          if (vLine % 2 === 0) {\n            line.start.x = hSpace / 2 + changeX;\n          } else {\n            line.start.x = changeX;\n          }\n        }\n      } else {\n        line.start.x = data.x - lineBoxOffset;\n        line.start.y = data.y - lineBoxOffset;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onEndPointDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n    }\n  ) {\n    // console.log(\"action_onEndPointDrag\");\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        hexSize,\n        type,\n      } = this.draftState.ui.grid;\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.end.x = Math.round(data.x / width) * width - lineBoxOffset;\n          line.end.y = Math.round(data.y / height) * height - lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n          const changeX = Math.round(data.x / hSpace) * hSpace - lineBoxOffset;\n          const vLine = Math.round(data.y / vSpace);\n          const changeY = vLine * vSpace - lineBoxOffset - hexHeight / 4;\n          line.end.y = changeY;\n          if (vLine % 2 === 0) {\n            line.end.x = hSpace / 2 + changeX;\n          } else {\n            line.end.x = changeX;\n          }\n        }\n      } else {\n        line.end.x = data.x - lineBoxOffset;\n        line.end.y = data.y - lineBoxOffset;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onLineDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n      deltaX: number;\n      deltaY: number;\n      startX: number;\n      startY: number;\n      lineStart: Point | null;\n      lineEnd: Point | null;\n    }\n  ) {\n    const { startX, startY, lineStart, lineEnd, x, y } = data;\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        type,\n        hexSize,\n      } = this.draftState.ui.grid;\n\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.start.x =\n            Math.round((line.start.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.start.y =\n            Math.round((line.start.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n\n          line.end.x =\n            Math.round((line.end.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.end.y =\n            Math.round((line.end.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n\n          if (lineStart !== null) {\n            const newX = lineStart.x + (x - startX);\n            const newY = lineStart.y + (y - startY);\n            const changeX = Math.round(newX / hSpace) * hSpace - lineBoxOffset;\n\n            const vLine = Math.round(newY / vSpace);\n            const newChangeY = vLine * vSpace;\n            const temp = hexHeight / 4;\n            let changeY = newChangeY - lineBoxOffset - temp;\n            line.start.y = changeY;\n            if (vLine % 2 === 0) {\n              line.start.x = hSpace / 2 + changeX;\n            } else {\n              line.start.x = changeX;\n            }\n          }\n\n          if (lineEnd !== null) {\n            const newX = lineEnd.x + (x - startX);\n            const newY = lineEnd.y + (y - startY);\n            const changeX = Math.round(newX / hSpace) * hSpace - lineBoxOffset;\n\n            const vLine = Math.round(newY / vSpace);\n            const newChangeY = vLine * vSpace;\n            const temp = hexHeight / 4;\n            let changeY = newChangeY - lineBoxOffset - temp;\n            line.end.y = changeY;\n            if (vLine % 2 === 0) {\n              line.end.x = hSpace / 2 + changeX;\n            } else {\n              line.end.x = changeX;\n            }\n          }\n        }\n      } else {\n        line.start.x = line.start.x + data.deltaX;\n        line.start.y = line.start.y + data.deltaY;\n        line.end.x = line.end.x + data.deltaX;\n        line.end.y = line.end.y + data.deltaY;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onGroupLineDrag(data: { deltaX: number; deltaY: number }) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(lineId => {\n      if (this.draftState.appData.lines[lineId]) {\n        const line = this.draftState.appData.lines[lineId];\n        const { width, height, snapEnabled } = this.draftState.ui.grid;\n        if (snapEnabled === true) {\n          line.start.x =\n            Math.round((line.start.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.start.y =\n            Math.round((line.start.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n\n          line.end.x =\n            Math.round((line.end.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.end.y =\n            Math.round((line.end.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n        } else {\n          line.start.x = line.start.x + data.deltaX;\n          line.start.y = line.start.y + data.deltaY;\n          line.end.x = line.end.x + data.deltaX;\n          line.end.y = line.end.y + data.deltaY;\n        }\n        this.updateBeadsPositions(line.id);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_onGroupBeadsDrag(data: { deltaX: number; deltaY: number }) {}\n\n  action_onClickLine(lineId: string) {\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIds[lineId] = true;\n    this.draftState.ui.selectedLinesIdsCount = 1;\n  }\n\n  action_onClickLastestLine() {\n    const keys = Object.keys(this.draftState.appData.lines);\n    if (keys.length > 0) {\n      const lineId = keys[keys.length - 1];\n      this.action_onClickLine(lineId);\n    }\n  }\n\n  action_onClickBead(beadId: string) {\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIds[beadId] = true;\n    this.draftState.ui.selectedBeadsIdsCount = 1;\n  }\n}\n","import { Editor } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\n\nexport class PersistImmerReducer extends BeadSnapperImmerReducer {\n  action_onClearCanvas() {\n    this.draftState.appData.beads = {};\n    this.draftState.appData.lines = {};\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIdsCount = 0;\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n  }\n\n  action_readSavedCanvas() {\n    console.log(\"action_readSavedCanvas\");\n    if (\"localStorage\" in window) {\n      this.draftState.ui.saveInfo.saved = true;\n      this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n      const readedData = localStorage.getItem(\"appData\");\n      if (readedData !== null) {\n        try {\n          const cached = JSON.parse(readedData) as Editor[\"appData\"];\n          this.draftState.appData = {\n            beads: {},\n            lines: {},\n          };\n          Object.keys(cached.beads).forEach(beadId => {\n            const currBead = cached.beads[beadId];\n            const bead = buildBead(currBead);\n            this.draftState.appData.beads[beadId] = bead;\n          });\n          Object.keys(cached.lines).forEach(lineId => {\n            const currLine = cached.lines[lineId];\n            const line = buildLine(currLine);\n            this.draftState.appData.lines[lineId] = line;\n          });\n          Object.keys(this.draftState.appData.lines).forEach(lineId => {\n            this.updateBeadsPositions(lineId);\n          });\n          console.log(\"action_readSavedCanvas loaded\");\n        } catch (err) {\n          console.error(\"action_readSavedCanvas error: \", err);\n        }\n      } else {\n        console.info(\"No data in localstorage\");\n      }\n    } else {\n      console.info(\"No localstorage available\");\n    }\n  }\n\n  action_onSaveCanvas() {\n    if (\"localStorage\" in window) {\n      localStorage.setItem(\"appData\", JSON.stringify(this.draftState.appData));\n      this.draftState.ui.saveInfo.saved = true;\n      this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n      console.log(\"action_onSaveCanvas saved\");\n    } else {\n      this.draftState.ui.saveInfo.saved = false;\n      console.info(\"No localstorage available\");\n    }\n  }\n}\n\nconst a = {\n  beads: {\n    \"a19AKjQX-\": {\n      id: \"a19AKjQX-\",\n      position: { x: 124.9038105676658, y: 49 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"KYwow-3r-\": {\n      id: \"KYwow-3r-\",\n      position: { x: 176.9038105676658, y: 49 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"8Zv9yoc3O\": {\n      id: \"8Zv9yoc3O\",\n      position: { x: 228.9038105676658, y: 49 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    Csyy61dk7: {\n      id: \"Csyy61dk7\",\n      position: { x: 280.9038105676658, y: 49 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"K9seOU-sZ\": {\n      id: \"K9seOU-sZ\",\n      position: { x: 332.9038105676658, y: 49 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"4OluG2val\": {\n      id: \"4OluG2val\",\n      position: { x: 384.9038105676658, y: 49 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    WyVILEjgG: {\n      id: \"WyVILEjgG\",\n      position: { x: 436.9038105676658, y: 49 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    oQ14N6Po8: {\n      id: \"oQ14N6Po8\",\n      position: { x: 98.92304845413263, y: 94 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    Av87g3peZ: {\n      id: \"Av87g3peZ\",\n      position: { x: 150.92304845413264, y: 94 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    I2UB_GTly: {\n      id: \"I2UB_GTly\",\n      position: { x: 202.92304845413264, y: 94 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    yGTQ4IT7l: {\n      id: \"yGTQ4IT7l\",\n      position: { x: 254.92304845413264, y: 94 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    sAXQ7hsQP: {\n      id: \"sAXQ7hsQP\",\n      position: { x: 306.92304845413264, y: 94 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    deV4qFK6b: {\n      id: \"deV4qFK6b\",\n      position: { x: 358.92304845413264, y: 94 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    VKyNP8c6Q: {\n      id: \"VKyNP8c6Q\",\n      position: { x: 410.92304845413264, y: 94 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    uwSd7QcQe: {\n      id: \"uwSd7QcQe\",\n      position: { x: 124.9038105676658, y: 139 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    fnAnxCx1i: {\n      id: \"fnAnxCx1i\",\n      position: { x: 176.9038105676658, y: 139 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    gZX7etv17: {\n      id: \"gZX7etv17\",\n      position: { x: 228.9038105676658, y: 139 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"0tH_CViDI\": {\n      id: \"0tH_CViDI\",\n      position: { x: 280.9038105676658, y: 139 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"8R3hzq0Kk\": {\n      id: \"8R3hzq0Kk\",\n      position: { x: 332.9038105676658, y: 139 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"4vauo8kt4\": {\n      id: \"4vauo8kt4\",\n      position: { x: 384.9038105676658, y: 139 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"ZqMNO9Q5-\": {\n      id: \"ZqMNO9Q5-\",\n      position: { x: 436.9038105676658, y: 139 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    wxjOD75mB: {\n      id: \"wxjOD75mB\",\n      position: { x: 98.92304845413263, y: 184 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    EyabW_7SH: {\n      id: \"EyabW_7SH\",\n      position: { x: 150.92304845413264, y: 184 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"QX-VSqWHJ\": {\n      id: \"QX-VSqWHJ\",\n      position: { x: 202.92304845413264, y: 184 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    YRjrowdYg: {\n      id: \"YRjrowdYg\",\n      position: { x: 254.92304845413264, y: 184 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    NwMuNbOKC: {\n      id: \"NwMuNbOKC\",\n      position: { x: 306.92304845413264, y: 184 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    Nia0xNTig: {\n      id: \"Nia0xNTig\",\n      position: { x: 358.92304845413264, y: 184 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"4t8McpTRT\": {\n      id: \"4t8McpTRT\",\n      position: { x: 410.92304845413264, y: 184 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    QZM85vE4H: {\n      id: \"QZM85vE4H\",\n      position: { x: 124.9038105676658, y: 229 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    m6NK9xpnJ: {\n      id: \"m6NK9xpnJ\",\n      position: { x: 176.9038105676658, y: 229 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"4SXetBeWL\": {\n      id: \"4SXetBeWL\",\n      position: { x: 228.9038105676658, y: 229 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    UhzJs0GPl: {\n      id: \"UhzJs0GPl\",\n      position: { x: 280.9038105676658, y: 229 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    yeLLzgEY6: {\n      id: \"yeLLzgEY6\",\n      position: { x: 332.9038105676658, y: 229 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    ZEU_ZVZik: {\n      id: \"ZEU_ZVZik\",\n      position: { x: 384.9038105676658, y: 229 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"5GbXtZC9B\": {\n      id: \"5GbXtZC9B\",\n      position: { x: 98.92304845413263, y: 274 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    N8qDr6L3f: {\n      id: \"N8qDr6L3f\",\n      position: { x: 150.92304845413264, y: 274 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"9IUytGuY1\": {\n      id: \"9IUytGuY1\",\n      position: { x: 202.92304845413264, y: 274 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    WPv1QJeJa: {\n      id: \"WPv1QJeJa\",\n      position: { x: 254.92304845413264, y: 274 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    dVhb5iUkr: {\n      id: \"dVhb5iUkr\",\n      position: { x: 306.92304845413264, y: 274 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    LlVZEDtJ9: {\n      id: \"LlVZEDtJ9\",\n      position: { x: 358.92304845413264, y: 274 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n    \"yQ-h8_tm0\": {\n      id: \"yQ-h8_tm0\",\n      position: { x: 410.92304845413264, y: 274 },\n      type: \"BasicEllipse\",\n      rotate: 0,\n      lineRotate: 90,\n      color: \"#4fc3f7\",\n      height: 52,\n      width: 52,\n      keepAspectRatio: true,\n    },\n  },\n  lines: {\n    \"YaQ3-jOG\": {\n      id: \"YaQ3-jOG\",\n      start: { x: 124.90381056766579, y: 70 },\n      end: { x: 540.5960043841962, y: 70 },\n      beadIds: [\n        \"a19AKjQX-\",\n        \"KYwow-3r-\",\n        \"8Zv9yoc3O\",\n        \"Csyy61dk7\",\n        \"K9seOU-sZ\",\n        \"4OluG2val\",\n        \"WyVILEjgG\",\n      ],\n      settings: {\n        beadsCount: 7,\n        beadsAutoCount: true,\n        beadsSpacing: 0,\n        beadsAutoSpacing: true,\n        defaultBead: {\n          id: \"dZjyRBQrH\",\n          position: { x: 0, y: 0 },\n          type: \"BasicEllipse\",\n          rotate: 0,\n          lineRotate: 0,\n          color: \"#4fc3f7\",\n          height: 52,\n          width: 52,\n          keepAspectRatio: true,\n        },\n      },\n    },\n    CRcLEam9P: {\n      id: \"CRcLEam9P\",\n      start: { x: 98.92304845413263, y: 115 },\n      end: { x: 514.6152422706631, y: 115 },\n      beadIds: [\n        \"oQ14N6Po8\",\n        \"Av87g3peZ\",\n        \"I2UB_GTly\",\n        \"yGTQ4IT7l\",\n        \"sAXQ7hsQP\",\n        \"deV4qFK6b\",\n        \"VKyNP8c6Q\",\n      ],\n      settings: {\n        beadsCount: 7,\n        beadsAutoCount: true,\n        beadsSpacing: 0,\n        beadsAutoSpacing: true,\n        defaultBead: {\n          id: \"ILgHjX7En\",\n          position: { x: 0, y: 0 },\n          type: \"BasicEllipse\",\n          rotate: 0,\n          lineRotate: 0,\n          color: \"#4fc3f7\",\n          height: 52,\n          width: 52,\n          keepAspectRatio: true,\n        },\n      },\n    },\n    Tml7p6ZKI: {\n      id: \"Tml7p6ZKI\",\n      start: { x: 124.90381056766579, y: 160 },\n      end: { x: 540.5960043841962, y: 160 },\n      beadIds: [\n        \"uwSd7QcQe\",\n        \"fnAnxCx1i\",\n        \"gZX7etv17\",\n        \"0tH_CViDI\",\n        \"8R3hzq0Kk\",\n        \"4vauo8kt4\",\n        \"ZqMNO9Q5-\",\n      ],\n      settings: {\n        beadsCount: 7,\n        beadsAutoCount: true,\n        beadsSpacing: 0,\n        beadsAutoSpacing: true,\n        defaultBead: {\n          id: \"ibloOzyTR\",\n          position: { x: 0, y: 0 },\n          type: \"BasicEllipse\",\n          rotate: 0,\n          lineRotate: 0,\n          color: \"#4fc3f7\",\n          height: 52,\n          width: 52,\n          keepAspectRatio: true,\n        },\n      },\n    },\n    Bq4W3C3Ew: {\n      id: \"Bq4W3C3Ew\",\n      start: { x: 98.92304845413263, y: 205 },\n      end: { x: 514.6152422706631, y: 205 },\n      beadIds: [\n        \"wxjOD75mB\",\n        \"EyabW_7SH\",\n        \"QX-VSqWHJ\",\n        \"YRjrowdYg\",\n        \"NwMuNbOKC\",\n        \"Nia0xNTig\",\n        \"4t8McpTRT\",\n      ],\n      settings: {\n        beadsCount: 7,\n        beadsAutoCount: true,\n        beadsSpacing: 0,\n        beadsAutoSpacing: true,\n        defaultBead: {\n          id: \"w648Um7U6\",\n          position: { x: 0, y: 0 },\n          type: \"BasicEllipse\",\n          rotate: 0,\n          lineRotate: 0,\n          color: \"#4fc3f7\",\n          height: 52,\n          width: 52,\n          keepAspectRatio: true,\n        },\n      },\n    },\n    mJvdHpK60: {\n      id: \"mJvdHpK60\",\n      start: { x: 124.90381056766579, y: 250 },\n      end: { x: 488.63448015713, y: 250 },\n      beadIds: [\n        \"QZM85vE4H\",\n        \"m6NK9xpnJ\",\n        \"4SXetBeWL\",\n        \"UhzJs0GPl\",\n        \"yeLLzgEY6\",\n        \"ZEU_ZVZik\",\n      ],\n      settings: {\n        beadsCount: 6,\n        beadsAutoCount: true,\n        beadsSpacing: 0,\n        beadsAutoSpacing: true,\n        defaultBead: {\n          id: \"irTbjtCzJ\",\n          position: { x: 0, y: 0 },\n          type: \"BasicEllipse\",\n          rotate: 0,\n          lineRotate: 0,\n          color: \"#4fc3f7\",\n          height: 52,\n          width: 52,\n          keepAspectRatio: true,\n        },\n      },\n    },\n    pA1FF6_zm: {\n      id: \"pA1FF6_zm\",\n      start: { x: 98.92304845413263, y: 295 },\n      end: { x: 514.6152422706631, y: 295 },\n      beadIds: [\n        \"5GbXtZC9B\",\n        \"N8qDr6L3f\",\n        \"9IUytGuY1\",\n        \"WPv1QJeJa\",\n        \"dVhb5iUkr\",\n        \"LlVZEDtJ9\",\n        \"yQ-h8_tm0\",\n      ],\n      settings: {\n        beadsCount: 7,\n        beadsAutoCount: true,\n        beadsSpacing: 0,\n        beadsAutoSpacing: true,\n        defaultBead: {\n          id: \"MtRiOzAsd\",\n          position: { x: 0, y: 0 },\n          type: \"BasicEllipse\",\n          rotate: 0,\n          lineRotate: 0,\n          color: \"#4fc3f7\",\n          height: 52,\n          width: 52,\n          keepAspectRatio: true,\n        },\n      },\n    },\n  },\n};\n","import { Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\n\nexport class ChangeEditorModeImmerReducer extends ImmerReducer<Editor> {\n  action_onChangeEditorMode(newEditorMode: EditorMode) {\n    this.draftState.mode = newEditorMode;\n    this.clearSelectedBeads();\n    this.clearSelectedLines();\n  }\n  private clearSelectedBeads = () => {\n    if (this.draftState.ui.selectedBeadsIdsCount > 0) {\n      this.draftState.ui.selectedBeadsIds = {};\n      this.draftState.ui.selectedBeadsIdsCount = 0;\n    }\n  };\n  private clearSelectedLines = () => {\n    if (this.draftState.ui.selectedLinesIdsCount) {\n      this.draftState.ui.selectedLinesIds = {};\n      this.draftState.ui.selectedLinesIdsCount = 0;\n    }\n  };\n  action_setSaveInfo(newValue: boolean) {\n    this.draftState.ui.saveInfo.saved = newValue;\n  }\n}\n","import { Editor } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\n\nexport class MainImmerReducer extends ImmerReducer<Editor> {\n  action_test() {}\n  action_restoreState() {}\n}\n","import { Editor } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildPoint } from \"../editorObjects/Point\";\nimport { contain } from \"../editorObjects/Point\";\nimport { difference } from \"lodash\";\n\nexport class MouseSelectionImmerReducer extends ImmerReducer<Editor> {\n  action_onEditBeadsMouseDown(x, y) {\n    this.draftState.ui.mouseSelection.isDragStarted = true;\n\n    this.draftState.ui.mouseSelection.start.x = x;\n    this.draftState.ui.mouseSelection.start.y = y;\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n  }\n\n  action_onEditBeadsMouseMove(x, y) {\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const deltaX = end.x - start.x;\n      const deltaY = end.y - start.y;\n\n      if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n        this.draftState.ui.mouseSelection.isDragged = true;\n      }\n    }\n\n    if (this.draftState.ui.mouseSelection.isDragged === true) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const p1 = buildPoint(Math.min(start.x, end.x), Math.min(start.y, end.y));\n      const p2 = buildPoint(Math.max(start.x, end.x), Math.max(start.y, end.y));\n\n      // const selectedIds = Object.keys(this.draftState.ui.selectedBeadsIds);\n      // const newIds: string[] = [];\n\n      // Object.keys(this.draftState.appData.beads).forEach(beadId => {\n      //   const bead = this.draftState.appData.beads[beadId];\n      //   const p3 = buildPoint(bead.position.x + 10, bead.position.y + 10);\n      //   if (contain(p1, p2, p3)) {\n      //     newIds.push(beadId);\n      //   }\n      // });\n\n      // const diff = difference(newIds, selectedIds);\n\n      // if (diff.length > 0) {\n      //   this.draftState.ui.selectedBeadsIds = {};\n      //   this.draftState.ui.selectedBeadsIdsCount = 0;\n      //   newIds.forEach(id => {\n      //     this.draftState.ui.selectedBeadsIds[id] = true;\n      //     this.draftState.ui.selectedBeadsIdsCount =\n      //       this.draftState.ui.selectedBeadsIdsCount + 1;\n      //   });\n      // }\n\n      this.draftState.ui.selectedBeadsIds = {};\n      this.draftState.ui.selectedBeadsIdsCount = 0;\n      Object.keys(this.draftState.appData.beads).forEach(beadId => {\n        const bead = this.draftState.appData.beads[beadId];\n        const p3 = buildPoint(bead.position.x + 10, bead.position.y + 10);\n        if (contain(p1, p2, p3)) {\n          this.draftState.ui.selectedBeadsIds[beadId] = true;\n          this.draftState.ui.selectedBeadsIdsCount =\n            this.draftState.ui.selectedBeadsIdsCount + 1;\n        }\n      });\n    }\n  }\n\n  action_onEditBeadsMouseUp() {\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      if (this.draftState.ui.selectedBeadsIdsCount > 0) {\n        this.draftState.ui.selectedBeadsIds = {};\n        this.draftState.ui.selectedBeadsIdsCount = 0;\n      }\n    }\n\n    this.draftState.ui.mouseSelection.isDragStarted = false;\n    this.draftState.ui.mouseSelection.isDragged = false;\n    this.draftState.ui.mouseSelection.start.x = 0;\n    this.draftState.ui.mouseSelection.start.y = 0;\n    this.draftState.ui.mouseSelection.end.x = 0;\n    this.draftState.ui.mouseSelection.end.y = 0;\n  }\n\n  action_onEditLinesMouseDown(x: number, y: number) {\n    this.draftState.ui.mouseSelection.isDragStarted = true;\n    this.draftState.ui.mouseSelection.start.x = x;\n    this.draftState.ui.mouseSelection.start.y = y;\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n  }\n\n  action_onEditLinesMouseMove(x: number, y: number) {\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const deltaX = end.x - start.x;\n      const deltaY = end.y - start.y;\n      if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n        this.draftState.ui.mouseSelection.isDragged = true;\n      }\n    }\n\n    if (this.draftState.ui.mouseSelection.isDragged === true) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const p1 = buildPoint(Math.min(start.x, end.x), Math.min(start.y, end.y));\n      const p2 = buildPoint(Math.max(start.x, end.x), Math.max(start.y, end.y));\n\n      // const selectedIds = Object.keys(this.draftState.ui.selectedLinesIds);\n      // const newIds: string[] = [];\n\n      // Object.keys(this.draftState.appData.lines).forEach(lineId => {\n      //   const line = this.draftState.appData.lines[lineId];\n      //   if (contain(p1, p2, line.start) || contain(p1, p2, line.end)) {\n      //     newIds.push(lineId);\n      //   }\n      // });\n\n      // const diff = difference(newIds, selectedIds);\n\n      // if (diff.length > 0) {\n      //   this.draftState.ui.selectedLinesIds = {};\n      //   this.draftState.ui.selectedLinesIdsCount = 0;\n      //   newIds.forEach(id => {\n      //     this.draftState.ui.selectedLinesIds[id] = true;\n      //     this.draftState.ui.selectedLinesIdsCount =\n      //       this.draftState.ui.selectedLinesIdsCount + 1;\n      //   });\n      // }\n      this.draftState.ui.selectedLinesIds = {};\n      this.draftState.ui.selectedLinesIdsCount = 0;\n      Object.keys(this.draftState.appData.lines).forEach(lineId => {\n        const line = this.draftState.appData.lines[lineId];\n        if (contain(p1, p2, line.start) || contain(p1, p2, line.end)) {\n          this.draftState.ui.selectedLinesIds[lineId] = true;\n          this.draftState.ui.selectedLinesIdsCount =\n            this.draftState.ui.selectedLinesIdsCount + 1;\n        }\n      });\n    }\n  }\n\n  action_onEditLinesMouseUp() {\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      if (this.draftState.ui.selectedLinesIdsCount > 0) {\n        this.draftState.ui.selectedLinesIds = {};\n        this.draftState.ui.selectedLinesIdsCount = 0;\n      }\n    }\n\n    this.draftState.ui.mouseSelection.isDragStarted = false;\n    this.draftState.ui.mouseSelection.isDragged = false;\n    this.draftState.ui.mouseSelection.start.x = 0;\n    this.draftState.ui.mouseSelection.start.y = 0;\n    this.draftState.ui.mouseSelection.end.x = 0;\n    this.draftState.ui.mouseSelection.end.y = 0;\n  }\n}\n","import { BeadTypes } from \"../editorObjects/Editor\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { merge } from \"lodash\";\n\nexport class ToolbarImmerReducer extends BeadSnapperImmerReducer {\n  editorAppDataHasChanged() {\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = true;\n  }\n  action_changeBeadFill(color: string) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      this.draftState.appData.beads[beadId].color = color;\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeBeadType(type: BeadTypes) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      this.draftState.appData.beads[beadId].type = type;\n    });\n    this.editorAppDataHasChanged();\n  }\n  action_onBeadRotate(beadId, { deg }) {}\n  action_onBeadsRotate({ deg }) {}\n\n  action_changeSelectedLinesBeadsSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsAutoSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsAutoSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsAutoCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsAutoCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_resetSelectedLines() {\n    const firstLineId = Object.keys(this.draftState.ui.selectedLinesIds)[0];\n    const firstLine = this.draftState.appData.lines[firstLineId];\n    const defaultBead = { ...firstLine.settings.defaultBead };\n\n    defaultBead.id = undefined;\n    defaultBead.position = undefined;\n\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].beadIds.forEach(beadId => {\n        if (defaultBead) {\n          this.draftState.appData.beads[beadId] = merge(\n            this.draftState.appData.beads[beadId],\n            defaultBead\n          );\n        }\n      });\n      this.draftState.appData.lines[id].settings.defaultBead = merge(\n        this.draftState.appData.lines[id].settings.defaultBead,\n        defaultBead\n      );\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_deleteSelectedLines() {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].beadIds.forEach(beadId => {\n        delete this.draftState.appData.beads[beadId];\n      });\n      delete this.draftState.appData.lines[id];\n    });\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n    this.editorAppDataHasChanged();\n  }\n\n  action_cloneSelectedLines() {\n    const moveX = 20;\n    const moveY = 20;\n    const newLinesIds: string[] = [];\n\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      const newLine = buildLine({\n        ...this.draftState.appData.lines[id],\n        id: undefined,\n        beadIds: [],\n      });\n      newLine.start.x = newLine.start.x + moveX;\n      newLine.start.y = newLine.start.y + moveY;\n      newLine.end.x = newLine.end.x + moveX;\n      newLine.end.y = newLine.end.y + moveY;\n\n      this.draftState.appData.lines[id].beadIds.forEach(beadId => {\n        const newBead = buildBead({\n          ...this.draftState.appData.beads[beadId],\n          id: undefined,\n        });\n        newBead.position.x = newBead.position.x + moveX;\n        newBead.position.y = newBead.position.y + moveY;\n        this.draftState.appData.beads[newBead.id] = newBead;\n        newLine.beadIds.push(newBead.id);\n      });\n\n      newLinesIds.push(newLine.id);\n      this.draftState.appData.lines[newLine.id] = newLine;\n    });\n\n    newLinesIds.forEach(lineId => {\n      this.updateBeadsPositions(lineId);\n    });\n\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n\n    newLinesIds.forEach(lineId => {\n      this.draftState.ui.selectedLinesIds[lineId] = true;\n      this.draftState.ui.selectedLinesIdsCount =\n        this.draftState.ui.selectedLinesIdsCount + 1;\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  /**\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeDefaultLineBeadsCount(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsCount = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsAutoCount(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsAutoCount = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsSpacing(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsSpacing = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsAutoSpacing(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsAutoSpacing = value;\n    }\n  }\n\n  action_changeDefaultLineBeadType(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      if (this.draftState.ui.lineSettings.settings.defaultBead) {\n        this.draftState.ui.lineSettings.settings.defaultBead.type = value;\n      }\n    }\n  }\n\n  action_changeDefaultLineColor(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      if (this.draftState.ui.lineSettings.settings.defaultBead) {\n        this.draftState.ui.lineSettings.settings.defaultBead.color = value;\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadHeight(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        const {\n          width,\n          height,\n          keepAspectRatio,\n        } = lineSettings.settings.defaultBead;\n        if (keepAspectRatio && width && height) {\n          if (height >= 1) {\n            const ratio = width / height;\n            lineSettings.settings.defaultBead.width = value * ratio;\n            lineSettings.settings.defaultBead.height = value;\n          } else {\n            lineSettings.settings.defaultBead.height = 1;\n          }\n        } else {\n          lineSettings.settings.defaultBead.height = value;\n        }\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadWidth(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        const {\n          width,\n          height,\n          keepAspectRatio,\n        } = lineSettings.settings.defaultBead;\n        if (keepAspectRatio && width && height) {\n          if (width >= 1) {\n            const ratio = height / width;\n            lineSettings.settings.defaultBead.width = value;\n            lineSettings.settings.defaultBead.height = value * ratio;\n          } else {\n            lineSettings.settings.defaultBead.width = 1;\n          }\n        } else {\n          lineSettings.settings.defaultBead.width = value;\n        }\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadKeepAspectRatio(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        lineSettings.settings.defaultBead.keepAspectRatio = value;\n      }\n    }\n  }\n  action_changeDefaultLineBeadRotate(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        lineSettings.settings.defaultBead.rotate = value;\n      }\n    }\n  }\n\n  /**\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeSelectedLines_settings_beadsCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsAutoCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsAutoCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsAutoSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(id => {\n      this.draftState.appData.lines[id].settings.beadsAutoSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_type(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(lineId => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.type = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        this.draftState.appData.beads[beadId].type = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_color(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(lineId => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.color = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        this.draftState.appData.beads[beadId].color = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_height(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(lineId => {\n      const currLine = this.draftState.appData.lines[lineId];\n      let { width, height, keepAspectRatio } = currLine.settings.defaultBead;\n\n      if (keepAspectRatio === false) {\n        currLine.settings.defaultBead.height = value;\n        this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n          this.draftState.appData.beads[beadId].height = value;\n        });\n        this.updateBeadsPositions(lineId);\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n            height = value;\n          }\n\n          currLine.settings.defaultBead.width = width;\n          currLine.settings.defaultBead.height = height;\n        }\n\n        this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n          if (width && height) {\n            this.draftState.appData.beads[beadId].width = width;\n            this.draftState.appData.beads[beadId].height = height;\n          }\n        });\n\n        this.updateBeadsPositions(lineId);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_width(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(lineId => {\n      const currLine = this.draftState.appData.lines[lineId];\n      let { width, height, keepAspectRatio } = currLine.settings.defaultBead;\n\n      if (keepAspectRatio === false) {\n        currLine.settings.defaultBead.width = value;\n        this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n          this.draftState.appData.beads[beadId].width = value;\n        });\n        this.updateBeadsPositions(lineId);\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = height / width;\n            width = value;\n            height = value * ratio;\n          }\n\n          currLine.settings.defaultBead.width = width;\n          currLine.settings.defaultBead.height = height;\n        }\n\n        this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n          if (width && height) {\n            this.draftState.appData.beads[beadId].width = width;\n            this.draftState.appData.beads[beadId].height = height;\n          }\n        });\n\n        this.updateBeadsPositions(lineId);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_keepAspectRatio(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(lineId => {\n      this.draftState.appData.lines[\n        lineId\n      ].settings.defaultBead.keepAspectRatio = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        this.draftState.appData.beads[beadId].keepAspectRatio = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_rotate(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach(lineId => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.rotate = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        this.draftState.appData.beads[beadId].rotate = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  /****\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeSelectedBeads_type(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      this.draftState.appData.beads[beadId].type = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_color(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      this.draftState.appData.beads[beadId].color = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_height(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      const currBead = this.draftState.appData.beads[beadId];\n      let { width, height, keepAspectRatio } = currBead;\n\n      if (keepAspectRatio === false) {\n        this.draftState.appData.beads[beadId].height = value;\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n            height = value;\n          }\n        }\n        this.draftState.appData.beads[beadId].width = width;\n        this.draftState.appData.beads[beadId].height = height;\n      }\n    });\n\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_width(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      const currBead = this.draftState.appData.beads[beadId];\n      let { width, height, keepAspectRatio } = currBead;\n\n      if (keepAspectRatio === false) {\n        this.draftState.appData.beads[beadId].width = value;\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = height / width;\n            width = value;\n            height = value * ratio;\n          }\n        }\n        this.draftState.appData.beads[beadId].width = width;\n        this.draftState.appData.beads[beadId].height = height;\n      }\n    });\n\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_keepAspectRatio(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      this.draftState.appData.beads[beadId].keepAspectRatio = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_rotate(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      this.draftState.appData.beads[beadId].rotate = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  updateLineFromSelectedBeads() {\n    const results: string[] = [];\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach(beadId => {\n      for (const lineId of Object.keys(this.draftState.appData.lines)) {\n        if (\n          this.draftState.appData.lines[lineId].beadIds.indexOf(beadId) !== -1\n        ) {\n          if (results.indexOf(lineId) === -1) {\n            results.push(lineId);\n            break;\n          }\n        }\n      }\n    });\n    for (const lineId of results) {\n      this.updateBeadsPositions(lineId);\n    }\n  }\n\n  /****\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n\n   \n  action_updateBrushSize(value) {\n    this.draftState.ui.brush.size = value;\n  }\n\n  action_updateBrushColor(value) {\n    this.draftState.ui.brush.color = value;\n  }\n}\n","import { Editor, EditorMenuMain } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildPoint } from \"../editorObjects/Point\";\n\nexport class TopbarImmerReducer extends ImmerReducer<Editor> {\n  action_toggleMenuFile() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.File) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.File;\n    }\n  }\n  action_toggleMenuSettings() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.Grid) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.Grid;\n    }\n  }\n  action_toggleMenuBackground() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.Background) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.Background;\n    }\n  }\n  action_toggleGridSnapEnabled() {\n    this.draftState.ui.grid.snapEnabled = !this.draftState.ui.grid.snapEnabled;\n  }\n  action_toggleGridIsVisible() {\n    this.draftState.ui.grid.isVisible = !this.draftState.ui.grid.isVisible;\n  }\n  action_setGridWidth(value) {\n    this.draftState.ui.grid.width = value;\n  }\n  action_setGridHeight(value) {\n    this.draftState.ui.grid.height = value;\n  }\n  action_setGridType(value) {\n    this.draftState.ui.grid.type = value;\n  }\n  action_setGridHexSize(value) {\n    this.draftState.ui.grid.hexSize = value;\n  }\n\n  action_background_image_clear() {\n    this.draftState.ui.background.image.position = buildPoint(0, 0);\n    this.draftState.ui.background.image.scale = 1;\n    this.draftState.ui.background.image.url = \"\";\n  }\n  action_background_image_upload(value) {\n    this.draftState.ui.background.image.url = value;\n  }\n  action_background_image_pointX(value) {\n    this.draftState.ui.background.image.position.x = value;\n  }\n  action_background_image_pointY(value) {\n    this.draftState.ui.background.image.position.y = value;\n  }\n  action_background_image_scale(value) {\n    this.draftState.ui.background.image.scale = value;\n  }\n  action_background_image_opacity(value) {\n    this.draftState.ui.background.image.opacity = value;\n  }\n  \n}\n","import { Editor, BrushType } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { getDistanceBetweenPoints, buildPoint } from \"../editorObjects/Point\";\n\nexport class PaintImmerReducer extends ImmerReducer<Editor> {\n  action_applyColorBrush(x, y) {\n    const { color, type, size } = this.draftState.ui.brush;\n    if (type === BrushType.Color) {\n      const mousePoint = buildPoint(x + size / 2, y + size /2);\n      Object.keys(this.draftState.appData.beads).forEach(beadId => {\n        const currBead = this.draftState.appData.beads[beadId];\n        if (currBead.color !== color) {\n          const centerPoint = buildPoint(\n            currBead.position.x + currBead.width / 2,\n            currBead.position.y + currBead.height / 2\n          );\n          const len = getDistanceBetweenPoints(centerPoint, mousePoint);\n          const brush = size / 2 + Math.min(currBead.width , currBead.height) / 2;\n          if (len < brush) {\n            this.draftState.appData.beads[beadId].color = color;\n          }\n        }\n      });\n    }\n  }\n}\n","import {\n  Editor,\n  EditorMode,\n  BeadTypes,\n  EditorMenuMain,\n  EditorGridType,\n  BrushType,\n} from \"./editorObjects/Editor\";\nimport { buildPoint } from \"./editorObjects/Point\";\nimport { composeReducers } from \"immer-reducer\";\nimport { createActionCreators, createReducerFunction } from \"immer-reducer\";\nimport { DraggableOperationsImmerReducer } from \"./immerReducers/DraggableOperationsImmerReducer\";\nimport { PersistImmerReducer } from \"./immerReducers/PersistImmerReducer\";\nimport { ChangeEditorModeImmerReducer } from \"./immerReducers/ChangeEditorModeImmerReducer\";\nimport { MainImmerReducer } from \"./immerReducers/MainImmerReducer\";\nimport { MouseSelectionImmerReducer } from \"./immerReducers/MouseSelectionImmerReducer\";\nimport { ToolbarImmerReducer } from \"./immerReducers/ToolbarImmerReducer\";\nimport { defaulBeadColor } from \"./components/colors\";\nimport { TopbarImmerReducer } from \"./immerReducers/TopbarImmerReducer\";\nimport { PaintImmerReducer } from \"./immerReducers/PaintImmerReducer\";\n\nconst defaultAppData: Editor = {\n  appData: {\n    beads: {},\n    lines: {},\n  },\n  ui: {\n    lineSettings: {\n      settings: {\n        beadsAutoCount: true,\n        beadsAutoSpacing: true,\n        beadsCount: 0,\n        beadsSpacing: 0,\n        defaultBead: {\n          type: BeadTypes.BasicEllipse,\n          rotate: 0,\n          color: defaulBeadColor,\n          height: 52,\n          width: 52,\n          keepAspectRatio: false,\n        },\n      },\n    },\n    saveInfo: {\n      saved: false,\n      haveUnsavedChanges: false,\n    },\n    selectedLinesIds: {},\n    selectedLinesIdsCount: 0,\n    selectedBeadsIds: {},\n    selectedBeadsIdsCount: 0,\n    mouseSelection: {\n      start: buildPoint(0, 0),\n      end: buildPoint(0, 0),\n      isDragStarted: false,\n      isDragged: false,\n    },\n    currentMenuMainOpen: EditorMenuMain.None,\n    grid: {\n      type: EditorGridType.Hex,\n      hexSize: 30,\n      snapEnabled: true,\n      isVisible: true,\n      width: 30,\n      height: 30,\n    },\n    brush: {\n      type: BrushType.Color,\n      size: 50,\n      color: defaulBeadColor,\n    },\n    background: {\n      image: {\n        url: \"\",\n        scale: 1,\n        position: buildPoint(0, 0),\n        opacity: 0.5,\n      },\n    },\n  },\n  mode: EditorMode.Idle,\n};\n\nexport const Actions = {\n  Main: createActionCreators(MainImmerReducer),\n  Draggable: createActionCreators(DraggableOperationsImmerReducer),\n  Persist: createActionCreators(PersistImmerReducer),\n  ChangeEditorMode: createActionCreators(ChangeEditorModeImmerReducer),\n  MouseSelection: createActionCreators(MouseSelectionImmerReducer),\n  Toolbar: createActionCreators(ToolbarImmerReducer),\n  Topbar: createActionCreators(TopbarImmerReducer),\n  Paint: createActionCreators(PaintImmerReducer),\n};\n\nexport const store = composeReducers(\n  createReducerFunction(MainImmerReducer, defaultAppData),\n  createReducerFunction(DraggableOperationsImmerReducer, defaultAppData),\n  createReducerFunction(PersistImmerReducer, defaultAppData),\n  createReducerFunction(ToolbarImmerReducer, defaultAppData),\n  createReducerFunction(TopbarImmerReducer, defaultAppData),\n  createReducerFunction(ChangeEditorModeImmerReducer, defaultAppData),\n  createReducerFunction(MouseSelectionImmerReducer, defaultAppData),\n  createReducerFunction(PaintImmerReducer, defaultAppData)\n);\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faPlus,\n  faEdit,\n  faArrowsAlt,\n  faPaintBrush,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { EditorMode } from \"../../editorObjects/Editor\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch } from \"react-redux\";\nimport { Actions } from \"../../store\";\n\nexport const EditorModes = ({ editorMode }) => {\n  const dispatch = useDispatch();\n\n  const onChangeEditorMode = (newEditorMode: EditorMode) => {\n    dispatch(Actions.ChangeEditorMode.action_onChangeEditorMode(newEditorMode));\n  };\n\n  return (\n    <div className=\"\">\n      <StateButton\n        label={\"Idle\"}\n        icon={<FontAwesomeIcon icon={faArrowsAlt} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.Idle)}\n        isSelected={editorMode === EditorMode.Idle}\n      />\n\n      <StateButton\n        label={\"Edit Lines\"}\n        icon={<FontAwesomeIcon icon={faEdit} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.EditLines)}\n        isSelected={editorMode === EditorMode.EditLines}\n      />\n\n      <StateButton\n        label={\"Edit Beads\"}\n        icon={<FontAwesomeIcon icon={faEdit} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.EditBeads)}\n        isSelected={editorMode === EditorMode.EditBeads}\n      />\n\n      <StateButton\n        label={\"AddLine\"}\n        icon={<FontAwesomeIcon icon={faPlus} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.AddLine)}\n        isSelected={editorMode === EditorMode.AddLine}\n      />\n\n      <StateButton\n        label={\"Paint\"}\n        icon={<FontAwesomeIcon icon={faPaintBrush} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.Paint)}\n        isSelected={editorMode === EditorMode.Paint}\n      />\n    </div>\n  );\n};\n\nconst StateButton = ({ label, isSelected, onClick, icon }) => {\n  return (\n    <div\n      className={`\n              button \n              ${isSelected ? \"is-active\" : \"\"}\n            `}\n      onClick={onClick}\n    >\n      <span className=\"icon is-small\">{icon}</span>\n      <span>{label}</span>\n    </div>\n  );\n};\n","export const getTranslate3dCss = (x, y, z = 1) => {\n  return `translate3d(${x}px, ${y}px, ${z}px)`;\n};\n\nexport const getRotateCss = rotate => {\n  return `rotate(${rotate}rad)`;\n};\n","import React from \"react\";\nimport { getDistanceBetweenPoints, getRotate } from \"../../editorObjects/Point\";\nimport { getTranslate3dCss, getRotateCss } from \"../operations/MapValuesToCss\";\n\nexport const StraightLine = ({ start, end }) => {\n  const size = 5;\n  const height = 1;\n  const width = getDistanceBetweenPoints(start, end);\n  const rotate = getRotate(end.y - start.y, end.x - start.x);\n  return (\n    <div\n      style={{\n        height,\n        width,\n        transform: `${getTranslate3dCss(\n          start.x + size,\n          start.y + size\n        )} ${getRotateCss(rotate)}`,\n        transformOrigin: \"left center\",\n      }}\n      className=\"line\"\n    >\n      &nbsp;\n    </div>\n  );\n};\n","import React, { useState, MouseEvent, useRef } from \"react\";\nimport { StraightLine } from \"./StraightLine\";\nimport { getTranslate3dCss } from \"../operations/MapValuesToCss\";\nimport { useDispatch } from \"react-redux\";\nimport { Point } from \"../../editorObjects/Editor\";\nimport { Actions } from \"../../store\";\n\nexport const AddLineMode = ({ isActive }) => {\n  if (isActive === false) {\n    return <React.Fragment />;\n  }\n\n  return <AddLineModeContent />;\n};\n\nconst AddLineModeContent = () => {\n  interface SimplePoint {\n    x: number;\n    y: number;\n  }\n  const [startPoint, setStartPoint] = useState<SimplePoint>({\n    x: 0,\n    y: 0,\n  });\n  const [endPoint, setEndPoint] = useState<SimplePoint>({\n    x: 0,\n    y: 0,\n  });\n  const [isDragEnabled, setIsDragEnabled] = useState<boolean>(false);\n  const lineRef = useRef<HTMLDivElement>(null);\n  const onMouseDown = (event: MouseEvent<HTMLElement>) => {\n    if (lineRef.current) {\n      const rect = lineRef.current.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      setStartPoint({ x, y });\n      setEndPoint({ x, y });\n      setIsDragEnabled(true);\n    }\n  };\n  const onMouseUp = (event: MouseEvent<HTMLElement>) => {\n    if (isDragEnabled) {\n      if (lineRef.current) {\n        const rect = lineRef.current.getBoundingClientRect();\n        const x = event.clientX - rect.left;\n        const y = event.clientY - rect.top;\n        setEndPoint({ x, y });\n        onAddLine(startPoint, endPoint);\n        setIsDragEnabled(false);\n      }\n    }\n  };\n  const onMouseMove = (event: MouseEvent<HTMLElement>) => {\n    if (isDragEnabled) {\n      if (lineRef.current) {\n        const rect = lineRef.current.getBoundingClientRect();\n        const x = event.clientX - rect.left;\n        const y = event.clientY - rect.top;\n        setEndPoint({ x, y });\n      }\n    }\n  };\n  const dispatch = useDispatch();\n\n  const onAddLine = (start: SimplePoint, end: SimplePoint) => {\n    dispatch(Actions.Draggable.action_onAddLine(start as Point, end as Point));\n  };\n\n  return (\n    <div>\n      <div\n        onMouseDown={onMouseDown}\n        onMouseUp={onMouseUp}\n        onMouseMove={onMouseMove}\n        onMouseLeave={onMouseUp}\n        className=\"add-line-wrapper\"\n        ref={lineRef}\n      ></div>\n\n      {isDragEnabled ? (\n        <div>\n          <div\n            style={{\n              transform: getTranslate3dCss(startPoint.x, startPoint.y),\n              width: 10,\n              height: 10,\n            }}\n            className={\"line-start\"}\n          >\n            &nbsp;\n          </div>\n          <div\n            style={{\n              transform: getTranslate3dCss(endPoint.x, endPoint.y),\n              width: 10,\n              height: 10,\n            }}\n            className={\"line-end\"}\n          >\n            &nbsp;\n          </div>\n          <StraightLine start={startPoint} end={endPoint} />\n        </div>\n      ) : null}\n    </div>\n  );\n};\n","import React, { useRef, MouseEvent } from \"react\";\nimport { getTranslate3dCss } from \"./MapValuesToCss\";\nimport { Editor } from \"../../editorObjects/Editor\";\nimport { useSelector } from \"react-redux\";\n\nexport const MouseSelection = (props: {\n  isVisible: boolean;\n  onMouseDown: any;\n  onMouseUp: any;\n  onMouseMove: any;\n}) => {\n  const { isVisible } = props;\n  const sceneWrapperRef = useRef<HTMLDivElement>(null);\n\n  const start = useSelector((state: Editor) => {\n    return state.ui.mouseSelection.start;\n  });\n\n  const end = useSelector((state: Editor) => {\n    return state.ui.mouseSelection.end;\n  });\n\n  const mouseSelectionIsDragStarted = useSelector((state: Editor) => {\n    return state.ui.mouseSelection.isDragStarted;\n  });\n\n  if (isVisible === false) {\n    return <React.Fragment />;\n  }\n\n  const isActive = mouseSelectionIsDragStarted === true;\n  const { onMouseDown, onMouseUp, onMouseMove } = props;\n\n  const onMouseDownHandler = (event: MouseEvent<HTMLElement>) => {\n    if (sceneWrapperRef.current) {\n      const rect = sceneWrapperRef.current.getBoundingClientRect();\n      const x = event.clientX - rect.left;\n      const y = event.clientY - rect.top;\n      onMouseDown(x, y);\n    }\n  };\n\n  const onMouseUpHandler = (event: MouseEvent<HTMLElement>) => {\n    onMouseUp();\n  };\n\n  const onMouseMoveHandler = (event: MouseEvent<HTMLElement>) => {\n    if (isActive) {\n      if (sceneWrapperRef.current) {\n        const rect = sceneWrapperRef.current.getBoundingClientRect();\n        const x = event.clientX - rect.left;\n        const y = event.clientY - rect.top;\n        onMouseMove(x, y);\n      }\n    }\n  };\n\n  const width = Math.abs(end.x - start.x);\n  const height = Math.abs(end.y - start.y);\n  const top = Math.min(end.x, start.x);\n  const left = Math.min(end.y, start.y);\n\n  // @TODO: czy chce odznaczać zaznaczenie po wyjściu poza teren edytora?\n\n  return (\n    <div\n      className={\"mouse-selection\"}\n      ref={sceneWrapperRef}\n      onMouseDown={onMouseDownHandler}\n      onMouseUp={onMouseUpHandler}\n      // onMouseLeave={onMouseUpHandler}\n      onMouseMove={onMouseMoveHandler}\n      style={{\n        zIndex: isActive ? 23 : 9,\n      }}\n    >\n      {isActive ? (\n        <div\n          style={{\n            width,\n            height,\n            backgroundColor: \"rgba(0,0,0, 0.05)\",\n            border: \"1px solid rgba(0,0,0,.3)\",\n            transform: getTranslate3dCss(top, left),\n          }}\n        ></div>\n      ) : null}\n    </div>\n  );\n};\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Actions } from \"../../store\";\nimport { MouseSelection } from \"../operations/MouseSelection\";\n\nexport const MouseSelectionBeads = ({ isVisible }) => {\n  const dispatch = useDispatch();\n\n  const onMouseDown = (x, y) => {\n    dispatch(Actions.MouseSelection.action_onEditBeadsMouseDown(x, y));\n  };\n\n  const onMouseMove = (x, y) => {\n    dispatch(Actions.MouseSelection.action_onEditBeadsMouseMove(x, y));\n  };\n\n  const onMouseUp = () => {\n    dispatch(Actions.MouseSelection.action_onEditBeadsMouseUp());\n  };\n\n  return (\n    <MouseSelection\n      isVisible={isVisible}\n      onMouseDown={onMouseDown}\n      onMouseMove={onMouseMove}\n      onMouseUp={onMouseUp}\n    />\n  );\n};\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Actions } from \"../../store\";\nimport { MouseSelection } from \"../operations/MouseSelection\";\n\nexport const MouseSelectionLines = ({ isVisible }) => {\n  const dispatch = useDispatch();\n\n  const onMouseDown = (x, y) => {\n    dispatch(Actions.MouseSelection.action_onEditLinesMouseDown(x, y));\n  };\n\n  const onMouseMove = (x, y) => {\n    dispatch(Actions.MouseSelection.action_onEditLinesMouseMove(x, y));\n  };\n\n  const onMouseUp = () => {\n    dispatch(Actions.MouseSelection.action_onEditLinesMouseUp());\n  };\n\n  return (\n    <MouseSelection\n      isVisible={isVisible}\n      onMouseDown={onMouseDown}\n      onMouseMove={onMouseMove}\n      onMouseUp={onMouseUp}\n    />\n  );\n};\n","import React from \"react\";\nimport { Bead, BeadTypes } from \"../../editorObjects/Editor\";\nimport { getTranslate3dCss } from \"../operations/MapValuesToCss\";\nimport { Actions } from \"../../store\";\nimport { useDispatch } from \"react-redux\";\n\nexport const DisplayBead = (props: {\n  bead: Bead;\n  opacity?: number;\n  zIndex?: number;\n  isSelected: boolean;\n  isSelectable: boolean;\n}) => {\n  const { bead, opacity, zIndex, isSelected, isSelectable } = props;\n  const isOpacity = opacity !== undefined && opacity >= 0 && opacity <= 1;\n  const isZindex = zIndex !== undefined && zIndex >= 0 && zIndex <= 9999;\n\n  const dispatch = useDispatch();\n  const onClick = () => {\n    if (isSelectable) {\n      dispatch(Actions.Draggable.action_onClickBead(bead.id));\n    }\n  };\n\n  const translate3d = getTranslate3dCss(bead.position.x, bead.position.y);\n  const rotate = bead.rotate + bead.lineRotate;\n  const rotateCss = !rotate ? \"rotateZ(0deg)\" : `rotateZ(${rotate}deg)`;\n  let styles: React.CSSProperties = {\n    transform: `${translate3d} ${rotateCss}`,\n    opacity: isOpacity ? opacity : 1,\n    zIndex: isZindex ? zIndex : undefined,\n    border: isSelected ? \"1px solid #000\" : \"\",\n    width: `${bead.width}px`,\n    height: `${bead.height}px`,\n    background: bead.color,\n  };\n\n  if (bead.type === BeadTypes.BasicEllipse) {\n    styles.borderRadius = \"100%\";\n  }\n\n  return (\n    <div className=\"bead-item\" onClick={onClick} style={styles}>\n      &nbsp;\n    </div>\n  );\n};\n","import React from \"react\";\nimport { DisplayBead } from \"./DisplayBead\";\nimport { useSelector } from \"react-redux\";\nimport { Editor, EditorMode } from \"../../editorObjects/Editor\";\n\nexport const DisplayBeads = ({ mode }) => {\n  const fadeOut = mode === EditorMode.EditLines;\n  const onTop = mode === EditorMode.EditBeads;\n  const isSelectable = mode === EditorMode.EditBeads;\n  const beads = useSelector((state: Editor) => {\n    return Object.values(state.appData.beads);\n  });\n  const selectedBeadsIds = useSelector((state: Editor) => {\n    return state.ui.selectedBeadsIds;\n  });\n\n  return (\n    <React.Fragment>\n      {beads.map(bead => {\n        return (\n          // <React.Fragment key={bead.id} />\n          <DisplayBead\n            key={bead.id}\n            bead={bead}\n            opacity={fadeOut ? 0.5 : 1}\n            isSelected={selectedBeadsIds[bead.id] !== undefined}\n            isSelectable={isSelectable}\n            zIndex={fadeOut ? 10 : onTop ? 20 : undefined}\n          />\n        );\n      })}\n    </React.Fragment>\n  );\n};\n","import React from \"react\";\nimport { getDistanceBetweenPoints, getRotate } from \"../../editorObjects/Point\";\nimport { getTranslate3dCss, getRotateCss } from \"../operations/MapValuesToCss\";\n\nexport const SelectionStraightLine = ({ start, end, onClick }) => {\n  const size = 0;\n  const height = 10;\n  const width = getDistanceBetweenPoints(start, end);\n  const rotate = getRotate(end.y - start.y, end.x - start.x);\n\n  return (\n    <div\n      style={{\n        height,\n        width,\n        backgroundColor: \"rgba(0,0,0,0.0)\",\n        transform: `${getTranslate3dCss(\n          start.x + size,\n          start.y + size\n        )} ${getRotateCss(rotate)}`,\n        transformOrigin: \"left center\",\n        cursor: \"pointer\",\n        zIndex: 20,\n      }}\n      onClick={onClick}\n      className=\"line\"\n    >\n      &nbsp;\n    </div>\n  );\n};\n","import React, { useState } from \"react\";\nimport { getDistanceBetweenPoints, getRotate } from \"../../editorObjects/Point\";\nimport { getTranslate3dCss, getRotateCss } from \"../operations/MapValuesToCss\";\nimport { DraggableCore, DraggableData } from \"react-draggable\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Actions } from \"../../store\";\nimport { Editor, EditorGridType, Point } from \"../../editorObjects/Editor\";\n\nexport const SelectedStraightLine = ({ lineId, start, end }) => {\n  const size = 0;\n  const height = 10;\n  const width = getDistanceBetweenPoints(start, end);\n  const rotate = getRotate(end.y - start.y, end.x - start.x);\n\n  const dispatch = useDispatch();\n\n  const snapToGrid = useSelector((state: Editor) => {\n    return state.ui.grid.snapEnabled;\n  });\n  const gridItemW = useSelector((state: Editor) => {\n    return state.ui.grid.width;\n  });\n  const gridItemH = useSelector((state: Editor) => {\n    return state.ui.grid.height;\n  });\n\n  const type = useSelector((state: Editor) => {\n    return state.ui.grid.type;\n  });\n\n  const [startX, set_tempX] = useState(0);\n  const [startY, set_tempY] = useState(0);\n\n  const [lineStart, set_lineStart] = useState<Point | null>(null);\n  const [lineEnd, set_lineEnd] = useState<Point | null>(null);\n\n  const onStart = (_, { x, y }: DraggableData) => {\n    console.log(\"rozpoczecie \", start, end, x, y);\n    set_tempX(x);\n    set_tempY(y);\n    set_lineStart({ ...start });\n    set_lineEnd({ ...end });\n  };\n  const onStop = (_, { x, y }: DraggableData) => {\n    console.log(\"zakoneczenie \", start, end, x, y);\n    set_tempX(0);\n    set_tempY(0);\n    set_lineStart(null);\n    set_lineEnd(null);\n  };\n  const onDrag = (_, { x, y, deltaX, deltaY }: DraggableData) => {\n    dispatch(\n      Actions.Draggable.action_onLineDrag(lineId, {\n        x,\n        y,\n        deltaX,\n        deltaY,\n        startX,\n        startY,\n        lineStart,\n        lineEnd,\n      })\n    );\n  };\n\n  return (\n    <DraggableCore\n      onStart={onStart}\n      onDrag={onDrag}\n      onStop={onStop}\n      grid={\n        snapToGrid === true && type === EditorGridType.Box\n          ? [gridItemW, gridItemH]\n          : undefined\n      }\n      disabled={false}\n      scale={1}\n    >\n      <div\n        style={{\n          height,\n          width,\n          backgroundColor: \"rgba(0,0,0,0.05)\",\n          border: \"1px dashed rgba(0,0,0,0.60)\",\n          transform: `${getTranslate3dCss(\n            start.x + size,\n            start.y + size\n          )} ${getRotateCss(rotate)}`,\n          transformOrigin: \"left center\",\n          cursor: \"move\",\n          zIndex: 21,\n        }}\n        className=\"line\"\n      >\n        &nbsp;\n      </div>\n    </DraggableCore>\n  );\n};\n","import React from \"react\";\nimport { Line, Editor, EditorGridType } from \"../../editorObjects/Editor\";\nimport { StraightLine } from \"./StraightLine\";\nimport { DraggableData, DraggableCore } from \"react-draggable\";\nimport { SelectionStraightLine } from \"./SelectionStraightLine\";\nimport { SelectedStraightLine } from \"./SelectedStraightLine\";\nimport { getTranslate3dCss } from \"../operations/MapValuesToCss\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Actions } from \"../../store\";\n\nexport const DisplayLine = (props: { line: Line; isSelected: boolean }) => {\n  const { isSelected, line } = props;\n  const dispatch = useDispatch();\n  const eventHandlerStartPoint = (_, { x, y }: DraggableData) => {\n    dispatch(Actions.Draggable.action_onStartPointDrag(line.id, { x, y }));\n  };\n  const eventHandlerEndPoint = (_, { x, y }: DraggableData) => {\n    dispatch(Actions.Draggable.action_onEndPointDrag(line.id, { x, y }));\n  };\n  const onClick = () => {\n    dispatch(Actions.Draggable.action_onClickLine(line.id));\n  };\n  const itemWidth = 10;\n  const itemHeight = 10;\n  const snapToGrid = useSelector((state: Editor) => {\n    return state.ui.grid.snapEnabled;\n  });\n  const gridItemW = useSelector((state: Editor) => {\n    return state.ui.grid.width;\n  });\n  const gridItemH = useSelector((state: Editor) => {\n    return state.ui.grid.height;\n  });\n  const type = useSelector((state: Editor) => {\n    return state.ui.grid.type;\n  });\n  return (\n    <div>\n      <DraggableCore\n        // onStart={eventHandlerStartPoint}\n        onDrag={eventHandlerStartPoint}\n        // onStop={eventHandlerStartPoint}\n        grid={snapToGrid === true && type === EditorGridType.Box ? [gridItemW, gridItemH] : undefined}\n        scale={1}\n        disabled={false}\n      >\n        <div\n          style={{\n            transform: getTranslate3dCss(line.start.x, line.start.y),\n            zIndex: isSelected === true ? 22 : 21,\n            width: itemWidth,\n            height: itemHeight,\n          }}\n          className={\"line-start\"}\n        >\n          &nbsp;\n        </div>\n      </DraggableCore>\n\n      <DraggableCore\n        // onStart={eventHandlerEndPoint}\n        onDrag={eventHandlerEndPoint}\n        // onStop={eventHandlerEndPoint}\n        grid={snapToGrid === true && type === EditorGridType.Box ? [gridItemW, gridItemH] : undefined}\n        disabled={false}\n        scale={1}\n      >\n        <div\n          style={{\n            transform: getTranslate3dCss(line.end.x, line.end.y),\n            zIndex: isSelected === true ? 22 : 21,\n            width: itemWidth,\n            height: itemHeight,\n          }}\n          className={\"line-end test\"}\n        >\n          &nbsp;\n        </div>\n      </DraggableCore>\n\n      {isSelected === true ? (\n        <SelectedStraightLine\n          start={line.start}\n          end={line.end}\n          lineId={line.id}\n        />\n      ) : (\n        <SelectionStraightLine\n          start={line.start}\n          end={line.end}\n          onClick={onClick}\n        />\n      )}\n\n      <StraightLine start={line.start} end={line.end} />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { DndProvider } from \"react-dnd\";\nimport { DisplayLine } from \"./DisplayLine\";\nimport HTML5Backend from \"react-dnd-html5-backend\";\n\nexport const DraggableLines = ({ lines, selectedLinesIds }) => {\n  return (\n    <DndProvider backend={HTML5Backend}>\n      {lines.map(line => {\n        return (\n          <DisplayLine\n            key={line.id}\n            line={line}\n            isSelected={selectedLinesIds[line.id] !== undefined}\n          />\n        );\n      })}\n    </DndProvider>\n  );\n};\n","import React from \"react\";\nimport { Line } from \"../../editorObjects/Editor\";\nimport { StraightLine } from \"./StraightLine\";\n\nexport const DisplaySimpleLine = (props: { line: Line }) => {\n  const { line } = props;\n  return (\n    <div>\n      <StraightLine start={line.start} end={line.end} />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { EditorMode, Editor } from \"../../editorObjects/Editor\";\nimport { DraggableLines } from \"./DraggableLines\";\nimport { DisplaySimpleLine } from \"./DisplaySimpleLine\";\nimport { useSelector } from \"react-redux\";\n\nexport const DisplayLines = ({ mode }) => {\n  const isEditable = mode === EditorMode.EditLines;\n  const lines = useSelector((state: Editor) => {\n    return Object.values(state.appData.lines);\n  });\n  const selectedLinesIds = useSelector((state: Editor) => {\n    return state.ui.selectedLinesIds;\n  });\n\n  const isHidden = mode === EditorMode.Idle;\n  \n  if (isHidden) {\n    return <React.Fragment />;\n  }\n\n  if (isEditable) {\n    return <DraggableLines lines={lines} selectedLinesIds={selectedLinesIds} />;\n  }\n\n  return (\n    <React.Fragment>\n      {lines.map(line => {\n        return <DisplaySimpleLine key={line.id} line={line} />;\n      })}\n    </React.Fragment>\n  );\n};\n","import React from \"react\";\nimport { getTranslate3dCss } from \"./MapValuesToCss\";\nimport { DndProvider } from \"react-dnd\";\nimport HTML5Backend from \"react-dnd-html5-backend\";\nimport { DraggableCore } from \"react-draggable\";\nimport { useSelector } from \"react-redux\";\nimport { Editor, EditorGridType } from \"../../editorObjects/Editor\";\n\nexport const DisplayGroupLines = ({ location, onDrag }) => {\n  const { x, y, w, h } = location;\n\n  const snapToGrid = useSelector((state: Editor) => {\n    return state.ui.grid.snapEnabled;\n  });\n  const gridItemW = useSelector((state: Editor) => {\n    return state.ui.grid.width;\n  });\n  const gridItemH = useSelector((state: Editor) => {\n    return state.ui.grid.height;\n  });\n\n  const type = useSelector((state: Editor) => {\n    return state.ui.grid.type;\n  });\n\n  return (\n    <DndProvider backend={HTML5Backend}>\n      <DraggableCore\n        // onStart={onDrag}\n        onDrag={onDrag}\n        // onStop={onDrag}\n        grid={\n          snapToGrid === true && type === EditorGridType.Box\n            ? [gridItemW, gridItemH]\n            : undefined\n        }\n        scale={1}\n        disabled={false}\n      >\n        <div\n          style={{\n            position: \"absolute\",\n            top: 0,\n            left: 0,\n            width: w,\n            height: h,\n            transform: getTranslate3dCss(x, y),\n            opacity: 1,\n            zIndex: 22,\n            border: \"1px dashed rgba(0,0,0,0.2)\",\n            background: \"rgba(0,0,0,0.05)\",\n            cursor: \"move\",\n          }}\n        >\n          &nbsp;\n        </div>\n      </DraggableCore>\n    </DndProvider>\n  );\n};\n","import { Editor } from \"../../editorObjects/Editor\";\n\nexport const getGroupPositionFromLines = (selectedLines): { x; y; w; h } => {\n  let xMin: number = Number.MAX_SAFE_INTEGER;\n  let xMax: number = Number.MAX_SAFE_INTEGER * -1;\n  let yMin: number = Number.MAX_SAFE_INTEGER;\n  let yMax: number = Number.MAX_SAFE_INTEGER * -1;\n  selectedLines.forEach(line => {\n    const start = line.start;\n    const end = line.end;\n    xMin = Math.min(xMin, start.x, end.x);\n    xMax = Math.max(xMax, start.x, end.x);\n    yMin = Math.min(yMin, start.y, end.y);\n    yMax = Math.max(yMax, start.y, end.y);\n  });\n  return {\n    x: xMin,\n    y: yMin,\n    w: xMax - xMin + 10,\n    h: yMax - yMin + 10,\n  };\n};\n\nexport const getSelectedLines = (state: Editor) => {\n  return Object.keys(state.ui.selectedLinesIds).map(lineId => {\n    return state.appData.lines[lineId];\n  });\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Actions } from \"../../store\";\nimport { DraggableData } from \"react-draggable\";\nimport { DisplayGroupLines } from \"./DisplayGroupLines\";\nimport { getGroupPositionFromLines, getSelectedLines } from \"./getGroupPositionFromLines\";\n\nexport const DisplayLinesGroup = ({ selectedLinesIdsCount }) => {\n  const dispatch = useDispatch();\n  const selectedLines = useSelector(getSelectedLines);\n  const location = getGroupPositionFromLines(selectedLines);\n  const eventDragHandler = (_, { deltaX, deltaY }: DraggableData) => {\n    dispatch(Actions.Draggable.action_onGroupLineDrag({ deltaX, deltaY }));\n  };\n  return <DisplayGroupLines location={location} onDrag={eventDragHandler} />;\n};\n\nexport const MemoizedDisplayLinesGroup = React.memo(DisplayLinesGroup);\n","import React from \"react\";\nimport { getTranslate3dCss } from \"./MapValuesToCss\";\n\nexport const DisplayGroupBeads = ({ location }) => {\n  const { x, y, w, h } = location;\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        width: w,\n        height: h,\n        transform: getTranslate3dCss(x, y),\n        opacity: 1,\n        zIndex: 22,\n        border: \"1px dashed rgba(0,0,0,0.2)\",\n        background: \"rgba(0,0,0,0.05)\",\n      }}\n    >\n      &nbsp;\n    </div>\n  );\n};\n","import { Editor } from \"../../editorObjects/Editor\";\n\nexport const getGroupPositionFromBeads = (selectedBeads): { x; y; w; h } => {\n  let xMin: number = Number.MAX_SAFE_INTEGER;\n  let xMax: number = Number.MAX_SAFE_INTEGER * -1;\n  let yMin: number = Number.MAX_SAFE_INTEGER;\n  let yMax: number = Number.MAX_SAFE_INTEGER * -1;\n  selectedBeads.forEach(bead => {\n    const startX = bead.position.x;\n    const endX = bead.position.x + 10;\n    const startY = bead.position.y;\n    const endY = bead.position.y + 10;\n    xMin = Math.min(xMin, startX, endX);\n    xMax = Math.max(xMax, startX, endX);\n    yMin = Math.min(yMin, startY, endY);\n    yMax = Math.max(yMax, startY, endY);\n  });\n  return {\n    x: xMin,\n    y: yMin,\n    w: xMax - xMin + 10,\n    h: yMax - yMin + 10,\n  };\n};\n\nexport const getSelectedBeads = (state: Editor) => {\n  return Object.keys(state.ui.selectedBeadsIds).map(beadId => {\n    return state.appData.beads[beadId];\n  });\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { DisplayGroupBeads } from \"./DisplayGroupBeads\";\nimport {\n  getSelectedBeads,\n  getGroupPositionFromBeads,\n} from \"./getGroupPositionFromBeads\";\n\nexport const DisplayBeadsGroup = ({ selectedBeadsIdsCount }) => {\n  const selectedBead = useSelector(getSelectedBeads);\n  const location = getGroupPositionFromBeads(selectedBead);\n\n  return <DisplayGroupBeads location={location} />;\n};\n\nexport const MemoizedDisplayBeadsGroup = React.memo(DisplayBeadsGroup);\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Editor, EditorMode } from \"../../editorObjects/Editor\";\nimport { MemoizedDisplayLinesGroup } from \"./DisplayLinesGroup\";\nimport { MemoizedDisplayBeadsGroup } from \"./DisplayBeadsGroup\";\n\nexport const GroupSelectionPlaceholder = ({ mode }) => {\n  const selectedBeadsIdsCount = useSelector((state: Editor) => {\n    return state.ui.selectedBeadsIdsCount;\n  });\n\n  const selectedLinesIdsCount = useSelector((state: Editor) => {\n    return state.ui.selectedLinesIdsCount;\n  });\n\n  if (mode === EditorMode.EditBeads && selectedBeadsIdsCount >= 2) {\n    return (\n      <MemoizedDisplayBeadsGroup\n        selectedBeadsIdsCount={selectedBeadsIdsCount}\n      />\n    );\n  }\n\n  if (mode === EditorMode.EditLines && selectedLinesIdsCount >= 2) {\n    return (\n      <MemoizedDisplayLinesGroup\n        selectedLinesIdsCount={selectedLinesIdsCount}\n      />\n    );\n  }\n  return <React.Fragment />;\n};\n","import React from \"react\";\nimport { DisplayBead } from \"../../Bead/DisplayBead\";\nimport { buildBead } from \"../../../editorObjects/Bead\";\nimport { buildPoint } from \"../../../editorObjects/Point\";\n\nexport const FieldBeadPreview = ({ bead }) => {\n  const displayBead = buildBead({\n    ...bead,\n    position: buildPoint(0, 0),\n  });\n  return (\n    <div\n      style={{\n        marginTop: \"20px\",\n        marginBottom: \"20px\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        height: \"100px\",\n        boxSizing: \"border-box\",\n      }}\n    >\n      <div\n        style={{\n          position: \"relative\",\n          top: `${(-1 * bead.height) / 2}px`,\n          left: `${(-1 * bead.width) / 2}px`,\n        }}\n      >\n        <DisplayBead\n          bead={displayBead}\n          isSelected={false}\n          isSelectable={false}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport const ToolbarField = ({ label, icon, value, onToggle }) => {\n  return (\n    <div\n      className={\"fieldset\"}\n      onClick={onToggle}\n      style={{ cursor: \"pointer\" }}\n    >\n      <div className=\"label\">\n        {icon ? (\n          <div\n            style={{\n              width: \"30px\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              height: \"30px\",\n              marginRight: \"10px\",\n            }}\n          >\n            {icon}\n          </div>\n        ) : null}\n        {label ? <div>{label}</div> : null}\n      </div>\n\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          justifyContent: \"flex-end\",\n          alignItems: \"center\",\n          boxSizing: \"border-box\",\n          paddingLeft: \"10px\",\n          paddingRight: \"20px\",\n          width: \"100%\",\n        }}\n      >\n        <div>{value !== undefined ? value : \"-\"}</div>\n      </div>\n    </div>\n  );\n};\n","import React, { useState } from \"react\";\nimport { ToolbarField } from \"./ToolbarField\";\n\nexport const ToolbarFieldSet = ({ selected, label, icon, children }) => {\n  const [isPickerOpen, setIsPickerOpen] = useState(false);\n  const onToggle = () => {\n    setIsPickerOpen(!isPickerOpen);\n  };\n  return (\n    <div\n      style={{\n        // borderBottom: \"1px solid #dfdfdf\",\n        borderTop: \"1px solid #dfdfdf\",\n      }}\n    >\n      <ToolbarField\n        label={label}\n        onToggle={onToggle}\n        icon={icon}\n        value={selected}\n      />\n\n      {isPickerOpen === true ? (\n        <div style={{ background: \"#fff\" }}>{React.cloneElement(children)}</div>\n      ) : null}\n    </div>\n  );\n};\n","import React from \"react\";\nimport * as material from \"material-colors\";\n\nexport const FieldColorPicker = ({ value, onChange, ...props }) => {\n  const colors = [\n    [\n      material.red[\"900\"],\n      material.red[\"700\"],\n      material.red[\"500\"],\n      material.red[\"300\"],\n      material.red[\"100\"],\n    ],\n    [\n      material.pink[\"900\"],\n      material.pink[\"700\"],\n      material.pink[\"500\"],\n      material.pink[\"300\"],\n      material.pink[\"100\"],\n    ],\n    [\n      material.purple[\"900\"],\n      material.purple[\"700\"],\n      material.purple[\"500\"],\n      material.purple[\"300\"],\n      material.purple[\"100\"],\n    ],\n    [\n      material.deepPurple[\"900\"],\n      material.deepPurple[\"700\"],\n      material.deepPurple[\"500\"],\n      material.deepPurple[\"300\"],\n      material.deepPurple[\"100\"],\n    ],\n    [\n      material.indigo[\"900\"],\n      material.indigo[\"700\"],\n      material.indigo[\"500\"],\n      material.indigo[\"300\"],\n      material.indigo[\"100\"],\n    ],\n    [\n      material.blue[\"900\"],\n      material.blue[\"700\"],\n      material.blue[\"500\"],\n      material.blue[\"300\"],\n      material.blue[\"100\"],\n    ],\n    [\n      material.lightBlue[\"900\"],\n      material.lightBlue[\"700\"],\n      material.lightBlue[\"500\"],\n      material.lightBlue[\"300\"],\n      material.lightBlue[\"100\"],\n    ],\n    [\n      material.cyan[\"900\"],\n      material.cyan[\"700\"],\n      material.cyan[\"500\"],\n      material.cyan[\"300\"],\n      material.cyan[\"100\"],\n    ],\n    [\n      material.teal[\"900\"],\n      material.teal[\"700\"],\n      material.teal[\"500\"],\n      material.teal[\"300\"],\n      material.teal[\"100\"],\n    ],\n    [\n      \"#194D33\",\n      material.green[\"700\"],\n      material.green[\"500\"],\n      material.green[\"300\"],\n      material.green[\"100\"],\n    ],\n    [\n      material.lightGreen[\"900\"],\n      material.lightGreen[\"700\"],\n      material.lightGreen[\"500\"],\n      material.lightGreen[\"300\"],\n      material.lightGreen[\"100\"],\n    ],\n    [\n      material.lime[\"900\"],\n      material.lime[\"700\"],\n      material.lime[\"500\"],\n      material.lime[\"300\"],\n      material.lime[\"100\"],\n    ],\n    [\n      material.yellow[\"900\"],\n      material.yellow[\"700\"],\n      material.yellow[\"500\"],\n      material.yellow[\"300\"],\n      material.yellow[\"100\"],\n    ],\n    [\n      material.amber[\"900\"],\n      material.amber[\"700\"],\n      material.amber[\"500\"],\n      material.amber[\"300\"],\n      material.amber[\"100\"],\n    ],\n    [\n      material.orange[\"900\"],\n      material.orange[\"700\"],\n      material.orange[\"500\"],\n      material.orange[\"300\"],\n      material.orange[\"100\"],\n    ],\n    [\n      material.deepOrange[\"900\"],\n      material.deepOrange[\"700\"],\n      material.deepOrange[\"500\"],\n      material.deepOrange[\"300\"],\n      material.deepOrange[\"100\"],\n    ],\n    [\n      material.brown[\"900\"],\n      material.brown[\"700\"],\n      material.brown[\"500\"],\n      material.brown[\"300\"],\n      material.brown[\"100\"],\n    ],\n    [\n      material.blueGrey[\"900\"],\n      material.blueGrey[\"700\"],\n      material.blueGrey[\"500\"],\n      material.blueGrey[\"300\"],\n      material.blueGrey[\"100\"],\n    ],\n    [\"#000000\", \"#525252\", \"#969696\", \"#D9D9D9\", \"#FFFFFF\"],\n  ];\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        paddingTop: \"20px\",\n        paddingBottom: \"30px\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n      }}\n    >\n      <DisplayColorsGroup colors={colors} onClick={onChange} />\n      {/* <CirclePicker\n        color={value}\n        onChangeComplete={color => onChange(color.hex)}\n        colors={[\"#000\"]}\n      /> */}\n      {/* <SwatchesPicker\n        width={258}\n        height={240}\n        onChangeComplete={color => onChange(color.hex)}\n        color={value}\n      /> */}\n    </div>\n  );\n};\n\nconst DisplayColorsGroup = ({ colors, onClick }) => {\n  return (\n    <div>\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"flex-start\",\n          alignItems: \"center\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        {colors.map(group => {\n          return (\n            <div key={group.toString()} style={{ marginBottom: \"10px\" }}>\n              {group.map(color => {\n                return (\n                  <div\n                    key={color}\n                    style={{\n                      cursor: \"pointer\",\n                      border: \"3px solid transparent\",\n                      boxSizing: \"border-box\",\n                    }}\n                  >\n                    <div\n                      onClick={() => onClick(color)}\n                      style={{\n                        boxSizing: \"border-box\",\n                        background: color,\n                        width: \"28px\",\n                        height: \"28px\",\n                        borderRadius: \"100%\",\n                        border: \"none\",\n                      }}\n                    />\n                  </div>\n                );\n              })}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\n\n\n// const colors = [\n//   material.red[\"900\"],\n//   material.red[\"700\"],\n//   material.red[\"500\"],\n//   material.red[\"300\"],\n//   material.red[\"100\"],\n//   material.pink[\"900\"],\n//   material.pink[\"700\"],\n//   material.pink[\"500\"],\n//   material.pink[\"300\"],\n//   material.pink[\"100\"],\n//   material.purple[\"900\"],\n//   material.purple[\"700\"],\n//   material.purple[\"500\"],\n//   material.purple[\"300\"],\n//   material.purple[\"100\"],\n//   material.deepPurple[\"900\"],\n//   material.deepPurple[\"700\"],\n//   material.deepPurple[\"500\"],\n//   material.deepPurple[\"300\"],\n//   material.deepPurple[\"100\"],\n//   material.indigo[\"900\"],\n//   material.indigo[\"700\"],\n//   material.indigo[\"500\"],\n//   material.indigo[\"300\"],\n//   material.indigo[\"100\"],\n//   material.blue[\"900\"],\n//   material.blue[\"700\"],\n//   material.blue[\"500\"],\n//   material.blue[\"300\"],\n//   material.blue[\"100\"],\n//   material.lightBlue[\"900\"],\n//   material.lightBlue[\"700\"],\n//   material.lightBlue[\"500\"],\n//   material.lightBlue[\"300\"],\n//   material.lightBlue[\"100\"],\n//   material.cyan[\"900\"],\n//   material.cyan[\"700\"],\n//   material.cyan[\"500\"],\n//   material.cyan[\"300\"],\n//   material.cyan[\"100\"],\n//   material.teal[\"900\"],\n//   material.teal[\"700\"],\n//   material.teal[\"500\"],\n//   material.teal[\"300\"],\n//   material.teal[\"100\"],\n//   \"#194D33\",\n//   material.green[\"700\"],\n//   material.green[\"500\"],\n//   material.green[\"300\"],\n//   material.green[\"100\"],\n//   material.lightGreen[\"900\"],\n//   material.lightGreen[\"700\"],\n//   material.lightGreen[\"500\"],\n//   material.lightGreen[\"300\"],\n//   material.lightGreen[\"100\"],\n//   material.lime[\"900\"],\n//   material.lime[\"700\"],\n//   material.lime[\"500\"],\n//   material.lime[\"300\"],\n//   material.lime[\"100\"],\n//   material.yellow[\"900\"],\n//   material.yellow[\"700\"],\n//   material.yellow[\"500\"],\n//   material.yellow[\"300\"],\n//   material.yellow[\"100\"],\n//   material.amber[\"900\"],\n//   material.amber[\"700\"],\n//   material.amber[\"500\"],\n//   material.amber[\"300\"],\n//   material.amber[\"100\"],\n//   material.orange[\"900\"],\n//   material.orange[\"700\"],\n//   material.orange[\"500\"],\n//   material.orange[\"300\"],\n//   material.orange[\"100\"],\n//   material.deepOrange[\"900\"],\n//   material.deepOrange[\"700\"],\n//   material.deepOrange[\"500\"],\n//   material.deepOrange[\"300\"],\n//   material.deepOrange[\"100\"],\n//   material.brown[\"900\"],\n//   material.brown[\"700\"],\n//   material.brown[\"500\"],\n//   material.brown[\"300\"],\n//   material.brown[\"100\"],\n//   material.blueGrey[\"900\"],\n//   material.blueGrey[\"700\"],\n//   material.blueGrey[\"500\"],\n//   material.blueGrey[\"300\"],\n//   material.blueGrey[\"100\"],\n\n//   \"#000000\",\n//   \"#525252\",\n//   \"#969696\",\n//   \"#D9D9D9\",\n//   \"#FFFFFF\",\n// ];\n","import React from \"react\";\n\nexport const FieldColor = ({ value, isSelected, onClick }) => {\n  return (\n    <div style={{ border: \"5px solid transparent\" }}>\n      <div\n        onClick={onClick ? () => onClick(value) : undefined}\n        style={{\n          width: 25,\n          height: 25,\n          background: value,\n          marginBottom: 0,\n          marginRight: 0,\n          border: isSelected ? \"2px solid #000\" : \"2px solid #000\",\n          boxShadow: isSelected\n            ? \"2px 2px 2px rgba(0,0,0,1)\"\n            : \"2px 2px 2px rgba(0,0,0,0.1)\",\n        }}\n      ></div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPalette } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { FieldColorPicker } from \"./FieldColorPicker\";\nimport { FieldColor } from \"./FieldColor\";\n\nexport const FieldsetColor = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={\n        <FieldColor value={value} isSelected={false} onClick={undefined} />\n      }\n      label={\"Color\"}\n      icon={<FontAwesomeIcon icon={faPalette} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldColorPicker value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { BeadTypes } from \"../../../editorObjects/Editor\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCircle, faExpand } from \"@fortawesome/free-solid-svg-icons\";\n\nexport const BeadTypesIcons = {\n  [BeadTypes.BasicEllipse]: \"circle\",\n  [BeadTypes.BasicRectangle]: \"rectangle-wide\",\n};\n\nexport const FieldBeadTypePicker = ({ value, onChange }) => {\n  return (\n    <DisplayAvailableBeadTypes\n      types={BeadTypesIcons}\n      selectedType={value}\n      onClick={onChange}\n    />\n  );\n};\n\nconst DisplayAvailableBeadTypes = ({ types, selectedType, onClick }) => {\n  console.log(\"jak jest?\", types);\n  return (\n    <div className=\"fieldset\" style={{}}>\n      <div className=\"label\"></div>\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          justifyContent: \"flex-start\",\n          alignItems: \"center\",\n          boxSizing: \"border-box\",\n          paddingLeft: \"10px\",\n          paddingRight: \"20px\",\n          width: \"100%\",\n        }}\n      >\n        {Object.keys(types).map((type, index) => {\n          return (\n            <DisplayBeadType\n              icon={types[type]}\n              type={type}\n              key={index}\n              isSelected={selectedType === type}\n              onClick={onClick}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport const DisplayBeadType = ({ icon, type, isSelected, onClick }) => {\n  return (\n    <div style={{ border: \"5px solid transparent\" }}>\n      <div\n        onClick={onClick ? () => onClick(type) : undefined}\n        style={{\n          width: 25,\n          height: 25,\n          background: \"#eee\",\n          marginBottom: 0,\n          marginRight: 0,\n          border: isSelected ? \"2px solid #000\" : \"2px solid #000\",\n          boxShadow: isSelected\n            ? \"2px 2px 2px rgba(0,0,0,1)\"\n            : \"2px 2px 2px rgba(0,0,0,0.1)\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n        }}\n      >\n        {icon === \"circle\" ? <FontAwesomeIcon icon={faCircle} /> : null}\n        {icon === \"rectangle-wide\" ? <FontAwesomeIcon icon={faExpand} /> : null}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faShapes } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport {\n  FieldBeadTypePicker,\n  BeadTypesIcons,\n  DisplayBeadType,\n} from \"./FieldBeadTypePicker\";\n\nexport const FieldsetBeadType = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={\n        <DisplayBeadType\n          icon={value ? BeadTypesIcons[value] : undefined}\n          type={value}\n          isSelected={false}\n          onClick={undefined}\n        />\n      }\n      label={\"Type\"}\n      icon={<FontAwesomeIcon icon={faShapes} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldBeadTypePicker value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport \"rc-slider/assets/index.css\";\nimport Slider, { createSliderWithTooltip } from \"rc-slider\";\n\nexport const SliderWithTooltip = createSliderWithTooltip(Slider);\n\nexport const FieldSlider = ({ value, onChange, ...props }) => {\n  return (\n    <div\n      style={{\n        background: \"#fff\",\n        width: \"100%\",\n        paddingTop: \"20px\",\n        paddingBottom: \"30px\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n      }}\n    >\n      <SliderWithTooltip\n        max={100}\n        min={1}\n        step={1}\n        value={value}\n        onChange={value => onChange(value)}\n        defaultValue={10}\n        marks={{\n          0: \"0\",\n          50: \"50\",\n          100: \"100\",\n        }}\n        {...props}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport const FieldCheckbox = ({ label, value, onChange, isDisabled }) => {\n  return (\n    <div className={\"fieldset\"}>\n      <div className=\"label\">{label}</div>\n      <input\n        type=\"checkbox\"\n        disabled={isDisabled}\n        value={value === true ? 1 : 0}\n        checked={value === true}\n        onChange={event => onChange(event.target.value === \"0\")}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDivide } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { SliderWithTooltip } from \"./FieldSlider\";\nimport { FieldCheckbox } from \"./FieldCheckbox\";\n\nexport const FieldsetBeadSpacing = ({\n  beadsAutoSpacing,\n  beadsSpacing,\n  onChange_beadsSpacing,\n  onChange_beadsAutoSpacing,\n}) => {\n  const label =\n    beadsAutoSpacing === true\n      ? \"auto\"\n      : beadsSpacing === undefined\n      ? \"0\"\n      : beadsSpacing;\n  return (\n    <ToolbarFieldSet\n      selected={label}\n      label={\"Spacing\"}\n      icon={\n        <FontAwesomeIcon\n          icon={faDivide}\n          color={uiButton}\n          size={\"lg\"}\n          style={{ transform: \"rotate(90deg)\" }}\n        />\n      }\n    >\n      <div>\n        <div style={{ width: \"100%\" }}>\n          <FieldCheckbox\n            label={\"Auto \"}\n            value={beadsAutoSpacing}\n            onChange={onChange_beadsAutoSpacing}\n            isDisabled={false}\n          />\n        </div>\n\n        <div\n          style={{\n            width: \"100%\",\n            paddingTop: \"20px\",\n            paddingBottom: \"30px\",\n            paddingLeft: \"20px\",\n            paddingRight: \"20px\",\n          }}\n        >\n          <SliderWithTooltip\n            max={100}\n            min={1}\n            step={1}\n            value={beadsSpacing}\n            disabled={beadsAutoSpacing === true}\n            onChange={value => onChange_beadsSpacing(value)}\n            defaultValue={10}\n            marks={{\n              0: \"0\",\n              50: \"50\",\n              100: \"100\",\n            }}\n          />\n        </div>\n      </div>\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDiceSix } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { SliderWithTooltip } from \"./FieldSlider\";\nimport { FieldCheckbox } from \"./FieldCheckbox\";\n\nexport const FieldsetBeadCount = ({\n  beadsAutoCount,\n  beadsCount,\n  onChange_beadsCount,\n  onChange_beadsAutoCount,\n}) => {\n  const label =\n    beadsAutoCount === true\n      ? \"auto\"\n      : beadsCount === undefined\n      ? \"0\"\n      : beadsCount;\n\n  const max = 300;\n  return (\n    <ToolbarFieldSet\n      selected={label}\n      label={\"Amount\"}\n      icon={<FontAwesomeIcon icon={faDiceSix} color={uiButton} size={\"lg\"} />}\n    >\n      <div>\n        <div style={{ width: \"100%\" }}>\n          <FieldCheckbox\n            label={\"Auto \"}\n            value={beadsAutoCount}\n            onChange={onChange_beadsAutoCount}\n            isDisabled={false}\n          />\n        </div>\n\n        <div\n          style={{\n            width: \"100%\",\n            paddingTop: \"20px\",\n            paddingBottom: \"30px\",\n            paddingLeft: \"20px\",\n            paddingRight: \"20px\",\n          }}\n        >\n          <SliderWithTooltip\n            max={max}\n            min={1}\n            step={1}\n            value={beadsCount}\n            disabled={beadsAutoCount === true}\n            onChange={value => onChange_beadsCount(value)}\n            defaultValue={10}\n            marks={{\n              1: \"1\",\n              [max / 2]: `${max / 2}`,\n              [max]: `${max}`,\n            }}\n          />\n        </div>\n      </div>\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport \"rc-slider/assets/index.css\";\nimport Slider, { createSliderWithTooltip } from \"rc-slider\";\n\nexport const SliderWithTooltip = createSliderWithTooltip(Slider);\n\nexport const FieldSliderWithLabel = ({ value, onChange, label, icon }) => {\n  return (\n    <div\n      className={\"fieldset\"}\n      style={{\n        paddingTop: \"10px\",\n        paddingBottom: \"10px\",\n        paddingLeft: \"10px\",\n        paddingRight: \"10px\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        justifyContent: \"space-between\",\n        background: \"#fff\",\n        borderBottom: 0,\n      }}\n    >\n      <div className=\"label\" style={{ padding: 0, width: \"105px\" }}>\n        {icon ? (\n          <div\n            style={{\n              width: \"30px\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              height: \"30px\",\n              marginRight: \"10px\",\n            }}\n          >\n            {icon}\n          </div>\n        ) : null}\n        {label ? <div>{label}</div> : null}\n      </div>\n\n      <div\n        style={{\n          boxSizing: \"border-box\",\n          flexGrow: 1,\n          paddingRight: \"10px\",\n          paddingBottom: \"10px\",\n        }}\n      >\n        <SliderWithTooltip\n          max={100}\n          min={1}\n          step={1}\n          value={value}\n          onChange={value => onChange(value)}\n          defaultValue={10}\n          marks={{\n            0: \"0\",\n            50: \"50\",\n            100: \"100\",\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { FieldsetHeight } from \"./FieldsetHeight\";\nimport { FieldsetWidth } from \"./FieldsetWidth\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faExpandArrowsAlt,\n  faArrowsAltV,\n  faArrowsAltH,\n  faLink,\n  faUnlink,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../../colors\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { FieldSliderWithLabel } from \"./FieldSliderWithLabel\";\nimport { FieldCheckbox } from \"./FieldCheckbox\";\n\nexport const FieldsetWidthAndHeight = ({\n  height,\n  width,\n  keepAspectRatio,\n  onChange_beadHeight,\n  onChange_beadWidth,\n  onChange_keepAspectRatio,\n}) => {\n  const format = value =>\n    value.toLocaleString(undefined, {\n      maximumFractionDigits: 2,\n      style: \"decimal\",\n    });\n  const value = `${format(width)} x ${format(height)}`;\n  return (\n    <div>\n      <ToolbarFieldSet\n        selected={value}\n        label={\"Size\"}\n        icon={\n          <FontAwesomeIcon\n            icon={faExpandArrowsAlt}\n            color={uiButton}\n            size={\"lg\"}\n          />\n        }\n      >\n        <div>\n          <div style={{ width: \"100%\", background: \"#fff\" }}>\n            <FieldCheckbox\n              label={\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexWrap: \"nowrap\",\n                    justifyContent: \"space\",\n                  }}\n                >\n                  <div\n                    style={{\n                      width: \"30px\",\n                      display: \"flex\",\n                      justifyContent: \"center\",\n                      alignItems: \"center\",\n                      height: \"30px\",\n                      marginRight: \"10px\",\n                      background: \"#fff\",\n                    }}\n                  >\n                    <FontAwesomeIcon\n                      icon={keepAspectRatio === true ? faLink : faUnlink}\n                      color={uiButton}\n                      size={\"lg\"}\n                    />\n                  </div>\n                  <div>Keep aspect ratio</div>\n                </div>\n              }\n              value={keepAspectRatio}\n              onChange={onChange_keepAspectRatio}\n              isDisabled={false}\n            />\n          </div>\n\n          <FieldSliderWithLabel\n            label={\"Width\"}\n            icon={\n              <FontAwesomeIcon\n                icon={faArrowsAltH}\n                color={uiButton}\n                size={\"lg\"}\n              />\n            }\n            value={width}\n            onChange={onChange_beadWidth}\n          />\n\n          <FieldSliderWithLabel\n            label={\"Height\"}\n            icon={\n              <FontAwesomeIcon\n                icon={faArrowsAltV}\n                color={uiButton}\n                size={\"lg\"}\n              />\n            }\n            value={height}\n            onChange={onChange_beadHeight}\n          />\n        </div>\n      </ToolbarFieldSet>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTrash, faClone, faDizzy } from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../../colors\";\n\nexport const FieldDeleteAndCopy = ({ onDelete, onClone, onReset }) => {\n  return (\n    <div\n      className=\"fieldset\"\n      style={{ paddingLeft: \"15px\", paddingRight: \"20px\" }}\n    >\n      <div className=\"field has-addons\">\n        <div className=\"control\">\n          <div className={` button `} onClick={onDelete}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faTrash} color={uiButton} />\n            </span>\n            <span>Delete</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={` button `} onClick={onClone}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faClone} color={uiButton} />\n            </span>\n            <span>Clone</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={` button `} onClick={onReset}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faDizzy} color={uiButton} />\n            </span>\n            <span>Reset beads</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSyncAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport { FieldSlider } from \"./FieldSlider\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport NumberFormat from \"react-number-format\";\n\nexport const FieldsetBeadRotate = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={`${value}deg`}\n      label={\"Rotate\"}\n      icon={<FontAwesomeIcon icon={faSyncAlt} color={uiButton} size={\"lg\"} />}\n    >\n      <React.Fragment>\n        <FieldSlider\n          value={value}\n          onChange={value => {\n            console.log(\"FieldSlider\", value);\n            onChange(value);\n          }}\n          max={180}\n          min={-180}\n          defaultValue={0}\n          marks={{\n            \"-180\": \"-180\",\n            \"0\": \"0\",\n            \"180\": \"180\",\n          }}\n        />\n        <NumberFormat\n          suffix={\"deg\"}\n          allowNegative={true}\n          allowEmptyFormatting={true}\n          value={value}\n          onValueChange={event => {\n            onChange(event.floatValue);\n          }}\n          placeholder=\" deg\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"1em\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"3px 10px\",\n            marginBottom: \"15px\",\n            marginTop: \"5px\",\n          }}\n        />\n      </React.Fragment>\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { FieldBeadPreview } from \"../ui/FieldBeadPreview\";\nimport { Actions } from \"../../../store\";\nimport { FieldsetWidth } from \"../ui/FieldsetWidth\";\nimport { FieldsetHeight } from \"../ui/FieldsetHeight\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetBeadType } from \"../ui/FieldsetBeadType\";\nimport { FieldsetBeadSpacing } from \"../ui/FieldsetBeadSpacing\";\nimport { FieldsetBeadCount } from \"../ui/FieldsetBeadCount\";\nimport { FieldsetWidthAndHeight } from \"../ui/FieldsetWidthAndHeight\";\nimport { FieldDeleteAndCopy } from \"../ui/FieldDeleteAndCopy\";\nimport { FieldsetBeadRotate } from \"../ui/FieldsetBeadRotate\";\n\nexport const ToolbarEditLines = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <ToolbarEditLinesWrapper />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst ToolbarEditLinesWrapper = ({}) => {\n  const showToolbar = useSelector((state: Editor) => {\n    return state.ui.selectedLinesIdsCount >= 1;\n  });\n  if (showToolbar) {\n    return <Content />;\n  }\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BeadPreview />\n      <BeadSize />\n      <BeadColor />\n      <BeadType />\n      <BeadsSpacing />\n      <BeadsCount />\n      <BeadsRotate />\n      <DeleteAndClone />\n    </React.Fragment>\n  );\n};\n\nconst BeadsRotate = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const lineId = Object.keys(state.ui.selectedLinesIds)[0];\n    return state.appData.lines[lineId];\n  });\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  const { settings } = selected;\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsRotate = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_defaultBead_rotate(newValue)\n    );\n  };\n\n  return (\n    <FieldsetBeadRotate\n      value={settings.defaultBead.rotate}\n      onChange={onChange_beadsRotate}\n    />\n  );\n};\n\nconst BeadSize = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const lineId = Object.keys(state.ui.selectedLinesIds)[0];\n    return state.appData.lines[lineId];\n  });\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  const { settings } = selected;\n\n  const onChange_beadWidth = value => {\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_defaultBead_width(value)\n    );\n  };\n  const onChange_beadHeight = value => {\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_defaultBead_height(value)\n    );\n  };\n  const onChange_keepAspectRatio = value => {\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_defaultBead_keepAspectRatio(\n        value\n      )\n    );\n  };\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  const width = settings.defaultBead.width ? settings.defaultBead.width : 10;\n  const height = settings.defaultBead.height ? settings.defaultBead.height : 10;\n  const keepAspectRatio = settings.defaultBead.keepAspectRatio\n    ? settings.defaultBead.keepAspectRatio\n    : false;\n\n  return (\n    <div>\n      <FieldsetWidthAndHeight\n        height={height}\n        width={width}\n        keepAspectRatio={keepAspectRatio}\n        onChange_beadHeight={onChange_beadHeight}\n        onChange_beadWidth={onChange_beadWidth}\n        onChange_keepAspectRatio={onChange_keepAspectRatio}\n      />\n    </div>\n  );\n};\n\nconst BeadsCount = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const lineId = Object.keys(state.ui.selectedLinesIds)[0];\n    return state.appData.lines[lineId];\n  });\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  const { settings } = selected;\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsCount = value => {\n    if (!value) {\n      return;\n    }\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_settings_beadsCount(\n        Number(value)\n      )\n    );\n  };\n\n  const onChange_beadsAutoCount = value => {\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_settings_beadsAutoCount(value)\n    );\n  };\n\n  return (\n    <FieldsetBeadCount\n      beadsAutoCount={settings.beadsAutoCount}\n      beadsCount={settings.beadsCount}\n      onChange_beadsAutoCount={onChange_beadsAutoCount}\n      onChange_beadsCount={onChange_beadsCount}\n    />\n  );\n};\n\nconst BeadsSpacing = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const lineId = Object.keys(state.ui.selectedLinesIds)[0];\n    return state.appData.lines[lineId];\n  });\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  const { settings } = selected;\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsSpacing = value => {\n    if (!value) {\n      return;\n    }\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_settings_beadsSpacing(\n        Number(value)\n      )\n    );\n  };\n\n  const onChange_beadsAutoSpacing = value => {\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_settings_beadsAutoSpacing(\n        value\n      )\n    );\n  };\n\n  return (\n    <FieldsetBeadSpacing\n      beadsAutoSpacing={settings.beadsAutoSpacing}\n      beadsSpacing={settings.beadsSpacing}\n      onChange_beadsAutoSpacing={onChange_beadsAutoSpacing}\n      onChange_beadsSpacing={onChange_beadsSpacing}\n    />\n  );\n};\n\nconst BeadType = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const lineId = Object.keys(state.ui.selectedLinesIds)[0];\n    return state.appData.lines[lineId];\n  });\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  const { settings } = selected;\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead.type) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = type => {\n    dispatch(Actions.Toolbar.action_changeSelectedLines_defaultBead_type(type));\n  };\n\n  return (\n    <FieldsetBeadType onChange={onSelect} value={settings.defaultBead.type} />\n  );\n};\n\nconst BeadColor = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const lineId = Object.keys(state.ui.selectedLinesIds)[0];\n    return state.appData.lines[lineId];\n  });\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  const { settings } = selected;\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead.color) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = color => {\n    dispatch(\n      Actions.Toolbar.action_changeSelectedLines_defaultBead_color(color)\n    );\n  };\n\n  return (\n    <FieldsetColor onChange={onSelect} value={settings.defaultBead.color} />\n  );\n};\n\nconst BeadPreview = () => {\n  const selected = useSelector((state: Editor) => {\n    const lineId = Object.keys(state.ui.selectedLinesIds)[0];\n    return state.appData.lines[lineId];\n  });\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  const { settings } = selected;\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  return <FieldBeadPreview bead={settings.defaultBead} />;\n};\n\nconst DeleteAndClone = () => {\n  const dispatch = useDispatch();\n  const onDeleteLines = () => {\n    dispatch(Actions.Toolbar.action_deleteSelectedLines());\n  };\n  const onCloneLines = () => {\n    dispatch(Actions.Toolbar.action_cloneSelectedLines());\n  };\n  const onResetBeads = () => {\n    dispatch(Actions.Toolbar.action_resetSelectedLines());\n  };\n\n  return (\n    <React.Fragment>\n      <FieldDeleteAndCopy\n        onDelete={onDeleteLines}\n        onClone={onCloneLines}\n        onReset={onResetBeads}\n      />\n    </React.Fragment>\n  );\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { FieldBeadPreview } from \"../ui/FieldBeadPreview\";\nimport { Actions } from \"../../../store\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetBeadType } from \"../ui/FieldsetBeadType\";\nimport { FieldsetBeadSpacing } from \"../ui/FieldsetBeadSpacing\";\nimport { FieldsetBeadCount } from \"../ui/FieldsetBeadCount\";\nimport { FieldsetWidthAndHeight } from \"../ui/FieldsetWidthAndHeight\";\nimport { FieldDeleteAndCopy } from \"../ui/FieldDeleteAndCopy\";\nimport { FieldsetBeadRotate } from \"../ui/FieldsetBeadRotate\";\n\nexport const ToolbarEditBeads = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <ContentWrapper />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst ContentWrapper = ({}) => {\n  const showToolbar = useSelector((state: Editor) => {\n    return state.ui.selectedBeadsIdsCount >= 1;\n  });\n  if (showToolbar) {\n    return <Content />;\n  }\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BeadPreview />\n      <BeadSize />\n      <BeadColor />\n      <BeadType />\n      <BeadsRotate />\n    </React.Fragment>\n  );\n};\n\nconst BeadsRotate = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsRotate = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_rotate(newValue));\n  };\n\n  return (\n    <FieldsetBeadRotate\n      value={selected.rotate}\n      onChange={onChange_beadsRotate}\n    />\n  );\n};\n\nconst BeadSize = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadWidth = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_width(value));\n  };\n  const onChange_beadHeight = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_height(value));\n  };\n  const onChange_keepAspectRatio = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_keepAspectRatio(value));\n  };\n  const width = selected.width ? selected.width : 10;\n  const height = selected.height ? selected.height : 10;\n  const keepAspectRatio = selected.keepAspectRatio\n    ? selected.keepAspectRatio\n    : false;\n\n  return (\n    <div>\n      <FieldsetWidthAndHeight\n        height={height}\n        width={width}\n        keepAspectRatio={keepAspectRatio}\n        onChange_beadHeight={onChange_beadHeight}\n        onChange_beadWidth={onChange_beadWidth}\n        onChange_keepAspectRatio={onChange_keepAspectRatio}\n      />\n    </div>\n  );\n};\n\nconst BeadType = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  if (!selected.type) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = type => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_type(type));\n  };\n\n  return <FieldsetBeadType onChange={onSelect} value={selected.type} />;\n};\n\nconst BeadColor = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  if (!selected.color) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = color => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_color(color));\n  };\n\n  return <FieldsetColor onChange={onSelect} value={selected.color} />;\n};\n\nconst BeadPreview = () => {\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  return <FieldBeadPreview bead={selected} />;\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { FieldBeadPreview } from \"../ui/FieldBeadPreview\";\nimport { Actions } from \"../../../store\";\nimport { FieldsetWidth } from \"../ui/FieldsetWidth\";\nimport { FieldsetHeight } from \"../ui/FieldsetHeight\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetBeadType } from \"../ui/FieldsetBeadType\";\nimport { FieldsetBeadSpacing } from \"../ui/FieldsetBeadSpacing\";\nimport { FieldsetBeadCount } from \"../ui/FieldsetBeadCount\";\nimport { FieldsetWidthAndHeight } from \"../ui/FieldsetWidthAndHeight\";\nimport { FieldsetBeadRotate } from \"../ui/FieldsetBeadRotate\";\n\nexport const ToolbarAddLine = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BeadPreview />\n      <BeadSize />\n      <BeadColor />\n      <BeadType />\n      <BeadsSpacing />\n      <BeadsCount />\n      <BeadsRotate />\n    </React.Fragment>\n  );\n};\n\nconst BeadsRotate = () => {\n  const dispatch = useDispatch();\n  const settings = useSelector((state: Editor) => {\n    return state.ui.lineSettings.settings;\n  });\n  if (!settings) {\n    return <React.Fragment />;\n  }\n\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsRotate = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_changeDefaultLineBeadRotate(newValue));\n  };\n\n  return (\n    <FieldsetBeadRotate\n      value={settings.defaultBead.rotate}\n      onChange={onChange_beadsRotate}\n    />\n  );\n};\n\nconst BeadSize = () => {\n  const dispatch = useDispatch();\n  const settings = useSelector((state: Editor) => {\n    return state.ui.lineSettings.settings;\n  });\n  const onChange_beadWidth = value => {\n    dispatch(Actions.Toolbar.action_changeDefaultLineBeadWidth(value));\n  };\n  const onChange_beadHeight = value => {\n    dispatch(Actions.Toolbar.action_changeDefaultLineBeadHeight(value));\n  };\n  const onChange_keepAspectRatio = value => {\n    dispatch(\n      Actions.Toolbar.action_changeDefaultLineBeadKeepAspectRatio(value)\n    );\n  };\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  const width = settings.defaultBead.width ? settings.defaultBead.width : 10;\n  const height = settings.defaultBead.height ? settings.defaultBead.height : 10;\n  const keepAspectRatio = settings.defaultBead.keepAspectRatio\n    ? settings.defaultBead.keepAspectRatio\n    : false;\n\n  return (\n    <div>\n      <FieldsetWidthAndHeight\n        height={height}\n        width={width}\n        keepAspectRatio={keepAspectRatio}\n        onChange_beadHeight={onChange_beadHeight}\n        onChange_beadWidth={onChange_beadWidth}\n        onChange_keepAspectRatio={onChange_keepAspectRatio}\n      />\n    </div>\n  );\n};\n\nconst BeadsCount = () => {\n  const dispatch = useDispatch();\n  const settings = useSelector((state: Editor) => {\n    return state.ui.lineSettings.settings;\n  });\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsCount = value => {\n    if (!value) {\n      return;\n    }\n    dispatch(Actions.Toolbar.action_changeDefaultLineBeadsCount(Number(value)));\n  };\n\n  const onChange_beadsAutoCount = value => {\n    dispatch(Actions.Toolbar.action_changeDefaultLineBeadsAutoCount(value));\n  };\n\n  return (\n    <FieldsetBeadCount\n      beadsAutoCount={settings.beadsAutoCount}\n      beadsCount={settings.beadsCount}\n      onChange_beadsAutoCount={onChange_beadsAutoCount}\n      onChange_beadsCount={onChange_beadsCount}\n    />\n  );\n};\n\nconst BeadsSpacing = () => {\n  const dispatch = useDispatch();\n  const settings = useSelector((state: Editor) => {\n    return state.ui.lineSettings.settings;\n  });\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsSpacing = value => {\n    if (!value) {\n      return;\n    }\n    dispatch(\n      Actions.Toolbar.action_changeDefaultLineBeadsSpacing(Number(value))\n    );\n  };\n\n  const onChange_beadsAutoSpacing = value => {\n    dispatch(Actions.Toolbar.action_changeDefaultLineBeadsAutoSpacing(value));\n  };\n\n  return (\n    <FieldsetBeadSpacing\n      beadsAutoSpacing={settings.beadsAutoSpacing}\n      beadsSpacing={settings.beadsSpacing}\n      onChange_beadsAutoSpacing={onChange_beadsAutoSpacing}\n      onChange_beadsSpacing={onChange_beadsSpacing}\n    />\n  );\n};\n\nconst BeadType = () => {\n  const dispatch = useDispatch();\n  const settings = useSelector((state: Editor) => {\n    return state.ui.lineSettings.settings;\n  });\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead.type) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = type => {\n    dispatch(Actions.Toolbar.action_changeDefaultLineBeadType(type));\n  };\n\n  return (\n    <FieldsetBeadType onChange={onSelect} value={settings.defaultBead.type} />\n  );\n};\n\nconst BeadColor = () => {\n  const dispatch = useDispatch();\n  const settings = useSelector((state: Editor) => {\n    return state.ui.lineSettings.settings;\n  });\n\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead.color) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = color => {\n    dispatch(Actions.Toolbar.action_changeDefaultLineColor(color));\n  };\n\n  return (\n    <FieldsetColor onChange={onSelect} value={settings.defaultBead.color} />\n  );\n};\n\nconst BeadPreview = () => {\n  const settings = useSelector((state: Editor) => {\n    return state.ui.lineSettings.settings;\n  });\n  if (!settings) {\n    return <React.Fragment />;\n  }\n  if (!settings.defaultBead) {\n    return <React.Fragment />;\n  }\n  return <FieldBeadPreview bead={settings.defaultBead} />;\n};\n\n// const BeadWidth = () => {\n//   const dispatch = useDispatch();\n//   const settings = useSelector((state: Editor) => {\n//     return state.ui.lineSettings.settings;\n//   });\n//   const onChange = value => {\n//     dispatch(Actions.Toolbar.action_changeDefaultLineBeadWidth(value));\n//   };\n//   if (!settings) {\n//     return <React.Fragment />;\n//   }\n//   if (!settings.defaultBead) {\n//     return <React.Fragment />;\n//   }\n//   const value = settings.defaultBead.width ? settings.defaultBead.width : 10;\n//   return <FieldsetWidth value={value} onChange={onChange} />;\n// };\n\n// const BeadHeight = () => {\n//   const dispatch = useDispatch();\n//   const settings = useSelector((state: Editor) => {\n//     return state.ui.lineSettings.settings;\n//   });\n//   const onChange = value => {\n//     dispatch(Actions.Toolbar.action_changeDefaultLineBeadHeight(value));\n//   };\n\n//   if (!settings) {\n//     return <React.Fragment />;\n//   }\n//   if (!settings.defaultBead) {\n//     return <React.Fragment />;\n//   }\n//   const value = settings.defaultBead.height ? settings.defaultBead.height : 10;\n\n//   return <FieldsetHeight value={value} onChange={onChange} />;\n// };\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { ToolbarField } from \"../ui/ToolbarField\";\n\nexport const ToolbarIdle = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  const linesLen = useSelector((state: Editor) => {\n    return Object.keys(state.appData.lines).length;\n  });\n\n  const beadsLen = useSelector((state: Editor) => {\n    return Object.keys(state.appData.beads).length;\n  });\n\n  return (\n    <div>\n      <ToolbarField\n        label={\"Beads\"}\n        onToggle={undefined}\n        value={beadsLen}\n        icon={undefined}\n      />\n\n      <ToolbarField\n        label={\"Lines\"}\n        onToggle={undefined}\n        value={linesLen}\n        icon={undefined}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { range } from \"lodash\";\nimport { getTranslate3dCss } from \"./MapValuesToCss\";\nimport { useSelector } from \"react-redux\";\nimport { Editor, EditorGridType } from \"../../editorObjects/Editor\";\nimport { buildPoint } from \"../../editorObjects/Point\";\nexport const DisplayGridLines = ({ isVisible }) => {\n  if (isVisible === false) {\n    return <React.Fragment />;\n  }\n\n  return <Content />;\n};\n\nconst Content = () => {\n  const grid = useSelector((state: Editor) => {\n    return state.ui.grid;\n  });\n\n  const { height, width, hexSize, type, isVisible } = grid;\n\n  if (isVisible === false) {\n    return <React.Fragment />;\n  }\n\n  if (type === EditorGridType.Box) {\n    return <GridBox height={height} width={width} />;\n  }\n\n  if (type === EditorGridType.Hex) {\n    return <GridHex hexSize={hexSize} />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst GridBox = ({ height, width }) => {\n  const gridItemW = width;\n  const gridItemH = height;\n  const gridItemColor = \"rgba(0,0,0,0.08)\";\n  const gridItemStrokeWidth = 1;\n  const svg =\n    `<svg xmlns='http://www.w3.org/2000/svg' width='${gridItemW}' height='${gridItemH}'>` +\n    `  <line x1='${gridItemW / 2}' y1='0' x2='${gridItemW /\n      2}' y2='${gridItemH}' style='stroke:${gridItemColor};stroke-width:${gridItemStrokeWidth}' />` +\n    `  <line x1='0' y1='${gridItemH / 2}' x2='${gridItemW}' y2='${gridItemH /\n      2}' style='stroke:${gridItemColor};stroke-width:${gridItemStrokeWidth}' />` +\n    \"</svg>\";\n  const backgroundUrl = `url(\"data:image/svg+xml;utf8,${svg}\")`;\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        width: \"100%\",\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        backgroundImage: backgroundUrl,\n        backgroundRepeat: \"repeat\",\n        backgroundPosition: `${gridItemW / 2}px ${gridItemH / 2}px`,\n        zIndex: 4,\n      }}\n    />\n  );\n};\n\nconst pointy_hex_corner = (center, size, i) => {\n  var angle_deg = 60 * i - 30;\n  var angle_rad = (Math.PI / 180) * angle_deg;\n  return buildPoint(\n    center.x + size * Math.cos(angle_rad),\n    center.y + size * Math.sin(angle_rad)\n  );\n\n  // w = sqrt(3) * size\n  // h = 2 * size\n};\n\nconst GridHex = ({ hexSize }) => {\n  const gridItemColor = \"rgba(0,0,0,0.1)\";\n  const gridItemStrokeWidth = 1;\n\n  const size = hexSize;\n  const width = Math.sqrt(3) * size;\n  const height = 2 * size;\n  const startPoint = buildPoint(0, size);\n  const movedPoint = buildPoint(startPoint.x, startPoint.y);\n  movedPoint.x = movedPoint.x + width;\n  const moreMovedPoint = buildPoint(startPoint.x, startPoint.y);\n  moreMovedPoint.x = moreMovedPoint.x + width / 2;\n  moreMovedPoint.y = moreMovedPoint.y + height * (3 / 4);\n  const evenmoreMovedPoint = buildPoint(startPoint.x, startPoint.y);\n  evenmoreMovedPoint.x = evenmoreMovedPoint.x - width / 2;\n  evenmoreMovedPoint.y = evenmoreMovedPoint.y + height * (3 / 4);\n  const lines = [\n    [\n      pointy_hex_corner(startPoint, size, 5),\n      pointy_hex_corner(startPoint, size, 6),\n    ],\n    [\n      pointy_hex_corner(startPoint, size, 0),\n      pointy_hex_corner(startPoint, size, 1),\n    ],\n    [\n      pointy_hex_corner(startPoint, size, 1),\n      pointy_hex_corner(startPoint, size, 2),\n    ],\n    [\n      pointy_hex_corner(movedPoint, size, 4),\n      pointy_hex_corner(movedPoint, size, 5),\n    ],\n    [\n      pointy_hex_corner(movedPoint, size, 2),\n      pointy_hex_corner(movedPoint, size, 3),\n    ],\n    [\n      pointy_hex_corner(movedPoint, size, 2),\n      pointy_hex_corner(movedPoint, size, 3),\n    ],\n    [\n      pointy_hex_corner(moreMovedPoint, size, 0),\n      pointy_hex_corner(moreMovedPoint, size, 1),\n    ],\n    [\n      pointy_hex_corner(evenmoreMovedPoint, size, 0),\n      pointy_hex_corner(evenmoreMovedPoint, size, 1),\n    ],\n  ];\n\n  const boxW = width;\n  const boxH = 1.5 * height;\n\n  let svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${boxW}' height='${boxH}'>`;\n  lines.forEach(points => {\n    const [a, b] = points;\n    const line =\n      `<line x1='${a.x}' y1='${a.y}' x2='${b.x}' y2='${b.y}' ` +\n      `style='stroke:${gridItemColor};stroke-width:${gridItemStrokeWidth}' />`;\n    svg = svg + line;\n  });\n  svg = svg + \"</svg>\";\n\n  const backgroundUrl = `url(\"data:image/svg+xml;utf8,${svg}\")`;\n\n  return (\n    <div\n      style={{\n        height: \"100%\",\n        width: \"100%\",\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        backgroundImage: backgroundUrl,\n        backgroundRepeat: \"repeat\",\n        backgroundPosition: `1px 0px`,\n        zIndex: 4,\n      }}\n    ></div>\n  );\n};\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faFileAlt,\n  faMarker,\n  faCog,\n  faImage,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Actions } from \"../../store\";\nimport { Editor, EditorMenuMain } from \"../../editorObjects/Editor\";\n\nexport const TopbarMain = () => {\n  const dispatch = useDispatch();\n  const currentMenuMainOpen = useSelector((state: Editor) => {\n    return state.ui.currentMenuMainOpen;\n  });\n  const onClick_file = () => {\n    dispatch(Actions.Topbar.action_toggleMenuFile());\n  };\n  const onClick_grid = () => {\n    dispatch(Actions.Topbar.action_toggleMenuSettings());\n  };\n  const onClick_background = () => {\n    dispatch(Actions.Topbar.action_toggleMenuBackground());\n  };\n  return (\n    <div\n      className=\"field has-addons\"\n      style={{ margin: 0, border: \"1px solid #e0e0e0\", paddingBottom: \"0px\" }}\n    >\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.File ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_file}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faFileAlt} color={uiButton} />\n          </span>\n          <span>File</span>\n        </div>\n      </div>\n\n      {/* <div className=\"control\">\n        <div className={`button`} onClick={onClick_selection}>\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faMarker} />\n          </span>\n          <span>Canvas</span>\n        </div>\n      </div> */}\n\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.Grid ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_grid}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faCog} color={uiButton} />\n          </span>\n          <span>Grid</span>\n        </div>\n      </div>\n\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.Background ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_background}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faImage} color={uiButton} />\n          </span>\n          <span>Background</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes, faSave, faDownload } from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Editor } from \"../../editorObjects/Editor\";\nimport { Actions } from \"../../store\";\n\nexport const EditorChangeState = () => {\n  const dispatch = useDispatch();\n  const isSaved = useSelector((state: Editor) => {\n    return state.ui.saveInfo.saved;\n  });\n  const haveUnsavedChanges = useSelector((state: Editor) => {\n    return state.ui.saveInfo.haveUnsavedChanges;\n  });\n\n  const onClearCanvas = () => {\n    dispatch(Actions.Persist.action_onClearCanvas());\n  };\n\n  const readSavedCanvas = () => {\n    dispatch(Actions.Persist.action_readSavedCanvas());\n  };\n\n  const onSaveCanvas = () => {\n    dispatch(Actions.Persist.action_onSaveCanvas());\n  };\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n      <div\n        className=\"field has-addons\"\n        style={{ width: \"auto\", flexWrap: \"nowrap\", marginBottom: \"0\" }}\n      >\n        <div className=\"control\">\n          <div className={` button is-light `} onClick={onClearCanvas}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faTimes} color={uiButton} />\n            </span>\n            <span>New project</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div\n            className={` button is-light ${\n              isSaved === true ? \"is-success\" : \"\"\n            }`}\n            onClick={onSaveCanvas}\n          >\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faSave} color={uiButton} />\n            </span>\n            <span>Save</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={`button is-light `} onClick={readSavedCanvas}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faDownload} color={uiButton} />\n            </span>\n            <span>Load local</span>\n          </div>\n        </div>\n      </div>\n      <div\n        style={{\n          fontFamily: \"Open Sans, sans-serif\",\n          fontSize: \"13px\",\n          alignSelf: \"center\",\n        }}\n      >\n        {haveUnsavedChanges === true ? (\n          <div>You have unsaved changes</div>\n        ) : (\n          <div>No changes to save</div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  Editor,\n  EditorMenuMain,\n  EditorGridType,\n} from \"../../editorObjects/Editor\";\nimport { EditorChangeState } from \"../Toolbar/EditorChangeState\";\nimport { FieldCheckbox } from \"../Toolbar/ui/FieldCheckbox\";\nimport NumberFormat from \"react-number-format\";\nimport { Actions } from \"../../store\";\nimport { SliderWithTooltip } from \"../Toolbar/ui/FieldSlider\";\n\nexport const TopbarSecoundary = () => {\n  const currentMenuMainOpen = useSelector((state: Editor) => {\n    return state.ui.currentMenuMainOpen;\n  });\n  if (currentMenuMainOpen === EditorMenuMain.File) {\n    return <SubMenuFile />;\n  }\n  if (currentMenuMainOpen === EditorMenuMain.Grid) {\n    return <SubMenuGrid />;\n  }\n  if (currentMenuMainOpen === EditorMenuMain.Background) {\n    return <SubMenuBackground />;\n  }\n  return <React.Fragment />;\n};\n\nconst SubMenuFile = () => {\n  const dispatch = useDispatch();\n  return (\n    <div>\n      <EditorChangeState />\n    </div>\n  );\n};\n\nconst SubMenuBackground = () => {\n  const dispatch = useDispatch();\n  const image = useSelector((state: Editor) => {\n    return state.ui.background.image;\n  });\n\n  const { position, url, scale, opacity } = image;\n  const onChange_clear = () => {\n    dispatch(Actions.Topbar.action_background_image_clear());\n  };\n  const onChange_upload = event => {\n    const selectedFiles: FileList = event.target.files;\n    const files = Array.from(selectedFiles);\n    if (files.length === 0) {\n      console.error(\"no files selected\");\n      return;\n    }\n    let file = files[0];\n    const types = [\"image/png\", \"image/jpeg\", \"image/gif\"];\n    if (types.every(type => file.type !== type)) {\n      console.error(`'${file.type}' is not a supported format`);\n      return;\n    }\n    if (file.size > 1 * 1024 * 1024) {\n      console.error(`'${file.name}' is too large, please pick a smaller file`);\n      return;\n    }\n    let reader = new FileReader();\n    reader.onloadend = () => {\n      dispatch(Actions.Topbar.action_background_image_upload(reader.result));\n    };\n    reader.readAsDataURL(file);\n    event.preventDefault();\n  };\n  const onChange_pointX = value => {\n    dispatch(Actions.Topbar.action_background_image_pointX(value));\n  };\n  const onChange_pointY = value => {\n    dispatch(Actions.Topbar.action_background_image_pointY(value));\n  };\n  const onChange_scale = value => {\n    dispatch(Actions.Topbar.action_background_image_scale(value));\n  };\n  const onChange_opacity = value => {\n    dispatch(Actions.Topbar.action_background_image_opacity(value));\n  };\n  return (\n    <div\n      style={{ flexWrap: \"nowrap\", display: \"flex\", alignItems: \"flex-start\" }}\n    >\n      <div style={{ flexWrap: \"nowrap\", display: \"flex\", marginTop: \"4px\" }}>\n        <div className=\"control\">\n          <div className={` button is-light `} onClick={onChange_clear}>\n            <span>Clear</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={` button is-light `} style={{ position: \"relative\" }}>\n            <input\n              type=\"file\"\n              onChange={onChange_upload}\n              style={{\n                position: \"absolute\",\n                top: 0,\n                left: 0,\n                width: \"100%\",\n                height: \"100%\",\n                opacity: 0,\n                zIndex: 2,\n              }}\n            />\n            <span>Upload</span>\n          </div>\n        </div>\n      </div>\n\n      <div\n        style={{\n          display: \"flex\",\n          marginLeft: \"10px\",\n          marginRight: \"10px\",\n          flexWrap: \"nowrap\",\n          alignItems: \"flex-start\",\n        }}\n      >\n        <div\n          className={\"fieldset\"}\n          style={{\n            width: \"100px\",\n            whiteSpace: \"nowrap\",\n            flexWrap: \"nowrap\",\n            display: \"flex\",\n            alignItems: \"flex-start\",\n          }}\n        >\n          <div\n            className=\"label\"\n            style={{ whiteSpace: \"nowrap\" }}\n          >{`Scale: ${scale}`}</div>\n        </div>\n        <div style={{ width: \"100px\", marginLeft: \"20px\", marginTop: \"13px\" }}>\n          <SliderWithTooltip\n            max={16}\n            min={0.2}\n            step={0.1}\n            value={scale}\n            onChange={value => onChange_scale(value)}\n            defaultValue={1}\n            // marks={{\n            //   0.2: \"0.2\",\n            //   4: \"4\",\n            //   8: \"8\",\n            // }}\n          />\n        </div>\n      </div>\n\n      <BackgroundPosition\n        pointX={position.x}\n        onChange_pointX={onChange_pointX}\n        pointY={position.y}\n        onChange_pointY={onChange_pointY}\n      />\n\n      <div\n        style={{\n          display: \"flex\",\n          marginLeft: \"10px\",\n          marginRight: \"10px\",\n          flexWrap: \"nowrap\",\n          alignItems: \"flex-start\",\n        }}\n      >\n        <div className={\"fieldset\"} style={{ width: \"85px\" }}>\n          <div\n            className=\"label\"\n            style={{ flexWrap: \"nowrap\", whiteSpace: \"nowrap\" }}\n          >\n            Opacity: {opacity}\n          </div>\n        </div>\n        <div style={{ width: \"80px\", marginLeft: \"10px\", marginTop: \"13px\" }}>\n          <SliderWithTooltip\n            max={1}\n            min={0}\n            step={0.1}\n            value={opacity}\n            onChange={value => onChange_opacity(value)}\n            defaultValue={1}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst BackgroundPosition = ({\n  pointX,\n  onChange_pointX,\n  pointY,\n  onChange_pointY,\n}) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\",\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Image position: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={999}\n          min={-999}\n          maxLength={3}\n          value={pointX}\n          onValueChange={event => {\n            onChange_pointX(event.floatValue);\n          }}\n          placeholder=\"x\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\",\n          }}\n        />\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={999}\n          min={-999}\n          maxLength={3}\n          value={pointY}\n          onValueChange={event => {\n            onChange_pointY(event.floatValue);\n          }}\n          placeholder=\"y\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nconst SubMenuGrid = () => {\n  const dispatch = useDispatch();\n  const grid = useSelector((state: Editor) => {\n    return state.ui.grid;\n  });\n\n  const { height, width, hexSize, type, snapEnabled, isVisible } = grid;\n  const onChange_isVisible = () => {\n    dispatch(Actions.Topbar.action_toggleGridIsVisible());\n  };\n  const onChange_snapEnabled = () => {\n    dispatch(Actions.Topbar.action_toggleGridSnapEnabled());\n  };\n  const onChange_gridItemW = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridWidth(newValue));\n  };\n  const onChange_gridItemH = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridHeight(newValue));\n  };\n  const onClick_selectTypeHex = () => {\n    dispatch(Actions.Topbar.action_setGridType(EditorGridType.Hex));\n  };\n  const onClick_selectTypeBox = () => {\n    dispatch(Actions.Topbar.action_setGridType(EditorGridType.Box));\n  };\n  const onChange_hexSize = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridHexSize(newValue));\n  };\n\n  return (\n    <div style={{ display: \"flex\", flexWrap: \"nowrap\", alignItems: \"center\" }}>\n      <GridOptions\n        isVisible={isVisible}\n        onChange_isVisible={onChange_isVisible}\n        snapEnabled={snapEnabled}\n        onChange_snapEnabled={onChange_snapEnabled}\n        type={type}\n        onClick_selectTypeHex={onClick_selectTypeHex}\n        onClick_selectTypeBox={onClick_selectTypeBox}\n      />\n\n      {type === EditorGridType.Box ? (\n        <GridBoxSettings\n          gridItemW={width}\n          onChange_gridItemW={onChange_gridItemW}\n          gridItemH={height}\n          onChange_gridItemH={onChange_gridItemH}\n        />\n      ) : null}\n\n      {type === EditorGridType.Hex ? (\n        <GridHexSettings\n          hexSize={hexSize}\n          onChange_hexSize={onChange_hexSize}\n        />\n      ) : null}\n    </div>\n  );\n};\n\nconst GridOptions = ({\n  isVisible,\n  onChange_isVisible,\n  snapEnabled,\n  onChange_snapEnabled,\n  type,\n  onClick_selectTypeHex,\n  onClick_selectTypeBox,\n}) => {\n  return (\n    <React.Fragment>\n      <div\n        style={{\n          marginRight: \"15px\",\n        }}\n      >\n        <FieldCheckbox\n          label={\"Show grid\"}\n          value={isVisible}\n          onChange={onChange_isVisible}\n          isDisabled={false}\n        />\n      </div>\n\n      <div\n        style={{\n          marginRight: \"15px\",\n        }}\n      >\n        <FieldCheckbox\n          label={\"Snap to grid\"}\n          value={snapEnabled}\n          onChange={onChange_snapEnabled}\n          isDisabled={false}\n        />\n      </div>\n\n      <div\n        style={{\n          marginRight: \"15px\",\n        }}\n      >\n        <div className={\"fieldset\"}>\n          <div className=\"label\">Grid type: </div>\n          <div className=\"control\">\n            <div\n              className={` button is-light ${\n                type === EditorGridType.Hex ? \"is-dark\" : \"\"\n              } `}\n              onClick={onClick_selectTypeHex}\n            >\n              <span>Hexagon</span>\n            </div>\n          </div>\n\n          <div className=\"control\">\n            <div\n              className={` button is-light ${\n                type === EditorGridType.Box ? \"is-dark\" : \"\"\n              }`}\n              onClick={onClick_selectTypeBox}\n            >\n              <span>Rectangle</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\nconst GridBoxSettings = ({\n  gridItemW,\n  onChange_gridItemW,\n  gridItemH,\n  onChange_gridItemH,\n}) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\",\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Grid size: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={1}\n          maxLength={2}\n          value={gridItemW}\n          onValueChange={event => {\n            onChange_gridItemW(event.floatValue);\n          }}\n          placeholder=\"width\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\",\n          }}\n        />\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={1}\n          maxLength={2}\n          value={gridItemH}\n          onValueChange={event => {\n            onChange_gridItemH(event.floatValue);\n          }}\n          placeholder=\"height\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nconst GridHexSettings = ({ hexSize, onChange_hexSize }) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\",\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Hex size: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={5}\n          maxLength={2}\n          value={hexSize}\n          onValueChange={event => {\n            onChange_hexSize(event.floatValue);\n          }}\n          placeholder=\"width\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\",\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n","import React, { useState, useRef } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor, BrushType } from \"../../editorObjects/Editor\";\nimport { getTranslate3dCss } from \"./MapValuesToCss\";\nimport { Actions } from \"../../store\";\n\nexport const Brush = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  const brush = useSelector((state: Editor) => {\n    return state.ui.brush;\n  });\n  const { type, color, size } = brush;\n  if (type === BrushType.Color) {\n    return <ColorBrush color={color} size={size} />;\n  }\n  return <React.Fragment />;\n};\n\nconst ColorBrush = ({ color, size }) => {\n  const dispatch = useDispatch();\n  const [isVisible, set_isVisible] = useState(false);\n  const [isActivated, set_isActivated] = useState(false);\n  const [pointX, set_pointX] = useState(0);\n  const [pointY, set_pointY] = useState(0);\n  const [rect, set_rect] = useState<ClientRect | null>(null);\n  const sceneWrapperRef = useRef<HTMLDivElement>(null);\n  const onMouseEnter = (event: React.MouseEvent<HTMLDivElement>) => {\n    set_isVisible(true);\n  };\n  const onMouseLeave = (event: React.MouseEvent<HTMLDivElement>) => {\n    set_isVisible(false);\n  };\n  const onMouseMove = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (rect === null) {\n      if (sceneWrapperRef.current) {\n        set_rect(sceneWrapperRef.current.getBoundingClientRect());\n      }\n    }\n    if (rect !== null) {\n      const x = event.clientX - rect.left - size / 2;\n      const y = event.clientY - rect.top - size / 2;\n      set_pointX(x);\n      set_pointY(y);\n      if (isActivated) {\n        dispatch(Actions.Paint.action_applyColorBrush(x, y));\n      }\n    }\n  };\n  const onMouseDown = (event: React.MouseEvent<HTMLDivElement>) => {\n    set_isActivated(true);\n    if (rect === null) {\n      if (sceneWrapperRef.current) {\n        const rect = sceneWrapperRef.current.getBoundingClientRect();\n        set_rect(rect);\n        const x = event.clientX - rect.left - size / 2;\n        const y = event.clientY - rect.top - size / 2;\n        set_pointX(x);\n        set_pointY(y);\n        dispatch(Actions.Paint.action_applyColorBrush(x, y));\n      }\n    }\n    if (rect !== null) {\n      const x = event.clientX - rect.left - size / 2;\n      const y = event.clientY - rect.top - size / 2;\n      set_pointX(x);\n      set_pointY(y);\n      dispatch(Actions.Paint.action_applyColorBrush(x, y));\n    }\n  };\n  const onMouseUp = (event: React.MouseEvent<HTMLDivElement>) => {\n    set_isActivated(false);\n  };\n  return (\n    <React.Fragment>\n      <div\n        style={{\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          width: \"100%\",\n          height: \"100%\",\n          backgroundColor: \"transparent\",\n          zIndex: 20,\n          cursor: \"cell\",\n        }}\n        ref={sceneWrapperRef}\n        onMouseDown={onMouseDown}\n        onMouseUp={onMouseUp}\n        onMouseEnter={onMouseEnter}\n        onMouseLeave={onMouseLeave}\n        onMouseMove={onMouseMove}\n      ></div>\n\n      <BrushElement\n        y={pointY}\n        x={pointX}\n        color={color}\n        size={size}\n        isVisible={isVisible}\n      />\n    </React.Fragment>\n  );\n};\n\nconst BrushElement = ({ x, y, color, size, isVisible }) => {\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        transform: getTranslate3dCss(x, y),\n        backgroundColor: color,\n        width: size,\n        height: size,\n        border: \"5px solid #aeaeae\",\n        borderRadius: \"100%\",\n        opacity: isVisible === true ? 0.8 : 0,\n        zIndex: 19,\n      }}\n    >\n      &nbsp;\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowsAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport { FieldSlider } from \"./FieldSlider\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\n\nexport const FieldsetSize = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={value}\n      label={\"Size\"}\n      icon={<FontAwesomeIcon icon={faArrowsAlt} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldSlider value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { Actions } from \"../../../store\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetSize } from \"../ui/FieldsetSize\";\n\nexport const ToolbarPaint = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BrushSize />\n      <BrushColor />\n    </React.Fragment>\n  );\n};\n\nconst BrushSize = () => {\n  const dispatch = useDispatch();\n  const size = useSelector((state: Editor) => {\n    return state.ui.brush.size;\n  });\n\n  if (!size) {\n    return <React.Fragment />;\n  }\n\n  const onChange = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_updateBrushSize(newValue));\n  };\n\n  return <FieldsetSize value={size} onChange={onChange} />;\n};\n\nconst BrushColor = () => {\n  const dispatch = useDispatch();\n  const color = useSelector((state: Editor) => {\n    return state.ui.brush.color;\n  });\n\n  if (!color) {\n    return <React.Fragment />;\n  }\n\n  const onChange = color => {\n    dispatch(Actions.Toolbar.action_updateBrushColor(color));\n  };\n\n  return <FieldsetColor onChange={onChange} value={color} />;\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Editor } from \"../../editorObjects/Editor\";\n\nexport const BackgroundImage = () => {\n  const image = useSelector((state: Editor) => {\n    return state.ui.background.image;\n  });\n\n  const { position, url, scale, opacity } = image;\n\n  if (!url) {\n    return <React.Fragment />;\n  }\n\n  return (\n    <img\n      src={url}\n      style={{\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        // width: \"100%\",\n        // height: \"100%\",\n        zIndex: 2,\n        transform: `translate3d(${position.x}px, ${position.y}px, 1px) scale(${scale})`,\n        transformOrigin: \"top left\",\n        opacity,\n      }}\n    />\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { EditorModes } from \"./Toolbar/EditorModes\";\nimport { AddLineMode } from \"./Line/AddLineMode\";\nimport { EditorChangeState } from \"./Toolbar/EditorChangeState\";\nimport { useSelector, useStore, useDispatch } from \"react-redux\";\nimport { MouseSelectionBeads } from \"./Bead/MouseSelectionBeads\";\nimport { MouseSelectionLines } from \"./Line/MouseSelectionLines\";\nimport { DisplayBeads } from \"./Bead/DisplayBeads\";\nimport { DisplayLines } from \"./Line/DisplayLines\";\nimport { GroupSelectionPlaceholder } from \"./operations/GroupSelectionPlaceholder\";\nimport { PickBeadColor } from \"./Toolbar/PickColor\";\nimport { ChangeLinePosition } from \"./Toolbar/ChangeLinePosition\";\nimport { PickBeadType } from \"./Toolbar/PickBeadType\";\nimport { ChangeBeadRotate } from \"./Toolbar/ChangeBeadRotate\";\nimport { LineInspector } from \"./Toolbar/LineInspector\";\nimport { Actions } from \"../store\";\nimport { EditToolbar } from \"./Toolbar/EditToolbar\";\nimport { ToolbarEditLines } from \"./Toolbar/Modes/ToolbarEditLines\";\nimport { ToolbarEditBeads } from \"./Toolbar/Modes/ToolbarEditBeads\";\nimport { ToolbarAddLine } from \"./Toolbar/Modes/ToolbarAddLine\";\nimport { ToolbarIdle } from \"./Toolbar/Modes/ToolbarIdle\";\nimport { DisplayGridLines } from \"./operations/DisplayGridLines\";\nimport { TopbarMain } from \"./Topbar/TopbarMain\";\nimport { TopbarSecoundary } from \"./Topbar/TopbarSecoundary\";\nimport { Brush } from \"./operations/Brush\";\nimport { ToolbarPaint } from \"./Toolbar/Modes/ToolbarPaint\";\nimport { BackgroundImage } from \"./operations/BackgroundImage\";\n\nexport const EditorScene = () => {\n  const editorMode = useSelector((state: Editor) => {\n    return state.mode;\n  });\n  const store = useStore();\n  const state = store.getState();\n  console.log(\"EditorRerender: \", state);\n\n  // @TODO: Dodac funkcje ktora zostaje uruchomiona po rozpoczeciu aplikajci\n  // const dispatch = useDispatch();\n  // const [firstPass, setFirstPass] = useState(false);\n  // useEffect(() => {\n  //   if (process.env.NODE_ENV && process.env.NODE_ENV === \"development\") {\n  //     if (firstPass === false) {\n  //       dispatch(Actions.Persist.action_readSavedCanvas());\n  //       // dispatch(\n  //       //   Actions.ChangeEditorMode.action_onChangeEditorMode(\n  //       //     EditorMode.EditLines\n  //       //   )\n  //       // );\n  //       // dispatch(Actions.Draggable.action_onClickLastestLine());\n  //       setFirstPass(true);\n  //     }\n  //   }\n  // });\n\n  if (!state) {\n    return <div>Error in app</div>;\n  }\n\n  return (\n    <div className=\"scene\">\n      <div className=\"topbar-wrapper\">\n        <TopbarMain />\n        <TopbarSecoundary />\n      </div>\n\n      <div className=\"actions-wrapper\">\n        <EditorModes editorMode={editorMode} />\n      </div>\n\n      <div className={\"scene-wrapper\"}>\n        <BackgroundImage />\n\n        <AddLineMode isActive={editorMode === EditorMode.AddLine} />\n\n        <MouseSelectionLines isVisible={editorMode === EditorMode.EditLines} />\n\n        <MouseSelectionBeads isVisible={editorMode === EditorMode.EditBeads} />\n\n        <DisplayBeads mode={editorMode} />\n\n        <DisplayLines mode={editorMode} />\n\n        <DisplayGridLines isVisible={editorMode === EditorMode.EditLines} />\n\n        <GroupSelectionPlaceholder mode={editorMode} />\n\n        <Brush isVisible={editorMode === EditorMode.Paint} />\n      </div>\n\n      <div className={\"toolbar-wrapper\"}>\n        <ToolbarEditLines isVisible={editorMode === EditorMode.EditLines} />\n        <ToolbarEditBeads isVisible={editorMode === EditorMode.EditBeads} />\n        <ToolbarAddLine isVisible={editorMode === EditorMode.AddLine} />\n        <ToolbarIdle isVisible={editorMode === EditorMode.Idle} />\n        <ToolbarPaint isVisible={editorMode === EditorMode.Paint} />\n\n        {/* <ChangeLinePosition mode={editorMode} />\n\n        <PickBeadType mode={editorMode} />\n        <ChangeBeadRotate mode={editorMode} />\n        <PickBeadColor mode={editorMode} />\n        <LineInspector mode={editorMode} />\n\n        <EditToolbar mode={editorMode} /> */}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport \"bulma/css/bulma.css\";\nimport \"./App.css\";\nimport { EditorScene } from \"./components/Editor\";\nimport { createStore } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport { store} from \"./store\";\n\nconst App: React.FC = () => {\n  const rootStore = createStore(\n    store,\n    // \"__REDUX_DEVTOOLS_EXTENSION__\" in window &&\n    //   (window as any).__REDUX_DEVTOOLS_EXTENSION__()\n  );\n  return (\n    <div className=\"App\">\n      <Provider store={rootStore}>\n        <EditorScene />\n      </Provider>\n    </div>\n  );\n};\n\nexport default App;\n\n// \"homepage\": \"https://rpcal.github.io/coralinio-preview/build/\",","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport * as Sentry from '@sentry/browser';\n\nSentry.init({dsn: \"https://94d8408ba8ab4a369c83de035643afa2@sentry.io/1807713\"});\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}