{"version":3,"sources":["threejs/RoundedBoxGeometry.js","editorObjects/Editor.tsx","EventEmitter.tsx","editorObjects/Point.ts","editorObjects/Bead.ts","components/colors.ts","editorObjects/Line.ts","immerReducers/BeadSnapperImmerReducer.tsx","immerReducers/DraggableOperationsImmerReducer.tsx","immerReducers/PersistImmerReducer.tsx","immerReducers/ChangeEditorModeImmerReducer.tsx","immerReducers/MainImmerReducer.tsx","immerReducers/MouseSelectionImmerReducer.tsx","immerReducers/ToolbarImmerReducer.tsx","immerReducers/TopbarImmerReducer.tsx","immerReducers/PaintImmerReducer.tsx","immerReducers/store.tsx","components/Toolbar/EditorModes.tsx","components/Bead/DisplayBead.tsx","components/operations/MapValuesToCss.tsx","components/Toolbar/ui/FieldBeadPreview.tsx","components/Toolbar/ui/ToolbarField.tsx","components/Toolbar/ui/ToolbarFieldSet.tsx","components/Toolbar/ui/FieldColorPicker.tsx","components/Toolbar/ui/FieldColor.tsx","components/Toolbar/ui/FieldsetColor.tsx","components/Toolbar/ui/FieldBeadTypePicker.tsx","components/Toolbar/ui/FieldsetBeadType.tsx","components/Toolbar/ui/FieldSliderWithLabel.tsx","components/Toolbar/ui/FieldCheckbox.tsx","components/Toolbar/ui/FieldsetWidthAndHeight.tsx","components/Toolbar/ui/FieldSlider.tsx","components/Toolbar/ui/FieldsetBeadRotate.tsx","components/Toolbar/Modes/ToolbarEditBeads.tsx","components/Toolbar/Modes/ToolbarIdle.tsx","components/Topbar/TopbarMain.tsx","components/Toolbar/EditorChangeState.tsx","components/Topbar/TopbarSecoundary.tsx","components/Toolbar/ui/FieldsetSize.tsx","components/Toolbar/Modes/ToolbarPaint.tsx","components/Toolbar/Modes/ToolbarAddBeads.tsx","components/Editor.tsx","threejs/renderThreejs.ts","immerReducers/appStore.tsx","App.tsx","index.tsx"],"names":["module","exports","THREE","RoundedBoxGeometry","width","height","depth","radius","radiusSegments","BufferGeometry","call","this","type","isNaN","Math","max","floor","edgeHalfWidth","min","edgeHalfHeight","edgeHalfDepth","parameters","rs1","totalVertexCount","positions","BufferAttribute","Float32Array","normals","cornerVerts","cornerNormals","vertex","Vector3","vertexPool","normalPool","indices","lastVertex","cornerVertNumber","cornerLayout","j","push","PIhalf","PI","cornerOffset","y","va","cosVa","cos","sinVa","sin","x","ha","z","vert","clone","multiplyScalar","add","norm","normalize","set","i","length","multiply","doVertices","a","b","c","d","doFaces","flips","lastRowOffset","v","r1","r2","u","u1","doCorners","cOffset","cRowOffset","needsFlip","doHeightEdges","end","cStarts","cEnds","cStart","cEnd","doWidthEdges","urs1","u1rs1","doDepthEdges","index","setXYZ","setIndex","Uint16Array","addAttribute","prototype","Object","create","constructor","BeadTypes","EditorMode","EditorMenuMain","EditorGridType","BrushType","internalEventEmiter","buildPoint","immerable","point","sqrt","getLength","useLen","scale","scalar","getDistanceBetweenPoints","start","contain","p1","p2","p","buildBead","props","defaults","id","generate","position","BasicEllipse","rotate","lineRotate","color","keepAspectRatio","merge","buildLine","__defaults","beadIds","settings","beadsCount","beadsAutoCount","beadsSpacing","beadsAutoSpacing","defaultBead","getPointFromStartLine","startX","startY","endX","endY","distance","BeadSnapperImmerReducer","lineId","currentLine","draftState","appData","lines","count","getLineBeadsCount","currentCount","remaining","addRemainingBeads","overflow","removeOverflowBeads","modifyBeadsPosition","modifyBeadsRotate","lineLen","beadsWidths","beadsWidth","forEach","beadId","beads","defaultBeadWidth","remainingSpace","remainingCount","ui","lineSettings","undefined","bead","overflowCount","arrLen","lastItemBeadId","splice","currentDistance","newPosition","standardLineHeight","avaiableSpace","dynamicBeadsSpacing","lineRotateRadian","atan2","ImmerReducer","EventEmitter","_events","name","listener","listenerToRemove","Error","filter","data","state","console","log","callback","warn","getEventEmitter","DraggableOperationsImmerReducer","event","sceneWrapperPosition","sceneWrapperWidth","sceneWrapperHeight","saveInfo","saved","haveUnsavedChanges","line","mode","EditLines","updateBeadsPositions","editorAppDataHasChanged","key","grid","snapEnabled","hexSize","Box","round","Hex","hSpace","hexHeight","vSpace","changeX","vLine","changeY","lineStart","lineEnd","deltaX","deltaY","newX","newY","keys","selectedLinesIds","selectedLinesIdsCount","action_onClickLine","selectedBeadsIds","selectedBeadsIdsCount","currentBeadChain","isDragEnabled","beadsTemplate","len","lastBeadId","lastBead","lastPosition","vec","sub","scaled","_x","_y","emit","PersistImmerReducer","b1","window","localStorage","setItem","JSON","stringify","info","ChangeEditorModeImmerReducer","clearSelectedBeads","clearSelectedLines","newEditorMode","newValue","MainImmerReducer","MouseSelectionImmerReducer","mouseSelection","isDragStarted","isDragged","abs","p3","beadsIds","prevSelectedIds","diffStates","_","xor","map","includes","ToolbarImmerReducer","field","value","lights","light","deg","firstLineId","firstLine","newLinesIds","newLine","newBead","ratio","currLine","updateLineFromSelectedBeads","currBead","results","indexOf","brush","size","TopbarImmerReducer","currentMenuMainOpen","File","None","Grid","Background","isVisible","background","image","url","opacity","PaintImmerReducer","Color","mousePoint","centerPoint","defaultAppData","intensity","angle","top","left","Idle","Actions","Main","createActionCreators","Draggable","Persist","ChangeEditorMode","MouseSelection","Toolbar","Topbar","Paint","eventEmitter","reducerForEventEmitter","produce","action","payload","store","composeReducers","createReducerFunction","EditorModes","editorMode","dispatch","useDispatch","onChangeEditorMode","action_onChangeEditorMode","className","label","icon","faArrowsAlt","onClick","isSelected","faEdit","EditBeads","faPaintBrush","AddBeads","PaintBeads","DeleteBeads","StateButton","DisplayBead","zIndex","isSelectable","isOpacity","isZindex","translate3d","getTranslate3dCss","rotateCss","styles","transform","border","borderRadius","action_onClickBead","style","FieldBeadPreview","displayBead","marginTop","marginBottom","display","justifyContent","alignItems","boxSizing","ToolbarField","onToggle","cursor","marginRight","flexDirection","paddingLeft","paddingRight","ToolbarFieldSet","selected","children","useState","isPickerOpen","setIsPickerOpen","borderTop","React","cloneElement","FieldColorPicker","onChange","colors","material","paddingTop","paddingBottom","DisplayColorsGroup","flexWrap","group","toString","FieldColor","boxShadow","FieldsetColor","faPalette","BeadTypesIcons","BasicRectangle","FieldBeadTypePicker","types","selectedType","DisplayAvailableBeadTypes","DisplayBeadType","faCircle","faExpand","FieldsetBeadType","faShapes","SliderWithTooltip","createSliderWithTooltip","Slider","FieldSliderWithLabel","borderBottom","padding","flexGrow","step","defaultValue","marks","0","50","100","FieldCheckbox","isDisabled","disabled","checked","target","FieldsetWidthAndHeight","onChange_beadHeight","onChange_beadWidth","onChange_keepAspectRatio","format","toLocaleString","maximumFractionDigits","faExpandArrowsAlt","faLink","faUnlink","faArrowsAltH","faArrowsAltV","FieldSlider","FieldsetBeadRotate","faSyncAlt","Fragment","suffix","allowNegative","allowEmptyFormatting","onValueChange","floatValue","placeholder","textAlign","fontFamily","fontSize","fontWeight","lineHeight","ToolbarEditBeads","ContentWrapper","useSelector","Content","BeadsRotate","action_changeSelectedBeads_rotate","BeadSize","action_changeSelectedBeads_height","action_changeSelectedBeads_width","action_changeSelectedBeads_keepAspectRatio","BeadType","action_changeSelectedBeads_type","BeadColor","action_changeSelectedBeads_color","BeadPreview","ToolbarIdle","linesLen","beadsLen","TopbarMain","margin","action_toggleMenuFile","faFileAlt","action_toggleMenuSettings","faCog","action_toggleMenuBackground","faImage","EditorChangeState","isSaved","action_onClearCanvas","faTimes","action_onSaveCanvas","faSave","action_readSavedCanvas","faDownload","alignSelf","TopbarSecoundary","SubMenuFile","SubMenuBackground","action_background_image_clear","selectedFiles","files","Array","from","file","every","error","reader","FileReader","onloadend","action_background_image_upload","result","readAsDataURL","preventDefault","marginLeft","whiteSpace","action_background_image_scale","onChange_scale","pointX","onChange_pointX","action_background_image_pointX","pointY","onChange_pointY","action_background_image_pointY","action_background_image_opacity","onChange_opacity","BackgroundPosition","maxLength","maxWidth","SubMenuGrid","onChange_isVisible","action_toggleGridIsVisible","onChange_snapEnabled","action_toggleGridSnapEnabled","onClick_selectTypeHex","action_setGridType","onClick_selectTypeBox","gridItemW","onChange_gridItemW","action_setGridWidth","gridItemH","onChange_gridItemH","action_setGridHeight","onChange_hexSize","action_setGridHexSize","GridOptions","GridBoxSettings","GridHexSettings","FieldsetSize","ToolbarPaint","BrushSize","action_updateBrushSize","BrushColor","action_updateBrushColor","ToolbarAddBeads","action_updateBeadsTemplate","el","EditorScene","useStore","getState","useRef","handleWidth","handleHeight","skipOnMount","onResize","action_updateSceneWrapperSize","ToolBarStyles","styled","div","Lights","LightsStyles","l","Number","action_updateLight","appStore","createStore","App","useEffect","initCanvasApp","require","camera","scene","renderer","mouse_intercestion","multiplyMatrices","makeRotationY","makeRotationZ","mouseSelectionBeads","mouseSelectionHelper","MouseSelectionHelper","getBoundingClientRect","lookAt","bg_geometry","bg_material","side","bg_plane","antialias","setPixelRatio","devicePixelRatio","setSize","appendChild","domElement","addEventListener","onWindowResize","onMouseDown","onMouseMove","onMouseUp","onWheel","setRenderer","init","animate","requestAnimationFrame","render","on","child","getObjectByName","values","emissive","geometry","SphereGeometry","mergeVertices","computeVertexNormals","flatShading","reflectivity","beadMesh","applyMatrix","makeRotationX","DEG2RAD","makeTranslation","basicMesh","sceneScale","screenX","clientX","screenY","clientY","cameraX","cameraY","mouseXInWorldBefore","mouseYInWorldBefore","sign","mouseXInWorldAfter","mouseYInWorldAfter","right","bottom","updateProjectionMatrix","diffX","diffY","boundingClientRect","screenToWorld","isCameraGrabed","startDragMousePosition","startDragCamera","onDown","action_addBeadOnClick","leftTop","rightBottom","action_selectBeads","onUp","screenMouseDiffX","screenMouseDiffY","mouseDiffXInWorldSpace","mouseDiffYInWorldSpace","subscribe","onMove","p1_x","p1_y","p2_x","p2_y","element","startPoint","pointTopLeft","pointBottomRight","isDown","document","createElement","pointerEvents","Vector2","parentElement","removeChild","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.69a9a91c.chunk.js","sourcesContent":["/**\n * @author pailhead / http://dusanbosnjak.com\n */\nmodule.exports = function(THREE) {\n  var RoundedBoxGeometry = function(width, height, depth, radius, radiusSegments) {\n    THREE.BufferGeometry.call(this);\n\n    this.type = \"RoundedBoxGeometry\";\n\n    //validate params ===================================\n\n    radiusSegments = !isNaN(radiusSegments)\n      ? Math.max(1, Math.floor(radiusSegments))\n      : 1;\n\n    width = !isNaN(width) ? width : 1;\n    height = !isNaN(height) ? height : 1;\n    depth = !isNaN(depth) ? depth : 1;\n\n    radius = !isNaN(radius) ? radius : 0.15;\n\n    radius = Math.min(\n      radius,\n      Math.min(width, Math.min(height, Math.min(depth))) / 2\n    );\n\n    var edgeHalfWidth = width / 2 - radius;\n    var edgeHalfHeight = height / 2 - radius;\n    var edgeHalfDepth = depth / 2 - radius;\n\n    //not sure why this is needed, for querying? ========\n\n    this.parameters = {\n      width: width,\n      height: height,\n      depth: depth,\n      radius: radius,\n      radiusSegments: radiusSegments\n    };\n\n    //calculate vertices count ==========================\n\n    var rs1 = radiusSegments + 1; //radius segments + 1\n\n    var totalVertexCount = (rs1 * radiusSegments + 1) << 3;\n\n    //make buffers ======================================\n\n    var positions = new THREE.BufferAttribute(\n      new Float32Array(totalVertexCount * 3),\n      3\n    );\n\n    var normals = new THREE.BufferAttribute(\n      new Float32Array(totalVertexCount * 3),\n      3\n    );\n\n    //some vars =========================================\n\n    var cornerVerts = [],\n      cornerNormals = [],\n      normal = new THREE.Vector3(),\n      vertex = new THREE.Vector3(),\n      vertexPool = [],\n      normalPool = [],\n      indices = [];\n    var lastVertex = rs1 * radiusSegments,\n      cornerVertNumber = rs1 * radiusSegments + 1;\n    doVertices();\n    doFaces();\n    doCorners();\n    doHeightEdges();\n    doWidthEdges();\n    doDepthEdges();\n\n    // calculate vert positions =========================\n\n    function doVertices() {\n      //corner offsets\n      var cornerLayout = [\n        new THREE.Vector3(1, 1, 1),\n        new THREE.Vector3(1, 1, -1),\n        new THREE.Vector3(-1, 1, -1),\n        new THREE.Vector3(-1, 1, 1),\n        new THREE.Vector3(1, -1, 1),\n        new THREE.Vector3(1, -1, -1),\n        new THREE.Vector3(-1, -1, -1),\n        new THREE.Vector3(-1, -1, 1)\n      ];\n\n      //corner holder\n      for (var j = 0; j < 8; j++) {\n        cornerVerts.push([]);\n        cornerNormals.push([]);\n      }\n\n      //construct 1/8 sphere ==============================\n\n      var PIhalf = Math.PI / 2;\n\n      var cornerOffset = new THREE.Vector3(\n        edgeHalfWidth,\n        edgeHalfHeight,\n        edgeHalfDepth\n      );\n\n      for (var y = 0; y <= radiusSegments; y++) {\n        var v = y / radiusSegments;\n\n        var va = v * PIhalf; //arrange in 90 deg\n\n        var cosVa = Math.cos(va); //scale of vertical angle\n\n        var sinVa = Math.sin(va);\n\n        if (y == radiusSegments) {\n          vertex.set(0, 1, 0);\n\n          var vert = vertex\n            .clone()\n            .multiplyScalar(radius)\n            .add(cornerOffset);\n\n          cornerVerts[0].push(vert);\n\n          vertexPool.push(vert);\n\n          var norm = vertex.clone();\n\n          cornerNormals[0].push(norm);\n\n          normalPool.push(norm);\n\n          continue; //skip row loop\n        }\n\n        for (var x = 0; x <= radiusSegments; x++) {\n          var u = x / radiusSegments;\n\n          var ha = u * PIhalf;\n\n          //make 1/8 sphere points\n          vertex.x = cosVa * Math.cos(ha);\n          vertex.y = sinVa;\n          vertex.z = cosVa * Math.sin(ha);\n\n          //copy sphere point, scale by radius, offset by half whd\n          var vert = vertex\n            .clone()\n            .multiplyScalar(radius)\n            .add(cornerOffset);\n\n          cornerVerts[0].push(vert);\n\n          vertexPool.push(vert);\n\n          //sphere already normalized, just clone\n\n          var norm = vertex.clone().normalize();\n          cornerNormals[0].push(norm);\n          normalPool.push(norm);\n        }\n      }\n\n      //distribute corner verts ===========================\n\n      for (var i = 1; i < 8; i++) {\n        for (var j = 0; j < cornerVerts[0].length; j++) {\n          var vert = cornerVerts[0][j].clone().multiply(cornerLayout[i]);\n\n          cornerVerts[i].push(vert);\n\n          vertexPool.push(vert);\n\n          var norm = cornerNormals[0][j].clone().multiply(cornerLayout[i]);\n\n          cornerNormals[i].push(norm);\n\n          normalPool.push(norm);\n        }\n      }\n    }\n\n    // weave corners ====================================\n\n    function doCorners() {\n      var indexInd = 0;\n\n      var flips = [true, false, true, false, false, true, false, true];\n\n      var lastRowOffset = rs1 * (radiusSegments - 1);\n\n      for (var i = 0; i < 8; i++) {\n        var cornerOffset = cornerVertNumber * i;\n\n        for (var v = 0; v < radiusSegments - 1; v++) {\n          var r1 = v * rs1; //row offset\n          var r2 = (v + 1) * rs1; //next row\n\n          for (var u = 0; u < radiusSegments; u++) {\n            var u1 = u + 1;\n            var a = cornerOffset + r1 + u;\n            var b = cornerOffset + r1 + u1;\n            var c = cornerOffset + r2 + u;\n            var d = cornerOffset + r2 + u1;\n\n            if (!flips[i]) {\n              indices.push(a);\n              indices.push(b);\n              indices.push(c);\n\n              indices.push(b);\n              indices.push(d);\n              indices.push(c);\n            } else {\n              indices.push(a);\n              indices.push(c);\n              indices.push(b);\n\n              indices.push(b);\n              indices.push(c);\n              indices.push(d);\n            }\n          }\n        }\n\n        for (var u = 0; u < radiusSegments; u++) {\n          var a = cornerOffset + lastRowOffset + u;\n          var b = cornerOffset + lastRowOffset + u + 1;\n          var c = cornerOffset + lastVertex;\n\n          if (!flips[i]) {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n          } else {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n          }\n        }\n      }\n    }\n\n    //plates ============================================\n    //fix this loop matrices find pattern something\n\n    function doFaces() {\n      //top\n      var a = lastVertex; // + cornerVertNumber * 0;\n      var b = lastVertex + cornerVertNumber; // * 1;\n      var c = lastVertex + cornerVertNumber * 2;\n      var d = lastVertex + cornerVertNumber * 3;\n\n      indices.push(a);\n      indices.push(b);\n      indices.push(c);\n      indices.push(a);\n      indices.push(c);\n      indices.push(d);\n\n      //bottom\n      a = lastVertex + cornerVertNumber * 4; // + cornerVertNumber * 0;\n      b = lastVertex + cornerVertNumber * 5; // * 1;\n      c = lastVertex + cornerVertNumber * 6;\n      d = lastVertex + cornerVertNumber * 7;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(a);\n      indices.push(d);\n      indices.push(c);\n\n      //left\n      a = 0;\n      b = cornerVertNumber;\n      c = cornerVertNumber * 4;\n      d = cornerVertNumber * 5;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(b);\n      indices.push(c);\n      indices.push(d);\n\n      //right\n      a = cornerVertNumber * 2;\n      b = cornerVertNumber * 3;\n      c = cornerVertNumber * 6;\n      d = cornerVertNumber * 7;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(b);\n      indices.push(c);\n      indices.push(d);\n\n      //front\n      a = radiusSegments;\n      b = radiusSegments + cornerVertNumber * 3;\n      c = radiusSegments + cornerVertNumber * 4;\n      d = radiusSegments + cornerVertNumber * 7;\n\n      indices.push(a);\n      indices.push(b);\n      indices.push(c);\n      indices.push(b);\n      indices.push(d);\n      indices.push(c);\n\n      //back\n      a = radiusSegments + cornerVertNumber;\n      b = radiusSegments + cornerVertNumber * 2;\n      c = radiusSegments + cornerVertNumber * 5;\n      d = radiusSegments + cornerVertNumber * 6;\n\n      indices.push(a);\n      indices.push(c);\n      indices.push(b);\n      indices.push(b);\n      indices.push(c);\n      indices.push(d);\n    }\n\n    // weave edges ======================================\n\n    function doHeightEdges() {\n      for (var i = 0; i < 4; i++) {\n        var cOffset = i * cornerVertNumber;\n        var cRowOffset = 4 * cornerVertNumber + cOffset;\n        var needsFlip = i & (1 === 1);\n        for (var u = 0; u < radiusSegments; u++) {\n          var u1 = u + 1;\n          var a = cOffset + u;\n          var b = cOffset + u1;\n          var c = cRowOffset + u;\n          var d = cRowOffset + u1;\n\n          if (!needsFlip) {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n            indices.push(b);\n            indices.push(d);\n            indices.push(c);\n          } else {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n            indices.push(b);\n            indices.push(c);\n            indices.push(d);\n          }\n        }\n      }\n    }\n\n    function doDepthEdges() {\n      var cStarts = [0, 2, 4, 6];\n      var cEnds = [1, 3, 5, 7];\n\n      for (var i = 0; i < 4; i++) {\n        var cStart = cornerVertNumber * cStarts[i];\n        var cEnd = cornerVertNumber * cEnds[i];\n\n        var needsFlip = 1 >= i;\n\n        for (var u = 0; u < radiusSegments; u++) {\n          var urs1 = u * rs1;\n          var u1rs1 = (u + 1) * rs1;\n\n          var a = cStart + urs1;\n          var b = cStart + u1rs1;\n          var c = cEnd + urs1;\n          var d = cEnd + u1rs1;\n\n          if (needsFlip) {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n            indices.push(b);\n            indices.push(c);\n            indices.push(d);\n          } else {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n            indices.push(b);\n            indices.push(d);\n            indices.push(c);\n          }\n        }\n      }\n    }\n\n    function doWidthEdges() {\n      var end = radiusSegments - 1;\n\n      var cStarts = [0, 1, 4, 5];\n      var cEnds = [3, 2, 7, 6];\n      var needsFlip = [0, 1, 1, 0];\n\n      for (var i = 0; i < 4; i++) {\n        var cStart = cStarts[i] * cornerVertNumber;\n        var cEnd = cEnds[i] * cornerVertNumber;\n\n        for (var u = 0; u <= end; u++) {\n          // var dInd = u != end ? radiusSegments + u * rs1 : cornerVertNumber - 1;\n\n          var a = cStart + radiusSegments + u * rs1;\n          var b =\n            cStart +\n            (u != end ? radiusSegments + (u + 1) * rs1 : cornerVertNumber - 1);\n\n          var c = cEnd + radiusSegments + u * rs1;\n          var d =\n            cEnd +\n            (u != end ? radiusSegments + (u + 1) * rs1 : cornerVertNumber - 1);\n\n          if (!needsFlip[i]) {\n            indices.push(a);\n            indices.push(b);\n            indices.push(c);\n            indices.push(b);\n            indices.push(d);\n            indices.push(c);\n          } else {\n            indices.push(a);\n            indices.push(c);\n            indices.push(b);\n            indices.push(b);\n            indices.push(c);\n            indices.push(d);\n          }\n        }\n      }\n    }\n\n    //fill buffers ======================================\n\n    var index = 0;\n\n    for (var i = 0; i < vertexPool.length; i++) {\n      positions.setXYZ(\n        index,\n        vertexPool[i].x,\n        vertexPool[i].y,\n        vertexPool[i].z\n      );\n\n      normals.setXYZ(index, normalPool[i].x, normalPool[i].y, normalPool[i].z);\n\n      index++;\n    }\n\n    this.setIndex(new THREE.BufferAttribute(new Uint16Array(indices), 1));\n\n    this.addAttribute(\"position\", positions);\n\n    this.addAttribute(\"normal\", normals);\n  };\n\n  RoundedBoxGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\n  RoundedBoxGeometry.constructor = RoundedBoxGeometry;\n\n  return RoundedBoxGeometry;\n};\n","import { immerable } from \"immer\";\nimport { DeepPartial } from \"ts-essentials\";\n\nexport interface Point {\n  x: number;\n  y: number;\n  [immerable]: boolean;\n}\n\nexport enum BeadTypes {\n  BasicRectangle = \"BasicRectangle\",\n  BasicEllipse = \"BasicEllipse\"\n}\n\nexport interface Bead {\n  id: string;\n  position: Point;\n  [immerable]: boolean;\n  width: number;\n  height: number;\n  type: BeadTypes;\n  color: string;\n  rotate: number;\n  lineRotate: number;\n  keepAspectRatio: boolean;\n}\n\nexport interface Line {\n  id: string;\n  start: Point;\n  end: Point;\n  beadIds: string[];\n  [immerable]: boolean;\n  settings: {\n    beadsCount: number;\n    beadsAutoCount: boolean;\n    beadsSpacing: number;\n    beadsAutoSpacing: boolean;\n    defaultBead: Partial<Bead>;\n  };\n}\n\nexport interface AppData {\n  beads: { [s: string]: Bead };\n  lines: { [s: string]: Line };\n}\n\nexport enum EditorMode {\n  Idle = \"Idle\",\n  EditLines = \"EditLines\",\n  AddLine = \"AddLine\",\n  EditBeads = \"EditBeads\",\n  AddBeads = \"AddBeads\",\n  DeleteBeads = \"DeleteBeads\",\n  PaintBeads = \"ColorPaint\"\n}\nexport enum EditorMenuMain {\n  None = \"None\",\n  File = \"File\",\n  Grid = \"Grid\",\n  Background = \"Background\"\n}\nexport enum EditorGridType {\n  Hex = \"Hex\",\n  Box = \"Box\"\n}\nexport enum BrushType {\n  Color = \"Color\"\n}\nexport interface ThreeLightConfig {\n  type: \"THREE.DirectionalLight\" | \"THREE.AmbientLight\";\n  name: string;\n  color?: string | number | THREE.Color | undefined, \n  intensity?: number | undefined\n  position?: {\n    x: number;\n    y: number;\n    z: number;\n  }\n}\n\nexport interface EditorUi {\n  lights: ThreeLightConfig[];\n  lineSettings: DeepPartial<Line>;\n  saveInfo: {\n    saved: boolean;\n    haveUnsavedChanges: boolean;\n  };\n  selectedLinesIds: { [s: string]: boolean };\n  selectedLinesIdsCount: number;\n  selectedBeadsIds: { [s: string]: boolean };\n  selectedBeadsIdsCount: number;\n  mouseSelection: {\n    start: Point;\n    end: Point;\n    isDragStarted: boolean;\n    isDragged: boolean;\n  };\n  currentMenuMainOpen: EditorMenuMain;\n  grid: {\n    type: EditorGridType;\n    hexSize: number;\n    snapEnabled: boolean;\n    isVisible: boolean;\n    width: number;\n    height: number;\n  };\n  currentBeadChain: {\n    isDragEnabled: boolean;\n    beadIds: string[];\n  };\n  beadsTemplate: {\n    width: number;\n    height: number;\n    type: BeadTypes;\n    color: string;\n    rotate: number;\n    keepAspectRatio: boolean;\n  };\n  brush: {\n    type: BrushType;\n    size: number;\n    color: string;\n  };\n  background: {\n    image: {\n      url: string;\n      scale: number;\n      position: Point;\n      opacity: number;\n    };\n  };\n  sceneWrapperWidth: number;\n  sceneWrapperHeight: number;\n  sceneWrapperPosition: {\n    x: number;\n    y: number;\n    angle: number;\n    scale: number;\n    top: number;\n    left: number;\n  };\n}\n\nexport interface Editor {\n  appData: AppData;\n  ui: EditorUi;\n  mode: EditorMode;\n}\n","export type EventCallback = (data: any, state: any) => void;\nexport interface Events {\n  [key: string]: EventCallback[];\n}\nexport class EventEmitter {\n  _events: Events;\n  constructor() {\n    this._events = {};\n  }\n\n  on(name: string, listener: EventCallback) {\n    if (!this._events[name]) {\n      this._events[name] = [];\n    }\n\n    this._events[name].push(listener);\n  }\n\n  removeListener(name: string, listenerToRemove: EventCallback) {\n    if (!this._events[name]) {\n      throw new Error(\n        `Can't remove a listener. Event \"${name}\" doesn't exits.`\n      );\n    }\n\n    const filterListeners = (listener) => listener !== listenerToRemove;\n\n    this._events[name] = this._events[name].filter(filterListeners);\n  }\n\n  emit(name: string, data: any, state: any) {\n    console.log(\"EventEmitter:emit:\", name, data);\n\n    if (!this._events[name]) {\n      console.warn(`Can't emit an event. Event \"${name}\" doesn't exits.`);\n      return;\n    }\n\n    const fireCallbacks = (callback: EventCallback) => {\n      callback(data, state);\n    };\n\n    this._events[name].forEach(fireCallbacks);\n  }\n}\n\nlet internalEventEmiter: EventEmitter | undefined;\n\nexport const getEventEmitter = () => {\n  if (internalEventEmiter === undefined) {\n    internalEventEmiter = new EventEmitter();\n  }\n  return internalEventEmiter;\n};\n","import { Point } from \"./Editor\";\nimport { immerable } from \"immer\";\n\nexport const buildPoint = (x: number = 0, y: number = 0): Point => {\n  return {\n    x,\n    y,\n    [immerable]: true,\n  } as Point;\n};\n\nexport const getLength = (point: Point) => {\n  return Math.sqrt(point.x * point.x + point.y * point.y);\n};\n\nexport const normalize = (point: Point) => {\n  const length = getLength(point);\n  const useLen = length === 0;\n  const x = useLen ? 0 : point.x / length;\n  const y = useLen ? 0 : point.y / length;\n  return buildPoint(x, y);\n};\n\nexport const scale = (point: Point, scalar: number) => {\n  return buildPoint(point.x * scalar, point.y * scalar);\n};\n\nexport const add = (point: Point, x: number, y: number) => {\n  return buildPoint(point.x + x, point.y + y);\n};\n\nexport const sub = (point: Point, x: number, y: number) => {\n  return buildPoint(point.x - x, point.y - y);\n};\n\nexport const getDistance = (x1, y1, x2, y2): number => {\n  return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n};\n\nexport const getDistanceBetweenPoints = (start: Point, end: Point): number => {\n  return Math.sqrt(\n    (end.x - start.x) * (end.x - start.x) +\n      (end.y - start.y) * (end.y - start.y)\n  );\n};\n\nexport const getRotate = (y, x) => {\n  return Math.atan2(y, x);\n};\n\nexport const contain = (p1: Point, p2: Point, p: Point): boolean => {\n  return p.x > p1.x && p.x < p2.x && p.y > p1.y && p.y < p2.y;\n};\n\nexport const toRadian = (radians: number) => {\n  return (radians / 180) * Math.PI;\n};\n\nexport const toDeg = (radians: number) => {\n  return (radians * 180) / Math.PI;\n};\n","import { immerable } from \"immer\";\nimport { generate } from \"shortid\";\nimport { Bead, BeadTypes } from \"./Editor\";\nimport { DeepPartial } from \"ts-essentials\";\nimport { buildPoint } from \"./Point\";\nimport { merge } from \"lodash\";\nimport { defaulBeadColor } from \"../components/colors\";\n\nexport const buildBead = (props: DeepPartial<Bead>): Bead => {\n  const defaults: Bead = {\n    id: generate(),\n    position: buildPoint(0, 0),\n    type: BeadTypes.BasicEllipse,\n    rotate: 0,\n    lineRotate: 0,\n    color: defaulBeadColor,\n    height: 10,\n    width: 10,\n    keepAspectRatio: false,\n    [immerable]: true,\n  };\n  return merge(defaults, props);\n  // const id = generate();\n  // const beadType = type ? type : BeadTypes.BasicCircle;\n  // const common = {\n  //   id,\n  //   position,\n  //   [immerable]: true,\n  //   type: beadType,\n  // };\n\n  // if (beadType === BeadTypes.BasicCircle) {\n  //   return buildBead_BasicCircle(common);\n  // }\n\n  // if (beadType === BeadTypes.BasicRectangle) {\n  //   return buildBead_BasicRectangle(common);\n  // }\n\n  // return buildBead_BasicCircle(common);\n};\n\n// const buildBead_BasicCircle = common => {\n//   return {\n//     ...common,\n//     width: 20,\n//     height: 20,\n//     fill: `linear-gradient(\n//       to bottom,\n//       rgba(254, 204, 177, 1) 0%,\n//       rgba(241, 116, 50, 1) 50%,\n//       rgba(234, 85, 7, 1) 51%,\n//       rgba(251, 149, 94, 1) 100%\n//     )`,\n//     settings: {\n//       radius: 20,\n//     },\n//   } as Bead;\n// };\n\n// const buildBead_BasicRectangle = common => {\n//   return {\n//     ...common,\n//     width: 20,\n//     height: 40,\n//     fill: \"#b1b1b1\",\n//   } as Bead;\n// };\n","export const uiButton = \"#aeaeae\"\nexport const defaulBeadColor = \"#4fc3f7\";","import { immerable } from \"immer\";\nimport { Line, Point } from \"./Editor\";\nimport { generate } from \"shortid\";\nimport { normalize, scale, add, buildPoint } from \"./Point\";\nimport { merge } from \"lodash\";\nimport { DeepPartial } from \"ts-essentials\";\nimport { buildBead } from \"./Bead\";\n\nexport const buildLine = (props: DeepPartial<Line>): Line => {\n  const __defaults = {\n    id: generate(),\n    start: buildPoint(10, 10),\n    end: buildPoint(100, 100),\n    beadIds: [],\n    settings: {\n      beadsCount: 0,\n      beadsAutoCount: true,\n      beadsSpacing: 0,\n      beadsAutoSpacing: false,\n      defaultBead: buildBead({}),\n    },\n    [immerable]: true,\n  };\n\n  return merge(__defaults, props);\n};\n\nexport const getLength = (line: Line): number => {\n  return Math.sqrt(\n    (line.end.x - line.start.x) * (line.end.x - line.start.x) +\n      (line.end.y - line.start.y) * (line.end.y - line.start.y)\n  );\n};\n\nexport const getPointFromStart = (line: Line, distance: number): Point => {\n  const x = line.end.x - line.start.x;\n  const y = line.end.y - line.start.y;\n  let point = buildPoint(x, y);\n  point = normalize(point);\n  point = scale(point, distance);\n  point = add(point, line.start.x, line.start.y);\n  return point;\n};\n\nexport const getPointFromStartLine = (\n  startX: number,\n  startY: number,\n  endX: number,\n  endY: number,\n  distance: number\n): Point => {\n  const x = endX - startX;\n  const y = endY - startY;\n  let point = buildPoint(x, y);\n  point = normalize(point);\n  point = scale(point, distance);\n  point = add(point, startX, startY);\n  return point;\n};\n","import { ImmerReducer } from \"immer-reducer\";\nimport { Editor, \n  // EditorMode, Point \n} from \"../editorObjects/Editor\";\nimport {\n  // buildPoint,\n  getDistanceBetweenPoints,\n  getRotate,\n  toDeg,\n} from \"../editorObjects/Point\";\nimport { buildBead } from \"../editorObjects/Bead\";\n// import { buildLine } from \"../editorObjects/Line\";\nimport { getPointFromStartLine } from \"../editorObjects/Line\";\n// import { merge } from \"lodash\";\n\nexport class BeadSnapperImmerReducer extends ImmerReducer<Editor> {\n  \n  // useHexGrid(){\n  //   xPos = P.transform.position[0];\n  //   yPos = P.transform.position[1];\n\n  //   cSize = L.effect(\"Cell Size\")(\"Slider\");\n  //   xOffset = L.effect(\"X Offset\")(\"Slider\");\n  //   yOffset = L.effect(\"Y Offset\")(\"Slider\");\n\n  //   // Convert size value into distance values between cells\n  //   cWidth = cSize*.75;\n  //   cHeight = cSize*13/15;\n\n  //   // Find new X and Y positions\n  //   yNew = yPos - yPos % cHeight + cHeight/2;\n  //   xNew = xPos - (xPos % cWidth) + (((yNew - cHeight/2).toFixed(2)/cHeight).toFixed(2) % 1) * (cWidth/2);\n\n  //   // Check for even/odd column, adjust properly\n  //   if (!(xNew % (cWidth*2) == 0)) yNew += cHeight/2;\n\n  //   // Implement offset\n  //   [xNew + xOffset, yNew+yOffset]\n  // }\n\n  updateBeadsPositions(lineId: string) {\n    // console.log(\"updateBeadsPositions: ---------------------- start\");\n    const currentLine = this.draftState.appData.lines[lineId];\n    const count = this.getLineBeadsCount(lineId);\n    const currentCount = currentLine.beadIds.length;\n    // console.log(\n    //   \"updateBeadsPositions: currentCount: \",\n    //   currentCount,\n    //   \" count\",\n    //   count\n    // );\n    if (count > currentCount) {\n      const remaining = count - currentCount;\n      this.addRemainingBeads(lineId, remaining);\n    } else if (count < currentCount) {\n      const overflow = currentCount - count;\n      this.removeOverflowBeads(lineId, overflow);\n    }\n    this.draftState.appData.lines[lineId].settings.beadsCount = count;\n    this.modifyBeadsPosition(lineId);\n    this.modifyBeadsRotate(lineId);\n    // console.log(\"updateBeadsPositions: ----------------------  end\");\n  }\n\n  getLineBeadsCount(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const {\n      beadsAutoCount,\n      beadsAutoSpacing,\n      beadsCount,\n      beadsSpacing,\n      defaultBead,\n    } = currentLine.settings;\n    const { start, end, beadIds } = currentLine;\n    const lineLen = getDistanceBetweenPoints(start, end);\n\n    // console.log(\n    //   \"getLineBeadsCount \",\n    //   lineLen,\n    //   beadsAutoCount === true,\n    //   beadsAutoSpacing === true\n    // );\n    if (beadsAutoCount === true && beadsAutoSpacing === true) {\n      // beadsy sa przyklejone do siebie. COunt powinien byc tyle ile sie zmiesci na lini\n      let beadsWidths: number[] = [];\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width = this.draftState.appData.beads[beadId].width;\n        beadsWidth = beadsWidth + width;\n        beadsWidths.push(width);\n      });\n      if (lineLen >= beadsWidth) {\n        // ile defaultsow trzeba dodac aby linia byla wypelniona?\n        const defaultBeadWidth = defaultBead.width ? defaultBead.width : 10;\n        const remainingSpace = lineLen - beadsWidth;\n        const count =\n          Math.floor(remainingSpace / defaultBeadWidth) + beadsWidths.length;\n\n        return count;\n      } else {\n        // trzeba odejmowac elementy z lini do momentu az wszystkie sie zmnieszcza\n        for (let i = beadsWidths.length - 1; i >= 0; i--) {\n          beadsWidth = beadsWidth - beadsWidths[i];\n          if (lineLen > beadsWidth) {\n            const count = i;\n            return count;\n          }\n        }\n        // nie powinno byc elementow na linie, bo nie ma miejsca z lineLen\n        return 0;\n      }\n    } else if (beadsAutoCount === false && beadsAutoSpacing === false) {\n      return beadsCount;\n    } else if (beadsAutoCount === true && beadsAutoSpacing === false) {\n      let beadsWidths: number[] = [];\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width =\n          this.draftState.appData.beads[beadId].width + beadsSpacing;\n        beadsWidth = beadsWidth + width;\n        beadsWidths.push(width);\n      });\n      if (lineLen >= beadsWidth - beadsSpacing) {\n        const defaultBeadWidth = defaultBead.width ? defaultBead.width : 10;\n        const remainingSpace = lineLen - (beadsWidth - beadsSpacing);\n        const count =\n          Math.floor(remainingSpace / (defaultBeadWidth + beadsSpacing)) +\n          beadsWidths.length;\n        return count;\n      } else {\n        for (let i = beadsWidths.length - 1; i >= 0; i--) {\n          beadsWidth = beadsWidth - beadsWidths[i];\n          if (lineLen > beadsWidth - beadsSpacing) {\n            const count = i;\n            return count;\n          }\n        }\n        return 0;\n      }\n    } else if (beadsAutoCount === false && beadsAutoSpacing === true) {\n      return beadsCount;\n    }\n    return 0;\n  }\n\n  addRemainingBeads(lineId, remainingCount) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    for (let i = 0; i < remainingCount; i++) {\n      let defaultBead: any = {};\n      if (currentLine.settings.defaultBead) {\n        defaultBead = { ...currentLine.settings.defaultBead };\n      } else if (\n        this.draftState.ui.lineSettings.settings &&\n        this.draftState.ui.lineSettings.settings.defaultBead\n      ) {\n        defaultBead = {\n          ...this.draftState.ui.lineSettings.settings.defaultBead,\n        };\n      }\n      defaultBead.id = undefined;\n      defaultBead.position = undefined;\n      const bead = buildBead(defaultBead);\n      this.draftState.appData.beads[bead.id] = bead;\n      this.draftState.appData.lines[lineId].beadIds.push(bead.id);\n    }\n  }\n\n  removeOverflowBeads(lineId, overflowCount) {\n    for (let i = 0; i < overflowCount; i++) {\n      const arrLen = this.draftState.appData.lines[lineId].beadIds.length;\n      const lastItemBeadId = this.draftState.appData.lines[\n        lineId\n      ].beadIds.splice(arrLen - 1, 1);\n      delete this.draftState.appData.beads[lastItemBeadId[0]];\n    }\n  }\n\n  modifyBeadsPosition(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const { start, end, beadIds } = currentLine;\n    const {\n      beadsAutoCount,\n      beadsAutoSpacing,\n      // beadsCount,\n      beadsSpacing,\n      // defaultBead,\n    } = currentLine.settings;\n\n    const standardLineHeight = 10;\n\n    if (beadsAutoCount === true && beadsAutoSpacing === true) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2;\n      });\n    } else if (beadsAutoCount === false && beadsAutoSpacing === false) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + beadsSpacing;\n      });\n    } else if (beadsAutoCount === true && beadsAutoSpacing === false) {\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + beadsSpacing;\n      });\n    } else if (beadsAutoCount === false && beadsAutoSpacing === true) {\n      let beadsWidth = 0;\n      beadIds.forEach(beadId => {\n        const width = this.draftState.appData.beads[beadId].width;\n        beadsWidth = beadsWidth + width;\n      });\n      const lineLen = getDistanceBetweenPoints(start, end);\n      const avaiableSpace = lineLen - beadsWidth;\n      let dynamicBeadsSpacing = 0;\n      if (beadIds.length > 1) {\n        dynamicBeadsSpacing = avaiableSpace / (beadIds.length - 1);\n      }\n      let currentDistance = 0;\n      this.draftState.appData.lines[lineId].beadIds.forEach(beadId => {\n        const { width, height } = this.draftState.appData.beads[beadId];\n        currentDistance = currentDistance + width / 2;\n        const newPosition = getPointFromStartLine(\n          start.x,\n          start.y,\n          end.x,\n          end.y,\n          currentDistance\n        );\n        const x = newPosition.x - width / 2;\n        const y = newPosition.y - height / 2 + standardLineHeight / 2;\n        this.draftState.appData.beads[beadId].position.x = x;\n        this.draftState.appData.beads[beadId].position.y = y;\n        currentDistance = currentDistance + width / 2 + dynamicBeadsSpacing;\n      });\n    }\n  }\n\n  modifyBeadsRotate(lineId) {\n    const currentLine = this.draftState.appData.lines[lineId];\n    const { start, end, beadIds } = currentLine;\n    const lineRotateRadian = getRotate(start.x - end.x, start.y - end.y);\n    beadIds.forEach(beadId => {\n      this.draftState.appData.beads[beadId].lineRotate =\n        toDeg(lineRotateRadian) * -1;\n    });\n  }\n}\n","import {\n  // Editor,\n  EditorMode,\n  Point,\n  EditorGridType,\n  Bead,\n} from \"../editorObjects/Editor\";\n// import { buildPoint, getDistanceBetweenPoints } from \"../editorObjects/Point\";\n// import { ImmerReducer } from \"immer-reducer\";\n// import { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\n// import { getPointFromStartLine } from \"../editorObjects/Line\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport {\n  buildPoint,\n  getDistanceBetweenPoints,\n  sub,\n  normalize,\n  scale,\n} from \"../editorObjects/Point\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nconst lineBoxOffset = 5;\n\nexport class DraggableOperationsImmerReducer extends BeadSnapperImmerReducer {\n  action_updateSceneZoom(event: any) {\n    this.draftState.ui.sceneWrapperPosition = event;\n  }\n  action_updateSceneWrapperSize({ width, height }) {\n    this.draftState.ui.sceneWrapperWidth = width;\n    this.draftState.ui.sceneWrapperHeight = height;\n  }\n\n  editorAppDataHasChanged() {\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = true;\n  }\n\n  action_onAddLine(start: Point, end: Point) {\n    const line = buildLine({ ...this.draftState.ui.lineSettings, start, end });\n    this.draftState.appData.lines[line.id] = line;\n    this.draftState.mode = EditorMode.EditLines;\n    this.updateBeadsPositions(line.id);\n    this.editorAppDataHasChanged();\n  }\n\n  action_onStartPointDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n    }\n  ) {\n    // console.log(\"action_onStartPointDrag\");\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        type,\n        hexSize,\n      } = this.draftState.ui.grid;\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.start.x = Math.round(data.x / width) * width - lineBoxOffset;\n          line.start.y = Math.round(data.y / height) * height - lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n          const changeX = Math.round(data.x / hSpace) * hSpace - lineBoxOffset;\n          const vLine = Math.round(data.y / vSpace);\n          const changeY = vLine * vSpace - lineBoxOffset - hexHeight / 4;\n          line.start.y = changeY;\n          if (vLine % 2 === 0) {\n            line.start.x = hSpace / 2 + changeX;\n          } else {\n            line.start.x = changeX;\n          }\n        }\n      } else {\n        line.start.x = data.x - lineBoxOffset;\n        line.start.y = data.y - lineBoxOffset;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onEndPointDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n    }\n  ) {\n    // console.log(\"action_onEndPointDrag\");\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        hexSize,\n        type,\n      } = this.draftState.ui.grid;\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.end.x = Math.round(data.x / width) * width - lineBoxOffset;\n          line.end.y = Math.round(data.y / height) * height - lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n          const changeX = Math.round(data.x / hSpace) * hSpace - lineBoxOffset;\n          const vLine = Math.round(data.y / vSpace);\n          const changeY = vLine * vSpace - lineBoxOffset - hexHeight / 4;\n          line.end.y = changeY;\n          if (vLine % 2 === 0) {\n            line.end.x = hSpace / 2 + changeX;\n          } else {\n            line.end.x = changeX;\n          }\n        }\n      } else {\n        line.end.x = data.x - lineBoxOffset;\n        line.end.y = data.y - lineBoxOffset;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onLineDrag(\n    key: string,\n    data: {\n      x: number;\n      y: number;\n      deltaX: number;\n      deltaY: number;\n      startX: number;\n      startY: number;\n      lineStart: Point | null;\n      lineEnd: Point | null;\n    }\n  ) {\n    const { startX, startY, lineStart, lineEnd, x, y } = data;\n    if (this.draftState.appData.lines[key]) {\n      const line = this.draftState.appData.lines[key];\n      const {\n        width,\n        height,\n        snapEnabled,\n        type,\n        hexSize,\n      } = this.draftState.ui.grid;\n\n      if (snapEnabled === true) {\n        if (type === EditorGridType.Box) {\n          line.start.x =\n            Math.round((line.start.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.start.y =\n            Math.round((line.start.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n\n          line.end.x =\n            Math.round((line.end.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.end.y =\n            Math.round((line.end.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n        } else if (type === EditorGridType.Hex) {\n          const hexWidth = Math.sqrt(3) * hexSize;\n          const hSpace = hexWidth;\n          const hexHeight = 2 * hexSize;\n          const vSpace = hexHeight * (3 / 4);\n\n          if (lineStart !== null) {\n            const newX = lineStart.x + (x - startX);\n            const newY = lineStart.y + (y - startY);\n            const changeX = Math.round(newX / hSpace) * hSpace - lineBoxOffset;\n\n            const vLine = Math.round(newY / vSpace);\n            const newChangeY = vLine * vSpace;\n            const temp = hexHeight / 4;\n            let changeY = newChangeY - lineBoxOffset - temp;\n            line.start.y = changeY;\n            if (vLine % 2 === 0) {\n              line.start.x = hSpace / 2 + changeX;\n            } else {\n              line.start.x = changeX;\n            }\n          }\n\n          if (lineEnd !== null) {\n            const newX = lineEnd.x + (x - startX);\n            const newY = lineEnd.y + (y - startY);\n            const changeX = Math.round(newX / hSpace) * hSpace - lineBoxOffset;\n\n            const vLine = Math.round(newY / vSpace);\n            const newChangeY = vLine * vSpace;\n            const temp = hexHeight / 4;\n            let changeY = newChangeY - lineBoxOffset - temp;\n            line.end.y = changeY;\n            if (vLine % 2 === 0) {\n              line.end.x = hSpace / 2 + changeX;\n            } else {\n              line.end.x = changeX;\n            }\n          }\n        }\n      } else {\n        line.start.x = line.start.x + data.deltaX;\n        line.start.y = line.start.y + data.deltaY;\n        line.end.x = line.end.x + data.deltaX;\n        line.end.y = line.end.y + data.deltaY;\n      }\n      this.updateBeadsPositions(line.id);\n      this.editorAppDataHasChanged();\n    }\n  }\n\n  action_onGroupLineDrag(data: { deltaX: number; deltaY: number }) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      if (this.draftState.appData.lines[lineId]) {\n        const line = this.draftState.appData.lines[lineId];\n        const { width, height, snapEnabled } = this.draftState.ui.grid;\n        if (snapEnabled === true) {\n          line.start.x =\n            Math.round((line.start.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.start.y =\n            Math.round((line.start.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n\n          line.end.x =\n            Math.round((line.end.x + data.deltaX) / width) * width -\n            lineBoxOffset;\n\n          line.end.y =\n            Math.round((line.end.y + data.deltaY) / height) * height -\n            lineBoxOffset;\n        } else {\n          line.start.x = line.start.x + data.deltaX;\n          line.start.y = line.start.y + data.deltaY;\n          line.end.x = line.end.x + data.deltaX;\n          line.end.y = line.end.y + data.deltaY;\n        }\n        this.updateBeadsPositions(line.id);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_onGroupBeadsDrag(data: { deltaX: number; deltaY: number }) {}\n\n  action_onClickLine(lineId: string) {\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIds[lineId] = true;\n    this.draftState.ui.selectedLinesIdsCount = 1;\n  }\n\n  action_onClickLastestLine() {\n    const keys = Object.keys(this.draftState.appData.lines);\n    if (keys.length > 0) {\n      const lineId = keys[keys.length - 1];\n      this.action_onClickLine(lineId);\n    }\n  }\n\n  action_onClickBead(beadId: string) {\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIds[beadId] = true;\n    this.draftState.ui.selectedBeadsIdsCount = 1;\n  }\n\n  action_addBeads_onMouseDown({ x, y }) {\n    this.draftState.ui.currentBeadChain.isDragEnabled = true;\n\n    let defaultBead: Partial<Bead> = { ...this.draftState.ui.beadsTemplate };\n    defaultBead.id = undefined;\n    defaultBead.position = buildPoint(x, y);\n\n    const bead = buildBead(defaultBead);\n    bead.position.x = bead.position.x - bead.width / 2;\n    bead.position.y = bead.position.y - bead.height / 2;\n\n    this.draftState.appData.beads[bead.id] = bead;\n    this.draftState.ui.currentBeadChain.beadIds.push(bead.id);\n  }\n\n  action_addBeads_onMouseMove({ x, y }) {\n    if (this.draftState.ui.currentBeadChain.isDragEnabled) {\n      const len = this.draftState.ui.currentBeadChain.beadIds.length;\n      const lastBeadId = this.draftState.ui.currentBeadChain.beadIds[len - 1];\n      const lastBead = this.draftState.appData.beads[lastBeadId];\n      const position = buildPoint(x, y);\n\n      const lastPosition = buildPoint(\n        lastBead.position.x + lastBead.width / 2,\n        lastBead.position.y + lastBead.height / 2\n      );\n      const distance = getDistanceBetweenPoints(lastPosition, position);\n\n      if (distance > lastBead.width) {\n        const vec = sub(position, lastPosition.x, lastPosition.y);\n        const norm = normalize(vec);\n        const scaled = scale(norm, lastBead.width);\n\n        let defaultBead: Partial<Bead> = {\n          ...this.draftState.ui.beadsTemplate,\n        };\n        defaultBead.id = undefined;\n        const _x = lastPosition.x + scaled.x;\n        const _y = lastPosition.y + scaled.y;\n        defaultBead.position = buildPoint(_x, _y);\n\n        const bead = buildBead(defaultBead);\n        bead.position.x = bead.position.x - bead.width / 2;\n        bead.position.y = bead.position.y - bead.height / 2;\n\n        this.draftState.appData.beads[bead.id] = bead;\n        this.draftState.ui.currentBeadChain.beadIds.push(bead.id);\n      }\n    }\n  }\n\n  action_addBeadOnClick({ x, y }) {\n    // console.log(\"action_addBeadOnClick triggered\");\n    let defaultBead: Partial<Bead> = {\n      ...this.draftState.ui.beadsTemplate,\n    };\n    defaultBead.id = undefined;\n    defaultBead.position = buildPoint(x, y);\n    const bead = buildBead(defaultBead);\n    // console.log(\"??\", bead.width, bead.height);\n    bead.position.x = bead.position.x - bead.width / 2;\n    bead.position.y = bead.position.y - bead.height / 2;\n    this.draftState.appData.beads[bead.id] = bead;\n    // console.log(\"ile jest?\", Object.keys(this.draftState.appData.beads).length);\n    getEventEmitter().emit(\"action_addBeadOnClick\", { bead }, this.state);\n  }\n\n  action_addBeads_onMouseUp({ x, y }) {\n    this.draftState.ui.currentBeadChain.isDragEnabled = false;\n    this.draftState.ui.currentBeadChain.beadIds = [];\n  }\n}\n","import { Editor } from \"../editorObjects/Editor\";\n// import { ImmerReducer } from \"immer-reducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nexport class PersistImmerReducer extends BeadSnapperImmerReducer {\n  action_onClearCanvas() {\n    this.draftState.appData.beads = {};\n    this.draftState.appData.lines = {};\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIdsCount = 0;\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n  }\n\n  action_readSavedCanvas() {\n    console.log(\"action_readSavedCanvas\");\n    // const startBeads = {};\n    for (let i = 0; i < 10 * 10; i = i + 10) {\n      for (let j = 0; j < 10 * 50; j = j + 10) {\n        const b1 = buildBead({\n          width: 8,\n          height: 8,\n          position: {\n            x: i,\n            y: j,\n          },\n        });\n        this.draftState.appData.beads[b1.id] = b1;\n      }\n    }\n\n    getEventEmitter().emit(\n      \"action_readSavedCanvas\",\n      this.draftState.appData,\n      this.state\n    );\n\n    // if (\"localStorage\" in window) {\n    //   this.draftState.ui.saveInfo.saved = true;\n    //   this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n    //   const readedData = localStorage.getItem(\"appData\");\n    //   if (readedData !== null) {\n    //     try {\n    //       const cached = JSON.parse(readedData) as Editor[\"appData\"];\n    //       this.draftState.appData = {\n    //         beads: {},\n    //         lines: {},\n    //       };\n    //       Object.keys(cached.beads).forEach(beadId => {\n    //         const currBead = cached.beads[beadId];\n    //         const bead = buildBead(currBead);\n    //         this.draftState.appData.beads[beadId] = bead;\n    //       });\n    //       Object.keys(cached.lines).forEach(lineId => {\n    //         const currLine = cached.lines[lineId];\n    //         const line = buildLine(currLine);\n    //         this.draftState.appData.lines[lineId] = line;\n    //       });\n    //       Object.keys(this.draftState.appData.lines).forEach(lineId => {\n    //         this.updateBeadsPositions(lineId);\n    //       });\n    //       console.log(\"action_readSavedCanvas loaded\");\n    //     } catch (err) {\n    //       console.error(\"action_readSavedCanvas error: \", err);\n    //     }\n    //   } else {\n    //     console.info(\"No data in localstorage\");\n    //   }\n    // } else {\n    //   console.info(\"No localstorage available\");\n    // }\n  }\n\n  action_onSaveCanvas() {\n    if (\"localStorage\" in window) {\n      localStorage.setItem(\"appData\", JSON.stringify(this.draftState.appData));\n      this.draftState.ui.saveInfo.saved = true;\n      this.draftState.ui.saveInfo.haveUnsavedChanges = false;\n      console.log(\"action_onSaveCanvas saved\");\n    } else {\n      this.draftState.ui.saveInfo.saved = false;\n      console.info(\"No localstorage available\");\n    }\n  }\n}\n\n// const a = {\n//   beads: {\n//     \"a19AKjQX-\": {\n//       id: \"a19AKjQX-\",\n//       position: { x: 124.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"KYwow-3r-\": {\n//       id: \"KYwow-3r-\",\n//       position: { x: 176.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"8Zv9yoc3O\": {\n//       id: \"8Zv9yoc3O\",\n//       position: { x: 228.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     Csyy61dk7: {\n//       id: \"Csyy61dk7\",\n//       position: { x: 280.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"K9seOU-sZ\": {\n//       id: \"K9seOU-sZ\",\n//       position: { x: 332.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4OluG2val\": {\n//       id: \"4OluG2val\",\n//       position: { x: 384.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     WyVILEjgG: {\n//       id: \"WyVILEjgG\",\n//       position: { x: 436.9038105676658, y: 49 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     oQ14N6Po8: {\n//       id: \"oQ14N6Po8\",\n//       position: { x: 98.92304845413263, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     Av87g3peZ: {\n//       id: \"Av87g3peZ\",\n//       position: { x: 150.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     I2UB_GTly: {\n//       id: \"I2UB_GTly\",\n//       position: { x: 202.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     yGTQ4IT7l: {\n//       id: \"yGTQ4IT7l\",\n//       position: { x: 254.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     sAXQ7hsQP: {\n//       id: \"sAXQ7hsQP\",\n//       position: { x: 306.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     deV4qFK6b: {\n//       id: \"deV4qFK6b\",\n//       position: { x: 358.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     VKyNP8c6Q: {\n//       id: \"VKyNP8c6Q\",\n//       position: { x: 410.92304845413264, y: 94 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     uwSd7QcQe: {\n//       id: \"uwSd7QcQe\",\n//       position: { x: 124.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     fnAnxCx1i: {\n//       id: \"fnAnxCx1i\",\n//       position: { x: 176.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     gZX7etv17: {\n//       id: \"gZX7etv17\",\n//       position: { x: 228.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"0tH_CViDI\": {\n//       id: \"0tH_CViDI\",\n//       position: { x: 280.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"8R3hzq0Kk\": {\n//       id: \"8R3hzq0Kk\",\n//       position: { x: 332.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4vauo8kt4\": {\n//       id: \"4vauo8kt4\",\n//       position: { x: 384.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"ZqMNO9Q5-\": {\n//       id: \"ZqMNO9Q5-\",\n//       position: { x: 436.9038105676658, y: 139 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     wxjOD75mB: {\n//       id: \"wxjOD75mB\",\n//       position: { x: 98.92304845413263, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     EyabW_7SH: {\n//       id: \"EyabW_7SH\",\n//       position: { x: 150.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"QX-VSqWHJ\": {\n//       id: \"QX-VSqWHJ\",\n//       position: { x: 202.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     YRjrowdYg: {\n//       id: \"YRjrowdYg\",\n//       position: { x: 254.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     NwMuNbOKC: {\n//       id: \"NwMuNbOKC\",\n//       position: { x: 306.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     Nia0xNTig: {\n//       id: \"Nia0xNTig\",\n//       position: { x: 358.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4t8McpTRT\": {\n//       id: \"4t8McpTRT\",\n//       position: { x: 410.92304845413264, y: 184 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     QZM85vE4H: {\n//       id: \"QZM85vE4H\",\n//       position: { x: 124.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     m6NK9xpnJ: {\n//       id: \"m6NK9xpnJ\",\n//       position: { x: 176.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"4SXetBeWL\": {\n//       id: \"4SXetBeWL\",\n//       position: { x: 228.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     UhzJs0GPl: {\n//       id: \"UhzJs0GPl\",\n//       position: { x: 280.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     yeLLzgEY6: {\n//       id: \"yeLLzgEY6\",\n//       position: { x: 332.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     ZEU_ZVZik: {\n//       id: \"ZEU_ZVZik\",\n//       position: { x: 384.9038105676658, y: 229 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"5GbXtZC9B\": {\n//       id: \"5GbXtZC9B\",\n//       position: { x: 98.92304845413263, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     N8qDr6L3f: {\n//       id: \"N8qDr6L3f\",\n//       position: { x: 150.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"9IUytGuY1\": {\n//       id: \"9IUytGuY1\",\n//       position: { x: 202.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     WPv1QJeJa: {\n//       id: \"WPv1QJeJa\",\n//       position: { x: 254.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     dVhb5iUkr: {\n//       id: \"dVhb5iUkr\",\n//       position: { x: 306.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     LlVZEDtJ9: {\n//       id: \"LlVZEDtJ9\",\n//       position: { x: 358.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//     \"yQ-h8_tm0\": {\n//       id: \"yQ-h8_tm0\",\n//       position: { x: 410.92304845413264, y: 274 },\n//       type: \"BasicEllipse\",\n//       rotate: 0,\n//       lineRotate: 90,\n//       color: \"#4fc3f7\",\n//       height: 52,\n//       width: 52,\n//       keepAspectRatio: true,\n//     },\n//   },\n//   lines: {\n//     \"YaQ3-jOG\": {\n//       id: \"YaQ3-jOG\",\n//       start: { x: 124.90381056766579, y: 70 },\n//       end: { x: 540.5960043841962, y: 70 },\n//       beadIds: [\n//         \"a19AKjQX-\",\n//         \"KYwow-3r-\",\n//         \"8Zv9yoc3O\",\n//         \"Csyy61dk7\",\n//         \"K9seOU-sZ\",\n//         \"4OluG2val\",\n//         \"WyVILEjgG\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"dZjyRBQrH\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     CRcLEam9P: {\n//       id: \"CRcLEam9P\",\n//       start: { x: 98.92304845413263, y: 115 },\n//       end: { x: 514.6152422706631, y: 115 },\n//       beadIds: [\n//         \"oQ14N6Po8\",\n//         \"Av87g3peZ\",\n//         \"I2UB_GTly\",\n//         \"yGTQ4IT7l\",\n//         \"sAXQ7hsQP\",\n//         \"deV4qFK6b\",\n//         \"VKyNP8c6Q\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"ILgHjX7En\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     Tml7p6ZKI: {\n//       id: \"Tml7p6ZKI\",\n//       start: { x: 124.90381056766579, y: 160 },\n//       end: { x: 540.5960043841962, y: 160 },\n//       beadIds: [\n//         \"uwSd7QcQe\",\n//         \"fnAnxCx1i\",\n//         \"gZX7etv17\",\n//         \"0tH_CViDI\",\n//         \"8R3hzq0Kk\",\n//         \"4vauo8kt4\",\n//         \"ZqMNO9Q5-\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"ibloOzyTR\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     Bq4W3C3Ew: {\n//       id: \"Bq4W3C3Ew\",\n//       start: { x: 98.92304845413263, y: 205 },\n//       end: { x: 514.6152422706631, y: 205 },\n//       beadIds: [\n//         \"wxjOD75mB\",\n//         \"EyabW_7SH\",\n//         \"QX-VSqWHJ\",\n//         \"YRjrowdYg\",\n//         \"NwMuNbOKC\",\n//         \"Nia0xNTig\",\n//         \"4t8McpTRT\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"w648Um7U6\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     mJvdHpK60: {\n//       id: \"mJvdHpK60\",\n//       start: { x: 124.90381056766579, y: 250 },\n//       end: { x: 488.63448015713, y: 250 },\n//       beadIds: [\n//         \"QZM85vE4H\",\n//         \"m6NK9xpnJ\",\n//         \"4SXetBeWL\",\n//         \"UhzJs0GPl\",\n//         \"yeLLzgEY6\",\n//         \"ZEU_ZVZik\",\n//       ],\n//       settings: {\n//         beadsCount: 6,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"irTbjtCzJ\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//     pA1FF6_zm: {\n//       id: \"pA1FF6_zm\",\n//       start: { x: 98.92304845413263, y: 295 },\n//       end: { x: 514.6152422706631, y: 295 },\n//       beadIds: [\n//         \"5GbXtZC9B\",\n//         \"N8qDr6L3f\",\n//         \"9IUytGuY1\",\n//         \"WPv1QJeJa\",\n//         \"dVhb5iUkr\",\n//         \"LlVZEDtJ9\",\n//         \"yQ-h8_tm0\",\n//       ],\n//       settings: {\n//         beadsCount: 7,\n//         beadsAutoCount: true,\n//         beadsSpacing: 0,\n//         beadsAutoSpacing: true,\n//         defaultBead: {\n//           id: \"MtRiOzAsd\",\n//           position: { x: 0, y: 0 },\n//           type: \"BasicEllipse\",\n//           rotate: 0,\n//           lineRotate: 0,\n//           color: \"#4fc3f7\",\n//           height: 52,\n//           width: 52,\n//           keepAspectRatio: true,\n//         },\n//       },\n//     },\n//   },\n// };\n","import { Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\n\nexport class ChangeEditorModeImmerReducer extends ImmerReducer<Editor> {\n  action_onChangeEditorMode(newEditorMode: EditorMode) {\n    this.draftState.mode = newEditorMode;\n    this.clearSelectedBeads();\n    this.clearSelectedLines();\n  }\n  private clearSelectedBeads = () => {\n    if (this.draftState.ui.selectedBeadsIdsCount > 0) {\n      this.draftState.ui.selectedBeadsIds = {};\n      this.draftState.ui.selectedBeadsIdsCount = 0;\n    }\n  };\n  private clearSelectedLines = () => {\n    if (this.draftState.ui.selectedLinesIdsCount) {\n      this.draftState.ui.selectedLinesIds = {};\n      this.draftState.ui.selectedLinesIdsCount = 0;\n    }\n  };\n  action_setSaveInfo(newValue: boolean) {\n    this.draftState.ui.saveInfo.saved = newValue;\n  }\n}\n","import { Editor } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\n\nexport class MainImmerReducer extends ImmerReducer<Editor> {\n  action_test() {}\n  action_restoreState() {}\n}\n","import { Editor } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildPoint } from \"../editorObjects/Point\";\nimport { contain } from \"../editorObjects/Point\";\nimport { getEventEmitter } from \"../EventEmitter\";\nimport _ from \"lodash\";\n// import { difference } from \"lodash\";\n\nexport class MouseSelectionImmerReducer extends ImmerReducer<Editor> {\n  action_onEditBeadsMouseDown(x, y) {\n    console.log(\"action_onEditBeadsMouseDown??\");\n    this.draftState.ui.mouseSelection.isDragStarted = true;\n\n    this.draftState.ui.mouseSelection.start.x = x;\n    this.draftState.ui.mouseSelection.start.y = y;\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n  }\n\n  action_onEditBeadsMouseMove(x, y) {\n    console.log(\"action_onEditBeadsMouseMove??\");\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const deltaX = end.x - start.x;\n      const deltaY = end.y - start.y;\n\n      if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n        this.draftState.ui.mouseSelection.isDragged = true;\n      }\n    }\n\n    if (this.draftState.ui.mouseSelection.isDragged === true) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const p1 = buildPoint(Math.min(start.x, end.x), Math.min(start.y, end.y));\n      const p2 = buildPoint(Math.max(start.x, end.x), Math.max(start.y, end.y));\n\n      // const selectedIds = Object.keys(this.draftState.ui.selectedBeadsIds);\n      // const newIds: string[] = [];\n\n      // Object.keys(this.draftState.appData.beads).forEach(beadId => {\n      //   const bead = this.draftState.appData.beads[beadId];\n      //   const p3 = buildPoint(bead.position.x + 10, bead.position.y + 10);\n      //   if (contain(p1, p2, p3)) {\n      //     newIds.push(beadId);\n      //   }\n      // });\n\n      // const diff = difference(newIds, selectedIds);\n\n      // if (diff.length > 0) {\n      //   this.draftState.ui.selectedBeadsIds = {};\n      //   this.draftState.ui.selectedBeadsIdsCount = 0;\n      //   newIds.forEach(id => {\n      //     this.draftState.ui.selectedBeadsIds[id] = true;\n      //     this.draftState.ui.selectedBeadsIdsCount =\n      //       this.draftState.ui.selectedBeadsIdsCount + 1;\n      //   });\n      // }\n\n      this.draftState.ui.selectedBeadsIds = {};\n      this.draftState.ui.selectedBeadsIdsCount = 0;\n      Object.keys(this.draftState.appData.beads).forEach((beadId) => {\n        const bead = this.draftState.appData.beads[beadId];\n        const p3 = buildPoint(bead.position.x + 10, bead.position.y + 10);\n        if (contain(p1, p2, p3)) {\n          this.draftState.ui.selectedBeadsIds[beadId] = true;\n          this.draftState.ui.selectedBeadsIdsCount =\n            this.draftState.ui.selectedBeadsIdsCount + 1;\n        }\n      });\n    }\n  }\n\n  action_selectBeads(beadsIds: string[]) {\n    const prevSelectedIds = Object.keys(this.draftState.ui.selectedBeadsIds);\n\n    const diffIds = _.xor(prevSelectedIds, beadsIds);\n    const diffStates = diffIds.map((id) => {\n      if (prevSelectedIds.includes(id)) {\n        return { [id]: false };\n      } else {\n        return { [id]: true };\n      }\n    });\n\n    this.draftState.ui.selectedBeadsIds = {};\n    this.draftState.ui.selectedBeadsIdsCount = 0;\n    if (beadsIds.length > 0) {\n      Object.keys(this.draftState.appData.beads).forEach((beadId) => {\n        if (beadsIds.includes(beadId)) {\n          this.draftState.ui.selectedBeadsIds[beadId] = true;\n          this.draftState.ui.selectedBeadsIdsCount =\n            this.draftState.ui.selectedBeadsIdsCount + 1;\n        }\n      });\n    }\n\n    getEventEmitter().emit(\"action_selectBeads\", { diffStates }, this.state);\n  }\n\n  action_onEditBeadsMouseUp() {\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      if (this.draftState.ui.selectedBeadsIdsCount > 0) {\n        this.draftState.ui.selectedBeadsIds = {};\n        this.draftState.ui.selectedBeadsIdsCount = 0;\n      }\n    }\n\n    this.draftState.ui.mouseSelection.isDragStarted = false;\n    this.draftState.ui.mouseSelection.isDragged = false;\n    this.draftState.ui.mouseSelection.start.x = 0;\n    this.draftState.ui.mouseSelection.start.y = 0;\n    this.draftState.ui.mouseSelection.end.x = 0;\n    this.draftState.ui.mouseSelection.end.y = 0;\n  }\n\n  action_onEditLinesMouseDown(x: number, y: number) {\n    this.draftState.ui.mouseSelection.isDragStarted = true;\n    this.draftState.ui.mouseSelection.start.x = x;\n    this.draftState.ui.mouseSelection.start.y = y;\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n  }\n\n  action_onEditLinesMouseMove(x: number, y: number) {\n    this.draftState.ui.mouseSelection.end.x = x;\n    this.draftState.ui.mouseSelection.end.y = y;\n\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const deltaX = end.x - start.x;\n      const deltaY = end.y - start.y;\n      if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n        this.draftState.ui.mouseSelection.isDragged = true;\n      }\n    }\n\n    if (this.draftState.ui.mouseSelection.isDragged === true) {\n      const { start, end } = this.draftState.ui.mouseSelection;\n      const p1 = buildPoint(Math.min(start.x, end.x), Math.min(start.y, end.y));\n      const p2 = buildPoint(Math.max(start.x, end.x), Math.max(start.y, end.y));\n\n      // const selectedIds = Object.keys(this.draftState.ui.selectedLinesIds);\n      // const newIds: string[] = [];\n\n      // Object.keys(this.draftState.appData.lines).forEach(lineId => {\n      //   const line = this.draftState.appData.lines[lineId];\n      //   if (contain(p1, p2, line.start) || contain(p1, p2, line.end)) {\n      //     newIds.push(lineId);\n      //   }\n      // });\n\n      // const diff = difference(newIds, selectedIds);\n\n      // if (diff.length > 0) {\n      //   this.draftState.ui.selectedLinesIds = {};\n      //   this.draftState.ui.selectedLinesIdsCount = 0;\n      //   newIds.forEach(id => {\n      //     this.draftState.ui.selectedLinesIds[id] = true;\n      //     this.draftState.ui.selectedLinesIdsCount =\n      //       this.draftState.ui.selectedLinesIdsCount + 1;\n      //   });\n      // }\n      this.draftState.ui.selectedLinesIds = {};\n      this.draftState.ui.selectedLinesIdsCount = 0;\n      Object.keys(this.draftState.appData.lines).forEach((lineId) => {\n        const line = this.draftState.appData.lines[lineId];\n        if (contain(p1, p2, line.start) || contain(p1, p2, line.end)) {\n          this.draftState.ui.selectedLinesIds[lineId] = true;\n          this.draftState.ui.selectedLinesIdsCount =\n            this.draftState.ui.selectedLinesIdsCount + 1;\n        }\n      });\n    }\n  }\n\n  action_onEditLinesMouseUp() {\n    if (this.draftState.ui.mouseSelection.isDragged === false) {\n      if (this.draftState.ui.selectedLinesIdsCount > 0) {\n        this.draftState.ui.selectedLinesIds = {};\n        this.draftState.ui.selectedLinesIdsCount = 0;\n      }\n    }\n\n    this.draftState.ui.mouseSelection.isDragStarted = false;\n    this.draftState.ui.mouseSelection.isDragged = false;\n    this.draftState.ui.mouseSelection.start.x = 0;\n    this.draftState.ui.mouseSelection.start.y = 0;\n    this.draftState.ui.mouseSelection.end.x = 0;\n    this.draftState.ui.mouseSelection.end.y = 0;\n  }\n}\n","import { BeadTypes } from \"../editorObjects/Editor\";\nimport { BeadSnapperImmerReducer } from \"./BeadSnapperImmerReducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { buildLine } from \"../editorObjects/Line\";\nimport { merge } from \"lodash\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nexport class ToolbarImmerReducer extends BeadSnapperImmerReducer {\n  editorAppDataHasChanged() {\n    this.draftState.ui.saveInfo.saved = false;\n    this.draftState.ui.saveInfo.haveUnsavedChanges = true;\n  }\n  action_changeBeadFill(color: string) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].color = color;\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_updateLight(index: number, field: string, value: any) {\n    if (this.draftState.ui.lights[index][field]) {\n      const light = this.draftState.ui.lights[index];\n      light[field] = value;\n      const name = light.name;\n      this.editorAppDataHasChanged();\n      getEventEmitter().emit(\n        \"action_updateLight\",\n        { name, field, value },\n        this.state\n      );\n    }\n  }\n\n  action_changeBeadType(type: BeadTypes) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].type = type;\n    });\n    this.editorAppDataHasChanged();\n  }\n  action_onBeadRotate(beadId, { deg }) {}\n  action_onBeadsRotate({ deg }) {}\n\n  action_changeSelectedLinesBeadsSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsAutoSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLinesBeadsAutoCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_resetSelectedLines() {\n    const firstLineId = Object.keys(this.draftState.ui.selectedLinesIds)[0];\n    const firstLine = this.draftState.appData.lines[firstLineId];\n    const defaultBead = { ...firstLine.settings.defaultBead };\n\n    defaultBead.id = undefined;\n    defaultBead.position = undefined;\n\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].beadIds.forEach((beadId) => {\n        if (defaultBead) {\n          this.draftState.appData.beads[beadId] = merge(\n            this.draftState.appData.beads[beadId],\n            defaultBead\n          );\n        }\n      });\n      this.draftState.appData.lines[id].settings.defaultBead = merge(\n        this.draftState.appData.lines[id].settings.defaultBead,\n        defaultBead\n      );\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_deleteSelectedLines() {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].beadIds.forEach((beadId) => {\n        delete this.draftState.appData.beads[beadId];\n      });\n      delete this.draftState.appData.lines[id];\n    });\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n    this.editorAppDataHasChanged();\n  }\n\n  action_cloneSelectedLines() {\n    const moveX = 20;\n    const moveY = 20;\n    const newLinesIds: string[] = [];\n\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      const newLine = buildLine({\n        ...this.draftState.appData.lines[id],\n        id: undefined,\n        beadIds: [],\n      });\n      newLine.start.x = newLine.start.x + moveX;\n      newLine.start.y = newLine.start.y + moveY;\n      newLine.end.x = newLine.end.x + moveX;\n      newLine.end.y = newLine.end.y + moveY;\n\n      this.draftState.appData.lines[id].beadIds.forEach((beadId) => {\n        const newBead = buildBead({\n          ...this.draftState.appData.beads[beadId],\n          id: undefined,\n        });\n        newBead.position.x = newBead.position.x + moveX;\n        newBead.position.y = newBead.position.y + moveY;\n        this.draftState.appData.beads[newBead.id] = newBead;\n        newLine.beadIds.push(newBead.id);\n      });\n\n      newLinesIds.push(newLine.id);\n      this.draftState.appData.lines[newLine.id] = newLine;\n    });\n\n    newLinesIds.forEach((lineId) => {\n      this.updateBeadsPositions(lineId);\n    });\n\n    this.draftState.ui.selectedLinesIds = {};\n    this.draftState.ui.selectedLinesIdsCount = 0;\n\n    newLinesIds.forEach((lineId) => {\n      this.draftState.ui.selectedLinesIds[lineId] = true;\n      this.draftState.ui.selectedLinesIdsCount =\n        this.draftState.ui.selectedLinesIdsCount + 1;\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  /**\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeDefaultLineBeadsCount(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsCount = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsAutoCount(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsAutoCount = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsSpacing(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsSpacing = value;\n    }\n  }\n\n  action_changeDefaultLineBeadsAutoSpacing(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      this.draftState.ui.lineSettings.settings.beadsAutoSpacing = value;\n    }\n  }\n\n  action_changeDefaultLineBeadType(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      if (this.draftState.ui.lineSettings.settings.defaultBead) {\n        this.draftState.ui.lineSettings.settings.defaultBead.type = value;\n      }\n    }\n  }\n\n  action_changeDefaultLineColor(value) {\n    if (this.draftState.ui.lineSettings.settings) {\n      if (this.draftState.ui.lineSettings.settings.defaultBead) {\n        this.draftState.ui.lineSettings.settings.defaultBead.color = value;\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadHeight(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        const {\n          width,\n          height,\n          keepAspectRatio,\n        } = lineSettings.settings.defaultBead;\n        if (keepAspectRatio && width && height) {\n          if (height >= 1) {\n            const ratio = width / height;\n            lineSettings.settings.defaultBead.width = value * ratio;\n            lineSettings.settings.defaultBead.height = value;\n          } else {\n            lineSettings.settings.defaultBead.height = 1;\n          }\n        } else {\n          lineSettings.settings.defaultBead.height = value;\n        }\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadWidth(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        const {\n          width,\n          height,\n          keepAspectRatio,\n        } = lineSettings.settings.defaultBead;\n        if (keepAspectRatio && width && height) {\n          if (width >= 1) {\n            const ratio = height / width;\n            lineSettings.settings.defaultBead.width = value;\n            lineSettings.settings.defaultBead.height = value * ratio;\n          } else {\n            lineSettings.settings.defaultBead.width = 1;\n          }\n        } else {\n          lineSettings.settings.defaultBead.width = value;\n        }\n      }\n    }\n  }\n\n  action_changeDefaultLineBeadKeepAspectRatio(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        lineSettings.settings.defaultBead.keepAspectRatio = value;\n      }\n    }\n  }\n  action_changeDefaultLineBeadRotate(value) {\n    const { lineSettings } = this.draftState.ui;\n    if (lineSettings.settings) {\n      if (lineSettings.settings.defaultBead) {\n        lineSettings.settings.defaultBead.rotate = value;\n      }\n    }\n  }\n\n  /**\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeSelectedLines_settings_beadsCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsAutoCount(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoCount = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_settings_beadsAutoSpacing(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((id) => {\n      this.draftState.appData.lines[id].settings.beadsAutoSpacing = value;\n      this.updateBeadsPositions(id);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_type(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.type = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].type = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_color(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.color = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].color = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_height(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      const currLine = this.draftState.appData.lines[lineId];\n      let { width, height, keepAspectRatio } = currLine.settings.defaultBead;\n\n      if (keepAspectRatio === false) {\n        currLine.settings.defaultBead.height = value;\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          this.draftState.appData.beads[beadId].height = value;\n        });\n        this.updateBeadsPositions(lineId);\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n            height = value;\n          }\n\n          currLine.settings.defaultBead.width = width;\n          currLine.settings.defaultBead.height = height;\n        }\n\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          if (width && height) {\n            this.draftState.appData.beads[beadId].width = width;\n            this.draftState.appData.beads[beadId].height = height;\n          }\n        });\n\n        this.updateBeadsPositions(lineId);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_width(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      const currLine = this.draftState.appData.lines[lineId];\n      let { width, height, keepAspectRatio } = currLine.settings.defaultBead;\n\n      if (keepAspectRatio === false) {\n        currLine.settings.defaultBead.width = value;\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          this.draftState.appData.beads[beadId].width = value;\n        });\n        this.updateBeadsPositions(lineId);\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = height / width;\n            width = value;\n            height = value * ratio;\n          }\n\n          currLine.settings.defaultBead.width = width;\n          currLine.settings.defaultBead.height = height;\n        }\n\n        this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n          if (width && height) {\n            this.draftState.appData.beads[beadId].width = width;\n            this.draftState.appData.beads[beadId].height = height;\n          }\n        });\n\n        this.updateBeadsPositions(lineId);\n      }\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_keepAspectRatio(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[\n        lineId\n      ].settings.defaultBead.keepAspectRatio = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].keepAspectRatio = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  action_changeSelectedLines_defaultBead_rotate(value) {\n    Object.keys(this.draftState.ui.selectedLinesIds).forEach((lineId) => {\n      this.draftState.appData.lines[lineId].settings.defaultBead.rotate = value;\n      this.draftState.appData.lines[lineId].beadIds.forEach((beadId) => {\n        this.draftState.appData.beads[beadId].rotate = value;\n      });\n      this.updateBeadsPositions(lineId);\n    });\n    this.editorAppDataHasChanged();\n  }\n\n  /****\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_changeSelectedBeads_type(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].type = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_color(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].color = value;\n    });\n    getEventEmitter().emit(\n      \"action_changeSelectedBeads_color\",\n      {\n        beadIds: Object.keys(this.draftState.ui.selectedBeadsIds),\n        color: value,\n      },\n      this.state\n    );\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_height(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      const currBead = this.draftState.appData.beads[beadId];\n      let { width, height, keepAspectRatio } = currBead;\n\n      if (keepAspectRatio === false) {\n        this.draftState.appData.beads[beadId].height = value;\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n            height = value;\n          }\n        }\n        this.draftState.appData.beads[beadId].width = width;\n        this.draftState.appData.beads[beadId].height = height;\n      }\n    });\n\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_width(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      const currBead = this.draftState.appData.beads[beadId];\n      let { width, height, keepAspectRatio } = currBead;\n\n      if (keepAspectRatio === false) {\n        this.draftState.appData.beads[beadId].width = value;\n      } else {\n        if (width && height) {\n          if (value >= 1) {\n            const ratio = height / width;\n            width = value;\n            height = value * ratio;\n          }\n        }\n        this.draftState.appData.beads[beadId].width = width;\n        this.draftState.appData.beads[beadId].height = height;\n      }\n    });\n\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_keepAspectRatio(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].keepAspectRatio = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  action_changeSelectedBeads_rotate(value) {\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      this.draftState.appData.beads[beadId].rotate = value;\n    });\n    this.updateLineFromSelectedBeads();\n  }\n\n  updateLineFromSelectedBeads() {\n    const results: string[] = [];\n    Object.keys(this.draftState.ui.selectedBeadsIds).forEach((beadId) => {\n      for (const lineId of Object.keys(this.draftState.appData.lines)) {\n        if (\n          this.draftState.appData.lines[lineId].beadIds.indexOf(beadId) !== -1\n        ) {\n          if (results.indexOf(lineId) === -1) {\n            results.push(lineId);\n            break;\n          }\n        }\n      }\n    });\n    for (const lineId of results) {\n      this.updateBeadsPositions(lineId);\n    }\n  }\n\n  /****\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   *\n   */\n\n  action_updateBrushSize(value) {\n    this.draftState.ui.brush.size = value;\n  }\n\n  action_updateBrushColor(value) {\n    this.draftState.ui.brush.color = value;\n  }\n\n  action_updateBeadsTemplate(key: string, value: any) {\n    if (this.draftState.ui.beadsTemplate[key] !== undefined) {\n      let { keepAspectRatio, width, height } = this.draftState.ui.beadsTemplate;\n\n      if (keepAspectRatio === true) {\n        if (key === \"width\") {\n          if (value >= 1) {\n            const ratio = height / width;\n            height = value * ratio;\n          }\n          this.draftState.ui.beadsTemplate.height = height;\n        }\n        if (key === \"height\") {\n          if (value >= 1) {\n            const ratio = width / height;\n            width = value * ratio;\n          }\n          this.draftState.ui.beadsTemplate.width = width;\n        }\n      }\n\n      this.draftState.ui.beadsTemplate[key] = value;\n    } else {\n      console.warn(`action_updateBeadsTemplate: key dont exists ${key}`);\n    }\n  }\n}\n","import { Editor, EditorMenuMain } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { buildPoint } from \"../editorObjects/Point\";\n\nexport class TopbarImmerReducer extends ImmerReducer<Editor> {\n  action_toggleMenuFile() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.File) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.File;\n    }\n  }\n  action_toggleMenuSettings() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.Grid) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.Grid;\n    }\n  }\n  action_toggleMenuBackground() {\n    if (this.draftState.ui.currentMenuMainOpen === EditorMenuMain.Background) {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.None;\n    } else {\n      this.draftState.ui.currentMenuMainOpen = EditorMenuMain.Background;\n    }\n  }\n  action_toggleGridSnapEnabled() {\n    this.draftState.ui.grid.snapEnabled = !this.draftState.ui.grid.snapEnabled;\n  }\n  action_toggleGridIsVisible() {\n    this.draftState.ui.grid.isVisible = !this.draftState.ui.grid.isVisible;\n  }\n  action_setGridWidth(value) {\n    this.draftState.ui.grid.width = value;\n  }\n  action_setGridHeight(value) {\n    this.draftState.ui.grid.height = value;\n  }\n  action_setGridType(value) {\n    this.draftState.ui.grid.type = value;\n  }\n  action_setGridHexSize(value) {\n    this.draftState.ui.grid.hexSize = value;\n  }\n\n  action_background_image_clear() {\n    this.draftState.ui.background.image.position = buildPoint(0, 0);\n    this.draftState.ui.background.image.scale = 1;\n    this.draftState.ui.background.image.url = \"\";\n  }\n  action_background_image_upload(value) {\n    this.draftState.ui.background.image.url = value;\n  }\n  action_background_image_pointX(value) {\n    this.draftState.ui.background.image.position.x = value;\n  }\n  action_background_image_pointY(value) {\n    this.draftState.ui.background.image.position.y = value;\n  }\n  action_background_image_scale(value) {\n    this.draftState.ui.background.image.scale = value;\n  }\n  action_background_image_opacity(value) {\n    this.draftState.ui.background.image.opacity = value;\n  }\n  \n}\n","import { Editor, BrushType } from \"../editorObjects/Editor\";\nimport { ImmerReducer } from \"immer-reducer\";\nimport { getDistanceBetweenPoints, buildPoint } from \"../editorObjects/Point\";\n\nexport class PaintImmerReducer extends ImmerReducer<Editor> {\n  action_applyColorBrush(x, y) {\n    const { color, type, size } = this.draftState.ui.brush;\n    if (type === BrushType.Color) {\n      const mousePoint = buildPoint(x + size / 2, y + size /2);\n      Object.keys(this.draftState.appData.beads).forEach(beadId => {\n        const currBead = this.draftState.appData.beads[beadId];\n        if (currBead.color !== color) {\n          const centerPoint = buildPoint(\n            currBead.position.x + currBead.width / 2,\n            currBead.position.y + currBead.height / 2\n          );\n          const len = getDistanceBetweenPoints(centerPoint, mousePoint);\n          const brush = size / 2 + Math.min(currBead.width , currBead.height) / 2;\n          if (len < brush) {\n            this.draftState.appData.beads[beadId].color = color;\n          }\n        }\n      });\n    }\n  }\n}\n","import {\n  Editor,\n  EditorMode,\n  BeadTypes,\n  EditorMenuMain,\n  EditorGridType,\n  BrushType,\n} from \"../editorObjects/Editor\";\nimport { Reducer } from \"redux\";\nimport { buildPoint } from \"../editorObjects/Point\";\nimport { composeReducers } from \"immer-reducer\";\nimport { createActionCreators, createReducerFunction } from \"immer-reducer\";\nimport { DraggableOperationsImmerReducer } from \"./DraggableOperationsImmerReducer\";\nimport { PersistImmerReducer } from \"./PersistImmerReducer\";\nimport { ChangeEditorModeImmerReducer } from \"./ChangeEditorModeImmerReducer\";\nimport { MainImmerReducer } from \"./MainImmerReducer\";\nimport { MouseSelectionImmerReducer } from \"./MouseSelectionImmerReducer\";\nimport { ToolbarImmerReducer } from \"./ToolbarImmerReducer\";\nimport { defaulBeadColor } from \"../components/colors\";\nimport { TopbarImmerReducer } from \"./TopbarImmerReducer\";\nimport { PaintImmerReducer } from \"./PaintImmerReducer\";\nimport { buildBead } from \"../editorObjects/Bead\";\nimport { produce } from \"immer\";\nimport { getEventEmitter } from \"../EventEmitter\";\n\nconst defaultBead = buildBead({});\n\nconst defaultAppData: Editor = {\n  appData: {\n    beads: {},\n    lines: {},\n  },\n  ui: {\n    lights: [\n      {\n        type: \"THREE.DirectionalLight\",\n        name: \"main_light_1\",\n        color: \"#FFF\",\n        intensity: 0.8,\n        position: {\n          x: 0,\n          y: 0,\n          z: 10,\n        },\n      },\n      {\n        type: \"THREE.DirectionalLight\",\n        name: \"main_light_2\",\n        color: \"#FFF\",\n        intensity: 0.4,\n        position: {\n          x: 0,\n          y: 0,\n          z: 10,\n        },\n      },\n    ],\n    lineSettings: {\n      settings: {\n        beadsAutoCount: true,\n        beadsAutoSpacing: true,\n        beadsCount: 0,\n        beadsSpacing: 0,\n        defaultBead: {\n          type: BeadTypes.BasicEllipse,\n          rotate: 0,\n          color: defaulBeadColor,\n          height: 52,\n          width: 52,\n          keepAspectRatio: false,\n        },\n      },\n    },\n    saveInfo: {\n      saved: false,\n      haveUnsavedChanges: false,\n    },\n    selectedLinesIds: {},\n    selectedLinesIdsCount: 0,\n    selectedBeadsIds: {},\n    selectedBeadsIdsCount: 0,\n    mouseSelection: {\n      start: buildPoint(0, 0),\n      end: buildPoint(0, 0),\n      isDragStarted: false,\n      isDragged: false,\n    },\n    currentMenuMainOpen: EditorMenuMain.None,\n    grid: {\n      type: EditorGridType.Hex,\n      hexSize: 30,\n      snapEnabled: true,\n      isVisible: true,\n      width: 30,\n      height: 30,\n    },\n    brush: {\n      type: BrushType.Color,\n      size: 50,\n      color: defaulBeadColor,\n    },\n    background: {\n      image: {\n        url: \"\",\n        scale: 1,\n        position: buildPoint(0, 0),\n        opacity: 0.5,\n      },\n    },\n    beadsTemplate: {\n      color: defaultBead.color,\n      width: defaultBead.width,\n      height: defaultBead.height,\n      keepAspectRatio: defaultBead.keepAspectRatio,\n      rotate: defaultBead.rotate,\n      type: defaultBead.type,\n    },\n    currentBeadChain: {\n      isDragEnabled: false,\n      beadIds: [],\n    },\n    sceneWrapperWidth: 0,\n    sceneWrapperHeight: 0,\n    sceneWrapperPosition: {\n      x: 0,\n      y: 0,\n      angle: 0,\n      scale: 0,\n      top: 0,\n      left: 0,\n    },\n  },\n  mode: EditorMode.Idle,\n};\n\nexport const Actions = {\n  Main: createActionCreators(MainImmerReducer),\n  Draggable: createActionCreators(DraggableOperationsImmerReducer),\n  Persist: createActionCreators(PersistImmerReducer),\n  ChangeEditorMode: createActionCreators(ChangeEditorModeImmerReducer),\n  MouseSelection: createActionCreators(MouseSelectionImmerReducer),\n  Toolbar: createActionCreators(ToolbarImmerReducer),\n  Topbar: createActionCreators(TopbarImmerReducer),\n  Paint: createActionCreators(PaintImmerReducer),\n};\n\nconst eventEmitter = getEventEmitter();\n\nconst reducerForEventEmitter = produce((state, action) => {\n  eventEmitter.emit(action.type, action.payload, state);\n}, {});\n\nexport const store = composeReducers(\n  createReducerFunction(MainImmerReducer, defaultAppData),\n  createReducerFunction(DraggableOperationsImmerReducer, defaultAppData),\n  createReducerFunction(PersistImmerReducer, defaultAppData),\n  createReducerFunction(ToolbarImmerReducer, defaultAppData),\n  createReducerFunction(TopbarImmerReducer, defaultAppData),\n  createReducerFunction(ChangeEditorModeImmerReducer, defaultAppData),\n  createReducerFunction(MouseSelectionImmerReducer, defaultAppData),\n  createReducerFunction(PaintImmerReducer, defaultAppData),\n  reducerForEventEmitter\n);\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faPlus,\n  faEdit,\n  faArrowsAlt,\n  faPaintBrush\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { EditorMode } from \"../../editorObjects/Editor\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch } from \"react-redux\";\nimport { Actions } from \"../../immerReducers/store\";\n\nexport const EditorModes = ({ editorMode }) => {\n  const dispatch = useDispatch();\n\n  const onChangeEditorMode = (newEditorMode: EditorMode) => {\n    dispatch(Actions.ChangeEditorMode.action_onChangeEditorMode(newEditorMode));\n  };\n\n  return (\n    <div className=\"\">\n      <StateButton\n        label={\"Idle\"}\n        icon={<FontAwesomeIcon icon={faArrowsAlt} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.Idle)}\n        isSelected={editorMode === EditorMode.Idle}\n      />\n\n      {/* <StateButton\n        label={\"Edit Lines\"}\n        icon={<FontAwesomeIcon icon={faEdit} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.EditLines)}\n        isSelected={editorMode === EditorMode.EditLines}\n      /> */}\n\n      <StateButton\n        label={\"Edit\"}\n        icon={<FontAwesomeIcon icon={faEdit} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.EditBeads)}\n        isSelected={editorMode === EditorMode.EditBeads}\n      />\n\n      {/* <StateButton\n        label={\"AddLine\"}\n        icon={<FontAwesomeIcon icon={faPlus} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.AddLine)}\n        isSelected={editorMode === EditorMode.AddLine}\n      /> */}\n\n      <StateButton\n        label={\"Add\"}\n        icon={<FontAwesomeIcon icon={faPaintBrush} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.AddBeads)}\n        isSelected={editorMode === EditorMode.AddBeads}\n      />\n\n      <StateButton\n        label={\"Paint\"}\n        icon={<FontAwesomeIcon icon={faPaintBrush} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.PaintBeads)}\n        isSelected={editorMode === EditorMode.PaintBeads}\n      />\n\n      <StateButton\n        label={\"Delete\"}\n        icon={<FontAwesomeIcon icon={faPaintBrush} color={uiButton} />}\n        onClick={() => onChangeEditorMode(EditorMode.DeleteBeads)}\n        isSelected={editorMode === EditorMode.DeleteBeads}\n      />\n    </div>\n  );\n};\n\nconst StateButton = ({ label, isSelected, onClick, icon }) => {\n  return (\n    <div\n      className={`\n              button \n              ${isSelected ? \"is-active\" : \"\"}\n            `}\n      onClick={onClick}\n    >\n      <span className=\"icon is-small\">{icon}</span>\n      <span>{label}</span>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Bead, BeadTypes } from \"../../editorObjects/Editor\";\nimport { getTranslate3dCss } from \"../operations/MapValuesToCss\";\nimport { Actions } from \"../../immerReducers/store\";\nimport { useDispatch } from \"react-redux\";\n\nexport const DisplayBead = (props: {\n  bead: Bead;\n  opacity?: number;\n  zIndex?: number;\n  isSelected: boolean;\n  isSelectable: boolean;\n}) => {\n  const { bead, opacity, zIndex, isSelected, isSelectable } = props;\n  const isOpacity = opacity !== undefined && opacity >= 0 && opacity <= 1;\n  const isZindex = zIndex !== undefined && zIndex >= 0 && zIndex <= 9999;\n\n  const dispatch = useDispatch();\n  const onClick = () => {\n    if (isSelectable) {\n      dispatch(Actions.Draggable.action_onClickBead(bead.id));\n    }\n  };\n\n  const translate3d = getTranslate3dCss(bead.position.x, bead.position.y);\n  const rotate = bead.rotate + bead.lineRotate;\n  const rotateCss = !rotate ? \"rotateZ(0deg)\" : `rotateZ(${rotate}deg)`;\n  let styles: React.CSSProperties = {\n    transform: `${translate3d} ${rotateCss}`,\n    opacity: isOpacity ? opacity : 1,\n    zIndex: isZindex ? zIndex : undefined,\n    border: isSelected ? \"1px solid #000\" : \"\",\n    width: `${bead.width}px`,\n    height: `${bead.height}px`,\n    background: bead.color\n  };\n\n  if (bead.type === BeadTypes.BasicEllipse) {\n    styles.borderRadius = \"100%\";\n  }\n\n  return (\n    <div className=\"bead-item\" onClick={onClick} style={styles}>\n      &nbsp;\n    </div>\n  );\n};\n","export const getTranslate3dCss = (x, y, z = 1) => {\n  return `translate3d(${x}px, ${y}px, ${z}px)`;\n};\n\nexport const getRotateCss = rotate => {\n  return `rotate(${rotate}rad)`;\n};\n","import React from \"react\";\nimport { DisplayBead } from \"../../Bead/DisplayBead\";\nimport { buildBead } from \"../../../editorObjects/Bead\";\nimport { buildPoint } from \"../../../editorObjects/Point\";\n\nexport const FieldBeadPreview = ({ bead }) => {\n  const displayBead = buildBead({\n    ...bead,\n    position: buildPoint(0, 0),\n  });\n  return (\n    <div\n      style={{\n        marginTop: \"20px\",\n        marginBottom: \"20px\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        height: \"100px\",\n        boxSizing: \"border-box\",\n      }}\n    >\n      <div\n        style={{\n          position: \"relative\",\n          top: `${(-1 * bead.height) / 2}px`,\n          left: `${(-1 * bead.width) / 2}px`,\n        }}\n      >\n        <DisplayBead\n          bead={displayBead}\n          isSelected={false}\n          isSelectable={false}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport const ToolbarField = ({ label, icon, value, onToggle }) => {\n  return (\n    <div\n      className={\"fieldset\"}\n      onClick={onToggle}\n      style={{ cursor: \"pointer\" }}\n    >\n      <div className=\"label\">\n        {icon ? (\n          <div\n            style={{\n              width: \"30px\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              height: \"30px\",\n              marginRight: \"10px\",\n            }}\n          >\n            {icon}\n          </div>\n        ) : null}\n        {label ? <div>{label}</div> : null}\n      </div>\n\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          justifyContent: \"flex-end\",\n          alignItems: \"center\",\n          boxSizing: \"border-box\",\n          paddingLeft: \"10px\",\n          paddingRight: \"20px\",\n          width: \"100%\",\n        }}\n      >\n        <div>{value !== undefined ? value : \"-\"}</div>\n      </div>\n    </div>\n  );\n};\n","import React, { useState } from \"react\";\nimport { ToolbarField } from \"./ToolbarField\";\n\nexport const ToolbarFieldSet = ({ selected, label, icon, children }) => {\n  const [isPickerOpen, setIsPickerOpen] = useState(false);\n  const onToggle = () => {\n    setIsPickerOpen(!isPickerOpen);\n  };\n  return (\n    <div\n      style={{\n        // borderBottom: \"1px solid #dfdfdf\",\n        borderTop: \"1px solid #dfdfdf\",\n      }}\n    >\n      <ToolbarField\n        label={label}\n        onToggle={onToggle}\n        icon={icon}\n        value={selected}\n      />\n\n      {isPickerOpen === true ? (\n        <div style={{ background: \"#fff\" }}>{React.cloneElement(children)}</div>\n      ) : null}\n    </div>\n  );\n};\n","import React from \"react\";\nimport * as material from \"material-colors\";\n\nexport const FieldColorPicker = ({ value, onChange, ...props }) => {\n  const colors = [\n    [\n      material.red[\"900\"],\n      material.red[\"700\"],\n      material.red[\"500\"],\n      material.red[\"300\"],\n      material.red[\"100\"],\n    ],\n    [\n      material.pink[\"900\"],\n      material.pink[\"700\"],\n      material.pink[\"500\"],\n      material.pink[\"300\"],\n      material.pink[\"100\"],\n    ],\n    [\n      material.purple[\"900\"],\n      material.purple[\"700\"],\n      material.purple[\"500\"],\n      material.purple[\"300\"],\n      material.purple[\"100\"],\n    ],\n    [\n      material.deepPurple[\"900\"],\n      material.deepPurple[\"700\"],\n      material.deepPurple[\"500\"],\n      material.deepPurple[\"300\"],\n      material.deepPurple[\"100\"],\n    ],\n    [\n      material.indigo[\"900\"],\n      material.indigo[\"700\"],\n      material.indigo[\"500\"],\n      material.indigo[\"300\"],\n      material.indigo[\"100\"],\n    ],\n    [\n      material.blue[\"900\"],\n      material.blue[\"700\"],\n      material.blue[\"500\"],\n      material.blue[\"300\"],\n      material.blue[\"100\"],\n    ],\n    [\n      material.lightBlue[\"900\"],\n      material.lightBlue[\"700\"],\n      material.lightBlue[\"500\"],\n      material.lightBlue[\"300\"],\n      material.lightBlue[\"100\"],\n    ],\n    [\n      material.cyan[\"900\"],\n      material.cyan[\"700\"],\n      material.cyan[\"500\"],\n      material.cyan[\"300\"],\n      material.cyan[\"100\"],\n    ],\n    [\n      material.teal[\"900\"],\n      material.teal[\"700\"],\n      material.teal[\"500\"],\n      material.teal[\"300\"],\n      material.teal[\"100\"],\n    ],\n    [\n      \"#194D33\",\n      material.green[\"700\"],\n      material.green[\"500\"],\n      material.green[\"300\"],\n      material.green[\"100\"],\n    ],\n    [\n      material.lightGreen[\"900\"],\n      material.lightGreen[\"700\"],\n      material.lightGreen[\"500\"],\n      material.lightGreen[\"300\"],\n      material.lightGreen[\"100\"],\n    ],\n    [\n      material.lime[\"900\"],\n      material.lime[\"700\"],\n      material.lime[\"500\"],\n      material.lime[\"300\"],\n      material.lime[\"100\"],\n    ],\n    [\n      material.yellow[\"900\"],\n      material.yellow[\"700\"],\n      material.yellow[\"500\"],\n      material.yellow[\"300\"],\n      material.yellow[\"100\"],\n    ],\n    [\n      material.amber[\"900\"],\n      material.amber[\"700\"],\n      material.amber[\"500\"],\n      material.amber[\"300\"],\n      material.amber[\"100\"],\n    ],\n    [\n      material.orange[\"900\"],\n      material.orange[\"700\"],\n      material.orange[\"500\"],\n      material.orange[\"300\"],\n      material.orange[\"100\"],\n    ],\n    [\n      material.deepOrange[\"900\"],\n      material.deepOrange[\"700\"],\n      material.deepOrange[\"500\"],\n      material.deepOrange[\"300\"],\n      material.deepOrange[\"100\"],\n    ],\n    [\n      material.brown[\"900\"],\n      material.brown[\"700\"],\n      material.brown[\"500\"],\n      material.brown[\"300\"],\n      material.brown[\"100\"],\n    ],\n    [\n      material.blueGrey[\"900\"],\n      material.blueGrey[\"700\"],\n      material.blueGrey[\"500\"],\n      material.blueGrey[\"300\"],\n      material.blueGrey[\"100\"],\n    ],\n    [\"#000000\", \"#525252\", \"#969696\", \"#D9D9D9\", \"#FFFFFF\"],\n  ];\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        paddingTop: \"20px\",\n        paddingBottom: \"30px\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n      }}\n    >\n      <DisplayColorsGroup colors={colors} onClick={onChange} />\n      {/* <CirclePicker\n        color={value}\n        onChangeComplete={color => onChange(color.hex)}\n        colors={[\"#000\"]}\n      /> */}\n      {/* <SwatchesPicker\n        width={258}\n        height={240}\n        onChangeComplete={color => onChange(color.hex)}\n        color={value}\n      /> */}\n    </div>\n  );\n};\n\nconst DisplayColorsGroup = ({ colors, onClick }) => {\n  return (\n    <div>\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"flex-start\",\n          alignItems: \"center\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        {colors.map(group => {\n          return (\n            <div key={group.toString()} style={{ marginBottom: \"10px\" }}>\n              {group.map(color => {\n                return (\n                  <div\n                    key={color}\n                    style={{\n                      cursor: \"pointer\",\n                      border: \"3px solid transparent\",\n                      boxSizing: \"border-box\",\n                    }}\n                  >\n                    <div\n                      onClick={() => onClick(color)}\n                      style={{\n                        boxSizing: \"border-box\",\n                        background: color,\n                        width: \"28px\",\n                        height: \"28px\",\n                        borderRadius: \"100%\",\n                        border: \"none\",\n                      }}\n                    />\n                  </div>\n                );\n              })}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\n\n\n// const colors = [\n//   material.red[\"900\"],\n//   material.red[\"700\"],\n//   material.red[\"500\"],\n//   material.red[\"300\"],\n//   material.red[\"100\"],\n//   material.pink[\"900\"],\n//   material.pink[\"700\"],\n//   material.pink[\"500\"],\n//   material.pink[\"300\"],\n//   material.pink[\"100\"],\n//   material.purple[\"900\"],\n//   material.purple[\"700\"],\n//   material.purple[\"500\"],\n//   material.purple[\"300\"],\n//   material.purple[\"100\"],\n//   material.deepPurple[\"900\"],\n//   material.deepPurple[\"700\"],\n//   material.deepPurple[\"500\"],\n//   material.deepPurple[\"300\"],\n//   material.deepPurple[\"100\"],\n//   material.indigo[\"900\"],\n//   material.indigo[\"700\"],\n//   material.indigo[\"500\"],\n//   material.indigo[\"300\"],\n//   material.indigo[\"100\"],\n//   material.blue[\"900\"],\n//   material.blue[\"700\"],\n//   material.blue[\"500\"],\n//   material.blue[\"300\"],\n//   material.blue[\"100\"],\n//   material.lightBlue[\"900\"],\n//   material.lightBlue[\"700\"],\n//   material.lightBlue[\"500\"],\n//   material.lightBlue[\"300\"],\n//   material.lightBlue[\"100\"],\n//   material.cyan[\"900\"],\n//   material.cyan[\"700\"],\n//   material.cyan[\"500\"],\n//   material.cyan[\"300\"],\n//   material.cyan[\"100\"],\n//   material.teal[\"900\"],\n//   material.teal[\"700\"],\n//   material.teal[\"500\"],\n//   material.teal[\"300\"],\n//   material.teal[\"100\"],\n//   \"#194D33\",\n//   material.green[\"700\"],\n//   material.green[\"500\"],\n//   material.green[\"300\"],\n//   material.green[\"100\"],\n//   material.lightGreen[\"900\"],\n//   material.lightGreen[\"700\"],\n//   material.lightGreen[\"500\"],\n//   material.lightGreen[\"300\"],\n//   material.lightGreen[\"100\"],\n//   material.lime[\"900\"],\n//   material.lime[\"700\"],\n//   material.lime[\"500\"],\n//   material.lime[\"300\"],\n//   material.lime[\"100\"],\n//   material.yellow[\"900\"],\n//   material.yellow[\"700\"],\n//   material.yellow[\"500\"],\n//   material.yellow[\"300\"],\n//   material.yellow[\"100\"],\n//   material.amber[\"900\"],\n//   material.amber[\"700\"],\n//   material.amber[\"500\"],\n//   material.amber[\"300\"],\n//   material.amber[\"100\"],\n//   material.orange[\"900\"],\n//   material.orange[\"700\"],\n//   material.orange[\"500\"],\n//   material.orange[\"300\"],\n//   material.orange[\"100\"],\n//   material.deepOrange[\"900\"],\n//   material.deepOrange[\"700\"],\n//   material.deepOrange[\"500\"],\n//   material.deepOrange[\"300\"],\n//   material.deepOrange[\"100\"],\n//   material.brown[\"900\"],\n//   material.brown[\"700\"],\n//   material.brown[\"500\"],\n//   material.brown[\"300\"],\n//   material.brown[\"100\"],\n//   material.blueGrey[\"900\"],\n//   material.blueGrey[\"700\"],\n//   material.blueGrey[\"500\"],\n//   material.blueGrey[\"300\"],\n//   material.blueGrey[\"100\"],\n\n//   \"#000000\",\n//   \"#525252\",\n//   \"#969696\",\n//   \"#D9D9D9\",\n//   \"#FFFFFF\",\n// ];\n","import React from \"react\";\n\nexport const FieldColor = ({ value, isSelected, onClick }) => {\n  return (\n    <div style={{ border: \"5px solid transparent\" }}>\n      <div\n        onClick={onClick ? () => onClick(value) : undefined}\n        style={{\n          width: 25,\n          height: 25,\n          background: value,\n          marginBottom: 0,\n          marginRight: 0,\n          border: isSelected ? \"2px solid #000\" : \"2px solid #000\",\n          boxShadow: isSelected\n            ? \"2px 2px 2px rgba(0,0,0,1)\"\n            : \"2px 2px 2px rgba(0,0,0,0.1)\",\n        }}\n      ></div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPalette } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { FieldColorPicker } from \"./FieldColorPicker\";\nimport { FieldColor } from \"./FieldColor\";\n\nexport const FieldsetColor = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={\n        <FieldColor value={value} isSelected={false} onClick={undefined} />\n      }\n      label={\"Color\"}\n      icon={<FontAwesomeIcon icon={faPalette} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldColorPicker value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { BeadTypes } from \"../../../editorObjects/Editor\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCircle, faExpand } from \"@fortawesome/free-solid-svg-icons\";\n\nexport const BeadTypesIcons = {\n  [BeadTypes.BasicEllipse]: \"circle\",\n  [BeadTypes.BasicRectangle]: \"rectangle-wide\",\n};\n\nexport const FieldBeadTypePicker = ({ value, onChange }) => {\n  return (\n    <DisplayAvailableBeadTypes\n      types={BeadTypesIcons}\n      selectedType={value}\n      onClick={onChange}\n    />\n  );\n};\n\nconst DisplayAvailableBeadTypes = ({ types, selectedType, onClick }) => {\n  // console.log(\"jak jest?\", types);\n  return (\n    <div className=\"fieldset\" style={{}}>\n      <div className=\"label\"></div>\n      <div\n        style={{\n          display: \"flex\",\n          flexDirection: \"row\",\n          justifyContent: \"flex-start\",\n          alignItems: \"center\",\n          boxSizing: \"border-box\",\n          paddingLeft: \"10px\",\n          paddingRight: \"20px\",\n          width: \"100%\",\n        }}\n      >\n        {Object.keys(types).map((type, index) => {\n          return (\n            <DisplayBeadType\n              icon={types[type]}\n              type={type}\n              key={index}\n              isSelected={selectedType === type}\n              onClick={onClick}\n            />\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport const DisplayBeadType = ({ icon, type, isSelected, onClick }) => {\n  return (\n    <div style={{ border: \"5px solid transparent\" }}>\n      <div\n        onClick={onClick ? () => onClick(type) : undefined}\n        style={{\n          width: 25,\n          height: 25,\n          background: \"#eee\",\n          marginBottom: 0,\n          marginRight: 0,\n          border: isSelected ? \"2px solid #000\" : \"2px solid #000\",\n          boxShadow: isSelected\n            ? \"2px 2px 2px rgba(0,0,0,1)\"\n            : \"2px 2px 2px rgba(0,0,0,0.1)\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n        }}\n      >\n        {icon === \"circle\" ? <FontAwesomeIcon icon={faCircle} /> : null}\n        {icon === \"rectangle-wide\" ? <FontAwesomeIcon icon={faExpand} /> : null}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faShapes } from \"@fortawesome/free-solid-svg-icons\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport {\n  FieldBeadTypePicker,\n  BeadTypesIcons,\n  DisplayBeadType,\n} from \"./FieldBeadTypePicker\";\n\nexport const FieldsetBeadType = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={\n        <DisplayBeadType\n          icon={value ? BeadTypesIcons[value] : undefined}\n          type={value}\n          isSelected={false}\n          onClick={undefined}\n        />\n      }\n      label={\"Type\"}\n      icon={<FontAwesomeIcon icon={faShapes} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldBeadTypePicker value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport \"rc-slider/assets/index.css\";\nimport Slider, { createSliderWithTooltip } from \"rc-slider\";\n\nexport const SliderWithTooltip = createSliderWithTooltip(Slider);\n\nexport const FieldSliderWithLabel = ({ value, onChange, label, icon }) => {\n  return (\n    <div\n      className={\"fieldset\"}\n      style={{\n        paddingTop: \"10px\",\n        paddingBottom: \"10px\",\n        paddingLeft: \"10px\",\n        paddingRight: \"10px\",\n        display: \"flex\",\n        flexDirection: \"row\",\n        justifyContent: \"space-between\",\n        background: \"#fff\",\n        borderBottom: 0,\n      }}\n    >\n      <div className=\"label\" style={{ padding: 0, width: \"105px\" }}>\n        {icon ? (\n          <div\n            style={{\n              width: \"30px\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              height: \"30px\",\n              marginRight: \"10px\",\n            }}\n          >\n            {icon}\n          </div>\n        ) : null}\n        {label ? <div>{label}</div> : null}\n      </div>\n\n      <div\n        style={{\n          boxSizing: \"border-box\",\n          flexGrow: 1,\n          paddingRight: \"10px\",\n          paddingBottom: \"10px\",\n        }}\n      >\n        <SliderWithTooltip\n          max={100}\n          min={1}\n          step={1}\n          value={value}\n          onChange={value => onChange(value)}\n          defaultValue={10}\n          marks={{\n            0: \"0\",\n            50: \"50\",\n            100: \"100\",\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\n\nexport const FieldCheckbox = ({ label, value, onChange, isDisabled }) => {\n  return (\n    <div className={\"fieldset\"}>\n      <div className=\"label\">{label}</div>\n      <input\n        type=\"checkbox\"\n        disabled={isDisabled}\n        value={value === true ? 1 : 0}\n        checked={value === true}\n        onChange={event => onChange(event.target.value === \"0\")}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\n// import { FieldsetHeight } from \"./FieldsetHeight\";\n// import { FieldsetWidth } from \"./FieldsetWidth\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport {\n  faExpandArrowsAlt,\n  faArrowsAltV,\n  faArrowsAltH,\n  faLink,\n  faUnlink,\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../../colors\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport { FieldSliderWithLabel } from \"./FieldSliderWithLabel\";\nimport { FieldCheckbox } from \"./FieldCheckbox\";\n\nexport const FieldsetWidthAndHeight = ({\n  height,\n  width,\n  keepAspectRatio,\n  onChange_beadHeight,\n  onChange_beadWidth,\n  onChange_keepAspectRatio,\n}) => {\n  const format = value =>\n    value.toLocaleString(undefined, {\n      maximumFractionDigits: 2,\n      style: \"decimal\",\n    });\n  const value = `${format(width)} x ${format(height)}`;\n  return (\n    <div>\n      <ToolbarFieldSet\n        selected={value}\n        label={\"Size\"}\n        icon={\n          <FontAwesomeIcon\n            icon={faExpandArrowsAlt}\n            color={uiButton}\n            size={\"lg\"}\n          />\n        }\n      >\n        <div>\n          <div style={{ width: \"100%\", background: \"#fff\" }}>\n            <FieldCheckbox\n              label={\n                <div\n                  style={{\n                    display: \"flex\",\n                    flexWrap: \"nowrap\",\n                    justifyContent: \"space\",\n                  }}\n                >\n                  <div\n                    style={{\n                      width: \"30px\",\n                      display: \"flex\",\n                      justifyContent: \"center\",\n                      alignItems: \"center\",\n                      height: \"30px\",\n                      marginRight: \"10px\",\n                      background: \"#fff\",\n                    }}\n                  >\n                    <FontAwesomeIcon\n                      icon={keepAspectRatio === true ? faLink : faUnlink}\n                      color={uiButton}\n                      size={\"lg\"}\n                    />\n                  </div>\n                  <div>Keep aspect ratio</div>\n                </div>\n              }\n              value={keepAspectRatio}\n              onChange={onChange_keepAspectRatio}\n              isDisabled={false}\n            />\n          </div>\n\n          <FieldSliderWithLabel\n            label={\"Width\"}\n            icon={\n              <FontAwesomeIcon\n                icon={faArrowsAltH}\n                color={uiButton}\n                size={\"lg\"}\n              />\n            }\n            value={width}\n            onChange={onChange_beadWidth}\n          />\n\n          <FieldSliderWithLabel\n            label={\"Height\"}\n            icon={\n              <FontAwesomeIcon\n                icon={faArrowsAltV}\n                color={uiButton}\n                size={\"lg\"}\n              />\n            }\n            value={height}\n            onChange={onChange_beadHeight}\n          />\n        </div>\n      </ToolbarFieldSet>\n    </div>\n  );\n};\n","import React from \"react\";\nimport \"rc-slider/assets/index.css\";\nimport Slider, { createSliderWithTooltip } from \"rc-slider\";\n\nexport const SliderWithTooltip = createSliderWithTooltip(Slider);\n\nexport const FieldSlider = ({ value, onChange, ...props }) => {\n  return (\n    <div\n      style={{\n        background: \"#fff\",\n        width: \"100%\",\n        paddingTop: \"20px\",\n        paddingBottom: \"30px\",\n        paddingLeft: \"20px\",\n        paddingRight: \"20px\",\n      }}\n    >\n      <SliderWithTooltip\n        max={100}\n        min={1}\n        step={1}\n        value={value}\n        onChange={value => onChange(value)}\n        defaultValue={10}\n        marks={{\n          0: \"0\",\n          50: \"50\",\n          100: \"100\",\n        }}\n        {...props}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSyncAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport { FieldSlider } from \"./FieldSlider\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\nimport NumberFormat from \"react-number-format\";\n\nexport const FieldsetBeadRotate = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={`${value}deg`}\n      label={\"Rotate\"}\n      icon={<FontAwesomeIcon icon={faSyncAlt} color={uiButton} size={\"lg\"} />}\n    >\n      <React.Fragment>\n        <FieldSlider\n          value={value}\n          onChange={value => {\n            // console.log(\"FieldSlider\", value);\n            onChange(value);\n          }}\n          max={180}\n          min={-180}\n          defaultValue={0}\n          marks={{\n            \"-180\": \"-180\",\n            \"0\": \"0\",\n            \"180\": \"180\",\n          }}\n        />\n        <NumberFormat\n          suffix={\"deg\"}\n          allowNegative={true}\n          allowEmptyFormatting={true}\n          value={value}\n          onValueChange={event => {\n            onChange(event.floatValue);\n          }}\n          placeholder=\" deg\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"1em\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"3px 10px\",\n            marginBottom: \"15px\",\n            marginTop: \"5px\",\n          }}\n        />\n      </React.Fragment>\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { FieldBeadPreview } from \"../ui/FieldBeadPreview\";\nimport { Actions } from \"../../../immerReducers/store\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetBeadType } from \"../ui/FieldsetBeadType\";\n// import { FieldsetBeadSpacing } from \"../ui/FieldsetBeadSpacing\";\n// import { FieldsetBeadCount } from \"../ui/FieldsetBeadCount\";\nimport { FieldsetWidthAndHeight } from \"../ui/FieldsetWidthAndHeight\";\n// import { FieldDeleteAndCopy } from \"../ui/FieldDeleteAndCopy\";\nimport { FieldsetBeadRotate } from \"../ui/FieldsetBeadRotate\";\n\nexport const ToolbarEditBeads = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <ContentWrapper />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst ContentWrapper = () => {\n  const showToolbar = useSelector((state: Editor) => {\n    return state.ui.selectedBeadsIdsCount >= 1;\n  });\n  if (showToolbar) {\n    return <Content />;\n  }\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BeadPreview />\n      <BeadSize />\n      <BeadColor />\n      <BeadType />\n      <BeadsRotate />\n    </React.Fragment>\n  );\n};\n\nconst BeadsRotate = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadsRotate = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_rotate(newValue));\n  };\n\n  return (\n    <FieldsetBeadRotate\n      value={selected.rotate}\n      onChange={onChange_beadsRotate}\n    />\n  );\n};\n\nconst BeadSize = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  const onChange_beadWidth = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_width(value));\n  };\n  const onChange_beadHeight = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_height(value));\n  };\n  const onChange_keepAspectRatio = value => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_keepAspectRatio(value));\n  };\n  const width = selected.width ? selected.width : 10;\n  const height = selected.height ? selected.height : 10;\n  const keepAspectRatio = selected.keepAspectRatio\n    ? selected.keepAspectRatio\n    : false;\n\n  return (\n    <div>\n      <FieldsetWidthAndHeight\n        height={height}\n        width={width}\n        keepAspectRatio={keepAspectRatio}\n        onChange_beadHeight={onChange_beadHeight}\n        onChange_beadWidth={onChange_beadWidth}\n        onChange_keepAspectRatio={onChange_keepAspectRatio}\n      />\n    </div>\n  );\n};\n\nconst BeadType = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  if (!selected.type) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = type => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_type(type));\n  };\n\n  return <FieldsetBeadType onChange={onSelect} value={selected.type} />;\n};\n\nconst BeadColor = () => {\n  const dispatch = useDispatch();\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n\n  if (!selected.color) {\n    return <React.Fragment />;\n  }\n\n  const onSelect = color => {\n    dispatch(Actions.Toolbar.action_changeSelectedBeads_color(color));\n  };\n\n  return <FieldsetColor onChange={onSelect} value={selected.color} />;\n};\n\nconst BeadPreview = () => {\n  const selected = useSelector((state: Editor) => {\n    const beadId = Object.keys(state.ui.selectedBeadsIds)[0];\n    return state.appData.beads[beadId];\n  });\n\n  if (!selected) {\n    return <React.Fragment />;\n  }\n  return <FieldBeadPreview bead={selected} />;\n};\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { ToolbarField } from \"../ui/ToolbarField\";\n\nexport const ToolbarIdle = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  const linesLen = useSelector((state: Editor) => {\n    return Object.keys(state.appData.lines).length;\n  });\n\n  const beadsLen = useSelector((state: Editor) => {\n    return Object.keys(state.appData.beads).length;\n  });\n\n  return (\n    <div>\n      <ToolbarField\n        label={\"Beads\"}\n        onToggle={undefined}\n        value={beadsLen}\n        icon={undefined}\n      />\n\n      <ToolbarField\n        label={\"Lines\"}\n        onToggle={undefined}\n        value={linesLen}\n        icon={undefined}\n      />\n    </div>\n  );\n};\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faFileAlt, faCog, faImage } from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Actions } from \"../../immerReducers/store\";\nimport { Editor, EditorMenuMain } from \"../../editorObjects/Editor\";\n\nexport const TopbarMain = () => {\n  const dispatch = useDispatch();\n  const currentMenuMainOpen = useSelector((state: Editor) => {\n    return state.ui.currentMenuMainOpen;\n  });\n  const onClick_file = () => {\n    dispatch(Actions.Topbar.action_toggleMenuFile());\n  };\n  const onClick_grid = () => {\n    dispatch(Actions.Topbar.action_toggleMenuSettings());\n  };\n  const onClick_background = () => {\n    dispatch(Actions.Topbar.action_toggleMenuBackground());\n  };\n  return (\n    <div\n      className=\"field has-addons\"\n      style={{ margin: 0, border: \"1px solid #e0e0e0\", paddingBottom: \"0px\" }}\n    >\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.File ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_file}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faFileAlt} color={uiButton} />\n          </span>\n          <span>File</span>\n        </div>\n      </div>\n\n      {/* <div className=\"control\">\n        <div className={`button`} onClick={onClick_selection}>\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faMarker} />\n          </span>\n          <span>Canvas</span>\n        </div>\n      </div> */}\n\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.Grid ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_grid}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faCog} color={uiButton} />\n          </span>\n          <span>Grid</span>\n        </div>\n      </div>\n\n      <div className=\"control\">\n        <div\n          className={`button is-light ${\n            currentMenuMainOpen === EditorMenuMain.Background ? \"is-dark\" : \"\"\n          }`}\n          onClick={onClick_background}\n          style={{ height: \"25px\", padding: \"3px 10px\" }}\n        >\n          <span className=\"icon is-small\">\n            <FontAwesomeIcon icon={faImage} color={uiButton} />\n          </span>\n          <span>Background</span>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n","import React from \"react\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes, faSave, faDownload } from \"@fortawesome/free-solid-svg-icons\";\nimport { uiButton } from \"../colors\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Editor } from \"../../editorObjects/Editor\";\nimport { Actions } from \"../../immerReducers/store\";\n\nexport const EditorChangeState = () => {\n  const dispatch = useDispatch();\n  const isSaved = useSelector((state: Editor) => {\n    return state.ui.saveInfo.saved;\n  });\n  const haveUnsavedChanges = useSelector((state: Editor) => {\n    return state.ui.saveInfo.haveUnsavedChanges;\n  });\n\n  const onClearCanvas = () => {\n    dispatch(Actions.Persist.action_onClearCanvas());\n  };\n\n  const readSavedCanvas = () => {\n    dispatch(Actions.Persist.action_readSavedCanvas());\n  };\n\n  const onSaveCanvas = () => {\n    dispatch(Actions.Persist.action_onSaveCanvas());\n  };\n\n  return (\n    <div style={{ display: \"flex\", flexDirection: \"row\" }}>\n      <div\n        className=\"field has-addons\"\n        style={{ width: \"auto\", flexWrap: \"nowrap\", marginBottom: \"0\" }}\n      >\n        <div className=\"control\">\n          <div className={` button is-light `} onClick={onClearCanvas}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faTimes} color={uiButton} />\n            </span>\n            <span>New project</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div\n            className={` button is-light ${\n              isSaved === true ? \"is-success\" : \"\"\n            }`}\n            onClick={onSaveCanvas}\n          >\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faSave} color={uiButton} />\n            </span>\n            <span>Save</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={`button is-light `} onClick={readSavedCanvas}>\n            <span className=\"icon is-small\">\n              <FontAwesomeIcon icon={faDownload} color={uiButton} />\n            </span>\n            <span>Load local</span>\n          </div>\n        </div>\n      </div>\n      <div\n        style={{\n          fontFamily: \"Open Sans, sans-serif\",\n          fontSize: \"13px\",\n          alignSelf: \"center\"\n        }}\n      >\n        {haveUnsavedChanges === true ? (\n          <div>You have unsaved changes</div>\n        ) : (\n          <div>No changes to save</div>\n        )}\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport {\n  Editor,\n  EditorMenuMain,\n  EditorGridType\n} from \"../../editorObjects/Editor\";\nimport { EditorChangeState } from \"../Toolbar/EditorChangeState\";\nimport { FieldCheckbox } from \"../Toolbar/ui/FieldCheckbox\";\nimport NumberFormat from \"react-number-format\";\nimport { Actions } from \"../../immerReducers/store\";\nimport { SliderWithTooltip } from \"../Toolbar/ui/FieldSlider\";\n\nexport const TopbarSecoundary = () => {\n  const currentMenuMainOpen = useSelector((state: Editor) => {\n    return state.ui.currentMenuMainOpen;\n  });\n  if (currentMenuMainOpen === EditorMenuMain.File) {\n    return <SubMenuFile />;\n  }\n  if (currentMenuMainOpen === EditorMenuMain.Grid) {\n    return <SubMenuGrid />;\n  }\n  if (currentMenuMainOpen === EditorMenuMain.Background) {\n    return <SubMenuBackground />;\n  }\n  return <React.Fragment />;\n};\n\nconst SubMenuFile = () => {\n  // const dispatch = useDispatch();\n  return (\n    <div>\n      <EditorChangeState />\n    </div>\n  );\n};\n\nconst SubMenuBackground = () => {\n  const dispatch = useDispatch();\n  const image = useSelector((state: Editor) => {\n    return state.ui.background.image;\n  });\n\n  const { position, scale, opacity } = image;\n  const onChange_clear = () => {\n    dispatch(Actions.Topbar.action_background_image_clear());\n  };\n  const onChange_upload = event => {\n    const selectedFiles: FileList = event.target.files;\n    const files = Array.from(selectedFiles);\n    if (files.length === 0) {\n      console.error(\"no files selected\");\n      return;\n    }\n    let file = files[0];\n    const types = [\"image/png\", \"image/jpeg\", \"image/gif\"];\n    if (types.every(type => file.type !== type)) {\n      console.error(`'${file.type}' is not a supported format`);\n      return;\n    }\n    if (file.size > 1 * 1024 * 1024) {\n      console.error(`'${file.name}' is too large, please pick a smaller file`);\n      return;\n    }\n    let reader = new FileReader();\n    reader.onloadend = () => {\n      dispatch(Actions.Topbar.action_background_image_upload(reader.result));\n    };\n    reader.readAsDataURL(file);\n    event.preventDefault();\n  };\n  const onChange_pointX = value => {\n    dispatch(Actions.Topbar.action_background_image_pointX(value));\n  };\n  const onChange_pointY = value => {\n    dispatch(Actions.Topbar.action_background_image_pointY(value));\n  };\n  const onChange_scale = value => {\n    dispatch(Actions.Topbar.action_background_image_scale(value));\n  };\n  const onChange_opacity = value => {\n    dispatch(Actions.Topbar.action_background_image_opacity(value));\n  };\n  return (\n    <div\n      style={{ flexWrap: \"nowrap\", display: \"flex\", alignItems: \"flex-start\" }}\n    >\n      <div style={{ flexWrap: \"nowrap\", display: \"flex\", marginTop: \"4px\" }}>\n        <div className=\"control\">\n          <div className={` button is-light `} onClick={onChange_clear}>\n            <span>Clear</span>\n          </div>\n        </div>\n\n        <div className=\"control\">\n          <div className={` button is-light `} style={{ position: \"relative\" }}>\n            <input\n              type=\"file\"\n              onChange={onChange_upload}\n              style={{\n                position: \"absolute\",\n                top: 0,\n                left: 0,\n                width: \"100%\",\n                height: \"100%\",\n                opacity: 0,\n                zIndex: 2\n              }}\n            />\n            <span>Upload</span>\n          </div>\n        </div>\n      </div>\n\n      <div\n        style={{\n          display: \"flex\",\n          marginLeft: \"10px\",\n          marginRight: \"10px\",\n          flexWrap: \"nowrap\",\n          alignItems: \"flex-start\"\n        }}\n      >\n        <div\n          className={\"fieldset\"}\n          style={{\n            width: \"100px\",\n            whiteSpace: \"nowrap\",\n            flexWrap: \"nowrap\",\n            display: \"flex\",\n            alignItems: \"flex-start\"\n          }}\n        >\n          <div\n            className=\"label\"\n            style={{ whiteSpace: \"nowrap\" }}\n          >{`Scale: ${scale}`}</div>\n        </div>\n        <div style={{ width: \"100px\", marginLeft: \"20px\", marginTop: \"13px\" }}>\n          <SliderWithTooltip\n            max={16}\n            min={0.2}\n            step={0.1}\n            value={scale}\n            onChange={value => onChange_scale(value)}\n            defaultValue={1}\n            // marks={{\n            //   0.2: \"0.2\",\n            //   4: \"4\",\n            //   8: \"8\",\n            // }}\n          />\n        </div>\n      </div>\n\n      <BackgroundPosition\n        pointX={position.x}\n        onChange_pointX={onChange_pointX}\n        pointY={position.y}\n        onChange_pointY={onChange_pointY}\n      />\n\n      <div\n        style={{\n          display: \"flex\",\n          marginLeft: \"10px\",\n          marginRight: \"10px\",\n          flexWrap: \"nowrap\",\n          alignItems: \"flex-start\"\n        }}\n      >\n        <div className={\"fieldset\"} style={{ width: \"85px\" }}>\n          <div\n            className=\"label\"\n            style={{ flexWrap: \"nowrap\", whiteSpace: \"nowrap\" }}\n          >\n            Opacity: {opacity}\n          </div>\n        </div>\n        <div style={{ width: \"80px\", marginLeft: \"10px\", marginTop: \"13px\" }}>\n          <SliderWithTooltip\n            max={1}\n            min={0}\n            step={0.1}\n            value={opacity}\n            onChange={value => onChange_opacity(value)}\n            defaultValue={1}\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst BackgroundPosition = ({\n  pointX,\n  onChange_pointX,\n  pointY,\n  onChange_pointY\n}) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\"\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Image position: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={999}\n          min={-999}\n          maxLength={3}\n          value={pointX}\n          onValueChange={event => {\n            onChange_pointX(event.floatValue);\n          }}\n          placeholder=\"x\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\"\n          }}\n        />\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={999}\n          min={-999}\n          maxLength={3}\n          value={pointY}\n          onValueChange={event => {\n            onChange_pointY(event.floatValue);\n          }}\n          placeholder=\"y\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\"\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nconst SubMenuGrid = () => {\n  const dispatch = useDispatch();\n  const grid = useSelector((state: Editor) => {\n    return state.ui.grid;\n  });\n\n  const { height, width, hexSize, type, snapEnabled, isVisible } = grid;\n  const onChange_isVisible = () => {\n    dispatch(Actions.Topbar.action_toggleGridIsVisible());\n  };\n  const onChange_snapEnabled = () => {\n    dispatch(Actions.Topbar.action_toggleGridSnapEnabled());\n  };\n  const onChange_gridItemW = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridWidth(newValue));\n  };\n  const onChange_gridItemH = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridHeight(newValue));\n  };\n  const onClick_selectTypeHex = () => {\n    dispatch(Actions.Topbar.action_setGridType(EditorGridType.Hex));\n  };\n  const onClick_selectTypeBox = () => {\n    dispatch(Actions.Topbar.action_setGridType(EditorGridType.Box));\n  };\n  const onChange_hexSize = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 1;\n      return;\n    }\n    if (newValue < 1) {\n      newValue = 1;\n    }\n    if (newValue > 100) {\n      newValue = 100;\n    }\n    dispatch(Actions.Topbar.action_setGridHexSize(newValue));\n  };\n\n  return (\n    <div style={{ display: \"flex\", flexWrap: \"nowrap\", alignItems: \"center\" }}>\n      <GridOptions\n        isVisible={isVisible}\n        onChange_isVisible={onChange_isVisible}\n        snapEnabled={snapEnabled}\n        onChange_snapEnabled={onChange_snapEnabled}\n        type={type}\n        onClick_selectTypeHex={onClick_selectTypeHex}\n        onClick_selectTypeBox={onClick_selectTypeBox}\n      />\n\n      {type === EditorGridType.Box ? (\n        <GridBoxSettings\n          gridItemW={width}\n          onChange_gridItemW={onChange_gridItemW}\n          gridItemH={height}\n          onChange_gridItemH={onChange_gridItemH}\n        />\n      ) : null}\n\n      {type === EditorGridType.Hex ? (\n        <GridHexSettings\n          hexSize={hexSize}\n          onChange_hexSize={onChange_hexSize}\n        />\n      ) : null}\n    </div>\n  );\n};\n\nconst GridOptions = ({\n  isVisible,\n  onChange_isVisible,\n  snapEnabled,\n  onChange_snapEnabled,\n  type,\n  onClick_selectTypeHex,\n  onClick_selectTypeBox\n}) => {\n  return (\n    <React.Fragment>\n      <div\n        style={{\n          marginRight: \"15px\"\n        }}\n      >\n        <FieldCheckbox\n          label={\"Show grid\"}\n          value={isVisible}\n          onChange={onChange_isVisible}\n          isDisabled={false}\n        />\n      </div>\n\n      <div\n        style={{\n          marginRight: \"15px\"\n        }}\n      >\n        <FieldCheckbox\n          label={\"Snap to grid\"}\n          value={snapEnabled}\n          onChange={onChange_snapEnabled}\n          isDisabled={false}\n        />\n      </div>\n\n      <div\n        style={{\n          marginRight: \"15px\"\n        }}\n      >\n        <div className={\"fieldset\"}>\n          <div className=\"label\">Grid type: </div>\n          <div className=\"control\">\n            <div\n              className={` button is-light ${\n                type === EditorGridType.Hex ? \"is-dark\" : \"\"\n              } `}\n              onClick={onClick_selectTypeHex}\n            >\n              <span>Hexagon</span>\n            </div>\n          </div>\n\n          <div className=\"control\">\n            <div\n              className={` button is-light ${\n                type === EditorGridType.Box ? \"is-dark\" : \"\"\n              }`}\n              onClick={onClick_selectTypeBox}\n            >\n              <span>Rectangle</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </React.Fragment>\n  );\n};\n\nconst GridBoxSettings = ({\n  gridItemW,\n  onChange_gridItemW,\n  gridItemH,\n  onChange_gridItemH\n}) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\"\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Grid size: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={1}\n          maxLength={2}\n          value={gridItemW}\n          onValueChange={event => {\n            onChange_gridItemW(event.floatValue);\n          }}\n          placeholder=\"width\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\"\n          }}\n        />\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={1}\n          maxLength={2}\n          value={gridItemH}\n          onValueChange={event => {\n            onChange_gridItemH(event.floatValue);\n          }}\n          placeholder=\"height\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\"\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n\nconst GridHexSettings = ({ hexSize, onChange_hexSize }) => {\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        flexWrap: \"nowrap\",\n        alignItems: \"center\",\n        marginRight: \"15px\"\n      }}\n    >\n      <div className={\"fieldset\"}>\n        <div className=\"label\">Hex size: </div>\n\n        <NumberFormat\n          allowNegative={false}\n          allowEmptyFormatting={true}\n          max={99}\n          min={5}\n          maxLength={2}\n          value={hexSize}\n          onValueChange={event => {\n            onChange_hexSize(event.floatValue);\n          }}\n          placeholder=\"width\"\n          style={{\n            color: \"#4a4a4a\",\n            textAlign: \"center\",\n            border: \"1px solid #aeaeae\",\n            fontFamily: \"Open Sans, sans-serif\",\n            fontSize: \"13px\",\n            fontWeight: 400,\n            lineHeight: \"1.5\",\n            padding: \"0px 10px\",\n            marginBottom: \"0px\",\n            marginTop: \"0px\",\n            maxWidth: \"70px\",\n            marginRight: \"5px\"\n          }}\n        />\n      </div>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { uiButton } from \"../../colors\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faArrowsAlt } from \"@fortawesome/free-solid-svg-icons\";\nimport { FieldSlider } from \"./FieldSlider\";\nimport { ToolbarFieldSet } from \"./ToolbarFieldSet\";\n\nexport const FieldsetSize = ({ value, onChange }) => {\n  return (\n    <ToolbarFieldSet\n      selected={value}\n      label={\"Size\"}\n      icon={<FontAwesomeIcon icon={faArrowsAlt} color={uiButton} size={\"lg\"} />}\n    >\n      <FieldSlider value={value} onChange={onChange} />\n    </ToolbarFieldSet>\n  );\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { Actions } from \"../../../immerReducers/store\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetSize } from \"../ui/FieldsetSize\";\n\nexport const ToolbarPaint = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BrushSize />\n      <BrushColor />\n    </React.Fragment>\n  );\n};\n\nconst BrushSize = () => {\n  const dispatch = useDispatch();\n  const size = useSelector((state: Editor) => {\n    return state.ui.brush.size;\n  });\n\n  if (!size) {\n    return <React.Fragment />;\n  }\n\n  const onChange = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_updateBrushSize(newValue));\n  };\n\n  return <FieldsetSize value={size} onChange={onChange} />;\n};\n\nconst BrushColor = () => {\n  const dispatch = useDispatch();\n  const color = useSelector((state: Editor) => {\n    return state.ui.brush.color;\n  });\n\n  if (!color) {\n    return <React.Fragment />;\n  }\n\n  const onChange = color => {\n    dispatch(Actions.Toolbar.action_updateBrushColor(color));\n  };\n\n  return <FieldsetColor onChange={onChange} value={color} />;\n};\n","import React from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { Editor } from \"../../../editorObjects/Editor\";\nimport { FieldBeadPreview } from \"../ui/FieldBeadPreview\";\nimport { Actions } from \"../../../immerReducers/store\";\n// import { FieldsetWidth } from \"../ui/FieldsetWidth\";\n// import { FieldsetHeight } from \"../ui/FieldsetHeight\";\nimport { FieldsetColor } from \"../ui/FieldsetColor\";\nimport { FieldsetBeadType } from \"../ui/FieldsetBeadType\";\nimport { FieldsetWidthAndHeight } from \"../ui/FieldsetWidthAndHeight\";\nimport { FieldsetBeadRotate } from \"../ui/FieldsetBeadRotate\";\nimport { buildBead } from \"../../../editorObjects/Bead\";\n\nexport const ToolbarAddBeads = ({ isVisible }) => {\n  if (isVisible === true) {\n    return <Content />;\n  }\n\n  return <React.Fragment />;\n};\n\nconst Content = () => {\n  return (\n    <React.Fragment>\n      <BeadPreview />\n      <BeadSize />\n      <BeadColor />\n      <BeadType />\n      <BeadsRotate />\n    </React.Fragment>\n  );\n};\n\nconst BeadsRotate = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onChange_beadsRotate = value => {\n    let newValue = value;\n    if (value === undefined || value === null || isNaN(value) === true) {\n      newValue = 0;\n    }\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"rotate\", newValue));\n  };\n\n  return (\n    <FieldsetBeadRotate\n      value={beadsTemplate.rotate}\n      onChange={onChange_beadsRotate}\n    />\n  );\n};\n\nconst BeadSize = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onChange_beadWidth = value => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"width\", value));\n  };\n\n  const onChange_beadHeight = value => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"height\", value));\n  };\n\n  const onChange_keepAspectRatio = value => {\n    dispatch(\n      Actions.Toolbar.action_updateBeadsTemplate(\"keepAspectRatio\", value)\n    );\n  };\n\n  const width = beadsTemplate.width ? beadsTemplate.width : 10;\n  const height = beadsTemplate.height ? beadsTemplate.height : 10;\n  const keepAspectRatio = beadsTemplate.keepAspectRatio\n    ? beadsTemplate.keepAspectRatio\n    : false;\n\n  return (\n    <div>\n      <FieldsetWidthAndHeight\n        height={height}\n        width={width}\n        keepAspectRatio={keepAspectRatio}\n        onChange_beadHeight={onChange_beadHeight}\n        onChange_beadWidth={onChange_beadWidth}\n        onChange_keepAspectRatio={onChange_keepAspectRatio}\n      />\n    </div>\n  );\n};\n\nconst BeadType = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onSelect = type => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"type\", type));\n  };\n\n  return <FieldsetBeadType onChange={onSelect} value={beadsTemplate.type} />;\n};\n\nconst BeadColor = () => {\n  const dispatch = useDispatch();\n\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const onSelect = color => {\n    dispatch(Actions.Toolbar.action_updateBeadsTemplate(\"color\", color));\n  };\n\n  return <FieldsetColor onChange={onSelect} value={beadsTemplate.color} />;\n};\n\nconst BeadPreview = () => {\n  const beadsTemplate = useSelector((state: Editor) => {\n    return state.ui.beadsTemplate;\n  });\n\n  const bead = buildBead(beadsTemplate);\n\n  return <FieldBeadPreview bead={bead} />;\n};\n","import React, { useRef, useState } from \"react\";\nimport { Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { EditorModes } from \"./Toolbar/EditorModes\";\n// import { AddLineMode } from \"./Line/AddLineMode\";\n// import { EditorChangeState } from \"./Toolbar/EditorChangeState\";\nimport { useSelector, useStore, useDispatch } from \"react-redux\";\nimport { MouseSelectionBeads } from \"./Bead/MouseSelectionBeads\";\n// import { MouseSelectionLines } from \"./Line/MouseSelectionLines\";\nimport { DisplayBeads } from \"./Bead/DisplayBeads\";\n// import { DisplayLines } from \"./Line/DisplayLines\";\nimport { GroupSelectionPlaceholder } from \"./operations/GroupSelectionPlaceholder\";\n// import { PickBeadColor } from \"./Toolbar/PickColor\";\n// import { ChangeLinePosition } from \"./Toolbar/ChangeLinePosition\";\n// import { PickBeadType } from \"./Toolbar/PickBeadType\";\n// import { ChangeBeadRotate } from \"./Toolbar/ChangeBeadRotate\";\n// import { LineInspector } from \"./Toolbar/LineInspector\";\n// import { Actions } from \"../store\";\n// import { EditToolbar } from \"./Toolbar/EditToolbar\";\n// import { ToolbarEditLines } from \"./Toolbar/Modes/ToolbarEditLines\";\nimport { ToolbarEditBeads } from \"./Toolbar/Modes/ToolbarEditBeads\";\n// import { ToolbarAddLine } from \"./Toolbar/Modes/ToolbarAddLine\";\nimport { ToolbarIdle } from \"./Toolbar/Modes/ToolbarIdle\";\nimport { DisplayGridLines } from \"./operations/DisplayGridLines\";\nimport { TopbarMain } from \"./Topbar/TopbarMain\";\nimport { TopbarSecoundary } from \"./Topbar/TopbarSecoundary\";\nimport { Brush } from \"./operations/Brush\";\nimport { ToolbarPaint } from \"./Toolbar/Modes/ToolbarPaint\";\nimport { BackgroundImage } from \"./operations/BackgroundImage\";\nimport { AddBeadsMode } from \"./Bead/AddBeadsMode\";\nimport { ToolbarAddBeads } from \"./Toolbar/Modes/ToolbarAddBeads\";\nimport { PanZoom } from \"react-easy-panzoom\";\nimport { Actions } from \"../immerReducers/store\";\nimport { ReactReduxContext } from \"react-redux\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport styled from \"styled-components\";\n\nexport const EditorScene = () => {\n  const dispatch = useDispatch();\n  const editorMode = useSelector((state: Editor) => {\n    return state.mode;\n  });\n  const store = useStore();\n  const state = store.getState();\n  console.log(\"EditorRerender: \", state);\n\n  // @TODO: Dodac funkcje ktora zostaje uruchomiona po rozpoczeciu aplikajci\n  // const dispatch = useDispatch();\n  // const [firstPass, setFirstPass] = useState(false);\n  // useEffect(() => {\n  //   if (process.env.NODE_ENV && process.env.NODE_ENV === \"development\") {\n  //     if (firstPass === false) {\n  //       dispatch(Actions.Persist.action_readSavedCanvas());\n  //       // dispatch(\n  //       //   Actions.ChangeEditorMode.action_onChangeEditorMode(\n  //       //     EditorMode.EditLines\n  //       //   )\n  //       // );\n  //       // dispatch(Actions.Draggable.action_onClickLastestLine());\n  //       setFirstPass(true);\n  //     }\n  //   }\n  // });\n\n  const panZoomRef = useRef<any>(null);\n\n  if (!state) {\n    return <div>Error in app</div>;\n  }\n\n  // const preventPan = (event, x, y) => {\n  //   console.log('??', event, x, y)\n  //   return true;\n  // }\n\n  const onStateChange = (event) => {\n    if (panZoomRef && panZoomRef.current !== null) {\n      const boundingClientRect = panZoomRef.current.getContainerBoundingRect();\n      dispatch(\n        Actions.Draggable.action_updateSceneZoom({\n          ...event,\n          top: boundingClientRect.top,\n          left: boundingClientRect.left,\n        })\n      );\n    } else {\n      dispatch(\n        Actions.Draggable.action_updateSceneZoom({\n          ...event,\n          top: 0,\n          left: 0,\n        })\n      );\n    }\n  };\n  const onResizeSceneWrapper = (width, height) => {\n    dispatch(\n      Actions.Draggable.action_updateSceneWrapperSize({\n        width,\n        height,\n      })\n    );\n  };\n\n  // const updatePosition = (event) => {\n  //   dispatch(Actions.Draggable.action_updatePanZoomWrapperRect(event));\n  // }\n\n  return (\n    <div className=\"scene\">\n      <div className=\"topbar-wrapper\">\n        <TopbarMain />\n        <TopbarSecoundary />\n      </div>\n\n      <div className=\"actions-wrapper\">\n        <EditorModes editorMode={editorMode} />\n      </div>\n\n      <div className={\"scene-wrapper\"}>\n        <ReactResizeDetector\n          handleWidth\n          handleHeight\n          skipOnMount={false}\n          onResize={onResizeSceneWrapper}\n        />\n        {/* <PanZoom\n          style={{ width: \"100%\", height: \"100%\", position: \"absolute\" }}\n          disabled={editorMode !== EditorMode.Idle}\n          ref={panZoomRef}\n          onStateChange={onStateChange}\n          keyMapping={{\n            \"87\": { x: 0, y: -1, z: 0 },\n            \"83\": { x: 0, y: 1, z: 0 },\n            \"65\": { x: -1, y: 0, z: 0 },\n            \"68\": { x: 1, y: 0, z: 0 }\n          }}\n        >\n          <div>{`This content can be panned and zoomed.`}</div>\n          <BackgroundImage />\n\n          <AddBeadsMode isActive={editorMode === EditorMode.AddBeads} />\n\n          <MouseSelectionBeads\n            isVisible={editorMode === EditorMode.EditBeads}\n          />\n\n          <DisplayBeads mode={editorMode} />\n\n         \n\n          <DisplayGridLines isVisible={editorMode === EditorMode.EditLines} />\n\n          <GroupSelectionPlaceholder mode={editorMode} />\n\n          <Brush isVisible={editorMode === EditorMode.PaintBeads} />\n        </PanZoom> */}\n        {/* <DisplayLines mode={editorMode} /> */}\n        {/* <AddLineMode isActive={editorMode === EditorMode.AddLine} /> */}\n\n        {/* <MouseSelectionLines isVisible={editorMode === EditorMode.EditLines} /> */}\n      </div>\n\n      <div className={\"toolbar-wrapper\"}>\n        <ToolBarStyles>\n          {/* <ToolbarEditLines isVisible={editorMode === EditorMode.EditLines} /> */}\n          <ToolbarEditBeads isVisible={editorMode === EditorMode.EditBeads} />\n          {/* <ToolbarAddLine isVisible={editorMode === EditorMode.AddLine} /> */}\n          <ToolbarIdle isVisible={editorMode === EditorMode.Idle} />\n          <ToolbarPaint isVisible={editorMode === EditorMode.PaintBeads} />\n          <ToolbarAddBeads isVisible={editorMode === EditorMode.AddBeads} />\n\n          <Lights />\n          {/* <ChangeLinePosition mode={editorMode} />\n\n        <PickBeadType mode={editorMode} />\n        <ChangeBeadRotate mode={editorMode} />\n        <PickBeadColor mode={editorMode} />\n        <LineInspector mode={editorMode} />\n\n        <EditToolbar mode={editorMode} /> */}\n        </ToolBarStyles>\n      </div>\n    </div>\n  );\n};\n\nconst ToolBarStyles = styled.div`\n  .fieldset {\n    /* border-top: 1px solid #dfdfdf;\n  border-bottom: 1px solid #dfdfdf; */\n    padding-bottom: 5px;\n    padding-top: 5px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n  }\n\n  .fieldset .label {\n    font-family: \"Open Sans\", sans-serif;\n    font-size: 16px;\n    line-height: 30px;\n    font-weight: 300;\n    padding: 0;\n    margin: 0;\n    padding-left: 10px;\n    padding-right: 10px;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    align-items: center;\n  }\n\n  .fieldset .input {\n    border: none;\n    background: none;\n    border-bottom: 1px solid #dfdfdf;\n    color: #6e6e6e;\n    font-size: 14px;\n    line-height: 30px;\n    font-family: \"Open Sans\", sans-serif;\n    box-shadow: none;\n    max-width: 200px;\n    padding: 0;\n    margin: 0;\n  }\n\n  .fieldset .input[type=\"number\"] {\n    max-width: 50px;\n  }\n`;\n\n// class PanZoomWrapper extends React.Component<{ children, updatePosition }> {\n//   htmlDivInstance: HTMLDivElement | null = null;\n//   componentDidMount() {\n//     if (this.htmlDivInstance !== null) {\n//       const boundingClientRect = this.htmlDivInstance.getBoundingClientRect();\n//       this.props.updatePosition(boundingClientRect);\n//     }\n//   }\n//   render() {\n//     return (\n//       <div ref={refInstance => this.htmlDivInstance = refInstance}>\n//         {this.props.children}\n//       </div>\n//     )\n//   }\n// }\n\nconst Lights: React.FC<{}> = (props) => {\n  const dispatch = useDispatch();\n  const lights = useSelector((state: Editor) => {\n    return state.ui.lights;\n  });\n  return (\n    <LightsStyles>\n      <div className={\"toolbar-lights\"}>\n        {lights.map((l, index) => {\n          const onChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n            const newValue = Number(event.target.value) / 100;\n            console.log(\"co mam?\", newValue);\n            dispatch(\n              Actions.Toolbar.action_updateLight(index, \"intensity\", newValue)\n            );\n          };\n          return (\n            <div key={l.name} className={\"light\"}>\n              <div className={\"info\"}>{JSON.stringify(l)}</div>\n              <div className={\"fields\"}>\n                <fieldset>\n                  <label>intensity: </label>\n                  <input\n                    type=\"range\"\n                    name={`${l.name}_${l.intensity}`}\n                    value={(l.intensity ?? 0) * 100}\n                    onChange={onChange}\n                    min=\"1\"\n                    max=\"99\"\n                    step=\"1\"\n                  />\n                </fieldset>\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </LightsStyles>\n  );\n};\nconst LightsStyles = styled.div`\n  .toolbar-lights {\n    background: #ddd;\n    width: 100%;\n    border: none;\n    box-sizing: border-box;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n  }\n  .light {\n    border: 1px solid #000;\n    border-radius: 3px;\n    margin-bottom: 10px;\n    padding: 10px;\n  }\n  .light .info {\n    font-size: 11px;\n    line-height: 13px;\n    display: block;\n    margin-bottom: 5px;\n    width: 100%;\n    overflow: hidden;\n    word-break: break-all;\n    white-space: pre-line;\n  }\n  .light .fields {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  .light .fields fieldset {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    column-gap: 10px;\n  }\n`;\n","import { appStore } from \"./../immerReducers/appStore\";\nimport { Actions } from \"../immerReducers/store\";\nimport { generate } from \"shortid\";\n\n// import { EditorMode } from \"../editorObjects/Editor\";\n// import { setInterval } from \"timers\";\n// import RoundedBoxGeometry from './RoundedBoxGeometry'\n\nimport * as THREE from \"three\";\nimport { Bead, BeadTypes, Editor, EditorMode } from \"../editorObjects/Editor\";\nimport { buildPoint, contain } from \"../editorObjects/Point\";\nimport { Vector2, BoxGeometry, SphereGeometry } from \"three\";\nimport { getEventEmitter } from \"../EventEmitter\";\nimport _ from \"lodash\";\n// import RoundedBoxGeometryInstance from \"./RoundedBoxGeometry\";\n\n// import {} from 'three/build/'\n// import * as THREE from \"../build/three.module.js\";\n\n// import Stats from \"./stats.module.js\";\n// import { GUI } from \"./dat.gui.module.js\";\n// import { OrbitControls } from \"./OrbitControls.js\";\nvar RoundedBoxGeometry = require(\"./RoundedBoxGeometry\")(THREE);\n\nexport const renderThreejs = (el: HTMLElement | null) => {\n  // console.log(\"renderThreejs?\", el, appStore);\n\n  initCanvasApp(el);\n};\n\nconst initCanvasApp = (el: HTMLElement | null) => {\n  var camera: THREE.OrthographicCamera,\n    scene: THREE.Scene,\n    renderer: THREE.WebGLRenderer;\n\n  // var mesh: THREE.InstancedMesh;\n  // var amount = 10;\n  // var count = Math.pow(amount, 3);\n\n  // var raycaster = new THREE.Raycaster();\n  var mouse_intercestion = new THREE.Vector2(1, 1);\n  // var mouse_2d = new THREE.Vector2(1, 1);\n\n  var rotationMatrix = new THREE.Matrix4().multiplyMatrices(\n    new THREE.Matrix4().makeRotationY(0.05),\n    new THREE.Matrix4().makeRotationZ(0.03)\n  );\n  // var rotationMatrix = new THREE.Matrix4().makeRotationZ(0.1);\n  // var instanceMatrix = new THREE.Matrix4();\n  // var matrix = new THREE.Matrix4();\n  const z_index = 100;\n  const intensivity = 1;\n  const distance = 900;\n  const color = 0xffffff;\n  const reflectivity = 1;\n\n  // const mouseSelection = {\n  //   isDragStarted: false,\n  //   isDragged: false,\n  //   start: { x: 0, y: 0 },\n  //   end: { x: 0, y: 0 }\n  // };\n\n  const eventEmitter = getEventEmitter();\n\n  const mouseSelectionBeads = new MouseSelection();\n  const mouseSelectionHelper = new MouseSelectionHelper();\n\n  init();\n  animate();\n\n  // eventEmitter.on(\n  //   \"IMMER_REDUCER:DraggableOperationsImmerReducer#action_updateSceneWrapperSize\",\n  //   (data: any) => {\n  //     console.log(\"odebranooo...\", data);\n  //   }\n  // );\n\n  // eventEmitter.on(\n  //   \"IMMER_REDUCER:DraggableOperationsImmerReducer#action_addBeadOnClick\",\n  //   (data: { x: number; y: number }) => {\n  //     console.log(\"dodaje nowy item...\", data);\n\n  //     // scene\n  //   }\n  // );\n\n  // eventEmitter.on(\n  //   \"IMMER_REDUCER:ChangeEditorModeImmerReducer#action_onChangeEditorMode\",\n  //   (data: EditorMode) => {\n  //     console.log(\"ustawiam mode na\", data);\n  //   }\n  // );\n\n  eventEmitter.on(\"action_changeSelectedBeads_color\", (data) => {\n    data.beadIds.forEach((id) => {\n      const child = scene.getObjectByName(id) as THREE.Mesh | undefined;\n      if (child === undefined) {\n        return;\n      }\n\n      (child.material as THREE.MeshPhysicalMaterial).color.set(data.color);\n    });\n  });\n\n  eventEmitter.on(\"action_selectBeads\", (data) => {\n    data.diffStates.forEach((bead) => {\n      const id = Object.keys(bead)[0];\n      const value = Object.values(bead)[0];\n      const child = scene.getObjectByName(id) as THREE.Mesh | undefined;\n      if (child === undefined) {\n        return;\n      }\n\n      if (value === true) {\n        (child.material as THREE.MeshPhysicalMaterial).emissive.set(0x171717);\n      } else {\n        (child.material as THREE.MeshPhysicalMaterial).emissive.set(0);\n      }\n    });\n  });\n\n  // beads.forEach((beadId, index) => {\n  //     const bead = state.appData.beads[beadId];\n  //     // console.log(\"renderBeads: add bead?\", bead);\n  //     // var transform = new THREE.Object3D();\n  //     // var shape = new THREE.SphereBufferGeometry(20)\n  //     // var transform = new RoundedBoxGeometry(50, 90, 40, 100, 10);\n  //     var transform = new THREE.Object3D();\n  //     transform.position.set(bead.position.x, bead.position.y, 0);\n  //     transform.updateMatrix();\n\n  //     let isSelected = false;\n\n  //     if (state.ui.selectedBeadsIdsCount > 0) {\n  //       isSelected = Object.keys(state.ui.selectedBeadsIds).includes(bead.id);\n  //     }\n\n  //     //  width, height, depth, radius, radiusSegments\n  //     // var geometry = new RoundedBoxGeometry(\n  //     //   bead.width,\n  //     //   bead.height,\n  //     //   Math.max(bead.width, bead.height),\n  //     //   bead.type === BeadTypes.BasicEllipse\n  //     //     ? Math.max(bead.width, bead.height)\n  //     //     : 0,\n  //     //   bead.type === BeadTypes.BasicEllipse\n  //     //     ? Math.max(bead.width, bead.height)\n  //     //     : 0\n  //     // );\n  //     // var geometry = new BoxGeometry(bead.width, bead.height, 10);\n  //     var geometry = new SphereGeometry(\n  //       Math.max(bead.width, bead.height),\n  //       32,\n  //       32\n  //     );\n  // var material = new THREE.MeshPhysicalMaterial({\n  //        flatShading: true,\n  //        reflectivity: reflectivity,\n  //        color: bead.color,\n  //      });\n  // if (isSelected) {\n  // -        material.emissive.set(0x888888);\n  //   -      // var geometry = new THREE.SphereBufferGeometry(20);\n  // -      // geometry.applyMatrix(transform.matrixWorld)\n  // -      // var material = new THREE.MeshBasicMaterial({ color: \"rgb(25, 118, 210)\" });\n  // -      var beadMesh = new THREE.Mesh(geometry, material);\n  // -      beadMesh.applyMatrix(new THREE.Matrix4().makeRotationZ(bead.rotate));\n  // -      beadMesh.applyMatrix(\n  // -        new THREE.Matrix4().makeTranslation(bead.position.x, bead.position.y, 0)\n  // -      );\n  // -      beadMesh.name = bead.id;\n  // -      basicMesh.push(beadMesh);\n  // -      scene.add(beadMesh);\n  // -\n  // -      // shape.applyMatrix(transform);\n  // -      // basicMesh.add(shape);\n  // -      // mesh.setMatrixAt(i++, transform.matrix);\n  // -      // mesh.matrixWorldNeedsUpdate = true;\n  // -    });\n\n  eventEmitter.on(\"action_addBeadOnClick\", (data) => {\n    // console.log(\"addBeadOnClick: ...\", );\n    const bead = data.bead as Bead;\n    const geometry = new SphereGeometry(\n      Math.max(bead.width, bead.height),\n      10,\n      10\n    );\n\n    geometry.mergeVertices();\n    geometry.computeVertexNormals();\n\n    const material = new THREE.MeshPhysicalMaterial({\n      flatShading: true,\n      reflectivity: reflectivity,\n      color: bead.color,\n    });\n    const beadMesh = new THREE.Mesh(geometry, material);\n    beadMesh.applyMatrix(\n      new THREE.Matrix4().makeRotationX(THREE.Math.DEG2RAD * 90)\n    );\n    beadMesh.applyMatrix(\n      new THREE.Matrix4().makeRotationZ(THREE.Math.DEG2RAD * bead.rotate)\n    );\n    beadMesh.applyMatrix(\n      new THREE.Matrix4().makeTranslation(bead.position.x, bead.position.y, 0)\n    );\n    basicMesh.push(beadMesh);\n    beadMesh.name = bead.id;\n    scene.add(beadMesh);\n  });\n\n  eventEmitter.on(\"action_updateLight\", (data: { name; field; value }) => {\n    console.log(\"co jest?\", data);\n\n    const light = scene.getObjectByName(data.name) as THREE.DirectionalLight | undefined;\n    if(light !== undefined){\n      if(data.field === \"color\"){\n        light.color = data.value\n      }\n      if(data.field === \"intensity\"){\n        light.intensity = data.value\n      }\n    }\n    // console.log('co to za swiatlo??', li)\n  });\n\n  eventEmitter.on(\"action_readSavedCanvas\", (data) => {});\n\n  eventEmitter.on(\"action_readSavedCanvas\", (data) => {\n    Object.keys(data.beads).forEach((id) => {\n      const bead = data.beads[id] as Bead;\n      const geometry = new SphereGeometry(\n        Math.max(bead.width, bead.height),\n        10,\n        10\n      );\n\n      geometry.mergeVertices();\n      geometry.computeVertexNormals();\n\n      const material = new THREE.MeshPhysicalMaterial({\n        flatShading: true,\n        reflectivity: reflectivity,\n        color: bead.color,\n      });\n      const beadMesh = new THREE.Mesh(geometry, material);\n      beadMesh.applyMatrix(\n        new THREE.Matrix4().makeRotationX(THREE.Math.DEG2RAD * 90)\n      );\n      beadMesh.applyMatrix(\n        new THREE.Matrix4().makeRotationZ(THREE.Math.DEG2RAD * bead.rotate)\n      );\n      beadMesh.applyMatrix(\n        new THREE.Matrix4().makeTranslation(bead.position.x, bead.position.y, 0)\n      );\n      basicMesh.push(beadMesh);\n      beadMesh.name = bead.id;\n      scene.add(beadMesh);\n    });\n  });\n\n  eventEmitter.on(\"startAppEvent\", (data: { state: Editor }) => {\n    console.log(\"startAppEvent: ...\", data.state.ui.lights);\n    if (data.state.ui.lights && data.state.ui.lights.length > 0) {\n      data.state.ui.lights.forEach((l) => {\n        if (l.type === \"THREE.DirectionalLight\") {\n          const light = new THREE.DirectionalLight(l.color, l.intensity);\n          light.position.set(\n            l.position?.x ?? 0,\n            l.position?.y ?? 0,\n            l.position?.z ?? 10\n          );\n          light.name = l.name;\n          scene.add(light);\n        }\n      });\n    }\n\n    // const { getState } = appStore;\n    // const state = getState();\n    // console.log(\"renderBeads: subscribe event \");\n\n    // scene.dispose();\n    // scene.remove(mesh);\n\n    // while (basicMesh.length) {\n    //   while (basicMesh[0].children.length) {\n    //     basicMesh[0].remove(basicMesh[0].children[0]);\n    //   }\n    //   basicMesh.shift();\n    // }\n\n    // while (scene.children.length > 0) {\n    //   scene.remove(scene.children[0]);\n    // }\n\n    // var light1 = new THREE.DirectionalLight(0xffffff, 1);\n    // light1.position.set(0, 0, 1);\n    // scene.add(light1);\n\n    // var light2 = new THREE.PointLight(color, intensivity, distance);\n    // light2.position.set(-300, -300, z_index);\n    // scene.add(light2);\n\n    // var light1 = new THREE.PointLight(color, intensivity, distance);\n    // light1.position.set(-300, 300, z_index);\n    // scene.add(light1);\n\n    // var light2 = new THREE.PointLight(color, intensivity, distance);\n    // light2.position.set(-300, -300, z_index);\n    // scene.add(light2);\n\n    // var light3 = new THREE.PointLight(color, intensivity, distance);\n    // light3.position.set(300, 300, z_index);\n    // scene.add(light3);\n\n    // var light4 = new THREE.PointLight(color, intensivity, distance);\n    // light4.position.set(300, -300, z_index);\n    // scene.add(light4);\n\n    // var light4 = new THREE.PointLight(color, 0.4, distance);\n    // light4.position.set(0, 0, z_index);\n    // scene.add(light4);\n\n    // var bg_geometry = new THREE.PlaneGeometry(1000, 1000, 1);\n    // var bg_material = new THREE.MeshBasicMaterial({\n    //   color: \"#ccc\",\n    //   side: THREE.DoubleSide,\n    // });\n\n    // var bg_plane = new THREE.Mesh(bg_geometry, bg_material);\n    // scene.add(bg_plane);\n\n    // const beads = Object.keys(state.appData.beads);\n\n    // mesh.count = beads.length;\n\n    // console.log(\"renderBeads: count?\", beads.length);\n\n    // var i = 0;\n    // beads.forEach((beadId, index) => {\n    //   const bead = state.appData.beads[beadId];\n    //   // console.log(\"renderBeads: add bead?\", bead);\n    //   // var transform = new THREE.Object3D();\n    //   // var shape = new THREE.SphereBufferGeometry(20)\n    //   // var transform = new RoundedBoxGeometry(50, 90, 40, 100, 10);\n    //   var transform = new THREE.Object3D();\n    //   transform.position.set(bead.position.x, bead.position.y, 0);\n    //   transform.updateMatrix();\n\n    //   let isSelected = false;\n\n    //   if (state.ui.selectedBeadsIdsCount > 0) {\n    //     isSelected = Object.keys(state.ui.selectedBeadsIds).includes(bead.id);\n    //   }\n\n    //   //  width, height, depth, radius, radiusSegments\n    //   // var geometry = new RoundedBoxGeometry(\n    //   //   bead.width,\n    //   //   bead.height,\n    //   //   Math.max(bead.width, bead.height),\n    //   //   bead.type === BeadTypes.BasicEllipse\n    //   //     ? Math.max(bead.width, bead.height)\n    //   //     : 0,\n    //   //   bead.type === BeadTypes.BasicEllipse\n    //   //     ? Math.max(bead.width, bead.height)\n    //   //     : 0\n    //   // );\n    //   // var geometry = new BoxGeometry(bead.width, bead.height, 10);\n\n    // for (let i = 0; i < 10 * 10; i = i + 10) {\n    //   for (let j = 0; j < 10 * 50; j = j + 10) {\n    //     var geometry = new SphereGeometry(Math.max(8, 8), 16, 16);\n    //     var material = new THREE.MeshPhongMaterial({\n    //       color: \"red\",\n    //     });\n    //     var beadMesh = new THREE.Mesh(geometry, material);\n    //     beadMesh.applyMatrix(\n    //       new THREE.Matrix4().makeRotationX(THREE.Math.DEG2RAD * 90)\n    //     );\n    //     beadMesh.applyMatrix(new THREE.Matrix4().makeTranslation(i, j, 0));\n    //     basicMesh.push(beadMesh);\n    //     const uuid1 = `${generate()}`;\n    //     beadMesh.name = uuid1;\n    //     scene.add(beadMesh);\n    //   }\n    // }\n\n    // console.log(scene.getObjectByName(uuid1));\n\n    //   // shape.applyMatrix(transform);\n    //   // basicMesh.add(shape);\n    //   // mesh.setMatrixAt(i++, transform.matrix);\n    //   // mesh.matrixWorldNeedsUpdate = true;\n    // });\n    // scene.add(basicMesh);\n\n    // setTimeout(() => {\n    //   basicMesh.matrixWorldNeedsUpdate = true;\n    //   basicMesh.translateX(1);\n    //   scene.visible = true;\n    //   render();\n    // }, 10);\n\n    // basicMesh.updateMatrixWorld();\n    // basicMesh.updateMorphTargets();\n    // basicMesh.updateWorldMatrix(true, true);\n    // basicMesh.updateMatrix();\n\n    // scene.matrixWorldNeedsUpdate = true;\n    // scene.add(basicMesh);\n\n    // console.log(\"mesh?\", basicMesh);\n    // renderer.render(scene, camera);\n  });\n\n  // const { dispatch, subscribe, getState } = appStore;\n\n  // subscribe(() => {\n  //   renderBeads();\n  // });\n  // dispatch({type: \"\"})\n\n  var basicMesh: THREE.Mesh[] = [];\n  var sceneScale = 1;\n\n  function init() {\n    if (el !== null) {\n      const { width, height } = el.getBoundingClientRect();\n\n      // camera = new THREE.PerspectiveCamera(60, width / height, 0.1, 100);\n      camera = new THREE.OrthographicCamera(\n        width / -2,\n        width / 2,\n        height / 2,\n        height / -2,\n        -1000,\n        1000\n      );\n    }\n    // camera.position.set(amount, amount, amount);\n    camera.position.set(0, 0, 500);\n    camera.lookAt(0, 0, 0);\n\n    // camera.zoom\n\n    scene = new THREE.Scene();\n\n    // var light = new THREE.HemisphereLight(0xffffff, 0x666, 1);\n    // light.position.set(0, 0, 1000);\n    // // light.position.set(-1, 1.5, 1);\n    // // light.position.set(-1, 1.5, 1);\n    // scene.add(light);\n\n    scene.background = new THREE.Color(\"#F1F3F3\");\n    // scene.background = new THREE.TextureLoader().load(require('./img/background.jpg').default);\n\n    // const l1 = new THREE.DirectionalLight(\"#FFF\", 0.99);\n    // const l1 = new THREE.DirectionalLight(\"#FFF\", 0.8);\n    // l1.position.set(0, 0, 1);\n    // l1.name = \"main_light_1\";\n    // scene.add(l1);\n\n    // const l2 = new THREE.AmbientLight(\"#FFF\", 0.1);\n    // const l2 = new THREE.AmbientLight(\"#FFF\", 0.2);\n    // l2.position.set(0, 0, 1);\n    // l2.name = \"main_light_2\";\n    // scene.add(l2);\n\n    // const directionalLight2 = new THREE.DirectionalLight(\"#FFF\", 0.99);\n    // directionalLight2.position.set(-10, -10, -10);\n    // scene.add(directionalLight2);\n\n    var bg_geometry = new THREE.PlaneGeometry(1000, 1000, 1);\n    var bg_material = new THREE.MeshBasicMaterial({\n      color: \"#ccc\",\n      side: THREE.DoubleSide,\n    });\n\n    var bg_plane = new THREE.Mesh(bg_geometry, bg_material);\n    scene.add(bg_plane);\n\n    // const li = scene.getObjectByName('main_light_1');\n    // console.log('co to za swiatlo??', li)\n\n    // var light1 = new THREE.PointLight(color, intensivity, distance);\n    // light1.position.set(-300, 300, z_index);\n    // scene.add(light1);\n\n    // var light2 = new THREE.PointLight(color, intensivity, distance);\n    // light2.position.set(-300, -300, z_index);\n    // scene.add(light2);\n\n    // var light3 = new THREE.PointLight(color, intensivity, distance);\n    // light3.position.set(300, 300, z_index);\n    // scene.add(light3);\n\n    // var light4 = new THREE.PointLight(color, intensivity, distance);\n    // light4.position.set(300, -300, z_index);\n    // scene.add(light4);\n\n    // var light4 = new THREE.PointLight(color, 0.4, distance);\n    // light4.position.set(0, 0, z_index);\n    // scene.add(light4);\n\n    var bg_geometry = new THREE.PlaneGeometry(1000, 1000, 1);\n    var bg_material = new THREE.MeshBasicMaterial({\n      color: \"#ccc\",\n      side: THREE.DoubleSide,\n    });\n\n    var bg_plane = new THREE.Mesh(bg_geometry, bg_material);\n    scene.add(bg_plane);\n\n    // var light = new THREE.HemisphereLight(0xffffff, 0x880000, 0.5);\n    // light.position.set(-1, -1.5, -1);\n    // scene.add(light);\n\n    // interface RoundedBoxGeometryProps{\n    //   width, height, depth, radius, radiusSegments\n    // }\n    // var __geometry = new RoundedBoxGeometry(50, 90, 40, 100, 10);\n    // var __material = new THREE.MeshPhysicalMaterial({\n    //   flatShading: true,\n    //   reflectivity: reflectivity,\n    //   color: \"red\"\n    // });\n\n    // mesh = new THREE.InstancedMesh(__geometry, __material, 20);\n    // var __transform = new THREE.Object3D();\n    // __transform.position.set(10, 10, 10);\n    // __transform.updateMatrix();\n    // mesh.setMatrixAt(0, __transform.matrix);\n    // scene.add(mesh);\n\n    // var geometry = new THREE.SphereBufferGeometry(20);\n    // var geometry = new THREE.BoxBufferGeometry(40, 40, 40);\n\n    // var material = new THREE.MeshPhysicalMaterial({\n    //   flatShading: true,\n    //   reflectivity: reflectivity,\n    //   color: \"rgb(25, 118, 210)\"\n    // });\n\n    // mesh = new THREE.InstancedMesh(geometry, material, count);\n\n    // var i = 0;\n    // var offset = (60 * (amount - 1)) / 2;\n\n    // var transform = new THREE.Object3D();\n\n    // for (var x = 0; x < amount; x++) {\n    //   for (var y = 0; y < amount; y++) {\n    //     // for (var z = 0; z < amount; z++) {\n    //     transform.position.set(\n    //       offset - x * 60,\n    //       offset - y * 60,\n    //       // offset - z * 60\n    //       0\n    //     );\n    //     transform.updateMatrix();\n\n    //     mesh.setMatrixAt(i++, transform.matrix);\n    //     // }\n    //   }\n    // }\n\n    // scene.add(mesh);\n\n    // const { dispatch, subscribe, getState } = appStore;\n    // const state = getState();\n\n    //\n\n    // var gui: any = new GUI();\n    // gui.add(mesh, \"count\", 0, count);\n\n    // console.log(\"init\");\n    renderer = new THREE.WebGLRenderer({ antialias: true });\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    if (el !== null) {\n      const { width, height } = el.getBoundingClientRect();\n      renderer.setSize(width, height);\n      el.appendChild(renderer.domElement);\n    }\n\n    // new OrbitControls(camera, renderer.domElement);\n\n    // stats = new (Stats as any)();\n    // if (el !== null) {\n    //   el.appendChild(stats.dom);\n    // }\n\n    window.addEventListener(\"resize\", onWindowResize, false);\n\n    if (el !== null) {\n      el.addEventListener(\"mousedown\", onMouseDown, false);\n      el.addEventListener(\"mousemove\", onMouseMove, false);\n      el.addEventListener(\"mouseup\", onMouseUp, false);\n      el.addEventListener(\"wheel\", onWheel, false);\n    }\n    mouseSelectionHelper.setRenderer(renderer);\n  }\n\n  function onWheel(event) {\n    event.preventDefault();\n    if (el !== null) {\n      const { width, height, top, left } = el.getBoundingClientRect();\n      // const __x1 = event.clientX - left - (width * sceneScale) / 2;\n      // const __y1 = (height * sceneScale) / 2 - (event.clientY - top);\n\n      const screenX = event.clientX - left;\n      const screenY = event.clientY - top;\n\n      const cameraX = camera.position.x;\n      const cameraY = camera.position.y;\n\n      const mouseXInWorldBefore = (screenX - width / 2) * sceneScale;\n      const mouseYInWorldBefore = -1 * (screenY - height / 2) * sceneScale;\n\n      sceneScale += Math.sign(event.deltaY) * 0.02;\n      sceneScale = Math.min(Math.max(0.125, sceneScale), 4);\n\n      const mouseXInWorldAfter = (screenX - width / 2) * sceneScale;\n      const mouseYInWorldAfter = -1 * (screenY - height / 2) * sceneScale;\n\n      camera.left = (width * sceneScale) / -2;\n      camera.right = (width * sceneScale) / 2;\n      camera.top = (height * sceneScale) / 2;\n      camera.bottom = (height * sceneScale) / -2;\n      camera.updateProjectionMatrix();\n\n      const diffX = mouseXInWorldBefore - mouseXInWorldAfter;\n      const diffY = mouseYInWorldBefore - mouseYInWorldAfter;\n\n      camera.position.x = cameraX + diffX;\n      camera.position.y = cameraY + diffY;\n      camera.lookAt(camera.position.x, camera.position.y, 0);\n\n      // camera.zoom = sceneScale;\n      // console.log('co to jest w getBoundingClientRect:', width, height)\n\n      // const __x2 = event.clientX - left - (width * sceneScale) / 2;\n      // const __y2 = (height * sceneScale) / 2 - (event.clientY - top);\n\n      // const delta_x1 = __x1 - __x2;\n      // const delta_y1 = __y1 - __y2;\n\n      // console.log(\n      //   \"jaki jest scale?\",\n      //   event.clientX,\n      //   event.clientY,\n      //   sceneScale,\n      //   delta_x1,\n      //   delta_y1\n      // );\n\n      // camera.position.set(\n      //   camera.position.x - delta_x1,\n      //   camera.position.y - delta_y1,\n      //   camera.position.z\n      // );\n      // camera.lookAt(\n      //   camera.position.x - delta_x1,\n      //   camera.position.y - delta_y1,\n      //   0\n      // );\n    }\n  }\n\n  const screenToWorld = (clientX, clientY): THREE.Vector2 => {\n    if (el === null) {\n      throw new Error(\"no el in dom\");\n    }\n\n    const { width, height, top, left } = el.getBoundingClientRect();\n    const screenX = clientX - left;\n    const screenY = clientY - top;\n    const x = (screenX - width / 2) * sceneScale + camera.position.x;\n    const y = (-screenY + height / 2) * sceneScale + camera.position.y;\n    return new THREE.Vector2(x, y);\n  };\n\n  let isCameraGrabed = false;\n  let startDragMousePosition = new THREE.Vector2();\n  let startDragCamera = new THREE.Vector2();\n\n  let boundingClientRect;\n\n  function onMouseDown(event) {\n    const { getState } = appStore;\n    const state = getState();\n    if (state.mode === EditorMode.Idle) {\n      isCameraGrabed = true;\n      if (el !== null) {\n        const { width, height, top, left } = el.getBoundingClientRect();\n        boundingClientRect = el.getBoundingClientRect();\n\n        const screenX = event.clientX - left;\n        const screenY = event.clientY - top;\n        startDragMousePosition.x = screenX;\n        startDragMousePosition.y = screenY;\n\n        startDragCamera.x = camera.position.x;\n        startDragCamera.y = camera.position.y;\n      }\n    } else if (state.mode === EditorMode.EditBeads) {\n      if (el !== null) {\n        boundingClientRect = el.getBoundingClientRect();\n      }\n      const { x, y } = screenToWorld(event.clientX, event.clientY);\n      mouseSelectionBeads.onDown(x, y);\n      if (el === null) {\n        throw new Error(\"no el in dom\");\n      }\n      const { width, height, top, left } = el.getBoundingClientRect();\n      const screenX = event.clientX - left;\n      const screenY = event.clientY - top;\n      mouseSelectionHelper.onDown(screenX, screenY);\n    }\n  }\n\n  function onMouseUp(event) {\n    const { dispatch, getState } = appStore;\n    const state = getState();\n    if (state.mode === EditorMode.AddBeads) {\n      const { x, y } = screenToWorld(event.clientX, event.clientY);\n      dispatch(\n        Actions.Draggable.action_addBeadOnClick({\n          x,\n          y,\n        })\n      );\n    } else if (state.mode === EditorMode.Idle) {\n      if (isCameraGrabed === true) {\n        isCameraGrabed = false;\n      }\n    } else if (state.mode === EditorMode.EditBeads) {\n      if (mouseSelectionBeads.isDragged === true) {\n        // do nothing\n      } else if (\n        mouseSelectionBeads.isDragged === false &&\n        mouseSelectionBeads.isDragStarted === true\n      ) {\n        const { x, y } = screenToWorld(event.clientX, event.clientY);\n        const beadsIds: string[] = [];\n        Object.keys(state.appData.beads).forEach((beadId) => {\n          const bead = state.appData.beads[beadId];\n          const leftTop = buildPoint(\n            bead.position.x - bead.width / 2,\n            bead.position.y - bead.height / 2\n          );\n          const rightBottom = buildPoint(\n            bead.position.x + bead.width / 2,\n            bead.position.y + bead.height / 2\n          );\n          if (contain(leftTop, rightBottom, buildPoint(x, y))) {\n            beadsIds.push(beadId);\n          }\n        });\n        dispatch(Actions.MouseSelection.action_selectBeads(beadsIds));\n      } else {\n        dispatch(Actions.MouseSelection.action_selectBeads([]));\n      }\n      mouseSelectionBeads.onUp();\n      mouseSelectionHelper.onUp();\n    }\n  }\n\n  function onWindowResize() {\n    // console.log(\"onWindowResize\");\n    // const { dispatch, subscribe, getState } = appStore;\n    // const state = getState();\n\n    if (el !== null) {\n      const { width, height } = el.getBoundingClientRect();\n\n      // camera.aspect = width / height;\n      // (camera as THREE.OrthographicCamera)\n      camera.left = width / -2;\n      camera.right = width / 2;\n      camera.top = height / 2;\n      camera.bottom = height / -2;\n      camera.updateProjectionMatrix();\n      renderer.setSize(width, height);\n    }\n  }\n\n  function onMouseMove(event) {\n    if (boundingClientRect) {\n      // event.preventDefault();\n      const { width, height, top, left } = boundingClientRect;\n\n      // Used in: Clicked at item in world?\n      mouse_intercestion.x = ((event.clientX - left) / width) * 2 - 1;\n      mouse_intercestion.y = -((event.clientY - top) / height) * 2 + 1;\n\n      const screenX = event.clientX - left;\n      const screenY = event.clientY - top;\n\n      if (isCameraGrabed === true) {\n        const screenMouseDiffX = startDragMousePosition.x - screenX;\n        const screenMouseDiffY = startDragMousePosition.y - screenY;\n\n        const mouseDiffXInWorldSpace = screenMouseDiffX * sceneScale;\n        const mouseDiffYInWorldSpace = screenMouseDiffY * sceneScale;\n\n        const cameraX = startDragCamera.x + mouseDiffXInWorldSpace;\n        const cameraY = startDragCamera.y - mouseDiffYInWorldSpace;\n        camera.position.x = cameraX;\n        camera.position.y = cameraY;\n        camera.lookAt(cameraX, cameraY, 0);\n      }\n\n      const { dispatch, subscribe, getState } = appStore;\n      const state = getState();\n\n      if (state.mode === EditorMode.EditBeads) {\n        if (mouseSelectionBeads.isDragStarted === true) {\n          const { x, y } = screenToWorld(event.clientX, event.clientY);\n          mouseSelectionBeads.onMove(x, y);\n          if (mouseSelectionBeads.isDragged === true) {\n            const beadsIds: string[] = [];\n            Object.keys(state.appData.beads).forEach((beadId) => {\n              const bead = state.appData.beads[beadId];\n              if (mouseSelectionBeads.contain(bead.position)) {\n                beadsIds.push(beadId);\n              }\n            });\n            dispatch(Actions.MouseSelection.action_selectBeads(beadsIds));\n          }\n        }\n        if (el === null) {\n          throw new Error(\"no el in dom\");\n        }\n        const { width, height, top, left } = el.getBoundingClientRect();\n        const screenX = event.clientX - left;\n        const screenY = event.clientY - top;\n        mouseSelectionHelper.onMove(screenX, screenY);\n      }\n    }\n  }\n\n  function animate() {\n    requestAnimationFrame(animate);\n\n    render();\n  }\n\n  function render() {\n    // console.log('render camra')\n    // if (basicMesh !== undefined && basicMesh.length > 0) {\n    //   raycaster.setFromCamera(mouse_intercestion, camera);\n    //   var intersection: any = raycaster.intersectObject(basicMesh[0]);\n\n    //   if (intersection.length > 0) {\n    //     console.log(\"co zaznaczono?\", intersection);\n    //     //   var instanceId = intersection[0].instanceId;\n\n    //     //   mesh.getMatrixAt(instanceId, instanceMatrix);\n    //     //   matrix.multiplyMatrices(instanceMatrix, rotationMatrix);\n\n    //     //   mesh.setMatrixAt(instanceId, matrix);\n    //     //   mesh.instanceMatrix.needsUpdate = true;\n    //   }\n    // }\n\n    // if(mesh){\n    //   mesh.instanceMatrix.needsUpdate = true;\n    //   // mesh.rotateX(0.01)\n    // }\n\n    renderer.render(scene, camera);\n    // console.log(\"render\")\n\n    // stats.update();\n  }\n};\n\nclass MouseSelection {\n  isDragged: boolean = false;\n  isDragStarted: boolean = false;\n  end: { x: number; y: number } = { x: 0, y: 0 };\n  start: { x: number; y: number } = { x: 0, y: 0 };\n\n  onUp() {\n    this.isDragStarted = false;\n    this.isDragged = false;\n    this.start.x = 0;\n    this.start.y = 0;\n    this.end.x = 0;\n    this.end.y = 0;\n  }\n\n  onDown(x: number, y: number) {\n    this.isDragStarted = true;\n    this.start.x = x;\n    this.start.y = y;\n    this.end.x = x;\n    this.end.y = y;\n  }\n\n  onMove(x: number, y: number) {\n    if (this.isDragStarted == true) {\n      this.end.x = x;\n      this.end.y = y;\n      if (this.isDragged === false) {\n        const { start, end } = this;\n        const deltaX = end.x - start.x;\n        const deltaY = end.y - start.y;\n\n        if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {\n          this.isDragged = true;\n        }\n      }\n    }\n  }\n\n  contain(p: { x: number; y: number }) {\n    const { start, end } = this;\n\n    const p1_x = Math.min(start.x, end.x);\n    const p1_y = Math.min(start.y, end.y);\n\n    const p2_x = Math.max(start.x, end.x);\n    const p2_y = Math.max(start.y, end.y);\n\n    return p.x > p1_x && p.x < p2_x && p.y > p1_y && p.y < p2_y;\n  }\n}\n\nclass MouseSelectionHelper {\n  element: HTMLDivElement;\n  renderer: any;\n  startPoint: Vector2;\n  pointTopLeft: Vector2;\n  pointBottomRight: Vector2;\n  isDown: boolean;\n\n  constructor() {\n    this.element = document.createElement(\"div\");\n    this.element.style.pointerEvents = \"none\";\n    this.element.style.background = \"rgba(75, 160, 255, 0.3)\";\n    this.element.style.border = \"1px solid #55aaff\";\n    this.element.style.position = \"absolute\";\n    this.element.style.zIndex = \"2\";\n    this.startPoint = new Vector2();\n    this.pointTopLeft = new Vector2();\n    this.pointBottomRight = new Vector2();\n    this.isDown = false;\n  }\n\n  setRenderer(renderer) {\n    this.renderer = renderer;\n  }\n\n  onDown(screenX: number, screenY: number) {\n    this.isDown = true;\n    this.renderer.domElement.parentElement.appendChild(this.element);\n\n    // this.element.setAttribute(\"style\", `\n    //   left: ${screenX}px;\n    //   top: ${screenY}px;\n    //   width: 0px;\n    //   height: 0px;\n    // `);\n    this.element.style.left = screenX + \"px\";\n    this.element.style.top = screenY + \"px\";\n    this.element.style.width = \"0px\";\n    this.element.style.height = \"0px\";\n\n    this.startPoint.x = screenX;\n    this.startPoint.y = screenY;\n  }\n\n  onMove(screenX: number, screenY: number) {\n    if (this.isDown) {\n      this.pointBottomRight.x = Math.max(this.startPoint.x, screenX);\n      this.pointBottomRight.y = Math.max(this.startPoint.y, screenY);\n      this.pointTopLeft.x = Math.min(this.startPoint.x, screenX);\n      this.pointTopLeft.y = Math.min(this.startPoint.y, screenY);\n\n      this.element.style.left = this.pointTopLeft.x + \"px\";\n      this.element.style.top = this.pointTopLeft.y + \"px\";\n      this.element.style.width =\n        this.pointBottomRight.x - this.pointTopLeft.x + \"px\";\n      this.element.style.height =\n        this.pointBottomRight.y - this.pointTopLeft.y + \"px\";\n    }\n  }\n\n  onUp() {\n    if (this.element.parentElement !== null) {\n      this.element.parentElement.removeChild(this.element);\n    }\n  }\n\n  // this.renderer.domElement.addEventListener( 'mousedown', function ( event ) {\n\n  //   this.isDown = true;\n  //   this.onSelectStart( event );\n\n  // }.bind( this ), false );\n\n  // this.renderer.domElement.addEventListener( 'mousemove', function ( event ) {\n\n  //   if ( this.isDown ) {\n\n  //     this.onSelectMove( event );\n\n  //   }\n\n  // }.bind( this ), false );\n\n  // this.renderer.domElement.addEventListener( 'mouseup', function ( event ) {\n\n  //   this.isDown = false;\n  //   this.onSelectOver( event );\n\n  // }.bind( this ), false );\n}\n\n// SelectionHelper.prototype.onSelectStart = function ( event ) {\n\n//   this.renderer.domElement.parentElement.appendChild( this.element );\n\n//   this.element.style.left = event.clientX + 'px';\n//   this.element.style.top = event.clientY + 'px';\n//   this.element.style.width = '0px';\n//   this.element.style.height = '0px';\n\n//   this.startPoint.x = event.clientX;\n//   this.startPoint.y = event.clientY;\n\n// };\n\n// SelectionHelper.prototype.onSelectMove = function ( event ) {\n\n//   this.pointBottomRight.x = Math.max( this.startPoint.x, event.clientX );\n//   this.pointBottomRight.y = Math.max( this.startPoint.y, event.clientY );\n//   this.pointTopLeft.x = Math.min( this.startPoint.x, event.clientX );\n//   this.pointTopLeft.y = Math.min( this.startPoint.y, event.clientY );\n\n//   this.element.style.left = this.pointTopLeft.x + 'px';\n//   this.element.style.top = this.pointTopLeft.y + 'px';\n//   this.element.style.width = ( this.pointBottomRight.x - this.pointTopLeft.x ) + 'px';\n//   this.element.style.height = ( this.pointBottomRight.y - this.pointTopLeft.y ) + 'px';\n\n// };\n\n// SelectionHelper.prototype.onSelectOver = function () {\n\n//   this.element.parentElement.removeChild( this.element );\n\n// };\n","import { createStore } from \"redux\";\nimport { store } from \"./store\";\n\nexport const appStore = createStore(\n  store\n  // \"__REDUX_DEVTOOLS_EXTENSION__\" in window &&\n  //   (window as any).__REDUX_DEVTOOLS_EXTENSION__()\n);\n","import React from \"react\";\nimport \"bulma/css/bulma.css\";\nimport \"./App.css\";\nimport { EditorScene } from \"./components/Editor\";\nimport { Provider } from \"react-redux\";\nimport { appStore } from \"./immerReducers/appStore\";\nimport { buildBead } from \"./editorObjects/Bead\";\nimport { Actions } from \"./immerReducers/store\";\n\nconst App: React.FC = () => {\n  console.log(\"render App.tsx\");\n\n  React.useEffect(() => {\n    appStore.dispatch({\n      type: \"startAppEvent\",\n      payload: { state: appStore.getState() },\n    });\n\n    appStore.dispatch(Actions.Persist.action_readSavedCanvas());\n  }, []);\n\n  return (\n    <div className=\"App\">\n      <Provider store={appStore}>\n        <EditorScene />\n      </Provider>\n    </div>\n  );\n};\n\nexport default App;\n\n// \"homepage\": \"https://rpcal.github.io/coralinio-preview/build/\",\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n// import * as Sentry from '@sentry/browser';\nimport { renderThreejs } from './threejs/renderThreejs';\n// import { EventEmitter } from 'stream';\n\n// Sentry.init({dsn: \"https://94d8408ba8ab4a369c83de035643afa2@sentry.io/1807713\"});\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nrenderThreejs(document.getElementById('threejs'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}